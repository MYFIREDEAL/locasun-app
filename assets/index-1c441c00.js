var P$=Object.defineProperty;var T$=(e,t,r)=>t in e?P$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Gs=(e,t,r)=>(T$(e,typeof t!="symbol"?t+"":t,r),r);function rN(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();const k$="modulepreload",A$=function(e){return"/"+e},Ib={},Fr=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=A$(i),i in Ib)return;Ib[i]=!0;const a=i.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!n)for(let f=s.length-1;f>=0;f--){const d=s[f];if(d.href===i&&(!a||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":k$,a||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),a)return new Promise((f,d)=>{u.addEventListener("load",f),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i})};var eoe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Di(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function R$(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var nN={exports:{}},wf={},sN={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bc=Symbol.for("react.element"),I$=Symbol.for("react.portal"),O$=Symbol.for("react.fragment"),D$=Symbol.for("react.strict_mode"),$$=Symbol.for("react.profiler"),M$=Symbol.for("react.provider"),L$=Symbol.for("react.context"),F$=Symbol.for("react.forward_ref"),B$=Symbol.for("react.suspense"),z$=Symbol.for("react.memo"),U$=Symbol.for("react.lazy"),Ob=Symbol.iterator;function V$(e){return e===null||typeof e!="object"?null:(e=Ob&&e[Ob]||e["@@iterator"],typeof e=="function"?e:null)}var iN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oN=Object.assign,aN={};function da(e,t,r){this.props=e,this.context=t,this.refs=aN,this.updater=r||iN}da.prototype.isReactComponent={};da.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};da.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lN(){}lN.prototype=da.prototype;function ox(e,t,r){this.props=e,this.context=t,this.refs=aN,this.updater=r||iN}var ax=ox.prototype=new lN;ax.constructor=ox;oN(ax,da.prototype);ax.isPureReactComponent=!0;var Db=Array.isArray,cN=Object.prototype.hasOwnProperty,lx={current:null},uN={key:!0,ref:!0,__self:!0,__source:!0};function dN(e,t,r){var n,s={},i=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)cN.call(t,n)&&!uN.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:bc,type:e,key:i,ref:a,props:s,_owner:lx.current}}function q$(e,t){return{$$typeof:bc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function cx(e){return typeof e=="object"&&e!==null&&e.$$typeof===bc}function W$(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var $b=/\/+/g;function dp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?W$(""+e.key):t.toString(36)}function Ku(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case bc:case I$:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+dp(a,0):n,Db(s)?(r="",e!=null&&(r=e.replace($b,"$&/")+"/"),Ku(s,t,r,"",function(u){return u})):s!=null&&(cx(s)&&(s=q$(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace($b,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",Db(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+dp(i,l);a+=Ku(i,t,r,c,s)}else if(c=V$(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+dp(i,l++),a+=Ku(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function tu(e,t,r){if(e==null)return e;var n=[],s=0;return Ku(e,n,"","",function(i){return t.call(r,i,s++)}),n}function H$(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qt={current:null},Yu={transition:null},G$={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:Yu,ReactCurrentOwner:lx};function fN(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:tu,forEach:function(e,t,r){tu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return tu(e,function(){t++}),t},toArray:function(e){return tu(e,function(t){return t})||[]},only:function(e){if(!cx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ee.Component=da;Ee.Fragment=O$;Ee.Profiler=$$;Ee.PureComponent=ox;Ee.StrictMode=D$;Ee.Suspense=B$;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G$;Ee.act=fN;Ee.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=oN({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=lx.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)cN.call(t,c)&&!uN.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:bc,type:e.type,key:s,ref:i,props:n,_owner:a}};Ee.createContext=function(e){return e={$$typeof:L$,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:M$,_context:e},e.Consumer=e};Ee.createElement=dN;Ee.createFactory=function(e){var t=dN.bind(null,e);return t.type=e,t};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(e){return{$$typeof:F$,render:e}};Ee.isValidElement=cx;Ee.lazy=function(e){return{$$typeof:U$,_payload:{_status:-1,_result:e},_init:H$}};Ee.memo=function(e,t){return{$$typeof:z$,type:e,compare:t===void 0?null:t}};Ee.startTransition=function(e){var t=Yu.transition;Yu.transition={};try{e()}finally{Yu.transition=t}};Ee.unstable_act=fN;Ee.useCallback=function(e,t){return qt.current.useCallback(e,t)};Ee.useContext=function(e){return qt.current.useContext(e)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(e){return qt.current.useDeferredValue(e)};Ee.useEffect=function(e,t){return qt.current.useEffect(e,t)};Ee.useId=function(){return qt.current.useId()};Ee.useImperativeHandle=function(e,t,r){return qt.current.useImperativeHandle(e,t,r)};Ee.useInsertionEffect=function(e,t){return qt.current.useInsertionEffect(e,t)};Ee.useLayoutEffect=function(e,t){return qt.current.useLayoutEffect(e,t)};Ee.useMemo=function(e,t){return qt.current.useMemo(e,t)};Ee.useReducer=function(e,t,r){return qt.current.useReducer(e,t,r)};Ee.useRef=function(e){return qt.current.useRef(e)};Ee.useState=function(e){return qt.current.useState(e)};Ee.useSyncExternalStore=function(e,t,r){return qt.current.useSyncExternalStore(e,t,r)};Ee.useTransition=function(){return qt.current.useTransition()};Ee.version="18.3.1";sN.exports=Ee;var p=sN.exports;const J=Di(p),wc=rN({__proto__:null,default:J},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K$=p,Y$=Symbol.for("react.element"),J$=Symbol.for("react.fragment"),X$=Object.prototype.hasOwnProperty,Q$=K$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Z$={key:!0,ref:!0,__self:!0,__source:!0};function hN(e,t,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)X$.call(t,n)&&!Z$.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:Y$,type:e,key:i,ref:a,props:s,_owner:Q$.current}}wf.Fragment=J$;wf.jsx=hN;wf.jsxs=hN;nN.exports=wf;var o=nN.exports,Jm={},pN={exports:{}},br={},mN={exports:{}},gN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(I,D){var $=I.length;I.push(D);e:for(;0<$;){var M=$-1>>>1,W=I[M];if(0<s(W,D))I[M]=D,I[$]=W,$=M;else break e}}function r(I){return I.length===0?null:I[0]}function n(I){if(I.length===0)return null;var D=I[0],$=I.pop();if($!==D){I[0]=$;e:for(var M=0,W=I.length,U=W>>>1;M<U;){var X=2*(M+1)-1,me=I[X],se=X+1,Z=I[se];if(0>s(me,$))se<W&&0>s(Z,me)?(I[M]=Z,I[se]=$,M=se):(I[M]=me,I[X]=$,M=X);else if(se<W&&0>s(Z,$))I[M]=Z,I[se]=$,M=se;else break e}}return D}function s(I,D){var $=I.sortIndex-D.sortIndex;return $!==0?$:I.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],u=[],f=1,d=null,h=3,m=!1,g=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(I){for(var D=r(u);D!==null;){if(D.callback===null)n(u);else if(D.startTime<=I)n(u),D.sortIndex=D.expirationTime,t(c,D);else break;D=r(u)}}function j(I){if(v=!1,w(I),!g)if(r(c)!==null)g=!0,F(_);else{var D=r(u);D!==null&&V(j,D.startTime-I)}}function _(I,D){g=!1,v&&(v=!1,x(E),E=-1),m=!0;var $=h;try{for(w(D),d=r(c);d!==null&&(!(d.expirationTime>D)||I&&!L());){var M=d.callback;if(typeof M=="function"){d.callback=null,h=d.priorityLevel;var W=M(d.expirationTime<=D);D=e.unstable_now(),typeof W=="function"?d.callback=W:d===r(c)&&n(c),w(D)}else n(c);d=r(c)}if(d!==null)var U=!0;else{var X=r(u);X!==null&&V(j,X.startTime-D),U=!1}return U}finally{d=null,h=$,m=!1}}var S=!1,N=null,E=-1,C=5,k=-1;function L(){return!(e.unstable_now()-k<C)}function A(){if(N!==null){var I=e.unstable_now();k=I;var D=!0;try{D=N(!0,I)}finally{D?R():(S=!1,N=null)}}else S=!1}var R;if(typeof b=="function")R=function(){b(A)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,z=O.port2;O.port1.onmessage=A,R=function(){z.postMessage(null)}}else R=function(){y(A,0)};function F(I){N=I,S||(S=!0,R())}function V(I,D){E=y(function(){I(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,F(_))},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(I){switch(h){case 1:case 2:case 3:var D=3;break;default:D=h}var $=h;h=D;try{return I()}finally{h=$}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(I,D){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var $=h;h=I;try{return D()}finally{h=$}},e.unstable_scheduleCallback=function(I,D,$){var M=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?M+$:M):$=M,I){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=$+W,I={id:f++,callback:D,priorityLevel:I,startTime:$,expirationTime:W,sortIndex:-1},$>M?(I.sortIndex=$,t(u,I),r(c)===null&&I===r(u)&&(v?(x(E),E=-1):v=!0,V(j,$-M))):(I.sortIndex=W,t(c,I),g||m||(g=!0,F(_))),I},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(I){var D=h;return function(){var $=h;h=D;try{return I.apply(this,arguments)}finally{h=$}}}})(gN);mN.exports=gN;var eM=mN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tM=p,vr=eM;function re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vN=new Set,Rl={};function $i(e,t){Ho(e,t),Ho(e+"Capture",t)}function Ho(e,t){for(Rl[e]=t,e=0;e<t.length;e++)vN.add(t[e])}var Un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xm=Object.prototype.hasOwnProperty,rM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mb={},Lb={};function nM(e){return Xm.call(Lb,e)?!0:Xm.call(Mb,e)?!1:rM.test(e)?Lb[e]=!0:(Mb[e]=!0,!1)}function sM(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function iM(e,t,r,n){if(t===null||typeof t>"u"||sM(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Wt(e,t,r,n,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Et[e]=new Wt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Et[t]=new Wt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Et[e]=new Wt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Et[e]=new Wt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Et[e]=new Wt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Et[e]=new Wt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Et[e]=new Wt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Et[e]=new Wt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Et[e]=new Wt(e,5,!1,e.toLowerCase(),null,!1,!1)});var ux=/[\-:]([a-z])/g;function dx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ux,dx);Et[t]=new Wt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ux,dx);Et[t]=new Wt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ux,dx);Et[t]=new Wt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Et[e]=new Wt(e,1,!1,e.toLowerCase(),null,!1,!1)});Et.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Et[e]=new Wt(e,1,!1,e.toLowerCase(),null,!0,!0)});function fx(e,t,r,n){var s=Et.hasOwnProperty(t)?Et[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(iM(t,r,s,n)&&(r=null),n||s===null?nM(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Qn=tM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ru=Symbol.for("react.element"),ho=Symbol.for("react.portal"),po=Symbol.for("react.fragment"),hx=Symbol.for("react.strict_mode"),Qm=Symbol.for("react.profiler"),xN=Symbol.for("react.provider"),yN=Symbol.for("react.context"),px=Symbol.for("react.forward_ref"),Zm=Symbol.for("react.suspense"),eg=Symbol.for("react.suspense_list"),mx=Symbol.for("react.memo"),cs=Symbol.for("react.lazy"),bN=Symbol.for("react.offscreen"),Fb=Symbol.iterator;function $a(e){return e===null||typeof e!="object"?null:(e=Fb&&e[Fb]||e["@@iterator"],typeof e=="function"?e:null)}var nt=Object.assign,fp;function rl(e){if(fp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);fp=t&&t[1]||""}return`
`+fp+e}var hp=!1;function pp(e,t){if(!e||hp)return"";hp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{hp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?rl(e):""}function oM(e){switch(e.tag){case 5:return rl(e.type);case 16:return rl("Lazy");case 13:return rl("Suspense");case 19:return rl("SuspenseList");case 0:case 2:case 15:return e=pp(e.type,!1),e;case 11:return e=pp(e.type.render,!1),e;case 1:return e=pp(e.type,!0),e;default:return""}}function tg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case po:return"Fragment";case ho:return"Portal";case Qm:return"Profiler";case hx:return"StrictMode";case Zm:return"Suspense";case eg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case yN:return(e.displayName||"Context")+".Consumer";case xN:return(e._context.displayName||"Context")+".Provider";case px:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case mx:return t=e.displayName||null,t!==null?t:tg(e.type)||"Memo";case cs:t=e._payload,e=e._init;try{return tg(e(t))}catch{}}return null}function aM(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tg(t);case 8:return t===hx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Is(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wN(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function lM(e){var t=wN(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function nu(e){e._valueTracker||(e._valueTracker=lM(e))}function jN(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=wN(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function pd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function rg(e,t){var r=t.checked;return nt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Bb(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Is(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _N(e,t){t=t.checked,t!=null&&fx(e,"checked",t,!1)}function ng(e,t){_N(e,t);var r=Is(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?sg(e,t.type,r):t.hasOwnProperty("defaultValue")&&sg(e,t.type,Is(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function zb(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function sg(e,t,r){(t!=="number"||pd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var nl=Array.isArray;function ko(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Is(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function ig(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(re(91));return nt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ub(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(re(92));if(nl(r)){if(1<r.length)throw Error(re(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Is(r)}}function SN(e,t){var r=Is(t.value),n=Is(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Vb(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function NN(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function og(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?NN(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var su,EN=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(su=su||document.createElement("div"),su.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=su.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Il(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var hl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cM=["Webkit","ms","Moz","O"];Object.keys(hl).forEach(function(e){cM.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),hl[t]=hl[e]})});function CN(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||hl.hasOwnProperty(e)&&hl[e]?(""+t).trim():t+"px"}function PN(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=CN(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var uM=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ag(e,t){if(t){if(uM[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(re(62))}}function lg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cg=null;function gx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ug=null,Ao=null,Ro=null;function qb(e){if(e=Sc(e)){if(typeof ug!="function")throw Error(re(280));var t=e.stateNode;t&&(t=Ef(t),ug(e.stateNode,e.type,t))}}function TN(e){Ao?Ro?Ro.push(e):Ro=[e]:Ao=e}function kN(){if(Ao){var e=Ao,t=Ro;if(Ro=Ao=null,qb(e),t)for(e=0;e<t.length;e++)qb(t[e])}}function AN(e,t){return e(t)}function RN(){}var mp=!1;function IN(e,t,r){if(mp)return e(t,r);mp=!0;try{return AN(e,t,r)}finally{mp=!1,(Ao!==null||Ro!==null)&&(RN(),kN())}}function Ol(e,t){var r=e.stateNode;if(r===null)return null;var n=Ef(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(re(231,t,typeof r));return r}var dg=!1;if(Un)try{var Ma={};Object.defineProperty(Ma,"passive",{get:function(){dg=!0}}),window.addEventListener("test",Ma,Ma),window.removeEventListener("test",Ma,Ma)}catch{dg=!1}function dM(e,t,r,n,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var pl=!1,md=null,gd=!1,fg=null,fM={onError:function(e){pl=!0,md=e}};function hM(e,t,r,n,s,i,a,l,c){pl=!1,md=null,dM.apply(fM,arguments)}function pM(e,t,r,n,s,i,a,l,c){if(hM.apply(this,arguments),pl){if(pl){var u=md;pl=!1,md=null}else throw Error(re(198));gd||(gd=!0,fg=u)}}function Mi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function ON(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wb(e){if(Mi(e)!==e)throw Error(re(188))}function mM(e){var t=e.alternate;if(!t){if(t=Mi(e),t===null)throw Error(re(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Wb(s),e;if(i===n)return Wb(s),t;i=i.sibling}throw Error(re(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a)throw Error(re(189))}}if(r.alternate!==n)throw Error(re(190))}if(r.tag!==3)throw Error(re(188));return r.stateNode.current===r?e:t}function DN(e){return e=mM(e),e!==null?$N(e):null}function $N(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=$N(e);if(t!==null)return t;e=e.sibling}return null}var MN=vr.unstable_scheduleCallback,Hb=vr.unstable_cancelCallback,gM=vr.unstable_shouldYield,vM=vr.unstable_requestPaint,ot=vr.unstable_now,xM=vr.unstable_getCurrentPriorityLevel,vx=vr.unstable_ImmediatePriority,LN=vr.unstable_UserBlockingPriority,vd=vr.unstable_NormalPriority,yM=vr.unstable_LowPriority,FN=vr.unstable_IdlePriority,jf=null,xn=null;function bM(e){if(xn&&typeof xn.onCommitFiberRoot=="function")try{xn.onCommitFiberRoot(jf,e,void 0,(e.current.flags&128)===128)}catch{}}var Qr=Math.clz32?Math.clz32:_M,wM=Math.log,jM=Math.LN2;function _M(e){return e>>>=0,e===0?32:31-(wM(e)/jM|0)|0}var iu=64,ou=4194304;function sl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function xd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=sl(l):(i&=a,i!==0&&(n=sl(i)))}else a=r&~s,a!==0?n=sl(a):i!==0&&(n=sl(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Qr(t),s=1<<r,n|=e[r],t&=~s;return n}function SM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function NM(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Qr(i),l=1<<a,c=s[a];c===-1?(!(l&r)||l&n)&&(s[a]=SM(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function hg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function BN(){var e=iu;return iu<<=1,!(iu&4194240)&&(iu=64),e}function gp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function jc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Qr(t),e[t]=r}function EM(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Qr(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function xx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Qr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var $e=0;function zN(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var UN,yx,VN,qN,WN,pg=!1,au=[],ys=null,bs=null,ws=null,Dl=new Map,$l=new Map,fs=[],CM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gb(e,t){switch(e){case"focusin":case"focusout":ys=null;break;case"dragenter":case"dragleave":bs=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":Dl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$l.delete(t.pointerId)}}function La(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Sc(t),t!==null&&yx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function PM(e,t,r,n,s){switch(t){case"focusin":return ys=La(ys,e,t,r,n,s),!0;case"dragenter":return bs=La(bs,e,t,r,n,s),!0;case"mouseover":return ws=La(ws,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Dl.set(i,La(Dl.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,$l.set(i,La($l.get(i)||null,e,t,r,n,s)),!0}return!1}function HN(e){var t=ci(e.target);if(t!==null){var r=Mi(t);if(r!==null){if(t=r.tag,t===13){if(t=ON(r),t!==null){e.blockedOn=t,WN(e.priority,function(){VN(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ju(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=mg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);cg=n,r.target.dispatchEvent(n),cg=null}else return t=Sc(r),t!==null&&yx(t),e.blockedOn=r,!1;t.shift()}return!0}function Kb(e,t,r){Ju(e)&&r.delete(t)}function TM(){pg=!1,ys!==null&&Ju(ys)&&(ys=null),bs!==null&&Ju(bs)&&(bs=null),ws!==null&&Ju(ws)&&(ws=null),Dl.forEach(Kb),$l.forEach(Kb)}function Fa(e,t){e.blockedOn===t&&(e.blockedOn=null,pg||(pg=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,TM)))}function Ml(e){function t(s){return Fa(s,e)}if(0<au.length){Fa(au[0],e);for(var r=1;r<au.length;r++){var n=au[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ys!==null&&Fa(ys,e),bs!==null&&Fa(bs,e),ws!==null&&Fa(ws,e),Dl.forEach(t),$l.forEach(t),r=0;r<fs.length;r++)n=fs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<fs.length&&(r=fs[0],r.blockedOn===null);)HN(r),r.blockedOn===null&&fs.shift()}var Io=Qn.ReactCurrentBatchConfig,yd=!0;function kM(e,t,r,n){var s=$e,i=Io.transition;Io.transition=null;try{$e=1,bx(e,t,r,n)}finally{$e=s,Io.transition=i}}function AM(e,t,r,n){var s=$e,i=Io.transition;Io.transition=null;try{$e=4,bx(e,t,r,n)}finally{$e=s,Io.transition=i}}function bx(e,t,r,n){if(yd){var s=mg(e,t,r,n);if(s===null)Ep(e,t,n,bd,r),Gb(e,n);else if(PM(s,e,t,r,n))n.stopPropagation();else if(Gb(e,n),t&4&&-1<CM.indexOf(e)){for(;s!==null;){var i=Sc(s);if(i!==null&&UN(i),i=mg(e,t,r,n),i===null&&Ep(e,t,n,bd,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Ep(e,t,n,null,r)}}var bd=null;function mg(e,t,r,n){if(bd=null,e=gx(n),e=ci(e),e!==null)if(t=Mi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=ON(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return bd=e,null}function GN(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xM()){case vx:return 1;case LN:return 4;case vd:case yM:return 16;case FN:return 536870912;default:return 16}default:return 16}}var ms=null,wx=null,Xu=null;function KN(){if(Xu)return Xu;var e,t=wx,r=t.length,n,s="value"in ms?ms.value:ms.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[i-n];n++);return Xu=s.slice(e,1<n?1-n:void 0)}function Qu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function lu(){return!0}function Yb(){return!1}function wr(e){function t(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?lu:Yb,this.isPropagationStopped=Yb,this}return nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=lu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=lu)},persist:function(){},isPersistent:lu}),t}var fa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jx=wr(fa),_c=nt({},fa,{view:0,detail:0}),RM=wr(_c),vp,xp,Ba,_f=nt({},_c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_x,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ba&&(Ba&&e.type==="mousemove"?(vp=e.screenX-Ba.screenX,xp=e.screenY-Ba.screenY):xp=vp=0,Ba=e),vp)},movementY:function(e){return"movementY"in e?e.movementY:xp}}),Jb=wr(_f),IM=nt({},_f,{dataTransfer:0}),OM=wr(IM),DM=nt({},_c,{relatedTarget:0}),yp=wr(DM),$M=nt({},fa,{animationName:0,elapsedTime:0,pseudoElement:0}),MM=wr($M),LM=nt({},fa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),FM=wr(LM),BM=nt({},fa,{data:0}),Xb=wr(BM),zM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qM(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=VM[e])?!!t[e]:!1}function _x(){return qM}var WM=nt({},_c,{key:function(e){if(e.key){var t=zM[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Qu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?UM[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_x,charCode:function(e){return e.type==="keypress"?Qu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Qu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),HM=wr(WM),GM=nt({},_f,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qb=wr(GM),KM=nt({},_c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_x}),YM=wr(KM),JM=nt({},fa,{propertyName:0,elapsedTime:0,pseudoElement:0}),XM=wr(JM),QM=nt({},_f,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ZM=wr(QM),eL=[9,13,27,32],Sx=Un&&"CompositionEvent"in window,ml=null;Un&&"documentMode"in document&&(ml=document.documentMode);var tL=Un&&"TextEvent"in window&&!ml,YN=Un&&(!Sx||ml&&8<ml&&11>=ml),Zb=String.fromCharCode(32),ew=!1;function JN(e,t){switch(e){case"keyup":return eL.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function XN(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var mo=!1;function rL(e,t){switch(e){case"compositionend":return XN(t);case"keypress":return t.which!==32?null:(ew=!0,Zb);case"textInput":return e=t.data,e===Zb&&ew?null:e;default:return null}}function nL(e,t){if(mo)return e==="compositionend"||!Sx&&JN(e,t)?(e=KN(),Xu=wx=ms=null,mo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return YN&&t.locale!=="ko"?null:t.data;default:return null}}var sL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!sL[e.type]:t==="textarea"}function QN(e,t,r,n){TN(n),t=wd(t,"onChange"),0<t.length&&(r=new jx("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var gl=null,Ll=null;function iL(e){cE(e,0)}function Sf(e){var t=xo(e);if(jN(t))return e}function oL(e,t){if(e==="change")return t}var ZN=!1;if(Un){var bp;if(Un){var wp="oninput"in document;if(!wp){var rw=document.createElement("div");rw.setAttribute("oninput","return;"),wp=typeof rw.oninput=="function"}bp=wp}else bp=!1;ZN=bp&&(!document.documentMode||9<document.documentMode)}function nw(){gl&&(gl.detachEvent("onpropertychange",eE),Ll=gl=null)}function eE(e){if(e.propertyName==="value"&&Sf(Ll)){var t=[];QN(t,Ll,e,gx(e)),IN(iL,t)}}function aL(e,t,r){e==="focusin"?(nw(),gl=t,Ll=r,gl.attachEvent("onpropertychange",eE)):e==="focusout"&&nw()}function lL(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Sf(Ll)}function cL(e,t){if(e==="click")return Sf(t)}function uL(e,t){if(e==="input"||e==="change")return Sf(t)}function dL(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var en=typeof Object.is=="function"?Object.is:dL;function Fl(e,t){if(en(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Xm.call(t,s)||!en(e[s],t[s]))return!1}return!0}function sw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function iw(e,t){var r=sw(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=sw(r)}}function tE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?tE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function rE(){for(var e=window,t=pd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=pd(e.document)}return t}function Nx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function fL(e){var t=rE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&tE(r.ownerDocument.documentElement,r)){if(n!==null&&Nx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=iw(r,i);var a=iw(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hL=Un&&"documentMode"in document&&11>=document.documentMode,go=null,gg=null,vl=null,vg=!1;function ow(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vg||go==null||go!==pd(n)||(n=go,"selectionStart"in n&&Nx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),vl&&Fl(vl,n)||(vl=n,n=wd(gg,"onSelect"),0<n.length&&(t=new jx("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=go)))}function cu(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var vo={animationend:cu("Animation","AnimationEnd"),animationiteration:cu("Animation","AnimationIteration"),animationstart:cu("Animation","AnimationStart"),transitionend:cu("Transition","TransitionEnd")},jp={},nE={};Un&&(nE=document.createElement("div").style,"AnimationEvent"in window||(delete vo.animationend.animation,delete vo.animationiteration.animation,delete vo.animationstart.animation),"TransitionEvent"in window||delete vo.transitionend.transition);function Nf(e){if(jp[e])return jp[e];if(!vo[e])return e;var t=vo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in nE)return jp[e]=t[r];return e}var sE=Nf("animationend"),iE=Nf("animationiteration"),oE=Nf("animationstart"),aE=Nf("transitionend"),lE=new Map,aw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zs(e,t){lE.set(e,t),$i(t,[e])}for(var _p=0;_p<aw.length;_p++){var Sp=aw[_p],pL=Sp.toLowerCase(),mL=Sp[0].toUpperCase()+Sp.slice(1);zs(pL,"on"+mL)}zs(sE,"onAnimationEnd");zs(iE,"onAnimationIteration");zs(oE,"onAnimationStart");zs("dblclick","onDoubleClick");zs("focusin","onFocus");zs("focusout","onBlur");zs(aE,"onTransitionEnd");Ho("onMouseEnter",["mouseout","mouseover"]);Ho("onMouseLeave",["mouseout","mouseover"]);Ho("onPointerEnter",["pointerout","pointerover"]);Ho("onPointerLeave",["pointerout","pointerover"]);$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$i("onBeforeInput",["compositionend","keypress","textInput","paste"]);$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var il="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gL=new Set("cancel close invalid load scroll toggle".split(" ").concat(il));function lw(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,pM(n,t,void 0,e),e.currentTarget=null}function cE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;lw(s,l,u),i=c}else for(a=0;a<n.length;a++){if(l=n[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;lw(s,l,u),i=c}}}if(gd)throw e=fg,gd=!1,fg=null,e}function Ge(e,t){var r=t[jg];r===void 0&&(r=t[jg]=new Set);var n=e+"__bubble";r.has(n)||(uE(t,e,2,!1),r.add(n))}function Np(e,t,r){var n=0;t&&(n|=4),uE(r,e,n,t)}var uu="_reactListening"+Math.random().toString(36).slice(2);function Bl(e){if(!e[uu]){e[uu]=!0,vN.forEach(function(r){r!=="selectionchange"&&(gL.has(r)||Np(r,!1,e),Np(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[uu]||(t[uu]=!0,Np("selectionchange",!1,t))}}function uE(e,t,r,n){switch(GN(t)){case 1:var s=kM;break;case 4:s=AM;break;default:s=bx}r=s.bind(null,t,r,e),s=void 0,!dg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Ep(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ci(l),a===null)return;if(c=a.tag,c===5||c===6){n=i=a;continue e}l=l.parentNode}}n=n.return}IN(function(){var u=i,f=gx(r),d=[];e:{var h=lE.get(e);if(h!==void 0){var m=jx,g=e;switch(e){case"keypress":if(Qu(r)===0)break e;case"keydown":case"keyup":m=HM;break;case"focusin":g="focus",m=yp;break;case"focusout":g="blur",m=yp;break;case"beforeblur":case"afterblur":m=yp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Jb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=OM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=YM;break;case sE:case iE:case oE:m=MM;break;case aE:m=XM;break;case"scroll":m=RM;break;case"wheel":m=ZM;break;case"copy":case"cut":case"paste":m=FM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Qb}var v=(t&4)!==0,y=!v&&e==="scroll",x=v?h!==null?h+"Capture":null:h;v=[];for(var b=u,w;b!==null;){w=b;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,x!==null&&(j=Ol(b,x),j!=null&&v.push(zl(b,j,w)))),y)break;b=b.return}0<v.length&&(h=new m(h,g,null,r,f),d.push({event:h,listeners:v}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==cg&&(g=r.relatedTarget||r.fromElement)&&(ci(g)||g[Vn]))break e;if((m||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=u,g=g?ci(g):null,g!==null&&(y=Mi(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(v=Jb,j="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(v=Qb,j="onPointerLeave",x="onPointerEnter",b="pointer"),y=m==null?h:xo(m),w=g==null?h:xo(g),h=new v(j,b+"leave",m,r,f),h.target=y,h.relatedTarget=w,j=null,ci(f)===u&&(v=new v(x,b+"enter",g,r,f),v.target=w,v.relatedTarget=y,j=v),y=j,m&&g)t:{for(v=m,x=g,b=0,w=v;w;w=Yi(w))b++;for(w=0,j=x;j;j=Yi(j))w++;for(;0<b-w;)v=Yi(v),b--;for(;0<w-b;)x=Yi(x),w--;for(;b--;){if(v===x||x!==null&&v===x.alternate)break t;v=Yi(v),x=Yi(x)}v=null}else v=null;m!==null&&cw(d,h,m,v,!1),g!==null&&y!==null&&cw(d,y,g,v,!0)}}e:{if(h=u?xo(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var _=oL;else if(tw(h))if(ZN)_=uL;else{_=lL;var S=aL}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=cL);if(_&&(_=_(e,u))){QN(d,_,r,f);break e}S&&S(e,h,u),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&sg(h,"number",h.value)}switch(S=u?xo(u):window,e){case"focusin":(tw(S)||S.contentEditable==="true")&&(go=S,gg=u,vl=null);break;case"focusout":vl=gg=go=null;break;case"mousedown":vg=!0;break;case"contextmenu":case"mouseup":case"dragend":vg=!1,ow(d,r,f);break;case"selectionchange":if(hL)break;case"keydown":case"keyup":ow(d,r,f)}var N;if(Sx)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else mo?JN(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(YN&&r.locale!=="ko"&&(mo||E!=="onCompositionStart"?E==="onCompositionEnd"&&mo&&(N=KN()):(ms=f,wx="value"in ms?ms.value:ms.textContent,mo=!0)),S=wd(u,E),0<S.length&&(E=new Xb(E,e,null,r,f),d.push({event:E,listeners:S}),N?E.data=N:(N=XN(r),N!==null&&(E.data=N)))),(N=tL?rL(e,r):nL(e,r))&&(u=wd(u,"onBeforeInput"),0<u.length&&(f=new Xb("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=N))}cE(d,t)})}function zl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function wd(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ol(e,r),i!=null&&n.unshift(zl(e,i,s)),i=Ol(e,t),i!=null&&n.push(zl(e,i,s))),e=e.return}return n}function Yi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function cw(e,t,r,n,s){for(var i=t._reactName,a=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=Ol(r,i),c!=null&&a.unshift(zl(r,c,l))):s||(c=Ol(r,i),c!=null&&a.push(zl(r,c,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var vL=/\r\n?/g,xL=/\u0000|\uFFFD/g;function uw(e){return(typeof e=="string"?e:""+e).replace(vL,`
`).replace(xL,"")}function du(e,t,r){if(t=uw(t),uw(e)!==t&&r)throw Error(re(425))}function jd(){}var xg=null,yg=null;function bg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var wg=typeof setTimeout=="function"?setTimeout:void 0,yL=typeof clearTimeout=="function"?clearTimeout:void 0,dw=typeof Promise=="function"?Promise:void 0,bL=typeof queueMicrotask=="function"?queueMicrotask:typeof dw<"u"?function(e){return dw.resolve(null).then(e).catch(wL)}:wg;function wL(e){setTimeout(function(){throw e})}function Cp(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Ml(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ml(t)}function js(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function fw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),hn="__reactFiber$"+ha,Ul="__reactProps$"+ha,Vn="__reactContainer$"+ha,jg="__reactEvents$"+ha,jL="__reactListeners$"+ha,_L="__reactHandles$"+ha;function ci(e){var t=e[hn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Vn]||r[hn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=fw(e);e!==null;){if(r=e[hn])return r;e=fw(e)}return t}e=r,r=e.parentNode}return null}function Sc(e){return e=e[hn]||e[Vn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function xo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(re(33))}function Ef(e){return e[Ul]||null}var _g=[],yo=-1;function Us(e){return{current:e}}function Ke(e){0>yo||(e.current=_g[yo],_g[yo]=null,yo--)}function ze(e,t){yo++,_g[yo]=e.current,e.current=t}var Os={},Ot=Us(Os),er=Us(!1),ji=Os;function Go(e,t){var r=e.type.contextTypes;if(!r)return Os;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function tr(e){return e=e.childContextTypes,e!=null}function _d(){Ke(er),Ke(Ot)}function hw(e,t,r){if(Ot.current!==Os)throw Error(re(168));ze(Ot,t),ze(er,r)}function dE(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(re(108,aM(e)||"Unknown",s));return nt({},r,n)}function Sd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Os,ji=Ot.current,ze(Ot,e),ze(er,er.current),!0}function pw(e,t,r){var n=e.stateNode;if(!n)throw Error(re(169));r?(e=dE(e,t,ji),n.__reactInternalMemoizedMergedChildContext=e,Ke(er),Ke(Ot),ze(Ot,e)):Ke(er),ze(er,r)}var Rn=null,Cf=!1,Pp=!1;function fE(e){Rn===null?Rn=[e]:Rn.push(e)}function SL(e){Cf=!0,fE(e)}function Vs(){if(!Pp&&Rn!==null){Pp=!0;var e=0,t=$e;try{var r=Rn;for($e=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Rn=null,Cf=!1}catch(s){throw Rn!==null&&(Rn=Rn.slice(e+1)),MN(vx,Vs),s}finally{$e=t,Pp=!1}}return null}var bo=[],wo=0,Nd=null,Ed=0,Tr=[],kr=0,_i=null,In=1,On="";function Qs(e,t){bo[wo++]=Ed,bo[wo++]=Nd,Nd=e,Ed=t}function hE(e,t,r){Tr[kr++]=In,Tr[kr++]=On,Tr[kr++]=_i,_i=e;var n=In;e=On;var s=32-Qr(n)-1;n&=~(1<<s),r+=1;var i=32-Qr(t)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,In=1<<32-Qr(t)+s|r<<s|n,On=i+e}else In=1<<i|r<<s|n,On=e}function Ex(e){e.return!==null&&(Qs(e,1),hE(e,1,0))}function Cx(e){for(;e===Nd;)Nd=bo[--wo],bo[wo]=null,Ed=bo[--wo],bo[wo]=null;for(;e===_i;)_i=Tr[--kr],Tr[kr]=null,On=Tr[--kr],Tr[kr]=null,In=Tr[--kr],Tr[kr]=null}var fr=null,ur=null,Xe=!1,Yr=null;function pE(e,t){var r=Ar(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function mw(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,fr=e,ur=js(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,fr=e,ur=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_i!==null?{id:In,overflow:On}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ar(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,fr=e,ur=null,!0):!1;default:return!1}}function Sg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ng(e){if(Xe){var t=ur;if(t){var r=t;if(!mw(e,t)){if(Sg(e))throw Error(re(418));t=js(r.nextSibling);var n=fr;t&&mw(e,t)?pE(n,r):(e.flags=e.flags&-4097|2,Xe=!1,fr=e)}}else{if(Sg(e))throw Error(re(418));e.flags=e.flags&-4097|2,Xe=!1,fr=e}}}function gw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;fr=e}function fu(e){if(e!==fr)return!1;if(!Xe)return gw(e),Xe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!bg(e.type,e.memoizedProps)),t&&(t=ur)){if(Sg(e))throw mE(),Error(re(418));for(;t;)pE(e,t),t=js(t.nextSibling)}if(gw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ur=js(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ur=null}}else ur=fr?js(e.stateNode.nextSibling):null;return!0}function mE(){for(var e=ur;e;)e=js(e.nextSibling)}function Ko(){ur=fr=null,Xe=!1}function Px(e){Yr===null?Yr=[e]:Yr.push(e)}var NL=Qn.ReactCurrentBatchConfig;function za(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(re(309));var n=r.stateNode}if(!n)throw Error(re(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(re(284));if(!r._owner)throw Error(re(290,e))}return e}function hu(e,t){throw e=Object.prototype.toString.call(t),Error(re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vw(e){var t=e._init;return t(e._payload)}function gE(e){function t(x,b){if(e){var w=x.deletions;w===null?(x.deletions=[b],x.flags|=16):w.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function s(x,b){return x=Es(x,b),x.index=0,x.sibling=null,x}function i(x,b,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<b?(x.flags|=2,b):w):(x.flags|=2,b)):(x.flags|=1048576,b)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,b,w,j){return b===null||b.tag!==6?(b=Dp(w,x.mode,j),b.return=x,b):(b=s(b,w),b.return=x,b)}function c(x,b,w,j){var _=w.type;return _===po?f(x,b,w.props.children,j,w.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===cs&&vw(_)===b.type)?(j=s(b,w.props),j.ref=za(x,b,w),j.return=x,j):(j=id(w.type,w.key,w.props,null,x.mode,j),j.ref=za(x,b,w),j.return=x,j)}function u(x,b,w,j){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=$p(w,x.mode,j),b.return=x,b):(b=s(b,w.children||[]),b.return=x,b)}function f(x,b,w,j,_){return b===null||b.tag!==7?(b=vi(w,x.mode,j,_),b.return=x,b):(b=s(b,w),b.return=x,b)}function d(x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Dp(""+b,x.mode,w),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ru:return w=id(b.type,b.key,b.props,null,x.mode,w),w.ref=za(x,null,b),w.return=x,w;case ho:return b=$p(b,x.mode,w),b.return=x,b;case cs:var j=b._init;return d(x,j(b._payload),w)}if(nl(b)||$a(b))return b=vi(b,x.mode,w,null),b.return=x,b;hu(x,b)}return null}function h(x,b,w,j){var _=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:l(x,b,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ru:return w.key===_?c(x,b,w,j):null;case ho:return w.key===_?u(x,b,w,j):null;case cs:return _=w._init,h(x,b,_(w._payload),j)}if(nl(w)||$a(w))return _!==null?null:f(x,b,w,j,null);hu(x,w)}return null}function m(x,b,w,j,_){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(w)||null,l(b,x,""+j,_);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case ru:return x=x.get(j.key===null?w:j.key)||null,c(b,x,j,_);case ho:return x=x.get(j.key===null?w:j.key)||null,u(b,x,j,_);case cs:var S=j._init;return m(x,b,w,S(j._payload),_)}if(nl(j)||$a(j))return x=x.get(w)||null,f(b,x,j,_,null);hu(b,j)}return null}function g(x,b,w,j){for(var _=null,S=null,N=b,E=b=0,C=null;N!==null&&E<w.length;E++){N.index>E?(C=N,N=null):C=N.sibling;var k=h(x,N,w[E],j);if(k===null){N===null&&(N=C);break}e&&N&&k.alternate===null&&t(x,N),b=i(k,b,E),S===null?_=k:S.sibling=k,S=k,N=C}if(E===w.length)return r(x,N),Xe&&Qs(x,E),_;if(N===null){for(;E<w.length;E++)N=d(x,w[E],j),N!==null&&(b=i(N,b,E),S===null?_=N:S.sibling=N,S=N);return Xe&&Qs(x,E),_}for(N=n(x,N);E<w.length;E++)C=m(N,x,E,w[E],j),C!==null&&(e&&C.alternate!==null&&N.delete(C.key===null?E:C.key),b=i(C,b,E),S===null?_=C:S.sibling=C,S=C);return e&&N.forEach(function(L){return t(x,L)}),Xe&&Qs(x,E),_}function v(x,b,w,j){var _=$a(w);if(typeof _!="function")throw Error(re(150));if(w=_.call(w),w==null)throw Error(re(151));for(var S=_=null,N=b,E=b=0,C=null,k=w.next();N!==null&&!k.done;E++,k=w.next()){N.index>E?(C=N,N=null):C=N.sibling;var L=h(x,N,k.value,j);if(L===null){N===null&&(N=C);break}e&&N&&L.alternate===null&&t(x,N),b=i(L,b,E),S===null?_=L:S.sibling=L,S=L,N=C}if(k.done)return r(x,N),Xe&&Qs(x,E),_;if(N===null){for(;!k.done;E++,k=w.next())k=d(x,k.value,j),k!==null&&(b=i(k,b,E),S===null?_=k:S.sibling=k,S=k);return Xe&&Qs(x,E),_}for(N=n(x,N);!k.done;E++,k=w.next())k=m(N,x,E,k.value,j),k!==null&&(e&&k.alternate!==null&&N.delete(k.key===null?E:k.key),b=i(k,b,E),S===null?_=k:S.sibling=k,S=k);return e&&N.forEach(function(A){return t(x,A)}),Xe&&Qs(x,E),_}function y(x,b,w,j){if(typeof w=="object"&&w!==null&&w.type===po&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ru:e:{for(var _=w.key,S=b;S!==null;){if(S.key===_){if(_=w.type,_===po){if(S.tag===7){r(x,S.sibling),b=s(S,w.props.children),b.return=x,x=b;break e}}else if(S.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===cs&&vw(_)===S.type){r(x,S.sibling),b=s(S,w.props),b.ref=za(x,S,w),b.return=x,x=b;break e}r(x,S);break}else t(x,S);S=S.sibling}w.type===po?(b=vi(w.props.children,x.mode,j,w.key),b.return=x,x=b):(j=id(w.type,w.key,w.props,null,x.mode,j),j.ref=za(x,b,w),j.return=x,x=j)}return a(x);case ho:e:{for(S=w.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(x,b.sibling),b=s(b,w.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=$p(w,x.mode,j),b.return=x,x=b}return a(x);case cs:return S=w._init,y(x,b,S(w._payload),j)}if(nl(w))return g(x,b,w,j);if($a(w))return v(x,b,w,j);hu(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(x,b.sibling),b=s(b,w),b.return=x,x=b):(r(x,b),b=Dp(w,x.mode,j),b.return=x,x=b),a(x)):r(x,b)}return y}var Yo=gE(!0),vE=gE(!1),Cd=Us(null),Pd=null,jo=null,Tx=null;function kx(){Tx=jo=Pd=null}function Ax(e){var t=Cd.current;Ke(Cd),e._currentValue=t}function Eg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Oo(e,t){Pd=e,Tx=jo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Zt=!0),e.firstContext=null)}function $r(e){var t=e._currentValue;if(Tx!==e)if(e={context:e,memoizedValue:t,next:null},jo===null){if(Pd===null)throw Error(re(308));jo=e,Pd.dependencies={lanes:0,firstContext:e}}else jo=jo.next=e;return t}var ui=null;function Rx(e){ui===null?ui=[e]:ui.push(e)}function xE(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Rx(t)):(r.next=s.next,s.next=r),t.interleaved=r,qn(e,n)}function qn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var us=!1;function Ix(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _s(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Oe&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,qn(e,r)}return s=n.interleaved,s===null?(t.next=t,Rx(n)):(t.next=s.next,s.next=t),n.interleaved=t,qn(e,r)}function Zu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,xx(e,r)}}function xw(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Td(e,t,r,n){var s=e.updateQueue;us=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==a&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(i!==null){var d=s.baseState;a=0,f=u=c=null,l=i;do{var h=l.lane,m=l.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,v=l;switch(h=t,m=r,v.tag){case 1:if(g=v.payload,typeof g=="function"){d=g.call(m,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,h=typeof g=="function"?g.call(m,d,h):g,h==null)break e;d=nt({},d,h);break e;case 2:us=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=m,c=d):f=f.next=m,a|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(1);if(f===null&&(c=d),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ni|=a,e.lanes=a,e.memoizedState=d}}function yw(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(re(191,s));s.call(n)}}}var Nc={},yn=Us(Nc),Vl=Us(Nc),ql=Us(Nc);function di(e){if(e===Nc)throw Error(re(174));return e}function Ox(e,t){switch(ze(ql,t),ze(Vl,e),ze(yn,Nc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:og(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=og(t,e)}Ke(yn),ze(yn,t)}function Jo(){Ke(yn),Ke(Vl),Ke(ql)}function bE(e){di(ql.current);var t=di(yn.current),r=og(t,e.type);t!==r&&(ze(Vl,e),ze(yn,r))}function Dx(e){Vl.current===e&&(Ke(yn),Ke(Vl))}var et=Us(0);function kd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Tp=[];function $x(){for(var e=0;e<Tp.length;e++)Tp[e]._workInProgressVersionPrimary=null;Tp.length=0}var ed=Qn.ReactCurrentDispatcher,kp=Qn.ReactCurrentBatchConfig,Si=0,rt=null,ht=null,gt=null,Ad=!1,xl=!1,Wl=0,EL=0;function Pt(){throw Error(re(321))}function Mx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!en(e[r],t[r]))return!1;return!0}function Lx(e,t,r,n,s,i){if(Si=i,rt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ed.current=e===null||e.memoizedState===null?kL:AL,e=r(n,s),xl){i=0;do{if(xl=!1,Wl=0,25<=i)throw Error(re(301));i+=1,gt=ht=null,t.updateQueue=null,ed.current=RL,e=r(n,s)}while(xl)}if(ed.current=Rd,t=ht!==null&&ht.next!==null,Si=0,gt=ht=rt=null,Ad=!1,t)throw Error(re(300));return e}function Fx(){var e=Wl!==0;return Wl=0,e}function fn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?rt.memoizedState=gt=e:gt=gt.next=e,gt}function Mr(){if(ht===null){var e=rt.alternate;e=e!==null?e.memoizedState:null}else e=ht.next;var t=gt===null?rt.memoizedState:gt.next;if(t!==null)gt=t,ht=e;else{if(e===null)throw Error(re(310));ht=e,e={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},gt===null?rt.memoizedState=gt=e:gt=gt.next=e}return gt}function Hl(e,t){return typeof t=="function"?t(e):t}function Ap(e){var t=Mr(),r=t.queue;if(r===null)throw Error(re(311));r.lastRenderedReducer=e;var n=ht,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=a=null,c=null,u=i;do{var f=u.lane;if((Si&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=d,a=n):c=c.next=d,rt.lanes|=f,Ni|=f}u=u.next}while(u!==null&&u!==i);c===null?a=n:c.next=l,en(n,t.memoizedState)||(Zt=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,rt.lanes|=i,Ni|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Rp(e){var t=Mr(),r=t.queue;if(r===null)throw Error(re(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);en(i,t.memoizedState)||(Zt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function wE(){}function jE(e,t){var r=rt,n=Mr(),s=t(),i=!en(n.memoizedState,s);if(i&&(n.memoizedState=s,Zt=!0),n=n.queue,Bx(NE.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||gt!==null&&gt.memoizedState.tag&1){if(r.flags|=2048,Gl(9,SE.bind(null,r,n,s,t),void 0,null),xt===null)throw Error(re(349));Si&30||_E(r,t,s)}return s}function _E(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function SE(e,t,r,n){t.value=r,t.getSnapshot=n,EE(t)&&CE(e)}function NE(e,t,r){return r(function(){EE(t)&&CE(e)})}function EE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!en(e,r)}catch{return!0}}function CE(e){var t=qn(e,1);t!==null&&Zr(t,e,1,-1)}function bw(e){var t=fn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hl,lastRenderedState:e},t.queue=e,e=e.dispatch=TL.bind(null,rt,e),[t.memoizedState,e]}function Gl(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rt.updateQueue,t===null?(t={lastEffect:null,stores:null},rt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function PE(){return Mr().memoizedState}function td(e,t,r,n){var s=fn();rt.flags|=e,s.memoizedState=Gl(1|t,r,void 0,n===void 0?null:n)}function Pf(e,t,r,n){var s=Mr();n=n===void 0?null:n;var i=void 0;if(ht!==null){var a=ht.memoizedState;if(i=a.destroy,n!==null&&Mx(n,a.deps)){s.memoizedState=Gl(t,r,i,n);return}}rt.flags|=e,s.memoizedState=Gl(1|t,r,i,n)}function ww(e,t){return td(8390656,8,e,t)}function Bx(e,t){return Pf(2048,8,e,t)}function TE(e,t){return Pf(4,2,e,t)}function kE(e,t){return Pf(4,4,e,t)}function AE(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function RE(e,t,r){return r=r!=null?r.concat([e]):null,Pf(4,4,AE.bind(null,t,e),r)}function zx(){}function IE(e,t){var r=Mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Mx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function OE(e,t){var r=Mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Mx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function DE(e,t,r){return Si&21?(en(r,t)||(r=BN(),rt.lanes|=r,Ni|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Zt=!0),e.memoizedState=r)}function CL(e,t){var r=$e;$e=r!==0&&4>r?r:4,e(!0);var n=kp.transition;kp.transition={};try{e(!1),t()}finally{$e=r,kp.transition=n}}function $E(){return Mr().memoizedState}function PL(e,t,r){var n=Ns(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ME(e))LE(t,r);else if(r=xE(e,t,r,n),r!==null){var s=Vt();Zr(r,e,n,s),FE(r,t,n)}}function TL(e,t,r){var n=Ns(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ME(e))LE(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,r);if(s.hasEagerState=!0,s.eagerState=l,en(l,a)){var c=t.interleaved;c===null?(s.next=s,Rx(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=xE(e,t,s,n),r!==null&&(s=Vt(),Zr(r,e,n,s),FE(r,t,n))}}function ME(e){var t=e.alternate;return e===rt||t!==null&&t===rt}function LE(e,t){xl=Ad=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function FE(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,xx(e,r)}}var Rd={readContext:$r,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},kL={readContext:$r,useCallback:function(e,t){return fn().memoizedState=[e,t===void 0?null:t],e},useContext:$r,useEffect:ww,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,td(4194308,4,AE.bind(null,t,e),r)},useLayoutEffect:function(e,t){return td(4194308,4,e,t)},useInsertionEffect:function(e,t){return td(4,2,e,t)},useMemo:function(e,t){var r=fn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=fn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=PL.bind(null,rt,e),[n.memoizedState,e]},useRef:function(e){var t=fn();return e={current:e},t.memoizedState=e},useState:bw,useDebugValue:zx,useDeferredValue:function(e){return fn().memoizedState=e},useTransition:function(){var e=bw(!1),t=e[0];return e=CL.bind(null,e[1]),fn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rt,s=fn();if(Xe){if(r===void 0)throw Error(re(407));r=r()}else{if(r=t(),xt===null)throw Error(re(349));Si&30||_E(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,ww(NE.bind(null,n,i,e),[e]),n.flags|=2048,Gl(9,SE.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=fn(),t=xt.identifierPrefix;if(Xe){var r=On,n=In;r=(n&~(1<<32-Qr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Wl++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=EL++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},AL={readContext:$r,useCallback:IE,useContext:$r,useEffect:Bx,useImperativeHandle:RE,useInsertionEffect:TE,useLayoutEffect:kE,useMemo:OE,useReducer:Ap,useRef:PE,useState:function(){return Ap(Hl)},useDebugValue:zx,useDeferredValue:function(e){var t=Mr();return DE(t,ht.memoizedState,e)},useTransition:function(){var e=Ap(Hl)[0],t=Mr().memoizedState;return[e,t]},useMutableSource:wE,useSyncExternalStore:jE,useId:$E,unstable_isNewReconciler:!1},RL={readContext:$r,useCallback:IE,useContext:$r,useEffect:Bx,useImperativeHandle:RE,useInsertionEffect:TE,useLayoutEffect:kE,useMemo:OE,useReducer:Rp,useRef:PE,useState:function(){return Rp(Hl)},useDebugValue:zx,useDeferredValue:function(e){var t=Mr();return ht===null?t.memoizedState=e:DE(t,ht.memoizedState,e)},useTransition:function(){var e=Rp(Hl)[0],t=Mr().memoizedState;return[e,t]},useMutableSource:wE,useSyncExternalStore:jE,useId:$E,unstable_isNewReconciler:!1};function Hr(e,t){if(e&&e.defaultProps){t=nt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Cg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Tf={isMounted:function(e){return(e=e._reactInternals)?Mi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Vt(),s=Ns(e),i=$n(n,s);i.payload=t,r!=null&&(i.callback=r),t=_s(e,i,s),t!==null&&(Zr(t,e,s,n),Zu(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Vt(),s=Ns(e),i=$n(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=_s(e,i,s),t!==null&&(Zr(t,e,s,n),Zu(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Vt(),n=Ns(e),s=$n(r,n);s.tag=2,t!=null&&(s.callback=t),t=_s(e,s,n),t!==null&&(Zr(t,e,n,r),Zu(t,e,n))}};function jw(e,t,r,n,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,a):t.prototype&&t.prototype.isPureReactComponent?!Fl(r,n)||!Fl(s,i):!0}function BE(e,t,r){var n=!1,s=Os,i=t.contextType;return typeof i=="object"&&i!==null?i=$r(i):(s=tr(t)?ji:Ot.current,n=t.contextTypes,i=(n=n!=null)?Go(e,s):Os),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Tf,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function _w(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Tf.enqueueReplaceState(t,t.state,null)}function Pg(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Ix(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=$r(i):(i=tr(t)?ji:Ot.current,s.context=Go(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Cg(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Tf.enqueueReplaceState(s,s.state,null),Td(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Xo(e,t){try{var r="",n=t;do r+=oM(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Ip(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Tg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var IL=typeof WeakMap=="function"?WeakMap:Map;function zE(e,t,r){r=$n(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Od||(Od=!0,Fg=n),Tg(e,t)},r}function UE(e,t,r){r=$n(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Tg(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Tg(e,t),typeof n!="function"&&(Ss===null?Ss=new Set([this]):Ss.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Sw(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new IL;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=GL.bind(null,e,t,r),t.then(e,e))}function Nw(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ew(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=$n(-1,1),t.tag=2,_s(r,t,1))),r.lanes|=1),e)}var OL=Qn.ReactCurrentOwner,Zt=!1;function Ft(e,t,r,n){t.child=e===null?vE(t,null,r,n):Yo(t,e.child,r,n)}function Cw(e,t,r,n,s){r=r.render;var i=t.ref;return Oo(t,s),n=Lx(e,t,r,n,i,s),r=Fx(),e!==null&&!Zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Wn(e,t,s)):(Xe&&r&&Ex(t),t.flags|=1,Ft(e,t,n,s),t.child)}function Pw(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!Yx(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,VE(e,t,i,n,s)):(e=id(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Fl,r(a,n)&&e.ref===t.ref)return Wn(e,t,s)}return t.flags|=1,e=Es(i,n),e.ref=t.ref,e.return=t,t.child=e}function VE(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Fl(i,n)&&e.ref===t.ref)if(Zt=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Zt=!0);else return t.lanes=e.lanes,Wn(e,t,s)}return kg(e,t,r,n,s)}function qE(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ze(So,or),or|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ze(So,or),or|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ze(So,or),or|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,ze(So,or),or|=n;return Ft(e,t,s,r),t.child}function WE(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function kg(e,t,r,n,s){var i=tr(r)?ji:Ot.current;return i=Go(t,i),Oo(t,s),r=Lx(e,t,r,n,i,s),n=Fx(),e!==null&&!Zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Wn(e,t,s)):(Xe&&n&&Ex(t),t.flags|=1,Ft(e,t,r,s),t.child)}function Tw(e,t,r,n,s){if(tr(r)){var i=!0;Sd(t)}else i=!1;if(Oo(t,s),t.stateNode===null)rd(e,t),BE(t,r,n),Pg(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=$r(u):(u=tr(r)?ji:Ot.current,u=Go(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||c!==u)&&_w(t,a,n,u),us=!1;var h=t.memoizedState;a.state=h,Td(t,n,a,s),c=t.memoizedState,l!==n||h!==c||er.current||us?(typeof f=="function"&&(Cg(t,r,f,n),c=t.memoizedState),(l=us||jw(t,r,l,n,h,c,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=u,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,yE(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Hr(t.type,l),a.props=u,d=t.pendingProps,h=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=$r(c):(c=tr(r)?ji:Ot.current,c=Go(t,c));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==d||h!==c)&&_w(t,a,n,c),us=!1,h=t.memoizedState,a.state=h,Td(t,n,a,s);var g=t.memoizedState;l!==d||h!==g||er.current||us?(typeof m=="function"&&(Cg(t,r,m,n),g=t.memoizedState),(u=us||jw(t,r,u,n,h,g,c)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=c,n=u):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Ag(e,t,r,n,i,s)}function Ag(e,t,r,n,s,i){WE(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&pw(t,r,!1),Wn(e,t,i);n=t.stateNode,OL.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Yo(t,e.child,null,i),t.child=Yo(t,null,l,i)):Ft(e,t,l,i),t.memoizedState=n.state,s&&pw(t,r,!0),t.child}function HE(e){var t=e.stateNode;t.pendingContext?hw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&hw(e,t.context,!1),Ox(e,t.containerInfo)}function kw(e,t,r,n,s){return Ko(),Px(s),t.flags|=256,Ft(e,t,r,n),t.child}var Rg={dehydrated:null,treeContext:null,retryLane:0};function Ig(e){return{baseLanes:e,cachePool:null,transitions:null}}function GE(e,t,r){var n=t.pendingProps,s=et.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ze(et,s&1),e===null)return Ng(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,i?(n=t.mode,i=t.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Rf(a,n,0,null),e=vi(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Ig(r),t.memoizedState=Rg,e):Ux(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return DL(e,t,a,n,l,s,r);if(i){i=n.fallback,a=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Es(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Es(l,i):(i=vi(i,a,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,a=e.child.memoizedState,a=a===null?Ig(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~r,t.memoizedState=Rg,n}return i=e.child,e=i.sibling,n=Es(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ux(e,t){return t=Rf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function pu(e,t,r,n){return n!==null&&Px(n),Yo(t,e.child,null,r),e=Ux(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function DL(e,t,r,n,s,i,a){if(r)return t.flags&256?(t.flags&=-257,n=Ip(Error(re(422))),pu(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Rf({mode:"visible",children:n.children},s,0,null),i=vi(i,s,a,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Yo(t,e.child,null,a),t.child.memoizedState=Ig(a),t.memoizedState=Rg,i);if(!(t.mode&1))return pu(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(re(419)),n=Ip(i,n,void 0),pu(e,t,a,n)}if(l=(a&e.childLanes)!==0,Zt||l){if(n=xt,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,qn(e,s),Zr(n,e,s,-1))}return Kx(),n=Ip(Error(re(421))),pu(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=KL.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,ur=js(s.nextSibling),fr=t,Xe=!0,Yr=null,e!==null&&(Tr[kr++]=In,Tr[kr++]=On,Tr[kr++]=_i,In=e.id,On=e.overflow,_i=t),t=Ux(t,n.children),t.flags|=4096,t)}function Aw(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Eg(e.return,t,r)}function Op(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function KE(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Ft(e,t,n.children,r),n=et.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Aw(e,r,t);else if(e.tag===19)Aw(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ze(et,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&kd(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Op(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&kd(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Op(t,!0,r,null,i);break;case"together":Op(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ni|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(re(153));if(t.child!==null){for(e=t.child,r=Es(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Es(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function $L(e,t,r){switch(t.tag){case 3:HE(t),Ko();break;case 5:bE(t);break;case 1:tr(t.type)&&Sd(t);break;case 4:Ox(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;ze(Cd,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ze(et,et.current&1),t.flags|=128,null):r&t.child.childLanes?GE(e,t,r):(ze(et,et.current&1),e=Wn(e,t,r),e!==null?e.sibling:null);ze(et,et.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return KE(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ze(et,et.current),n)break;return null;case 22:case 23:return t.lanes=0,qE(e,t,r)}return Wn(e,t,r)}var YE,Og,JE,XE;YE=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Og=function(){};JE=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,di(yn.current);var i=null;switch(r){case"input":s=rg(e,s),n=rg(e,n),i=[];break;case"select":s=nt({},s,{value:void 0}),n=nt({},n,{value:void 0}),i=[];break;case"textarea":s=ig(e,s),n=ig(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=jd)}ag(r,n);var a;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Rl.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Rl.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ge("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};XE=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ua(e,t){if(!Xe)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Tt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ML(e,t,r){var n=t.pendingProps;switch(Cx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(t),null;case 1:return tr(t.type)&&_d(),Tt(t),null;case 3:return n=t.stateNode,Jo(),Ke(er),Ke(Ot),$x(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(fu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Yr!==null&&(Ug(Yr),Yr=null))),Og(e,t),Tt(t),null;case 5:Dx(t);var s=di(ql.current);if(r=t.type,e!==null&&t.stateNode!=null)JE(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(re(166));return Tt(t),null}if(e=di(yn.current),fu(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[hn]=t,n[Ul]=i,e=(t.mode&1)!==0,r){case"dialog":Ge("cancel",n),Ge("close",n);break;case"iframe":case"object":case"embed":Ge("load",n);break;case"video":case"audio":for(s=0;s<il.length;s++)Ge(il[s],n);break;case"source":Ge("error",n);break;case"img":case"image":case"link":Ge("error",n),Ge("load",n);break;case"details":Ge("toggle",n);break;case"input":Bb(n,i),Ge("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ge("invalid",n);break;case"textarea":Ub(n,i),Ge("invalid",n)}ag(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&du(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&du(n.textContent,l,e),s=["children",""+l]):Rl.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ge("scroll",n)}switch(r){case"input":nu(n),zb(n,i,!0);break;case"textarea":nu(n),Vb(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=jd)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=NN(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[hn]=t,e[Ul]=n,YE(e,t,!1,!1),t.stateNode=e;e:{switch(a=lg(r,n),r){case"dialog":Ge("cancel",e),Ge("close",e),s=n;break;case"iframe":case"object":case"embed":Ge("load",e),s=n;break;case"video":case"audio":for(s=0;s<il.length;s++)Ge(il[s],e);s=n;break;case"source":Ge("error",e),s=n;break;case"img":case"image":case"link":Ge("error",e),Ge("load",e),s=n;break;case"details":Ge("toggle",e),s=n;break;case"input":Bb(e,n),s=rg(e,n),Ge("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=nt({},n,{value:void 0}),Ge("invalid",e);break;case"textarea":Ub(e,n),s=ig(e,n),Ge("invalid",e);break;default:s=n}ag(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?PN(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&EN(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Il(e,c):typeof c=="number"&&Il(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Rl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ge("scroll",e):c!=null&&fx(e,i,c,a))}switch(r){case"input":nu(e),zb(e,n,!1);break;case"textarea":nu(e),Vb(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Is(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?ko(e,!!n.multiple,i,!1):n.defaultValue!=null&&ko(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=jd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Tt(t),null;case 6:if(e&&t.stateNode!=null)XE(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(re(166));if(r=di(ql.current),di(yn.current),fu(t)){if(n=t.stateNode,r=t.memoizedProps,n[hn]=t,(i=n.nodeValue!==r)&&(e=fr,e!==null))switch(e.tag){case 3:du(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&du(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[hn]=t,t.stateNode=n}return Tt(t),null;case 13:if(Ke(et),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Xe&&ur!==null&&t.mode&1&&!(t.flags&128))mE(),Ko(),t.flags|=98560,i=!1;else if(i=fu(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(re(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(re(317));i[hn]=t}else Ko(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Tt(t),i=!1}else Yr!==null&&(Ug(Yr),Yr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||et.current&1?pt===0&&(pt=3):Kx())),t.updateQueue!==null&&(t.flags|=4),Tt(t),null);case 4:return Jo(),Og(e,t),e===null&&Bl(t.stateNode.containerInfo),Tt(t),null;case 10:return Ax(t.type._context),Tt(t),null;case 17:return tr(t.type)&&_d(),Tt(t),null;case 19:if(Ke(et),i=t.memoizedState,i===null)return Tt(t),null;if(n=(t.flags&128)!==0,a=i.rendering,a===null)if(n)Ua(i,!1);else{if(pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=kd(e),a!==null){for(t.flags|=128,Ua(i,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ze(et,et.current&1|2),t.child}e=e.sibling}i.tail!==null&&ot()>Qo&&(t.flags|=128,n=!0,Ua(i,!1),t.lanes=4194304)}else{if(!n)if(e=kd(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ua(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Xe)return Tt(t),null}else 2*ot()-i.renderingStartTime>Qo&&r!==1073741824&&(t.flags|=128,n=!0,Ua(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(r=i.last,r!==null?r.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=ot(),t.sibling=null,r=et.current,ze(et,n?r&1|2:r&1),t):(Tt(t),null);case 22:case 23:return Gx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?or&1073741824&&(Tt(t),t.subtreeFlags&6&&(t.flags|=8192)):Tt(t),null;case 24:return null;case 25:return null}throw Error(re(156,t.tag))}function LL(e,t){switch(Cx(t),t.tag){case 1:return tr(t.type)&&_d(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Jo(),Ke(er),Ke(Ot),$x(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Dx(t),null;case 13:if(Ke(et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(re(340));Ko()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ke(et),null;case 4:return Jo(),null;case 10:return Ax(t.type._context),null;case 22:case 23:return Gx(),null;case 24:return null;default:return null}}var mu=!1,Rt=!1,FL=typeof WeakSet=="function"?WeakSet:Set,de=null;function _o(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){st(e,t,n)}else r.current=null}function Dg(e,t,r){try{r()}catch(n){st(e,t,n)}}var Rw=!1;function BL(e,t){if(xg=yd,e=rE(),Nx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,l=-1,c=-1,u=0,f=0,d=e,h=null;t:for(;;){for(var m;d!==r||s!==0&&d.nodeType!==3||(l=a+s),d!==i||n!==0&&d.nodeType!==3||(c=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(m=d.firstChild)!==null;)h=d,d=m;for(;;){if(d===e)break t;if(h===r&&++u===s&&(l=a),h===i&&++f===n&&(c=a),(m=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(yg={focusedElem:e,selectionRange:r},yd=!1,de=t;de!==null;)if(t=de,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,de=e;else for(;de!==null;){t=de;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,y=g.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?v:Hr(t.type,v),y);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(j){st(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,de=e;break}de=t.return}return g=Rw,Rw=!1,g}function yl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Dg(t,r,i)}s=s.next}while(s!==n)}}function kf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function $g(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function QE(e){var t=e.alternate;t!==null&&(e.alternate=null,QE(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[hn],delete t[Ul],delete t[jg],delete t[jL],delete t[_L])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ZE(e){return e.tag===5||e.tag===3||e.tag===4}function Iw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ZE(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Mg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=jd));else if(n!==4&&(e=e.child,e!==null))for(Mg(e,t,r),e=e.sibling;e!==null;)Mg(e,t,r),e=e.sibling}function Lg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Lg(e,t,r),e=e.sibling;e!==null;)Lg(e,t,r),e=e.sibling}var _t=null,Kr=!1;function ns(e,t,r){for(r=r.child;r!==null;)eC(e,t,r),r=r.sibling}function eC(e,t,r){if(xn&&typeof xn.onCommitFiberUnmount=="function")try{xn.onCommitFiberUnmount(jf,r)}catch{}switch(r.tag){case 5:Rt||_o(r,t);case 6:var n=_t,s=Kr;_t=null,ns(e,t,r),_t=n,Kr=s,_t!==null&&(Kr?(e=_t,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):_t.removeChild(r.stateNode));break;case 18:_t!==null&&(Kr?(e=_t,r=r.stateNode,e.nodeType===8?Cp(e.parentNode,r):e.nodeType===1&&Cp(e,r),Ml(e)):Cp(_t,r.stateNode));break;case 4:n=_t,s=Kr,_t=r.stateNode.containerInfo,Kr=!0,ns(e,t,r),_t=n,Kr=s;break;case 0:case 11:case 14:case 15:if(!Rt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Dg(r,t,a),s=s.next}while(s!==n)}ns(e,t,r);break;case 1:if(!Rt&&(_o(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){st(r,t,l)}ns(e,t,r);break;case 21:ns(e,t,r);break;case 22:r.mode&1?(Rt=(n=Rt)||r.memoizedState!==null,ns(e,t,r),Rt=n):ns(e,t,r);break;default:ns(e,t,r)}}function Ow(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new FL),t.forEach(function(n){var s=YL.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ur(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:_t=l.stateNode,Kr=!1;break e;case 3:_t=l.stateNode.containerInfo,Kr=!0;break e;case 4:_t=l.stateNode.containerInfo,Kr=!0;break e}l=l.return}if(_t===null)throw Error(re(160));eC(i,a,s),_t=null,Kr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){st(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tC(t,e),t=t.sibling}function tC(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ur(t,e),dn(e),n&4){try{yl(3,e,e.return),kf(3,e)}catch(v){st(e,e.return,v)}try{yl(5,e,e.return)}catch(v){st(e,e.return,v)}}break;case 1:Ur(t,e),dn(e),n&512&&r!==null&&_o(r,r.return);break;case 5:if(Ur(t,e),dn(e),n&512&&r!==null&&_o(r,r.return),e.flags&32){var s=e.stateNode;try{Il(s,"")}catch(v){st(e,e.return,v)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&_N(s,i),lg(l,a);var u=lg(l,i);for(a=0;a<c.length;a+=2){var f=c[a],d=c[a+1];f==="style"?PN(s,d):f==="dangerouslySetInnerHTML"?EN(s,d):f==="children"?Il(s,d):fx(s,f,d,u)}switch(l){case"input":ng(s,i);break;case"textarea":SN(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?ko(s,!!i.multiple,m,!1):h!==!!i.multiple&&(i.defaultValue!=null?ko(s,!!i.multiple,i.defaultValue,!0):ko(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ul]=i}catch(v){st(e,e.return,v)}}break;case 6:if(Ur(t,e),dn(e),n&4){if(e.stateNode===null)throw Error(re(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(v){st(e,e.return,v)}}break;case 3:if(Ur(t,e),dn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ml(t.containerInfo)}catch(v){st(e,e.return,v)}break;case 4:Ur(t,e),dn(e);break;case 13:Ur(t,e),dn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Wx=ot())),n&4&&Ow(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Rt=(u=Rt)||f,Ur(t,e),Rt=u):Ur(t,e),dn(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(de=e,f=e.child;f!==null;){for(d=de=f;de!==null;){switch(h=de,m=h.child,h.tag){case 0:case 11:case 14:case 15:yl(4,h,h.return);break;case 1:_o(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){st(n,r,v)}}break;case 5:_o(h,h.return);break;case 22:if(h.memoizedState!==null){$w(d);continue}}m!==null?(m.return=h,de=m):$w(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{s=d.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=d.stateNode,c=d.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=CN("display",a))}catch(v){st(e,e.return,v)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){st(e,e.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ur(t,e),dn(e),n&4&&Ow(e);break;case 21:break;default:Ur(t,e),dn(e)}}function dn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ZE(r)){var n=r;break e}r=r.return}throw Error(re(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Il(s,""),n.flags&=-33);var i=Iw(e);Lg(e,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=Iw(e);Mg(e,l,a);break;default:throw Error(re(161))}}catch(c){st(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zL(e,t,r){de=e,rC(e)}function rC(e,t,r){for(var n=(e.mode&1)!==0;de!==null;){var s=de,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||mu;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Rt;l=mu;var u=Rt;if(mu=a,(Rt=c)&&!u)for(de=s;de!==null;)a=de,c=a.child,a.tag===22&&a.memoizedState!==null?Mw(s):c!==null?(c.return=a,de=c):Mw(s);for(;i!==null;)de=i,rC(i),i=i.sibling;de=s,mu=l,Rt=u}Dw(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,de=i):Dw(e)}}function Dw(e){for(;de!==null;){var t=de;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Rt||kf(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Rt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Hr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&yw(t,i,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}yw(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Ml(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}Rt||t.flags&512&&$g(t)}catch(h){st(t,t.return,h)}}if(t===e){de=null;break}if(r=t.sibling,r!==null){r.return=t.return,de=r;break}de=t.return}}function $w(e){for(;de!==null;){var t=de;if(t===e){de=null;break}var r=t.sibling;if(r!==null){r.return=t.return,de=r;break}de=t.return}}function Mw(e){for(;de!==null;){var t=de;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{kf(4,t)}catch(c){st(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){st(t,s,c)}}var i=t.return;try{$g(t)}catch(c){st(t,i,c)}break;case 5:var a=t.return;try{$g(t)}catch(c){st(t,a,c)}}}catch(c){st(t,t.return,c)}if(t===e){de=null;break}var l=t.sibling;if(l!==null){l.return=t.return,de=l;break}de=t.return}}var UL=Math.ceil,Id=Qn.ReactCurrentDispatcher,Vx=Qn.ReactCurrentOwner,Ir=Qn.ReactCurrentBatchConfig,Oe=0,xt=null,ct=null,Nt=0,or=0,So=Us(0),pt=0,Kl=null,Ni=0,Af=0,qx=0,bl=null,Jt=null,Wx=0,Qo=1/0,Pn=null,Od=!1,Fg=null,Ss=null,gu=!1,gs=null,Dd=0,wl=0,Bg=null,nd=-1,sd=0;function Vt(){return Oe&6?ot():nd!==-1?nd:nd=ot()}function Ns(e){return e.mode&1?Oe&2&&Nt!==0?Nt&-Nt:NL.transition!==null?(sd===0&&(sd=BN()),sd):(e=$e,e!==0||(e=window.event,e=e===void 0?16:GN(e.type)),e):1}function Zr(e,t,r,n){if(50<wl)throw wl=0,Bg=null,Error(re(185));jc(e,r,n),(!(Oe&2)||e!==xt)&&(e===xt&&(!(Oe&2)&&(Af|=r),pt===4&&hs(e,Nt)),rr(e,n),r===1&&Oe===0&&!(t.mode&1)&&(Qo=ot()+500,Cf&&Vs()))}function rr(e,t){var r=e.callbackNode;NM(e,t);var n=xd(e,e===xt?Nt:0);if(n===0)r!==null&&Hb(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Hb(r),t===1)e.tag===0?SL(Lw.bind(null,e)):fE(Lw.bind(null,e)),bL(function(){!(Oe&6)&&Vs()}),r=null;else{switch(zN(n)){case 1:r=vx;break;case 4:r=LN;break;case 16:r=vd;break;case 536870912:r=FN;break;default:r=vd}r=uC(r,nC.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function nC(e,t){if(nd=-1,sd=0,Oe&6)throw Error(re(327));var r=e.callbackNode;if(Do()&&e.callbackNode!==r)return null;var n=xd(e,e===xt?Nt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=$d(e,n);else{t=n;var s=Oe;Oe|=2;var i=iC();(xt!==e||Nt!==t)&&(Pn=null,Qo=ot()+500,gi(e,t));do try{WL();break}catch(l){sC(e,l)}while(1);kx(),Id.current=i,Oe=s,ct!==null?t=0:(xt=null,Nt=0,t=pt)}if(t!==0){if(t===2&&(s=hg(e),s!==0&&(n=s,t=zg(e,s))),t===1)throw r=Kl,gi(e,0),hs(e,n),rr(e,ot()),r;if(t===6)hs(e,n);else{if(s=e.current.alternate,!(n&30)&&!VL(s)&&(t=$d(e,n),t===2&&(i=hg(e),i!==0&&(n=i,t=zg(e,i))),t===1))throw r=Kl,gi(e,0),hs(e,n),rr(e,ot()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(re(345));case 2:Zs(e,Jt,Pn);break;case 3:if(hs(e,n),(n&130023424)===n&&(t=Wx+500-ot(),10<t)){if(xd(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Vt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=wg(Zs.bind(null,e,Jt,Pn),t);break}Zs(e,Jt,Pn);break;case 4:if(hs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-Qr(n);i=1<<a,a=t[a],a>s&&(s=a),n&=~i}if(n=s,n=ot()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*UL(n/1960))-n,10<n){e.timeoutHandle=wg(Zs.bind(null,e,Jt,Pn),n);break}Zs(e,Jt,Pn);break;case 5:Zs(e,Jt,Pn);break;default:throw Error(re(329))}}}return rr(e,ot()),e.callbackNode===r?nC.bind(null,e):null}function zg(e,t){var r=bl;return e.current.memoizedState.isDehydrated&&(gi(e,t).flags|=256),e=$d(e,t),e!==2&&(t=Jt,Jt=r,t!==null&&Ug(t)),e}function Ug(e){Jt===null?Jt=e:Jt.push.apply(Jt,e)}function VL(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!en(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function hs(e,t){for(t&=~qx,t&=~Af,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Qr(t),n=1<<r;e[r]=-1,t&=~n}}function Lw(e){if(Oe&6)throw Error(re(327));Do();var t=xd(e,0);if(!(t&1))return rr(e,ot()),null;var r=$d(e,t);if(e.tag!==0&&r===2){var n=hg(e);n!==0&&(t=n,r=zg(e,n))}if(r===1)throw r=Kl,gi(e,0),hs(e,t),rr(e,ot()),r;if(r===6)throw Error(re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Zs(e,Jt,Pn),rr(e,ot()),null}function Hx(e,t){var r=Oe;Oe|=1;try{return e(t)}finally{Oe=r,Oe===0&&(Qo=ot()+500,Cf&&Vs())}}function Ei(e){gs!==null&&gs.tag===0&&!(Oe&6)&&Do();var t=Oe;Oe|=1;var r=Ir.transition,n=$e;try{if(Ir.transition=null,$e=1,e)return e()}finally{$e=n,Ir.transition=r,Oe=t,!(Oe&6)&&Vs()}}function Gx(){or=So.current,Ke(So)}function gi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,yL(r)),ct!==null)for(r=ct.return;r!==null;){var n=r;switch(Cx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&_d();break;case 3:Jo(),Ke(er),Ke(Ot),$x();break;case 5:Dx(n);break;case 4:Jo();break;case 13:Ke(et);break;case 19:Ke(et);break;case 10:Ax(n.type._context);break;case 22:case 23:Gx()}r=r.return}if(xt=e,ct=e=Es(e.current,null),Nt=or=t,pt=0,Kl=null,qx=Af=Ni=0,Jt=bl=null,ui!==null){for(t=0;t<ui.length;t++)if(r=ui[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}ui=null}return e}function sC(e,t){do{var r=ct;try{if(kx(),ed.current=Rd,Ad){for(var n=rt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ad=!1}if(Si=0,gt=ht=rt=null,xl=!1,Wl=0,Vx.current=null,r===null||r.return===null){pt=1,Kl=t,ct=null;break}e:{var i=e,a=r.return,l=r,c=t;if(t=Nt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Nw(a);if(m!==null){m.flags&=-257,Ew(m,a,l,i,t),m.mode&1&&Sw(i,u,t),t=m,c=u;var g=t.updateQueue;if(g===null){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}else{if(!(t&1)){Sw(i,u,t),Kx();break e}c=Error(re(426))}}else if(Xe&&l.mode&1){var y=Nw(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Ew(y,a,l,i,t),Px(Xo(c,l));break e}}i=c=Xo(c,l),pt!==4&&(pt=2),bl===null?bl=[i]:bl.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=zE(i,c,t);xw(i,x);break e;case 1:l=c;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ss===null||!Ss.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=UE(i,l,t);xw(i,j);break e}}i=i.return}while(i!==null)}aC(r)}catch(_){t=_,ct===r&&r!==null&&(ct=r=r.return);continue}break}while(1)}function iC(){var e=Id.current;return Id.current=Rd,e===null?Rd:e}function Kx(){(pt===0||pt===3||pt===2)&&(pt=4),xt===null||!(Ni&268435455)&&!(Af&268435455)||hs(xt,Nt)}function $d(e,t){var r=Oe;Oe|=2;var n=iC();(xt!==e||Nt!==t)&&(Pn=null,gi(e,t));do try{qL();break}catch(s){sC(e,s)}while(1);if(kx(),Oe=r,Id.current=n,ct!==null)throw Error(re(261));return xt=null,Nt=0,pt}function qL(){for(;ct!==null;)oC(ct)}function WL(){for(;ct!==null&&!gM();)oC(ct)}function oC(e){var t=cC(e.alternate,e,or);e.memoizedProps=e.pendingProps,t===null?aC(e):ct=t,Vx.current=null}function aC(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=LL(r,t),r!==null){r.flags&=32767,ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pt=6,ct=null;return}}else if(r=ML(r,t,or),r!==null){ct=r;return}if(t=t.sibling,t!==null){ct=t;return}ct=t=e}while(t!==null);pt===0&&(pt=5)}function Zs(e,t,r){var n=$e,s=Ir.transition;try{Ir.transition=null,$e=1,HL(e,t,r,n)}finally{Ir.transition=s,$e=n}return null}function HL(e,t,r,n){do Do();while(gs!==null);if(Oe&6)throw Error(re(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(re(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(EM(e,i),e===xt&&(ct=xt=null,Nt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||gu||(gu=!0,uC(vd,function(){return Do(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Ir.transition,Ir.transition=null;var a=$e;$e=1;var l=Oe;Oe|=4,Vx.current=null,BL(e,r),tC(r,e),fL(yg),yd=!!xg,yg=xg=null,e.current=r,zL(r),vM(),Oe=l,$e=a,Ir.transition=i}else e.current=r;if(gu&&(gu=!1,gs=e,Dd=s),i=e.pendingLanes,i===0&&(Ss=null),bM(r.stateNode),rr(e,ot()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Od)throw Od=!1,e=Fg,Fg=null,e;return Dd&1&&e.tag!==0&&Do(),i=e.pendingLanes,i&1?e===Bg?wl++:(wl=0,Bg=e):wl=0,Vs(),null}function Do(){if(gs!==null){var e=zN(Dd),t=Ir.transition,r=$e;try{if(Ir.transition=null,$e=16>e?16:e,gs===null)var n=!1;else{if(e=gs,gs=null,Dd=0,Oe&6)throw Error(re(331));var s=Oe;for(Oe|=4,de=e.current;de!==null;){var i=de,a=i.child;if(de.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(de=u;de!==null;){var f=de;switch(f.tag){case 0:case 11:case 15:yl(8,f,i)}var d=f.child;if(d!==null)d.return=f,de=d;else for(;de!==null;){f=de;var h=f.sibling,m=f.return;if(QE(f),f===u){de=null;break}if(h!==null){h.return=m,de=h;break}de=m}}}var g=i.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}de=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,de=a;else e:for(;de!==null;){if(i=de,i.flags&2048)switch(i.tag){case 0:case 11:case 15:yl(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,de=x;break e}de=i.return}}var b=e.current;for(de=b;de!==null;){a=de;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,de=w;else e:for(a=b;de!==null;){if(l=de,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:kf(9,l)}}catch(_){st(l,l.return,_)}if(l===a){de=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,de=j;break e}de=l.return}}if(Oe=s,Vs(),xn&&typeof xn.onPostCommitFiberRoot=="function")try{xn.onPostCommitFiberRoot(jf,e)}catch{}n=!0}return n}finally{$e=r,Ir.transition=t}}return!1}function Fw(e,t,r){t=Xo(r,t),t=zE(e,t,1),e=_s(e,t,1),t=Vt(),e!==null&&(jc(e,1,t),rr(e,t))}function st(e,t,r){if(e.tag===3)Fw(e,e,r);else for(;t!==null;){if(t.tag===3){Fw(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ss===null||!Ss.has(n))){e=Xo(r,e),e=UE(t,e,1),t=_s(t,e,1),e=Vt(),t!==null&&(jc(t,1,e),rr(t,e));break}}t=t.return}}function GL(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Vt(),e.pingedLanes|=e.suspendedLanes&r,xt===e&&(Nt&r)===r&&(pt===4||pt===3&&(Nt&130023424)===Nt&&500>ot()-Wx?gi(e,0):qx|=r),rr(e,t)}function lC(e,t){t===0&&(e.mode&1?(t=ou,ou<<=1,!(ou&130023424)&&(ou=4194304)):t=1);var r=Vt();e=qn(e,t),e!==null&&(jc(e,t,r),rr(e,r))}function KL(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),lC(e,r)}function YL(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(re(314))}n!==null&&n.delete(t),lC(e,r)}var cC;cC=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||er.current)Zt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Zt=!1,$L(e,t,r);Zt=!!(e.flags&131072)}else Zt=!1,Xe&&t.flags&1048576&&hE(t,Ed,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;rd(e,t),e=t.pendingProps;var s=Go(t,Ot.current);Oo(t,r),s=Lx(null,t,n,e,s,r);var i=Fx();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,tr(n)?(i=!0,Sd(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ix(t),s.updater=Tf,t.stateNode=s,s._reactInternals=t,Pg(t,n,e,r),t=Ag(null,t,n,!0,i,r)):(t.tag=0,Xe&&i&&Ex(t),Ft(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(rd(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=XL(n),e=Hr(n,e),s){case 0:t=kg(null,t,n,e,r);break e;case 1:t=Tw(null,t,n,e,r);break e;case 11:t=Cw(null,t,n,e,r);break e;case 14:t=Pw(null,t,n,Hr(n.type,e),r);break e}throw Error(re(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Hr(n,s),kg(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Hr(n,s),Tw(e,t,n,s,r);case 3:e:{if(HE(t),e===null)throw Error(re(387));n=t.pendingProps,i=t.memoizedState,s=i.element,yE(e,t),Td(t,n,null,r);var a=t.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Xo(Error(re(423)),t),t=kw(e,t,n,r,s);break e}else if(n!==s){s=Xo(Error(re(424)),t),t=kw(e,t,n,r,s);break e}else for(ur=js(t.stateNode.containerInfo.firstChild),fr=t,Xe=!0,Yr=null,r=vE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ko(),n===s){t=Wn(e,t,r);break e}Ft(e,t,n,r)}t=t.child}return t;case 5:return bE(t),e===null&&Ng(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,bg(n,s)?a=null:i!==null&&bg(n,i)&&(t.flags|=32),WE(e,t),Ft(e,t,a,r),t.child;case 6:return e===null&&Ng(t),null;case 13:return GE(e,t,r);case 4:return Ox(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Yo(t,null,n,r):Ft(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Hr(n,s),Cw(e,t,n,s,r);case 7:return Ft(e,t,t.pendingProps,r),t.child;case 8:return Ft(e,t,t.pendingProps.children,r),t.child;case 12:return Ft(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,ze(Cd,n._currentValue),n._currentValue=a,i!==null)if(en(i.value,a)){if(i.children===s.children&&!er.current){t=Wn(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=$n(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Eg(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(re(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Eg(a,r,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Ft(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Oo(t,r),s=$r(s),n=n(s),t.flags|=1,Ft(e,t,n,r),t.child;case 14:return n=t.type,s=Hr(n,t.pendingProps),s=Hr(n.type,s),Pw(e,t,n,s,r);case 15:return VE(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Hr(n,s),rd(e,t),t.tag=1,tr(n)?(e=!0,Sd(t)):e=!1,Oo(t,r),BE(t,n,s),Pg(t,n,s,r),Ag(null,t,n,!0,e,r);case 19:return KE(e,t,r);case 22:return qE(e,t,r)}throw Error(re(156,t.tag))};function uC(e,t){return MN(e,t)}function JL(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ar(e,t,r,n){return new JL(e,t,r,n)}function Yx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function XL(e){if(typeof e=="function")return Yx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===px)return 11;if(e===mx)return 14}return 2}function Es(e,t){var r=e.alternate;return r===null?(r=Ar(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function id(e,t,r,n,s,i){var a=2;if(n=e,typeof e=="function")Yx(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case po:return vi(r.children,s,i,t);case hx:a=8,s|=8;break;case Qm:return e=Ar(12,r,t,s|2),e.elementType=Qm,e.lanes=i,e;case Zm:return e=Ar(13,r,t,s),e.elementType=Zm,e.lanes=i,e;case eg:return e=Ar(19,r,t,s),e.elementType=eg,e.lanes=i,e;case bN:return Rf(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case xN:a=10;break e;case yN:a=9;break e;case px:a=11;break e;case mx:a=14;break e;case cs:a=16,n=null;break e}throw Error(re(130,e==null?e:typeof e,""))}return t=Ar(a,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function vi(e,t,r,n){return e=Ar(7,e,n,t),e.lanes=r,e}function Rf(e,t,r,n){return e=Ar(22,e,n,t),e.elementType=bN,e.lanes=r,e.stateNode={isHidden:!1},e}function Dp(e,t,r){return e=Ar(6,e,null,t),e.lanes=r,e}function $p(e,t,r){return t=Ar(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function QL(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gp(0),this.expirationTimes=gp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gp(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Jx(e,t,r,n,s,i,a,l,c){return e=new QL(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ar(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ix(i),e}function ZL(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ho,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function dC(e){if(!e)return Os;e=e._reactInternals;e:{if(Mi(e)!==e||e.tag!==1)throw Error(re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(tr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(re(171))}if(e.tag===1){var r=e.type;if(tr(r))return dE(e,r,t)}return t}function fC(e,t,r,n,s,i,a,l,c){return e=Jx(r,n,!0,e,s,i,a,l,c),e.context=dC(null),r=e.current,n=Vt(),s=Ns(r),i=$n(n,s),i.callback=t??null,_s(r,i,s),e.current.lanes=s,jc(e,s,n),rr(e,n),e}function If(e,t,r,n){var s=t.current,i=Vt(),a=Ns(s);return r=dC(r),t.context===null?t.context=r:t.pendingContext=r,t=$n(i,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=_s(s,t,a),e!==null&&(Zr(e,s,a,i),Zu(e,s,a)),a}function Md(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Bw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Xx(e,t){Bw(e,t),(e=e.alternate)&&Bw(e,t)}function e4(){return null}var hC=typeof reportError=="function"?reportError:function(e){console.error(e)};function Qx(e){this._internalRoot=e}Of.prototype.render=Qx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(re(409));If(e,t,null,null)};Of.prototype.unmount=Qx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ei(function(){If(null,e,null,null)}),t[Vn]=null}};function Of(e){this._internalRoot=e}Of.prototype.unstable_scheduleHydration=function(e){if(e){var t=qN();e={blockedOn:null,target:e,priority:t};for(var r=0;r<fs.length&&t!==0&&t<fs[r].priority;r++);fs.splice(r,0,e),r===0&&HN(e)}};function Zx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Df(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function zw(){}function t4(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=Md(a);i.call(u)}}var a=fC(t,n,e,0,null,!1,!1,"",zw);return e._reactRootContainer=a,e[Vn]=a.current,Bl(e.nodeType===8?e.parentNode:e),Ei(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=Md(c);l.call(u)}}var c=Jx(e,0,!1,null,null,!1,!1,"",zw);return e._reactRootContainer=c,e[Vn]=c.current,Bl(e.nodeType===8?e.parentNode:e),Ei(function(){If(t,c,r,n)}),c}function $f(e,t,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Md(a);l.call(c)}}If(t,a,e,s)}else a=t4(r,t,e,s,n);return Md(a)}UN=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=sl(t.pendingLanes);r!==0&&(xx(t,r|1),rr(t,ot()),!(Oe&6)&&(Qo=ot()+500,Vs()))}break;case 13:Ei(function(){var n=qn(e,1);if(n!==null){var s=Vt();Zr(n,e,1,s)}}),Xx(e,1)}};yx=function(e){if(e.tag===13){var t=qn(e,134217728);if(t!==null){var r=Vt();Zr(t,e,134217728,r)}Xx(e,134217728)}};VN=function(e){if(e.tag===13){var t=Ns(e),r=qn(e,t);if(r!==null){var n=Vt();Zr(r,e,t,n)}Xx(e,t)}};qN=function(){return $e};WN=function(e,t){var r=$e;try{return $e=e,t()}finally{$e=r}};ug=function(e,t,r){switch(t){case"input":if(ng(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Ef(n);if(!s)throw Error(re(90));jN(n),ng(n,s)}}}break;case"textarea":SN(e,r);break;case"select":t=r.value,t!=null&&ko(e,!!r.multiple,t,!1)}};AN=Hx;RN=Ei;var r4={usingClientEntryPoint:!1,Events:[Sc,xo,Ef,TN,kN,Hx]},Va={findFiberByHostInstance:ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},n4={bundleType:Va.bundleType,version:Va.version,rendererPackageName:Va.rendererPackageName,rendererConfig:Va.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=DN(e),e===null?null:e.stateNode},findFiberByHostInstance:Va.findFiberByHostInstance||e4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vu.isDisabled&&vu.supportsFiber)try{jf=vu.inject(n4),xn=vu}catch{}}br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r4;br.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zx(t))throw Error(re(200));return ZL(e,t,null,r)};br.createRoot=function(e,t){if(!Zx(e))throw Error(re(299));var r=!1,n="",s=hC;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Jx(e,1,!1,null,null,r,!1,n,s),e[Vn]=t.current,Bl(e.nodeType===8?e.parentNode:e),new Qx(t)};br.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(re(188)):(e=Object.keys(e).join(","),Error(re(268,e)));return e=DN(t),e=e===null?null:e.stateNode,e};br.flushSync=function(e){return Ei(e)};br.hydrate=function(e,t,r){if(!Df(t))throw Error(re(200));return $f(null,e,t,!0,r)};br.hydrateRoot=function(e,t,r){if(!Zx(e))throw Error(re(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=hC;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=fC(t,null,e,1,r??null,s,!1,i,a),e[Vn]=t.current,Bl(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Of(t)};br.render=function(e,t,r){if(!Df(t))throw Error(re(200));return $f(null,e,t,!1,r)};br.unmountComponentAtNode=function(e){if(!Df(e))throw Error(re(40));return e._reactRootContainer?(Ei(function(){$f(null,null,e,!1,function(){e._reactRootContainer=null,e[Vn]=null})}),!0):!1};br.unstable_batchedUpdates=Hx;br.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Df(r))throw Error(re(200));if(e==null||e._reactInternals===void 0)throw Error(re(38));return $f(e,t,r,!1,n)};br.version="18.3.1-next-f1338f8080-20240426";function pC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pC)}catch(e){console.error(e)}}pC(),pN.exports=br;var jr=pN.exports;const Mf=Di(jr);var Uw=jr;Jm.createRoot=Uw.createRoot,Jm.hydrateRoot=Uw.hydrateRoot;/**
 * @remix-run/router v1.9.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yl(){return Yl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yl.apply(this,arguments)}var vs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(vs||(vs={}));const Vw="popstate";function s4(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:a,hash:l}=n.location;return Vg("",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Ld(s)}return o4(t,r,null,e)}function ut(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function e0(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function i4(){return Math.random().toString(36).substr(2,8)}function qw(e,t){return{usr:e.state,key:e.key,idx:t}}function Vg(e,t,r,n){return r===void 0&&(r=null),Yl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?pa(t):t,{state:r,key:t&&t.key||n||i4()})}function Ld(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function pa(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function o4(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,l=vs.Pop,c=null,u=f();u==null&&(u=0,a.replaceState(Yl({},a.state,{idx:u}),""));function f(){return(a.state||{idx:null}).idx}function d(){l=vs.Pop;let y=f(),x=y==null?null:y-u;u=y,c&&c({action:l,location:v.location,delta:x})}function h(y,x){l=vs.Push;let b=Vg(v.location,y,x);r&&r(b,y),u=f()+1;let w=qw(b,u),j=v.createHref(b);try{a.pushState(w,"",j)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(j)}i&&c&&c({action:l,location:v.location,delta:1})}function m(y,x){l=vs.Replace;let b=Vg(v.location,y,x);r&&r(b,y),u=f();let w=qw(b,u),j=v.createHref(b);a.replaceState(w,"",j),i&&c&&c({action:l,location:v.location,delta:0})}function g(y){let x=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof y=="string"?y:Ld(y);return ut(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let v={get action(){return l},get location(){return e(s,a)},listen(y){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Vw,d),c=y,()=>{s.removeEventListener(Vw,d),c=null}},createHref(y){return t(s,y)},createURL:g,encodeLocation(y){let x=g(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:m,go(y){return a.go(y)}};return v}var Ww;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Ww||(Ww={}));function a4(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?pa(t):t,s=t0(n.pathname||"/",r);if(s==null)return null;let i=mC(e);l4(i);let a=null;for(let l=0;a==null&&l<i.length;++l)a=v4(i[l],b4(s));return a}function mC(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,a,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};c.relativePath.startsWith("/")&&(ut(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Cs([n,c.relativePath]),f=r.concat(c);i.children&&i.children.length>0&&(ut(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),mC(i.children,t,f,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:m4(u,i.index),routesMeta:f})};return e.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,a);else for(let c of gC(i.path))s(i,a,c)}),t}function gC(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=gC(n.join("/")),l=[];return l.push(...a.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...a),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function l4(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:g4(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const c4=/^:\w+$/,u4=3,d4=2,f4=1,h4=10,p4=-2,Hw=e=>e==="*";function m4(e,t){let r=e.split("/"),n=r.length;return r.some(Hw)&&(n+=p4),t&&(n+=d4),r.filter(s=>!Hw(s)).reduce((s,i)=>s+(c4.test(i)?u4:i===""?f4:h4),n)}function g4(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function v4(e,t){let{routesMeta:r}=e,n={},s="/",i=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=s==="/"?t:t.slice(s.length)||"/",f=x4({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u);if(!f)return null;Object.assign(n,f.params);let d=l.route;i.push({params:n,pathname:Cs([s,f.pathname]),pathnameBase:S4(Cs([s,f.pathnameBase])),route:d}),f.pathnameBase!=="/"&&(s=Cs([s,f.pathnameBase]))}return i}function x4(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=y4(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,f,d)=>{if(f==="*"){let h=l[d]||"";a=i.slice(0,i.length-h.length).replace(/(.)\/+$/,"$1")}return u[f]=w4(l[d]||"",f),u},{}),pathname:i,pathnameBase:a,pattern:e}}function y4(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),e0(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,l)=>(n.push(l),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function b4(e){try{return decodeURI(e)}catch(t){return e0(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function w4(e,t){try{return decodeURIComponent(e)}catch(r){return e0(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function t0(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function j4(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?pa(e):e;return{pathname:r?r.startsWith("/")?r:_4(r,t):t,search:N4(n),hash:E4(s)}}function _4(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Mp(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function vC(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function xC(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=pa(e):(s=Yl({},e),ut(!s.pathname||!s.pathname.includes("?"),Mp("?","pathname","search",s)),ut(!s.pathname||!s.pathname.includes("#"),Mp("#","pathname","hash",s)),ut(!s.search||!s.search.includes("#"),Mp("#","search","hash",s)));let i=e===""||s.pathname==="",a=i?"/":s.pathname,l;if(n||a==null)l=r;else{let d=t.length-1;if(a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),d-=1;s.pathname=h.join("/")}l=d>=0?t[d]:"/"}let c=j4(s,l),u=a&&a!=="/"&&a.endsWith("/"),f=(i||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||f)&&(c.pathname+="/"),c}const Cs=e=>e.join("/").replace(/\/\/+/g,"/"),S4=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),N4=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,E4=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function C4(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const yC=["post","put","patch","delete"];new Set(yC);const P4=["get",...yC];new Set(P4);/**
 * React Router v6.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fd(){return Fd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fd.apply(this,arguments)}const r0=p.createContext(null),bC=p.createContext(null),Li=p.createContext(null),Lf=p.createContext(null),Zn=p.createContext({outlet:null,matches:[],isDataRoute:!1}),wC=p.createContext(null);function T4(e,t){let{relative:r}=t===void 0?{}:t;Ec()||ut(!1);let{basename:n,navigator:s}=p.useContext(Li),{hash:i,pathname:a,search:l}=n0(e,{relative:r}),c=a;return n!=="/"&&(c=a==="/"?n:Cs([n,a])),s.createHref({pathname:c,search:l,hash:i})}function Ec(){return p.useContext(Lf)!=null}function Ht(){return Ec()||ut(!1),p.useContext(Lf).location}function jC(e){p.useContext(Li).static||p.useLayoutEffect(e)}function Te(){let{isDataRoute:e}=p.useContext(Zn);return e?q4():k4()}function k4(){Ec()||ut(!1);let e=p.useContext(r0),{basename:t,navigator:r}=p.useContext(Li),{matches:n}=p.useContext(Zn),{pathname:s}=Ht(),i=JSON.stringify(vC(n).map(c=>c.pathnameBase)),a=p.useRef(!1);return jC(()=>{a.current=!0}),p.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let f=xC(c,JSON.parse(i),s,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Cs([t,f.pathname])),(u.replace?r.replace:r.push)(f,u.state,u)},[t,r,i,s,e])}const A4=p.createContext(null);function R4(e){let t=p.useContext(Zn).outlet;return t&&p.createElement(A4.Provider,{value:e},t)}function ma(){let{matches:e}=p.useContext(Zn),t=e[e.length-1];return t?t.params:{}}function n0(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=p.useContext(Zn),{pathname:s}=Ht(),i=JSON.stringify(vC(n).map(a=>a.pathnameBase));return p.useMemo(()=>xC(e,JSON.parse(i),s,r==="path"),[e,i,s,r])}function I4(e,t){return O4(e,t)}function O4(e,t,r){Ec()||ut(!1);let{navigator:n}=p.useContext(Li),{matches:s}=p.useContext(Zn),i=s[s.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=Ht(),u;if(t){var f;let v=typeof t=="string"?pa(t):t;l==="/"||(f=v.pathname)!=null&&f.startsWith(l)||ut(!1),u=v}else u=c;let d=u.pathname||"/",h=l==="/"?d:d.slice(l.length)||"/",m=a4(e,{pathname:h}),g=F4(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},a,v.params),pathname:Cs([l,n.encodeLocation?n.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Cs([l,n.encodeLocation?n.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,r);return t&&g?p.createElement(Lf.Provider,{value:{location:Fd({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:vs.Pop}},g):g}function D4(){let e=V4(),t=C4(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),r?p.createElement("pre",{style:s},r):null,i)}const $4=p.createElement(D4,null);class M4 extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?p.createElement(Zn.Provider,{value:this.props.routeContext},p.createElement(wC.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function L4(e){let{routeContext:t,match:r,children:n}=e,s=p.useContext(r0);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),p.createElement(Zn.Provider,{value:t},n)}function F4(e,t,r){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var s;if((s=r)!=null&&s.errors)e=r.matches;else return null}let i=e,a=(n=r)==null?void 0:n.errors;if(a!=null){let l=i.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id]));l>=0||ut(!1),i=i.slice(0,Math.min(i.length,l+1))}return i.reduceRight((l,c,u)=>{let f=c.route.id?a==null?void 0:a[c.route.id]:null,d=null;r&&(d=c.route.errorElement||$4);let h=t.concat(i.slice(0,u+1)),m=()=>{let g;return f?g=d:c.route.Component?g=p.createElement(c.route.Component,null):c.route.element?g=c.route.element:g=l,p.createElement(L4,{match:c,routeContext:{outlet:l,matches:h,isDataRoute:r!=null},children:g})};return r&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?p.createElement(M4,{location:r.location,revalidation:r.revalidation,component:d,error:f,children:m(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):m()},null)}var _C=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(_C||{}),Bd=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Bd||{});function B4(e){let t=p.useContext(r0);return t||ut(!1),t}function z4(e){let t=p.useContext(bC);return t||ut(!1),t}function U4(e){let t=p.useContext(Zn);return t||ut(!1),t}function SC(e){let t=U4(),r=t.matches[t.matches.length-1];return r.route.id||ut(!1),r.route.id}function V4(){var e;let t=p.useContext(wC),r=z4(Bd.UseRouteError),n=SC(Bd.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function q4(){let{router:e}=B4(_C.UseNavigateStable),t=SC(Bd.UseNavigateStable),r=p.useRef(!1);return jC(()=>{r.current=!0}),p.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Fd({fromRouteId:t},i)))},[e,t])}function Ff(e){return R4(e.context)}function ge(e){ut(!1)}function W4(e){let{basename:t="/",children:r=null,location:n,navigationType:s=vs.Pop,navigator:i,static:a=!1}=e;Ec()&&ut(!1);let l=t.replace(/^\/*/,"/"),c=p.useMemo(()=>({basename:l,navigator:i,static:a}),[l,i,a]);typeof n=="string"&&(n=pa(n));let{pathname:u="/",search:f="",hash:d="",state:h=null,key:m="default"}=n,g=p.useMemo(()=>{let v=t0(u,l);return v==null?null:{location:{pathname:v,search:f,hash:d,state:h,key:m},navigationType:s}},[l,u,f,d,h,m,s]);return g==null?null:p.createElement(Li.Provider,{value:c},p.createElement(Lf.Provider,{children:r,value:g}))}function H4(e){let{children:t,location:r}=e;return I4(qg(t),r)}new Promise(()=>{});function qg(e,t){t===void 0&&(t=[]);let r=[];return p.Children.forEach(e,(n,s)=>{if(!p.isValidElement(n))return;let i=[...t,s];if(n.type===p.Fragment){r.push.apply(r,qg(n.props.children,i));return}n.type!==ge&&ut(!1),!n.props.index||!n.props.children||ut(!1);let a={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=qg(n.props.children,i)),r.push(a)}),r}/**
 * React Router DOM v6.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zd(){return zd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zd.apply(this,arguments)}function NC(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function G4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function K4(e,t){return e.button===0&&(!t||t==="_self")&&!G4(e)}function Wg(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function Y4(e,t){let r=Wg(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(i=>{r.append(s,i)})}),r}const J4=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],X4=["aria-current","caseSensitive","className","end","style","to","children"],Q4="startTransition",Gw=wc[Q4];function Kw(e){let{basename:t,children:r,future:n,window:s}=e,i=p.useRef();i.current==null&&(i.current=s4({window:s,v5Compat:!0}));let a=i.current,[l,c]=p.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},f=p.useCallback(d=>{u&&Gw?Gw(()=>c(d)):c(d)},[c,u]);return p.useLayoutEffect(()=>a.listen(f),[a,f]),p.createElement(W4,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:a})}const Z4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",e5=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xi=p.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:l,target:c,to:u,preventScrollReset:f}=t,d=NC(t,J4),{basename:h}=p.useContext(Li),m,g=!1;if(typeof u=="string"&&e5.test(u)&&(m=u,Z4))try{let b=new URL(window.location.href),w=u.startsWith("//")?new URL(b.protocol+u):new URL(u),j=t0(w.pathname,h);w.origin===b.origin&&j!=null?u=j+w.search+w.hash:g=!0}catch{}let v=T4(u,{relative:s}),y=t5(u,{replace:a,state:l,target:c,preventScrollReset:f,relative:s});function x(b){n&&n(b),b.defaultPrevented||y(b)}return p.createElement("a",zd({},d,{href:m||v,onClick:g||i?n:x,ref:r,target:c}))}),Ud=p.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:i="",end:a=!1,style:l,to:c,children:u}=t,f=NC(t,X4),d=n0(c,{relative:f.relative}),h=Ht(),m=p.useContext(bC),{navigator:g}=p.useContext(Li),v=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,y=h.pathname,x=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;s||(y=y.toLowerCase(),x=x?x.toLowerCase():null,v=v.toLowerCase());let b=y===v||!a&&y.startsWith(v)&&y.charAt(v.length)==="/",w=x!=null&&(x===v||!a&&x.startsWith(v)&&x.charAt(v.length)==="/"),j=b?n:void 0,_;typeof i=="function"?_=i({isActive:b,isPending:w}):_=[i,b?"active":null,w?"pending":null].filter(Boolean).join(" ");let S=typeof l=="function"?l({isActive:b,isPending:w}):l;return p.createElement(xi,zd({},f,{"aria-current":j,className:_,ref:r,style:S,to:c}),typeof u=="function"?u({isActive:b,isPending:w}):u)});var Yw;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(Yw||(Yw={}));var Jw;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Jw||(Jw={}));function t5(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a}=t===void 0?{}:t,l=Te(),c=Ht(),u=n0(e,{relative:a});return p.useCallback(f=>{if(K4(f,r)){f.preventDefault();let d=n!==void 0?n:Ld(c)===Ld(u);l(e,{replace:d,state:s,preventScrollReset:i,relative:a})}},[c,l,u,n,s,r,e,i,a])}function Bf(e){let t=p.useRef(Wg(e)),r=p.useRef(!1),n=Ht(),s=p.useMemo(()=>Y4(n.search,r.current?null:t.current),[n.search]),i=Te(),a=p.useCallback((l,c)=>{const u=Wg(typeof l=="function"?l(s):l);r.current=!0,i("?"+u,c)},[i,s]);return[s,a]}var EC={exports:{}},r5="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",n5=r5,s5=n5;function CC(){}function PC(){}PC.resetWarningCache=CC;var i5=function(){function e(n,s,i,a,l,c){if(c!==s5){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:PC,resetWarningCache:CC};return r.PropTypes=r,r};EC.exports=i5();var o5=EC.exports;const Ye=Di(o5);function a5(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var TC=p,l5=a5(TC);function Xw(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c5(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var u5=!!(typeof window<"u"&&window.document&&window.document.createElement);function d5(e,t,r){if(typeof e!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof t!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof r<"u"&&typeof r!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function n(s){return s.displayName||s.name||"Component"}return function(i){if(typeof i!="function")throw new Error("Expected WrappedComponent to be a React component.");var a=[],l;function c(){l=e(a.map(function(f){return f.props})),u.canUseDOM?t(l):r&&(l=r(l))}var u=function(f){c5(d,f);function d(){return f.apply(this,arguments)||this}d.peek=function(){return l},d.rewind=function(){if(d.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var g=l;return l=void 0,a=[],g};var h=d.prototype;return h.UNSAFE_componentWillMount=function(){a.push(this),c()},h.componentDidUpdate=function(){c()},h.componentWillUnmount=function(){var g=a.indexOf(this);a.splice(g,1),c()},h.render=function(){return l5.createElement(i,this.props)},d}(TC.PureComponent);return Xw(u,"displayName","SideEffect("+n(i)+")"),Xw(u,"canUseDOM",u5),u}}var f5=d5;const h5=Di(f5);var p5=typeof Element<"u",m5=typeof Map=="function",g5=typeof Set=="function",v5=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function od(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n,s;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!od(e[n],t[n]))return!1;return!0}var i;if(m5&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;for(i=e.entries();!(n=i.next()).done;)if(!od(n.value[1],t.get(n.value[0])))return!1;return!0}if(g5&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(v5&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[n]))return!1;if(p5&&e instanceof Element)return!1;for(n=r;n--!==0;)if(!((s[n]==="_owner"||s[n]==="__v"||s[n]==="__o")&&e.$$typeof)&&!od(e[s[n]],t[s[n]]))return!1;return!0}return e!==e&&t!==t}var x5=function(t,r){try{return od(t,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const y5=Di(x5);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Qw=Object.getOwnPropertySymbols,b5=Object.prototype.hasOwnProperty,w5=Object.prototype.propertyIsEnumerable;function j5(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function _5(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(i){return t[i]});if(n.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(i){s[i]=i}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var S5=_5()?Object.assign:function(e,t){for(var r,n=j5(e),s,i=1;i<arguments.length;i++){r=Object(arguments[i]);for(var a in r)b5.call(r,a)&&(n[a]=r[a]);if(Qw){s=Qw(r);for(var l=0;l<s.length;l++)w5.call(r,s[l])&&(n[s[l]]=r[s[l]])}}return n};const N5=Di(S5);var yi={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},Ne={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(Ne).map(function(e){return Ne[e]});var Je={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},Vd={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Jl={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},E5=Object.keys(Vd).reduce(function(e,t){return e[Vd[t]]=t,e},{}),C5=[Ne.NOSCRIPT,Ne.SCRIPT,Ne.STYLE],Jr="data-react-helmet",P5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T5=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},k5=function(){function e(t,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Kt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A5=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Zw=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},R5=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},Hg=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},I5=function(t){var r=$o(t,Ne.TITLE),n=$o(t,Jl.TITLE_TEMPLATE);if(n&&r)return n.replace(/%s/g,function(){return Array.isArray(r)?r.join(""):r});var s=$o(t,Jl.DEFAULT_TITLE);return r||s||void 0},O5=function(t){return $o(t,Jl.ON_CHANGE_CLIENT_STATE)||function(){}},Lp=function(t,r){return r.filter(function(n){return typeof n[t]<"u"}).map(function(n){return n[t]}).reduce(function(n,s){return Kt({},n,s)},{})},D5=function(t,r){return r.filter(function(n){return typeof n[Ne.BASE]<"u"}).map(function(n){return n[Ne.BASE]}).reverse().reduce(function(n,s){if(!n.length)for(var i=Object.keys(s),a=0;a<i.length;a++){var l=i[a],c=l.toLowerCase();if(t.indexOf(c)!==-1&&s[c])return n.concat(s)}return n},[])},qa=function(t,r,n){var s={};return n.filter(function(i){return Array.isArray(i[t])?!0:(typeof i[t]<"u"&&F5("Helmet: "+t+' should be of type "Array". Instead found type "'+P5(i[t])+'"'),!1)}).map(function(i){return i[t]}).reverse().reduce(function(i,a){var l={};a.filter(function(h){for(var m=void 0,g=Object.keys(h),v=0;v<g.length;v++){var y=g[v],x=y.toLowerCase();r.indexOf(x)!==-1&&!(m===Je.REL&&h[m].toLowerCase()==="canonical")&&!(x===Je.REL&&h[x].toLowerCase()==="stylesheet")&&(m=x),r.indexOf(y)!==-1&&(y===Je.INNER_HTML||y===Je.CSS_TEXT||y===Je.ITEM_PROP)&&(m=y)}if(!m||!h[m])return!1;var b=h[m].toLowerCase();return s[m]||(s[m]={}),l[m]||(l[m]={}),s[m][b]?!1:(l[m][b]=!0,!0)}).reverse().forEach(function(h){return i.push(h)});for(var c=Object.keys(l),u=0;u<c.length;u++){var f=c[u],d=N5({},s[f],l[f]);s[f]=d}return i},[]).reverse()},$o=function(t,r){for(var n=t.length-1;n>=0;n--){var s=t[n];if(s.hasOwnProperty(r))return s[r]}return null},$5=function(t){return{baseTag:D5([Je.HREF,Je.TARGET],t),bodyAttributes:Lp(yi.BODY,t),defer:$o(t,Jl.DEFER),encode:$o(t,Jl.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Lp(yi.HTML,t),linkTags:qa(Ne.LINK,[Je.REL,Je.HREF],t),metaTags:qa(Ne.META,[Je.NAME,Je.CHARSET,Je.HTTPEQUIV,Je.PROPERTY,Je.ITEM_PROP],t),noscriptTags:qa(Ne.NOSCRIPT,[Je.INNER_HTML],t),onChangeClientState:O5(t),scriptTags:qa(Ne.SCRIPT,[Je.SRC,Je.INNER_HTML],t),styleTags:qa(Ne.STYLE,[Je.CSS_TEXT],t),title:I5(t),titleAttributes:Lp(yi.TITLE,t)}},Gg=function(){var e=Date.now();return function(t){var r=Date.now();r-e>16?(e=r,t(r)):setTimeout(function(){Gg(t)},0)}}(),ej=function(t){return clearTimeout(t)},M5=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||Gg:global.requestAnimationFrame||Gg,L5=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||ej:global.cancelAnimationFrame||ej,F5=function(t){return console&&typeof console.warn=="function"&&console.warn(t)},Wa=null,B5=function(t){Wa&&L5(Wa),t.defer?Wa=M5(function(){tj(t,function(){Wa=null})}):(tj(t),Wa=null)},tj=function(t,r){var n=t.baseTag,s=t.bodyAttributes,i=t.htmlAttributes,a=t.linkTags,l=t.metaTags,c=t.noscriptTags,u=t.onChangeClientState,f=t.scriptTags,d=t.styleTags,h=t.title,m=t.titleAttributes;Kg(Ne.BODY,s),Kg(Ne.HTML,i),z5(h,m);var g={baseTag:Ji(Ne.BASE,n),linkTags:Ji(Ne.LINK,a),metaTags:Ji(Ne.META,l),noscriptTags:Ji(Ne.NOSCRIPT,c),scriptTags:Ji(Ne.SCRIPT,f),styleTags:Ji(Ne.STYLE,d)},v={},y={};Object.keys(g).forEach(function(x){var b=g[x],w=b.newTags,j=b.oldTags;w.length&&(v[x]=w),j.length&&(y[x]=g[x].oldTags)}),r&&r(),u(t,v,y)},kC=function(t){return Array.isArray(t)?t.join(""):t},z5=function(t,r){typeof t<"u"&&document.title!==t&&(document.title=kC(t)),Kg(Ne.TITLE,r)},Kg=function(t,r){var n=document.getElementsByTagName(t)[0];if(n){for(var s=n.getAttribute(Jr),i=s?s.split(","):[],a=[].concat(i),l=Object.keys(r),c=0;c<l.length;c++){var u=l[c],f=r[u]||"";n.getAttribute(u)!==f&&n.setAttribute(u,f),i.indexOf(u)===-1&&i.push(u);var d=a.indexOf(u);d!==-1&&a.splice(d,1)}for(var h=a.length-1;h>=0;h--)n.removeAttribute(a[h]);i.length===a.length?n.removeAttribute(Jr):n.getAttribute(Jr)!==l.join(",")&&n.setAttribute(Jr,l.join(","))}},Ji=function(t,r){var n=document.head||document.querySelector(Ne.HEAD),s=n.querySelectorAll(t+"["+Jr+"]"),i=Array.prototype.slice.call(s),a=[],l=void 0;return r&&r.length&&r.forEach(function(c){var u=document.createElement(t);for(var f in c)if(c.hasOwnProperty(f))if(f===Je.INNER_HTML)u.innerHTML=c.innerHTML;else if(f===Je.CSS_TEXT)u.styleSheet?u.styleSheet.cssText=c.cssText:u.appendChild(document.createTextNode(c.cssText));else{var d=typeof c[f]>"u"?"":c[f];u.setAttribute(f,d)}u.setAttribute(Jr,"true"),i.some(function(h,m){return l=m,u.isEqualNode(h)})?i.splice(l,1):a.push(u)}),i.forEach(function(c){return c.parentNode.removeChild(c)}),a.forEach(function(c){return n.appendChild(c)}),{oldTags:i,newTags:a}},AC=function(t){return Object.keys(t).reduce(function(r,n){var s=typeof t[n]<"u"?n+'="'+t[n]+'"':""+n;return r?r+" "+s:s},"")},U5=function(t,r,n,s){var i=AC(n),a=kC(r);return i?"<"+t+" "+Jr+'="true" '+i+">"+Hg(a,s)+"</"+t+">":"<"+t+" "+Jr+'="true">'+Hg(a,s)+"</"+t+">"},V5=function(t,r,n){return r.reduce(function(s,i){var a=Object.keys(i).filter(function(u){return!(u===Je.INNER_HTML||u===Je.CSS_TEXT)}).reduce(function(u,f){var d=typeof i[f]>"u"?f:f+'="'+Hg(i[f],n)+'"';return u?u+" "+d:d},""),l=i.innerHTML||i.cssText||"",c=C5.indexOf(t)===-1;return s+"<"+t+" "+Jr+'="true" '+a+(c?"/>":">"+l+"</"+t+">")},"")},RC=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,s){return n[Vd[s]||s]=t[s],n},r)},q5=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,s){return n[E5[s]||s]=t[s],n},r)},W5=function(t,r,n){var s,i=(s={key:r},s[Jr]=!0,s),a=RC(n,i);return[J.createElement(Ne.TITLE,a,r)]},H5=function(t,r){return r.map(function(n,s){var i,a=(i={key:s},i[Jr]=!0,i);return Object.keys(n).forEach(function(l){var c=Vd[l]||l;if(c===Je.INNER_HTML||c===Je.CSS_TEXT){var u=n.innerHTML||n.cssText;a.dangerouslySetInnerHTML={__html:u}}else a[c]=n[l]}),J.createElement(t,a)})},En=function(t,r,n){switch(t){case Ne.TITLE:return{toComponent:function(){return W5(t,r.title,r.titleAttributes)},toString:function(){return U5(t,r.title,r.titleAttributes,n)}};case yi.BODY:case yi.HTML:return{toComponent:function(){return RC(r)},toString:function(){return AC(r)}};default:return{toComponent:function(){return H5(t,r)},toString:function(){return V5(t,r,n)}}}},IC=function(t){var r=t.baseTag,n=t.bodyAttributes,s=t.encode,i=t.htmlAttributes,a=t.linkTags,l=t.metaTags,c=t.noscriptTags,u=t.scriptTags,f=t.styleTags,d=t.title,h=d===void 0?"":d,m=t.titleAttributes;return{base:En(Ne.BASE,r,s),bodyAttributes:En(yi.BODY,n,s),htmlAttributes:En(yi.HTML,i,s),link:En(Ne.LINK,a,s),meta:En(Ne.META,l,s),noscript:En(Ne.NOSCRIPT,c,s),script:En(Ne.SCRIPT,u,s),style:En(Ne.STYLE,f,s),title:En(Ne.TITLE,{title:h,titleAttributes:m},s)}},G5=function(t){var r,n;return n=r=function(s){A5(i,s);function i(){return T5(this,i),R5(this,s.apply(this,arguments))}return i.prototype.shouldComponentUpdate=function(l){return!y5(this.props,l)},i.prototype.mapNestedChildrenToProps=function(l,c){if(!c)return null;switch(l.type){case Ne.SCRIPT:case Ne.NOSCRIPT:return{innerHTML:c};case Ne.STYLE:return{cssText:c}}throw new Error("<"+l.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},i.prototype.flattenArrayTypeChildren=function(l){var c,u=l.child,f=l.arrayTypeChildren,d=l.newChildProps,h=l.nestedChildren;return Kt({},f,(c={},c[u.type]=[].concat(f[u.type]||[],[Kt({},d,this.mapNestedChildrenToProps(u,h))]),c))},i.prototype.mapObjectTypeChildren=function(l){var c,u,f=l.child,d=l.newProps,h=l.newChildProps,m=l.nestedChildren;switch(f.type){case Ne.TITLE:return Kt({},d,(c={},c[f.type]=m,c.titleAttributes=Kt({},h),c));case Ne.BODY:return Kt({},d,{bodyAttributes:Kt({},h)});case Ne.HTML:return Kt({},d,{htmlAttributes:Kt({},h)})}return Kt({},d,(u={},u[f.type]=Kt({},h),u))},i.prototype.mapArrayTypeChildrenToProps=function(l,c){var u=Kt({},c);return Object.keys(l).forEach(function(f){var d;u=Kt({},u,(d={},d[f]=l[f],d))}),u},i.prototype.warnOnInvalidChildren=function(l,c){return!0},i.prototype.mapChildrenToProps=function(l,c){var u=this,f={};return J.Children.forEach(l,function(d){if(!(!d||!d.props)){var h=d.props,m=h.children,g=Zw(h,["children"]),v=q5(g);switch(u.warnOnInvalidChildren(d,m),d.type){case Ne.LINK:case Ne.META:case Ne.NOSCRIPT:case Ne.SCRIPT:case Ne.STYLE:f=u.flattenArrayTypeChildren({child:d,arrayTypeChildren:f,newChildProps:v,nestedChildren:m});break;default:c=u.mapObjectTypeChildren({child:d,newProps:c,newChildProps:v,nestedChildren:m});break}}}),c=this.mapArrayTypeChildrenToProps(f,c),c},i.prototype.render=function(){var l=this.props,c=l.children,u=Zw(l,["children"]),f=Kt({},u);return c&&(f=this.mapChildrenToProps(c,f)),J.createElement(t,f)},k5(i,null,[{key:"canUseDOM",set:function(l){t.canUseDOM=l}}]),i}(J.Component),r.propTypes={base:Ye.object,bodyAttributes:Ye.object,children:Ye.oneOfType([Ye.arrayOf(Ye.node),Ye.node]),defaultTitle:Ye.string,defer:Ye.bool,encodeSpecialCharacters:Ye.bool,htmlAttributes:Ye.object,link:Ye.arrayOf(Ye.object),meta:Ye.arrayOf(Ye.object),noscript:Ye.arrayOf(Ye.object),onChangeClientState:Ye.func,script:Ye.arrayOf(Ye.object),style:Ye.arrayOf(Ye.object),title:Ye.string,titleAttributes:Ye.object,titleTemplate:Ye.string},r.defaultProps={defer:!0,encodeSpecialCharacters:!0},r.peek=t.peek,r.rewind=function(){var s=t.rewind();return s||(s=IC({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),s},n},K5=function(){return null},Y5=h5($5,B5,IC)(K5),qd=G5(Y5);qd.renderStatic=qd.rewind;function OC(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=OC(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function DC(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=OC(e))&&(n&&(n+=" "),n+=t);return n}function J5(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=$C(t))&&(n&&(n+=" "),n+=r);return n}function $C(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=$C(e[n]))&&(r&&(r+=" "),r+=t);return r}var s0="-";function X5(e){var t=Z5(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,s=n===void 0?{}:n;function i(l){var c=l.split(s0);return c[0]===""&&c.length!==1&&c.shift(),MC(c,t)||Q5(l)}function a(l,c){var u=r[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:i,getConflictingClassGroupIds:a}}function MC(e,t){var a;if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),s=n?MC(e.slice(1),n):void 0;if(s)return s;if(t.validators.length!==0){var i=e.join(s0);return(a=t.validators.find(function(l){var c=l.validator;return c(i)}))==null?void 0:a.classGroupId}}var rj=/^\[(.+)\]$/;function Q5(e){if(rj.test(e)){var t=rj.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function Z5(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},s=t6(Object.entries(e.classGroups),r);return s.forEach(function(i){var a=i[0],l=i[1];Yg(l,n,a,t)}),n}function Yg(e,t,r,n){e.forEach(function(s){if(typeof s=="string"){var i=s===""?t:nj(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(e6(s)){Yg(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(function(a){var l=a[0],c=a[1];Yg(c,nj(t,l),r,n)})})}function nj(e,t){var r=e;return t.split(s0).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function e6(e){return e.isThemeGetter}function t6(e,t){return t?e.map(function(r){var n=r[0],s=r[1],i=s.map(function(a){return typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(function(l){var c=l[0],u=l[1];return[t+c,u]})):a});return[n,i]}):e}function r6(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function s(i,a){r.set(i,a),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(a){var l=r.get(a);if(l!==void 0)return l;if((l=n.get(a))!==void 0)return s(a,l),l},set:function(a,l){r.has(a)?r.set(a,l):s(a,l)}}}var LC="!";function n6(e){var t=e.separator||":",r=t.length===1,n=t[0],s=t.length;return function(a){for(var l=[],c=0,u=0,f,d=0;d<a.length;d++){var h=a[d];if(c===0){if(h===n&&(r||a.slice(d,d+s)===t)){l.push(a.slice(u,d)),u=d+s;continue}if(h==="/"){f=d;continue}}h==="["?c++:h==="]"&&c--}var m=l.length===0?a:a.substring(u),g=m.startsWith(LC),v=g?m.substring(1):m,y=f&&f>u?f-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:v,maybePostfixModifierPosition:y}}}function s6(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var s=n[0]==="[";s?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function i6(e){return{cache:r6(e.cacheSize),splitModifiers:n6(e),...X5(e)}}var o6=/\s+/;function a6(e,t){var r=t.splitModifiers,n=t.getClassGroupId,s=t.getConflictingClassGroupIds,i=new Set;return e.trim().split(o6).map(function(a){var l=r(a),c=l.modifiers,u=l.hasImportantModifier,f=l.baseClassName,d=l.maybePostfixModifierPosition,h=n(d?f.substring(0,d):f),m=!!d;if(!h){if(!d)return{isTailwindClass:!1,originalClassName:a};if(h=n(f),!h)return{isTailwindClass:!1,originalClassName:a};m=!1}var g=s6(c).join(":"),v=u?g+LC:g;return{isTailwindClass:!0,modifierId:v,classGroupId:h,originalClassName:a,hasPostfixModifier:m}}).reverse().filter(function(a){if(!a.isTailwindClass)return!0;var l=a.modifierId,c=a.classGroupId,u=a.hasPostfixModifier,f=l+c;return i.has(f)?!1:(i.add(f),s(c,u).forEach(function(d){return i.add(l+d)}),!0)}).reverse().map(function(a){return a.originalClassName}).join(" ")}function l6(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,s,i,a=l;function l(u){var f=t[0],d=t.slice(1),h=d.reduce(function(m,g){return g(m)},f());return n=i6(h),s=n.cache.get,i=n.cache.set,a=c,c(u)}function c(u){var f=s(u);if(f)return f;var d=a6(u,n);return i(u,d),d}return function(){return a(J5.apply(null,arguments))}}function He(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var FC=/^\[(?:([a-z-]+):)?(.+)\]$/i,c6=/^\d+\/\d+$/,u6=new Set(["px","full","screen"]),d6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,f6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,h6=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Vr(e){return fi(e)||u6.has(e)||c6.test(e)||Jg(e)}function Jg(e){return Fi(e,"length",y6)}function p6(e){return Fi(e,"size",BC)}function m6(e){return Fi(e,"position",BC)}function g6(e){return Fi(e,"url",b6)}function xu(e){return Fi(e,"number",fi)}function fi(e){return!Number.isNaN(Number(e))}function v6(e){return e.endsWith("%")&&fi(e.slice(0,-1))}function Ha(e){return sj(e)||Fi(e,"number",sj)}function Ce(e){return FC.test(e)}function Ga(){return!0}function ss(e){return d6.test(e)}function x6(e){return Fi(e,"",w6)}function Fi(e,t,r){var n=FC.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function y6(e){return f6.test(e)}function BC(){return!1}function b6(e){return e.startsWith("url(")}function sj(e){return Number.isInteger(Number(e))}function w6(e){return h6.test(e)}function j6(){var e=He("colors"),t=He("spacing"),r=He("blur"),n=He("brightness"),s=He("borderColor"),i=He("borderRadius"),a=He("borderSpacing"),l=He("borderWidth"),c=He("contrast"),u=He("grayscale"),f=He("hueRotate"),d=He("invert"),h=He("gap"),m=He("gradientColorStops"),g=He("gradientColorStopPositions"),v=He("inset"),y=He("margin"),x=He("opacity"),b=He("padding"),w=He("saturate"),j=He("scale"),_=He("sepia"),S=He("skew"),N=He("space"),E=He("translate"),C=function(){return["auto","contain","none"]},k=function(){return["auto","hidden","clip","visible","scroll"]},L=function(){return["auto",Ce,t]},A=function(){return[Ce,t]},R=function(){return["",Vr]},O=function(){return["auto",fi,Ce]},z=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},F=function(){return["solid","dashed","dotted","double","none"]},V=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},I=function(){return["start","end","center","between","around","evenly","stretch"]},D=function(){return["","0",Ce]},$=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},M=function(){return[fi,xu]},W=function(){return[fi,Ce]};return{cacheSize:500,theme:{colors:[Ga],spacing:[Vr],blur:["none","",ss,Ce],brightness:M(),borderColor:[e],borderRadius:["none","","full",ss,Ce],borderSpacing:A(),borderWidth:R(),contrast:M(),grayscale:D(),hueRotate:W(),invert:D(),gap:A(),gradientColorStops:[e],gradientColorStopPositions:[v6,Jg],inset:L(),margin:L(),opacity:M(),padding:A(),saturate:M(),scale:M(),sepia:D(),skew:W(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",Ce]}],container:["container"],columns:[{columns:[ss]}],"break-after":[{"break-after":$()}],"break-before":[{"break-before":$()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(z(),[Ce])}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ha]}],basis:[{basis:L()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ce]}],grow:[{grow:D()}],shrink:[{shrink:D()}],order:[{order:["first","last","none",Ha]}],"grid-cols":[{"grid-cols":[Ga]}],"col-start-end":[{col:["auto",{span:["full",Ha]},Ce]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[Ga]}],"row-start-end":[{row:["auto",{span:[Ha]},Ce]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ce]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ce]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat(I())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(I(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(I(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[N]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[N]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Ce,t]}],"min-w":[{"min-w":["min","max","fit",Ce,Vr]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[ss]},ss,Ce]}],h:[{h:[Ce,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Ce,Vr]}],"max-h":[{"max-h":[Ce,t,"min","max","fit"]}],"font-size":[{text:["base",ss,Jg]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",xu]}],"font-family":[{font:[Ga]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ce]}],"line-clamp":[{"line-clamp":["none",fi,xu]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ce,Vr]}],"list-image":[{"list-image":["none",Ce]}],"list-style-type":[{list:["none","disc","decimal",Ce]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(F(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Vr]}],"underline-offset":[{"underline-offset":["auto",Ce,Vr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ce]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ce]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(z(),[m6])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",p6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},g6]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[].concat(F(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:F()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(F())}],"outline-offset":[{"outline-offset":[Ce,Vr]}],"outline-w":[{outline:[Vr]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:R()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Vr]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",ss,x6]}],"shadow-color":[{shadow:[Ga]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":V()}],"bg-blend":[{"bg-blend":V()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",ss,Ce]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[d]}],saturate:[{saturate:[w]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ce]}],duration:[{duration:W()}],ease:[{ease:["linear","in","out","in-out",Ce]}],delay:[{delay:W()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ce]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[Ha,Ce]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ce]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ce]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ce]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Vr,xu]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var _6=l6(j6);function he(...e){return _6(DC(e))}function S6(e){return e?e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,""):""}function xe(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function ij(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function zf(...e){return t=>{let r=!1;const n=e.map(s=>{const i=ij(s,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():ij(e[s],null)}}}}function Fe(...e){return p.useCallback(zf(...e),e)}function N6(e,t){const r=p.createContext(t),n=i=>{const{children:a,...l}=i,c=p.useMemo(()=>l,Object.values(l));return o.jsx(r.Provider,{value:c,children:a})};n.displayName=e+"Provider";function s(i){const a=p.useContext(r);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[n,s]}function sn(e,t=[]){let r=[];function n(i,a){const l=p.createContext(a),c=r.length;r=[...r,a];const u=d=>{var x;const{scope:h,children:m,...g}=d,v=((x=h==null?void 0:h[e])==null?void 0:x[c])||l,y=p.useMemo(()=>g,Object.values(g));return o.jsx(v.Provider,{value:y,children:m})};u.displayName=i+"Provider";function f(d,h){var v;const m=((v=h==null?void 0:h[e])==null?void 0:v[c])||l,g=p.useContext(m);if(g)return g;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[u,f]}const s=()=>{const i=r.map(a=>p.createContext(a));return function(l){const c=(l==null?void 0:l[e])||i;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,E6(s,...t)]}function E6(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:c,scopeName:u})=>{const d=c(i)[`__scope${u}`];return{...l,...d}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}function Ci(e){const t=P6(e),r=p.forwardRef((n,s)=>{const{children:i,...a}=n,l=p.Children.toArray(i),c=l.find(k6);if(c){const u=c.props.children,f=l.map(d=>d===c?p.Children.count(u)>1?p.Children.only(null):p.isValidElement(u)?u.props.children:null:d);return o.jsx(t,{...a,ref:s,children:p.isValidElement(u)?p.cloneElement(u,void 0,f):null})}return o.jsx(t,{...a,ref:s,children:i})});return r.displayName=`${e}.Slot`,r}var C6=Ci("Slot");function P6(e){const t=p.forwardRef((r,n)=>{const{children:s,...i}=r;if(p.isValidElement(s)){const a=R6(s),l=A6(i,s.props);return s.type!==p.Fragment&&(l.ref=n?zf(n,a):a),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var zC=Symbol("radix.slottable");function T6(e){const t=({children:r})=>o.jsx(o.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=zC,t}function k6(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===zC}function A6(e,t){const r={...t};for(const n in t){const s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}function R6(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function i0(e){const t=e+"CollectionProvider",[r,n]=sn(t),[s,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=v=>{const{scope:y,children:x}=v,b=J.useRef(null),w=J.useRef(new Map).current;return o.jsx(s,{scope:y,itemMap:w,collectionRef:b,children:x})};a.displayName=t;const l=e+"CollectionSlot",c=Ci(l),u=J.forwardRef((v,y)=>{const{scope:x,children:b}=v,w=i(l,x),j=Fe(y,w.collectionRef);return o.jsx(c,{ref:j,children:b})});u.displayName=l;const f=e+"CollectionItemSlot",d="data-radix-collection-item",h=Ci(f),m=J.forwardRef((v,y)=>{const{scope:x,children:b,...w}=v,j=J.useRef(null),_=Fe(y,j),S=i(f,x);return J.useEffect(()=>(S.itemMap.set(j,{ref:j,...w}),()=>void S.itemMap.delete(j))),o.jsx(h,{[d]:"",ref:_,children:b})});m.displayName=f;function g(v){const y=i(e+"CollectionConsumer",v);return J.useCallback(()=>{const b=y.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${d}]`));return Array.from(y.itemMap.values()).sort((S,N)=>w.indexOf(S.ref.current)-w.indexOf(N.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:a,Slot:u,ItemSlot:m},g,n]}var I6=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Re=I6.reduce((e,t)=>{const r=Ci(`Primitive.${t}`),n=p.forwardRef((s,i)=>{const{asChild:a,...l}=s,c=a?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function o0(e,t){e&&jr.flushSync(()=>e.dispatchEvent(t))}function xr(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function O6(e,t=globalThis==null?void 0:globalThis.document){const r=xr(e);p.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var D6="DismissableLayer",Xg="dismissableLayer.update",$6="dismissableLayer.pointerDownOutside",M6="dismissableLayer.focusOutside",oj,UC=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Cc=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:l,...c}=e,u=p.useContext(UC),[f,d]=p.useState(null),h=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=Fe(t,N=>d(N)),v=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),x=v.indexOf(y),b=f?v.indexOf(f):-1,w=u.layersWithOutsidePointerEventsDisabled.size>0,j=b>=x,_=F6(N=>{const E=N.target,C=[...u.branches].some(k=>k.contains(E));!j||C||(s==null||s(N),a==null||a(N),N.defaultPrevented||l==null||l())},h),S=B6(N=>{const E=N.target;[...u.branches].some(k=>k.contains(E))||(i==null||i(N),a==null||a(N),N.defaultPrevented||l==null||l())},h);return O6(N=>{b===u.layers.size-1&&(n==null||n(N),!N.defaultPrevented&&l&&(N.preventDefault(),l()))},h),p.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(oj=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),aj(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=oj)}},[f,h,r,u]),p.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),aj())},[f,u]),p.useEffect(()=>{const N=()=>m({});return document.addEventListener(Xg,N),()=>document.removeEventListener(Xg,N)},[]),o.jsx(Re.div,{...c,ref:g,style:{pointerEvents:w?j?"auto":"none":void 0,...e.style},onFocusCapture:xe(e.onFocusCapture,S.onFocusCapture),onBlurCapture:xe(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:xe(e.onPointerDownCapture,_.onPointerDownCapture)})});Cc.displayName=D6;var L6="DismissableLayerBranch",VC=p.forwardRef((e,t)=>{const r=p.useContext(UC),n=p.useRef(null),s=Fe(t,n);return p.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),o.jsx(Re.div,{...e,ref:s})});VC.displayName=L6;function F6(e,t=globalThis==null?void 0:globalThis.document){const r=xr(e),n=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){qC($6,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function B6(e,t=globalThis==null?void 0:globalThis.document){const r=xr(e),n=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!n.current&&qC(M6,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function aj(){const e=new CustomEvent(Xg);document.dispatchEvent(e)}function qC(e,t,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?o0(s,i):s.dispatchEvent(i)}var z6=Cc,U6=VC,Hn=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},V6="Portal",Pc=p.forwardRef((e,t)=>{var l;const{container:r,...n}=e,[s,i]=p.useState(!1);Hn(()=>i(!0),[]);const a=r||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return a?Mf.createPortal(o.jsx(Re.div,{...n,ref:t}),a):null});Pc.displayName=V6;function q6(e,t){return p.useReducer((r,n)=>t[r][n]??r,e)}var Br=e=>{const{present:t,children:r}=e,n=W6(t),s=typeof r=="function"?r({present:n.isPresent}):p.Children.only(r),i=Fe(n.ref,H6(s));return typeof r=="function"||n.isPresent?p.cloneElement(s,{ref:i}):null};Br.displayName="Presence";function W6(e){const[t,r]=p.useState(),n=p.useRef(null),s=p.useRef(e),i=p.useRef("none"),a=e?"mounted":"unmounted",[l,c]=q6(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=yu(n.current);i.current=l==="mounted"?u:"none"},[l]),Hn(()=>{const u=n.current,f=s.current;if(f!==e){const h=i.current,m=yu(u);e?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(f&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),Hn(()=>{if(t){let u;const f=t.ownerDocument.defaultView??window,d=m=>{const v=yu(n.current).includes(CSS.escape(m.animationName));if(m.target===t&&v&&(c("ANIMATION_END"),!s.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",u=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},h=m=>{m.target===t&&(i.current=yu(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{f.clearTimeout(u),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function yu(e){return(e==null?void 0:e.animationName)||"none"}function H6(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var G6=wc[" useInsertionEffect ".trim().toString()]||Hn;function Bi({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,i,a]=K6({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:s;{const f=p.useRef(e!==void 0);p.useEffect(()=>{const d=f.current;d!==l&&console.warn(`${n} is changing from ${d?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=l},[l,n])}const u=p.useCallback(f=>{var d;if(l){const h=Y6(f)?f(e):f;h!==e&&((d=a.current)==null||d.call(a,h))}else i(f)},[l,e,i,a]);return[c,u]}function K6({defaultProp:e,onChange:t}){const[r,n]=p.useState(e),s=p.useRef(r),i=p.useRef(t);return G6(()=>{i.current=t},[t]),p.useEffect(()=>{var a;s.current!==r&&((a=i.current)==null||a.call(i,r),s.current=r)},[r,s]),[r,n,i]}function Y6(e){return typeof e=="function"}var J6=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),X6="VisuallyHidden",a0=p.forwardRef((e,t)=>o.jsx(Re.span,{...e,ref:t,style:{...J6,...e.style}}));a0.displayName=X6;var l0="ToastProvider",[c0,Q6,Z6]=i0("Toast"),[WC,toe]=sn("Toast",[Z6]),[e3,Uf]=WC(l0),HC=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:a}=e,[l,c]=p.useState(null),[u,f]=p.useState(0),d=p.useRef(!1),h=p.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${l0}\`. Expected non-empty \`string\`.`),o.jsx(c0.Provider,{scope:t,children:o.jsx(e3,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>f(m=>m+1),[]),onToastRemove:p.useCallback(()=>f(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:a})})};HC.displayName=l0;var GC="ToastViewport",t3=["F8"],Qg="toast.viewportPause",Zg="toast.viewportResume",KC=p.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=t3,label:s="Notifications ({hotkey})",...i}=e,a=Uf(GC,r),l=Q6(r),c=p.useRef(null),u=p.useRef(null),f=p.useRef(null),d=p.useRef(null),h=Fe(t,d,a.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=a.toastCount>0;p.useEffect(()=>{const y=x=>{var w;n.length!==0&&n.every(j=>x[j]||x.code===j)&&((w=d.current)==null||w.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[n]),p.useEffect(()=>{const y=c.current,x=d.current;if(g&&y&&x){const b=()=>{if(!a.isClosePausedRef.current){const S=new CustomEvent(Qg);x.dispatchEvent(S),a.isClosePausedRef.current=!0}},w=()=>{if(a.isClosePausedRef.current){const S=new CustomEvent(Zg);x.dispatchEvent(S),a.isClosePausedRef.current=!1}},j=S=>{!y.contains(S.relatedTarget)&&w()},_=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",b),y.addEventListener("focusout",j),y.addEventListener("pointermove",b),y.addEventListener("pointerleave",_),window.addEventListener("blur",b),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",b),y.removeEventListener("focusout",j),y.removeEventListener("pointermove",b),y.removeEventListener("pointerleave",_),window.removeEventListener("blur",b),window.removeEventListener("focus",w)}}},[g,a.isClosePausedRef]);const v=p.useCallback(({tabbingDirection:y})=>{const b=l().map(w=>{const j=w.ref.current,_=[j,...p3(j)];return y==="forwards"?_:_.reverse()});return(y==="forwards"?b.reverse():b).flat()},[l]);return p.useEffect(()=>{const y=d.current;if(y){const x=b=>{var _,S,N;const w=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!w){const E=document.activeElement,C=b.shiftKey;if(b.target===y&&C){(_=u.current)==null||_.focus();return}const A=v({tabbingDirection:C?"backwards":"forwards"}),R=A.findIndex(O=>O===E);Fp(A.slice(R+1))?b.preventDefault():C?(S=u.current)==null||S.focus():(N=f.current)==null||N.focus()}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[l,v]),o.jsxs(U6,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&o.jsx(ev,{ref:u,onFocusFromOutsideViewport:()=>{const y=v({tabbingDirection:"forwards"});Fp(y)}}),o.jsx(c0.Slot,{scope:r,children:o.jsx(Re.ol,{tabIndex:-1,...i,ref:h})}),g&&o.jsx(ev,{ref:f,onFocusFromOutsideViewport:()=>{const y=v({tabbingDirection:"backwards"});Fp(y)}})]})});KC.displayName=GC;var YC="ToastFocusProxy",ev=p.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,i=Uf(YC,r);return o.jsx(a0,{tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:a=>{var u;const l=a.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&n()}})});ev.displayName=YC;var Tc="Toast",r3="toast.swipeStart",n3="toast.swipeMove",s3="toast.swipeCancel",i3="toast.swipeEnd",JC=p.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:i,...a}=e,[l,c]=Bi({prop:n,defaultProp:s??!0,onChange:i,caller:Tc});return o.jsx(Br,{present:r||l,children:o.jsx(l3,{open:l,...a,ref:t,onClose:()=>c(!1),onPause:xr(e.onPause),onResume:xr(e.onResume),onSwipeStart:xe(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:xe(e.onSwipeMove,u=>{const{x:f,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:xe(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:xe(e.onSwipeEnd,u=>{const{x:f,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),c(!1)})})})});JC.displayName=Tc;var[o3,a3]=WC(Tc,{onClose(){}}),l3=p.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:i,onClose:a,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:f,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:m,...g}=e,v=Uf(Tc,r),[y,x]=p.useState(null),b=Fe(t,O=>x(O)),w=p.useRef(null),j=p.useRef(null),_=s||v.duration,S=p.useRef(0),N=p.useRef(_),E=p.useRef(0),{onToastAdd:C,onToastRemove:k}=v,L=xr(()=>{var z;(y==null?void 0:y.contains(document.activeElement))&&((z=v.viewport)==null||z.focus()),a()}),A=p.useCallback(O=>{!O||O===1/0||(window.clearTimeout(E.current),S.current=new Date().getTime(),E.current=window.setTimeout(L,O))},[L]);p.useEffect(()=>{const O=v.viewport;if(O){const z=()=>{A(N.current),u==null||u()},F=()=>{const V=new Date().getTime()-S.current;N.current=N.current-V,window.clearTimeout(E.current),c==null||c()};return O.addEventListener(Qg,F),O.addEventListener(Zg,z),()=>{O.removeEventListener(Qg,F),O.removeEventListener(Zg,z)}}},[v.viewport,_,c,u,A]),p.useEffect(()=>{i&&!v.isClosePausedRef.current&&A(_)},[i,_,v.isClosePausedRef,A]),p.useEffect(()=>(C(),()=>k()),[C,k]);const R=p.useMemo(()=>y?nP(y):null,[y]);return v.viewport?o.jsxs(o.Fragment,{children:[R&&o.jsx(c3,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:R}),o.jsx(o3,{scope:r,onClose:L,children:jr.createPortal(o.jsx(c0.ItemSlot,{scope:r,children:o.jsx(z6,{asChild:!0,onEscapeKeyDown:xe(l,()=>{v.isFocusedToastEscapeKeyDownRef.current||L(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:o.jsx(Re.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection,...g,ref:b,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:xe(e.onKeyDown,O=>{O.key==="Escape"&&(l==null||l(O.nativeEvent),O.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,L()))}),onPointerDown:xe(e.onPointerDown,O=>{O.button===0&&(w.current={x:O.clientX,y:O.clientY})}),onPointerMove:xe(e.onPointerMove,O=>{if(!w.current)return;const z=O.clientX-w.current.x,F=O.clientY-w.current.y,V=!!j.current,I=["left","right"].includes(v.swipeDirection),D=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,$=I?D(0,z):0,M=I?0:D(0,F),W=O.pointerType==="touch"?10:2,U={x:$,y:M},X={originalEvent:O,delta:U};V?(j.current=U,bu(n3,d,X,{discrete:!1})):lj(U,v.swipeDirection,W)?(j.current=U,bu(r3,f,X,{discrete:!1}),O.target.setPointerCapture(O.pointerId)):(Math.abs(z)>W||Math.abs(F)>W)&&(w.current=null)}),onPointerUp:xe(e.onPointerUp,O=>{const z=j.current,F=O.target;if(F.hasPointerCapture(O.pointerId)&&F.releasePointerCapture(O.pointerId),j.current=null,w.current=null,z){const V=O.currentTarget,I={originalEvent:O,delta:z};lj(z,v.swipeDirection,v.swipeThreshold)?bu(i3,m,I,{discrete:!0}):bu(s3,h,I,{discrete:!0}),V.addEventListener("click",D=>D.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),c3=e=>{const{__scopeToast:t,children:r,...n}=e,s=Uf(Tc,t),[i,a]=p.useState(!1),[l,c]=p.useState(!1);return f3(()=>a(!0)),p.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:o.jsx(Pc,{asChild:!0,children:o.jsx(a0,{...n,children:i&&o.jsxs(o.Fragment,{children:[s.label," ",r]})})})},u3="ToastTitle",XC=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return o.jsx(Re.div,{...n,ref:t})});XC.displayName=u3;var d3="ToastDescription",QC=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return o.jsx(Re.div,{...n,ref:t})});QC.displayName=d3;var ZC="ToastAction",eP=p.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?o.jsx(rP,{altText:r,asChild:!0,children:o.jsx(u0,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${ZC}\`. Expected non-empty \`string\`.`),null)});eP.displayName=ZC;var tP="ToastClose",u0=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=a3(tP,r);return o.jsx(rP,{asChild:!0,children:o.jsx(Re.button,{type:"button",...n,ref:t,onClick:xe(e.onClick,s.onClose)})})});u0.displayName=tP;var rP=p.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return o.jsx(Re.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function nP(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),h3(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const a=n.dataset.radixToastAnnounceAlt;a&&t.push(a)}else t.push(...nP(n))}}),t}function bu(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?o0(s,i):s.dispatchEvent(i)}var lj=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),i=n>s;return t==="left"||t==="right"?i&&n>r:!i&&s>r};function f3(e=()=>{}){const t=xr(e);Hn(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function h3(e){return e.nodeType===e.ELEMENT_NODE}function p3(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Fp(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var m3=HC,sP=KC,iP=JC,oP=XC,aP=QC,lP=eP,cP=u0;const cj=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,uj=DC,Vf=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return uj(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(u=>{const f=r==null?void 0:r[u],d=i==null?void 0:i[u];if(f===null)return null;const h=cj(f)||cj(d);return s[u][h]}),l=r&&Object.entries(r).reduce((u,f)=>{let[d,h]=f;return h===void 0||(u[d]=h),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,f)=>{let{class:d,className:h,...m}=f;return Object.entries(m).every(g=>{let[v,y]=g;return Array.isArray(y)?y.includes({...i,...l}[v]):{...i,...l}[v]===y})?[...u,d,h]:u},[]);return uj(e,a,c,r==null?void 0:r.class,r==null?void 0:r.className)};var g3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const v3=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ie=(e,t)=>{const r=p.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,children:l,...c},u)=>p.createElement("svg",{ref:u,...g3,width:s,height:s,stroke:n,strokeWidth:a?Number(i)*24/Number(s):i,className:`lucide lucide-${v3(e)}`,...c},[...t.map(([f,d])=>p.createElement(f,d)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r},d0=ie("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),qf=ie("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),f0=ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),dj=ie("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Wd=ie("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Xl=ie("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),tv=ie("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),rv=ie("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),x3=ie("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),h0=ie("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),y3=ie("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),Wf=ie("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Hf=ie("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Mn=ie("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Ds=ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Gn=ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),b3=ie("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),w3=ie("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),j3=ie("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),fj=ie("ClipboardSignature",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-.5",key:"1but9f"}],["path",{d:"M16 4h2a2 2 0 0 1 1.73 1",key:"1p8n7l"}],["path",{d:"M18.42 9.61a2.1 2.1 0 1 1 2.97 2.97L16.95 17 13 18l.99-3.95 4.43-4.44Z",key:"johvi5"}],["path",{d:"M8 18h1",key:"13wk12"}]]),Hd=ie("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),hj=ie("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),_3=ie("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),S3=ie("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),N3=ie("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),E3=ie("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),C3=ie("DraftingCompass",[["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}],["path",{d:"m3 21 8.02-14.26",key:"1ssaw4"}],["path",{d:"m12.99 6.74 1.93 3.44",key:"iwagvd"}],["path",{d:"M19 12c-3.87 4-10.13 4-14 0",key:"1tsu18"}],["path",{d:"m21 21-2.16-3.84",key:"vylbct"}]]),P3=ie("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),nv=ie("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]),Ql=ie("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Zl=ie("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),T3=ie("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),pj=ie("FileSearch",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v3",key:"am10z3"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M5 17a3 3 0 1 0 0-6 3 3 0 0 0 0 6z",key:"ychnub"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}]]),Ln=ie("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),mj=ie("FileUp",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]),sv=ie("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]),k3=ie("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),A3=ie("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),R3=ie("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]]),uP=ie("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),ad=ie("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),gj=ie("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]),p0=ie("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),De=ie("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Gf=ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),I3=ie("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),tn=ie("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),m0=ie("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),dP=ie("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),g0=ie("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Mo=ie("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),O3=ie("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),kc=ie("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),hr=ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Kf=ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),D3=ie("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),$3=ie("Scaling",[["path",{d:"M21 3 9 15",key:"15kdhq"}],["path",{d:"M12 3H3v18h18v-9",key:"8suug0"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}]]),Zo=ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),fP=ie("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),hP=ie("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),iv=ie("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),pP=ie("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),M3=ie("Shovel",[["path",{d:"M2 22v-5l5-5 5 5-5 5z",key:"1fh25c"}],["path",{d:"M9.5 14.5 16 8",key:"1smz5x"}],["path",{d:"m17 2 5 5-.5.5a3.53 3.53 0 0 1-5 0s0 0 0 0a3.53 3.53 0 0 1 0-5L17 2",key:"1q8uv5"}]]),ov=ie("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Fn=ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),L3=ie("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),mP=ie("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),F3=ie("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),jl=ie("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),B3=ie("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Ac=ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Pi=ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),z3=ie("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),U3=ie("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),v0=ie("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),es=ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),gP=ie("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),V3=m3,vP=J.forwardRef(({className:e,...t},r)=>o.jsx(sP,{ref:r,className:he("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));vP.displayName=sP.displayName;const q3=Vf("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),xP=J.forwardRef(({className:e,variant:t,...r},n)=>o.jsx(iP,{ref:n,className:he(q3({variant:t}),e),...r}));xP.displayName=iP.displayName;const W3=J.forwardRef(({className:e,...t},r)=>o.jsx(lP,{ref:r,className:he("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));W3.displayName=lP.displayName;const yP=J.forwardRef(({className:e,...t},r)=>o.jsx(cP,{ref:r,className:he("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:o.jsx(es,{className:"h-4 w-4"})}));yP.displayName=cP.displayName;const bP=J.forwardRef(({className:e,...t},r)=>o.jsx(oP,{ref:r,className:he("text-sm font-semibold",e),...t}));bP.displayName=oP.displayName;const wP=J.forwardRef(({className:e,...t},r)=>o.jsx(aP,{ref:r,className:he("text-sm opacity-90",e),...t}));wP.displayName=aP.displayName;const H3=1;let Bp=0;function G3(){return Bp=(Bp+1)%Number.MAX_VALUE,Bp.toString()}const Mt={state:{toasts:[]},listeners:[],getState:()=>Mt.state,setState:e=>{typeof e=="function"?Mt.state=e(Mt.state):Mt.state={...Mt.state,...e},Mt.listeners.forEach(t=>t(Mt.state))},subscribe:e=>(Mt.listeners.push(e),()=>{Mt.listeners=Mt.listeners.filter(t=>t!==e)})},B=({...e})=>{const t=G3(),r=s=>Mt.setState(i=>({...i,toasts:i.toasts.map(a=>a.id===t?{...a,...s}:a)})),n=()=>Mt.setState(s=>({...s,toasts:s.toasts.filter(i=>i.id!==t)}));return Mt.setState(s=>({...s,toasts:[{...e,id:t,dismiss:n},...s.toasts].slice(0,H3)})),{id:t,dismiss:n,update:r}};function jP(){const[e,t]=p.useState(Mt.getState());return p.useEffect(()=>Mt.subscribe(n=>{t(n)}),[]),p.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const s=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(s)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:B,toasts:e.toasts}}function K3(){const{toasts:e}=jP();return o.jsxs(V3,{children:[e.map(({id:t,title:r,description:n,action:s,...i})=>o.jsxs(xP,{...i,children:[o.jsxs("div",{className:"grid gap-1",children:[r&&o.jsx(bP,{children:r}),n&&o.jsx(wP,{children:n})]}),s,o.jsx(yP,{})]},t)),o.jsx(vP,{})]})}const _P=p.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Yf=p.createContext({}),Jf=p.createContext(null),Xf=typeof document<"u",x0=Xf?p.useLayoutEffect:p.useEffect,SP=p.createContext({strict:!1}),y0=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Y3="framerAppearId",NP="data-"+y0(Y3);function J3(e,t,r,n){const{visualElement:s}=p.useContext(Yf),i=p.useContext(SP),a=p.useContext(Jf),l=p.useContext(_P).reducedMotion,c=p.useRef();n=n||i.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:s,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;p.useInsertionEffect(()=>{u&&u.update(r,a)});const f=p.useRef(!!(r[NP]&&!window.HandoffComplete));return x0(()=>{u&&(u.render(),f.current&&u.animationState&&u.animationState.animateChanges())}),p.useEffect(()=>{u&&(u.updateFeatures(),!f.current&&u.animationState&&u.animationState.animateChanges(),f.current&&(f.current=!1,window.HandoffComplete=!0))}),u}function No(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function X3(e,t,r){return p.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):No(r)&&(r.current=n))},[t])}function ec(e){return typeof e=="string"||Array.isArray(e)}function Qf(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const b0=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],w0=["initial",...b0];function Zf(e){return Qf(e.animate)||w0.some(t=>ec(e[t]))}function EP(e){return!!(Zf(e)||e.variants)}function Q3(e,t){if(Zf(e)){const{initial:r,animate:n}=e;return{initial:r===!1||ec(r)?r:void 0,animate:ec(n)?n:void 0}}return e.inherit!==!1?t:{}}function Z3(e){const{initial:t,animate:r}=Q3(e,p.useContext(Yf));return p.useMemo(()=>({initial:t,animate:r}),[vj(t),vj(r)])}function vj(e){return Array.isArray(e)?e.join(" "):e}const xj={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},tc={};for(const e in xj)tc[e]={isEnabled:t=>xj[e].some(r=>!!t[r])};function eF(e){for(const t in e)tc[t]={...tc[t],...e[t]}}const j0=p.createContext({}),CP=p.createContext({}),tF=Symbol.for("motionComponentSymbol");function rF({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:s}){e&&eF(e);function i(l,c){let u;const f={...p.useContext(_P),...l,layoutId:nF(l)},{isStatic:d}=f,h=Z3(l),m=n(l,d);if(!d&&Xf){h.visualElement=J3(s,m,f,t);const g=p.useContext(CP),v=p.useContext(SP).strict;h.visualElement&&(u=h.visualElement.loadFeatures(f,v,e,g))}return p.createElement(Yf.Provider,{value:h},u&&h.visualElement?p.createElement(u,{visualElement:h.visualElement,...f}):null,r(s,l,X3(m,h.visualElement,c),m,d,h.visualElement))}const a=p.forwardRef(i);return a[tF]=s,a}function nF({layoutId:e}){const t=p.useContext(j0).id;return t&&e!==void 0?t+"-"+e:e}function sF(e){function t(n,s={}){return rF(e(n,s))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,s)=>(r.has(s)||r.set(s,t(s)),r.get(s))})}const iF=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function _0(e){return typeof e!="string"||e.includes("-")?!1:!!(iF.indexOf(e)>-1||/[A-Z]/.test(e))}const Gd={};function oF(e){Object.assign(Gd,e)}const Rc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],zi=new Set(Rc);function PP(e,{layout:t,layoutId:r}){return zi.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Gd[e]||e==="opacity")}const nr=e=>!!(e&&e.getVelocity),aF={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lF=Rc.length;function cF(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,s){let i="";for(let a=0;a<lF;a++){const l=Rc[a];if(e[l]!==void 0){const c=aF[l]||l;i+=`${c}(${e[l]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(e,n?"":i):r&&n&&(i="none"),i}const TP=e=>t=>typeof t=="string"&&t.startsWith(e),kP=TP("--"),av=TP("var(--"),uF=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,dF=(e,t)=>t&&typeof e=="number"?t.transform(e):e,$s=(e,t,r)=>Math.min(Math.max(r,e),t),Ui={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},_l={...Ui,transform:e=>$s(0,1,e)},wu={...Ui,default:1},Sl=e=>Math.round(e*1e5)/1e5,eh=/(-)?([\d]*\.?[\d])+/g,AP=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,fF=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Ic(e){return typeof e=="string"}const Oc=e=>({test:t=>Ic(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),os=Oc("deg"),bn=Oc("%"),we=Oc("px"),hF=Oc("vh"),pF=Oc("vw"),yj={...bn,parse:e=>bn.parse(e)/100,transform:e=>bn.transform(e*100)},bj={...Ui,transform:Math.round},RP={borderWidth:we,borderTopWidth:we,borderRightWidth:we,borderBottomWidth:we,borderLeftWidth:we,borderRadius:we,radius:we,borderTopLeftRadius:we,borderTopRightRadius:we,borderBottomRightRadius:we,borderBottomLeftRadius:we,width:we,maxWidth:we,height:we,maxHeight:we,size:we,top:we,right:we,bottom:we,left:we,padding:we,paddingTop:we,paddingRight:we,paddingBottom:we,paddingLeft:we,margin:we,marginTop:we,marginRight:we,marginBottom:we,marginLeft:we,rotate:os,rotateX:os,rotateY:os,rotateZ:os,scale:wu,scaleX:wu,scaleY:wu,scaleZ:wu,skew:os,skewX:os,skewY:os,distance:we,translateX:we,translateY:we,translateZ:we,x:we,y:we,z:we,perspective:we,transformPerspective:we,opacity:_l,originX:yj,originY:yj,originZ:we,zIndex:bj,fillOpacity:_l,strokeOpacity:_l,numOctaves:bj};function S0(e,t,r,n){const{style:s,vars:i,transform:a,transformOrigin:l}=e;let c=!1,u=!1,f=!0;for(const d in t){const h=t[d];if(kP(d)){i[d]=h;continue}const m=RP[d],g=dF(h,m);if(zi.has(d)){if(c=!0,a[d]=g,!f)continue;h!==(m.default||0)&&(f=!1)}else d.startsWith("origin")?(u=!0,l[d]=g):s[d]=g}if(t.transform||(c||n?s.transform=cF(e.transform,r,f,n):s.transform&&(s.transform="none")),u){const{originX:d="50%",originY:h="50%",originZ:m=0}=l;s.transformOrigin=`${d} ${h} ${m}`}}const N0=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function IP(e,t,r){for(const n in t)!nr(t[n])&&!PP(n,r)&&(e[n]=t[n])}function mF({transformTemplate:e},t,r){return p.useMemo(()=>{const n=N0();return S0(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function gF(e,t,r){const n=e.style||{},s={};return IP(s,n,e),Object.assign(s,mF(e,t,r)),e.transformValues?e.transformValues(s):s}function vF(e,t,r){const n={},s=gF(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n}const xF=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Kd(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||xF.has(e)}let OP=e=>!Kd(e);function yF(e){e&&(OP=t=>t.startsWith("on")?!Kd(t):e(t))}try{yF(require("@emotion/is-prop-valid").default)}catch{}function bF(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(OP(s)||r===!0&&Kd(s)||!t&&!Kd(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}function wj(e,t,r){return typeof e=="string"?e:we.transform(t+r*e)}function wF(e,t,r){const n=wj(t,e.x,e.width),s=wj(r,e.y,e.height);return`${n} ${s}`}const jF={offset:"stroke-dashoffset",array:"stroke-dasharray"},_F={offset:"strokeDashoffset",array:"strokeDasharray"};function SF(e,t,r=1,n=0,s=!0){e.pathLength=1;const i=s?jF:_F;e[i.offset]=we.transform(-n);const a=we.transform(t),l=we.transform(r);e[i.array]=`${a} ${l}`}function E0(e,{attrX:t,attrY:r,attrScale:n,originX:s,originY:i,pathLength:a,pathSpacing:l=1,pathOffset:c=0,...u},f,d,h){if(S0(e,u,f,h),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:m,style:g,dimensions:v}=e;m.transform&&(v&&(g.transform=m.transform),delete m.transform),v&&(s!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=wF(v,s!==void 0?s:.5,i!==void 0?i:.5)),t!==void 0&&(m.x=t),r!==void 0&&(m.y=r),n!==void 0&&(m.scale=n),a!==void 0&&SF(m,a,l,c,!1)}const DP=()=>({...N0(),attrs:{}}),C0=e=>typeof e=="string"&&e.toLowerCase()==="svg";function NF(e,t,r,n){const s=p.useMemo(()=>{const i=DP();return E0(i,t,{enableHardwareAcceleration:!1},C0(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};IP(i,e.style,e),s.style={...i,...s.style}}return s}function EF(e=!1){return(r,n,s,{latestValues:i},a)=>{const c=(_0(r)?NF:vF)(n,i,a,r),f={...bF(n,typeof r=="string",e),...c,ref:s},{children:d}=n,h=p.useMemo(()=>nr(d)?d.get():d,[d]);return p.createElement(r,{...f,children:h})}}function $P(e,{style:t,vars:r},n,s){Object.assign(e.style,t,s&&s.getProjectionStyles(n));for(const i in r)e.style.setProperty(i,r[i])}const MP=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function LP(e,t,r,n){$P(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(MP.has(s)?s:y0(s),t.attrs[s])}function P0(e,t){const{style:r}=e,n={};for(const s in r)(nr(r[s])||t.style&&nr(t.style[s])||PP(s,e))&&(n[s]=r[s]);return n}function FP(e,t){const r=P0(e,t);for(const n in e)if(nr(e[n])||nr(t[n])){const s=Rc.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[s]=e[n]}return r}function T0(e,t,r,n={},s={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),t}function BP(e){const t=p.useRef(null);return t.current===null&&(t.current=e()),t.current}const Yd=e=>Array.isArray(e),CF=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),PF=e=>Yd(e)?e[e.length-1]||0:e;function ld(e){const t=nr(e)?e.get():e;return CF(t)?t.toValue():t}function TF({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,s,i){const a={latestValues:kF(n,s,i,e),renderState:t()};return r&&(a.mount=l=>r(n,l,a)),a}const zP=e=>(t,r)=>{const n=p.useContext(Yf),s=p.useContext(Jf),i=()=>TF(e,t,n,s);return r?i():BP(i)};function kF(e,t,r,n){const s={},i=n(e,{});for(const h in i)s[h]=ld(i[h]);let{initial:a,animate:l}=e;const c=Zf(e),u=EP(e);t&&u&&!c&&e.inherit!==!1&&(a===void 0&&(a=t.initial),l===void 0&&(l=t.animate));let f=r?r.initial===!1:!1;f=f||a===!1;const d=f?l:a;return d&&typeof d!="boolean"&&!Qf(d)&&(Array.isArray(d)?d:[d]).forEach(m=>{const g=T0(e,m);if(!g)return;const{transitionEnd:v,transition:y,...x}=g;for(const b in x){let w=x[b];if(Array.isArray(w)){const j=f?w.length-1:0;w=w[j]}w!==null&&(s[b]=w)}for(const b in v)s[b]=v[b]}),s}const it=e=>e;class jj{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function AF(e){let t=new jj,r=new jj,n=0,s=!1,i=!1;const a=new WeakSet,l={schedule:(c,u=!1,f=!1)=>{const d=f&&s,h=d?t:r;return u&&a.add(c),h.add(c)&&d&&s&&(n=t.order.length),c},cancel:c=>{r.remove(c),a.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let u=0;u<n;u++){const f=t.order[u];f(c),a.has(f)&&(l.schedule(f),e())}s=!1,i&&(i=!1,l.process(c))}};return l}const ju=["prepare","read","update","preRender","render","postRender"],RF=40;function IF(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=ju.reduce((d,h)=>(d[h]=AF(()=>r=!0),d),{}),a=d=>i[d].process(s),l=()=>{const d=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(d-s.timestamp,RF),1),s.timestamp=d,s.isProcessing=!0,ju.forEach(a),s.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,s.isProcessing||e(l)};return{schedule:ju.reduce((d,h)=>{const m=i[h];return d[h]=(g,v=!1,y=!1)=>(r||c(),m.schedule(g,v,y)),d},{}),cancel:d=>ju.forEach(h=>i[h].cancel(d)),state:s,steps:i}}const{schedule:Ue,cancel:Kn,state:At,steps:zp}=IF(typeof requestAnimationFrame<"u"?requestAnimationFrame:it,!0),OF={useVisualState:zP({scrapeMotionValuesFromProps:FP,createRenderState:DP,onMount:(e,t,{renderState:r,latestValues:n})=>{Ue.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),Ue.render(()=>{E0(r,n,{enableHardwareAcceleration:!1},C0(t.tagName),e.transformTemplate),LP(t,r)})}})},DF={useVisualState:zP({scrapeMotionValuesFromProps:P0,createRenderState:N0})};function $F(e,{forwardMotionProps:t=!1},r,n){return{..._0(e)?OF:DF,preloadedFeatures:r,useRender:EF(t),createVisualElement:n,Component:e}}function Dn(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const UP=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function th(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const MF=e=>t=>UP(t)&&e(t,th(t));function Bn(e,t,r,n){return Dn(e,t,MF(r),n)}const LF=(e,t)=>r=>t(e(r)),Ps=(...e)=>e.reduce(LF);function VP(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const _j=VP("dragHorizontal"),Sj=VP("dragVertical");function qP(e){let t=!1;if(e==="y")t=Sj();else if(e==="x")t=_j();else{const r=_j(),n=Sj();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function WP(){const e=qP(!0);return e?(e(),!1):!0}class qs{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Nj(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),s=(i,a)=>{if(i.pointerType==="touch"||WP())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&Ue.update(()=>l[n](i,a))};return Bn(e.current,r,s,{passive:!e.getProps()[n]})}class FF extends qs{mount(){this.unmount=Ps(Nj(this.node,!0),Nj(this.node,!1))}unmount(){}}class BF extends qs{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ps(Dn(this.node.current,"focus",()=>this.onFocus()),Dn(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const HP=(e,t)=>t?e===t?!0:HP(e,t.parentElement):!1;function Up(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,th(r))}class zF extends qs{constructor(){super(...arguments),this.removeStartListeners=it,this.removeEndListeners=it,this.removeAccessibleListeners=it,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Bn(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:f,globalTapTarget:d}=this.node.getProps();Ue.update(()=>{!d&&!HP(this.node.current,l.target)?f&&f(l,c):u&&u(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),a=Bn(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Ps(i,a),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const a=l=>{l.key!=="Enter"||!this.checkPressEnd()||Up("up",(c,u)=>{const{onTap:f}=this.node.getProps();f&&Ue.update(()=>f(c,u))})};this.removeEndListeners(),this.removeEndListeners=Dn(this.node.current,"keyup",a),Up("down",(l,c)=>{this.startPress(l,c)})},r=Dn(this.node.current,"keydown",t),n=()=>{this.isPressing&&Up("cancel",(i,a)=>this.cancelPress(i,a))},s=Dn(this.node.current,"blur",n);this.removeAccessibleListeners=Ps(r,s)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&Ue.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!WP()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&Ue.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Bn(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Dn(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Ps(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const lv=new WeakMap,Vp=new WeakMap,UF=e=>{const t=lv.get(e.target);t&&t(e)},VF=e=>{e.forEach(UF)};function qF({root:e,...t}){const r=e||document;Vp.has(r)||Vp.set(r,{});const n=Vp.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(VF,{root:e,...t})),n[s]}function WF(e,t,r){const n=qF(t);return lv.set(e,r),n.observe(e),()=>{lv.delete(e),n.unobserve(e)}}const HF={some:0,all:1};class GF extends qs{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:i}=t,a={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:HF[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:f,onViewportLeave:d}=this.node.getProps(),h=u?f:d;h&&h(c)};return WF(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(KF(t,r))&&this.startObserver()}unmount(){}}function KF({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const YF={inView:{Feature:GF},tap:{Feature:zF},focus:{Feature:BF},hover:{Feature:FF}};function GP(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function JF(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function XF(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function rh(e,t,r){const n=e.getProps();return T0(n,t,r!==void 0?r:n.custom,JF(e),XF(e))}let QF=it,k0=it;const Ts=e=>e*1e3,zn=e=>e/1e3,ZF={current:!1},KP=e=>Array.isArray(e)&&typeof e[0]=="number";function YP(e){return!!(!e||typeof e=="string"&&JP[e]||KP(e)||Array.isArray(e)&&e.every(YP))}const ol=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,JP={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ol([0,.65,.55,1]),circOut:ol([.55,0,1,.45]),backIn:ol([.31,.01,.66,-.59]),backOut:ol([.33,1.53,.69,.99])};function XP(e){if(e)return KP(e)?ol(e):Array.isArray(e)?e.map(XP):JP[e]}function eB(e,t,r,{delay:n=0,duration:s,repeat:i=0,repeatType:a="loop",ease:l,times:c}={}){const u={[t]:r};c&&(u.offset=c);const f=XP(l);return Array.isArray(f)&&(u.easing=f),e.animate(u,{delay:n,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"})}function tB(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const QP=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,rB=1e-7,nB=12;function sB(e,t,r,n,s){let i,a,l=0;do a=t+(r-t)/2,i=QP(a,n,s)-e,i>0?r=a:t=a;while(Math.abs(i)>rB&&++l<nB);return a}function Dc(e,t,r,n){if(e===t&&r===n)return it;const s=i=>sB(i,0,1,e,r);return i=>i===0||i===1?i:QP(s(i),t,n)}const iB=Dc(.42,0,1,1),oB=Dc(0,0,.58,1),ZP=Dc(.42,0,.58,1),aB=e=>Array.isArray(e)&&typeof e[0]!="number",e2=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,t2=e=>t=>1-e(1-t),A0=e=>1-Math.sin(Math.acos(e)),r2=t2(A0),lB=e2(A0),n2=Dc(.33,1.53,.69,.99),R0=t2(n2),cB=e2(R0),uB=e=>(e*=2)<1?.5*R0(e):.5*(2-Math.pow(2,-10*(e-1))),dB={linear:it,easeIn:iB,easeInOut:ZP,easeOut:oB,circIn:A0,circInOut:lB,circOut:r2,backIn:R0,backInOut:cB,backOut:n2,anticipate:uB},Ej=e=>{if(Array.isArray(e)){k0(e.length===4);const[t,r,n,s]=e;return Dc(t,r,n,s)}else if(typeof e=="string")return dB[e];return e},I0=(e,t)=>r=>!!(Ic(r)&&fF.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),s2=(e,t,r)=>n=>{if(!Ic(n))return n;const[s,i,a,l]=n.match(eh);return{[e]:parseFloat(s),[t]:parseFloat(i),[r]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},fB=e=>$s(0,255,e),qp={...Ui,transform:e=>Math.round(fB(e))},hi={test:I0("rgb","red"),parse:s2("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+qp.transform(e)+", "+qp.transform(t)+", "+qp.transform(r)+", "+Sl(_l.transform(n))+")"};function hB(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const cv={test:I0("#"),parse:hB,transform:hi.transform},Eo={test:I0("hsl","hue"),parse:s2("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+bn.transform(Sl(t))+", "+bn.transform(Sl(r))+", "+Sl(_l.transform(n))+")"},Lt={test:e=>hi.test(e)||cv.test(e)||Eo.test(e),parse:e=>hi.test(e)?hi.parse(e):Eo.test(e)?Eo.parse(e):cv.parse(e),transform:e=>Ic(e)?e:e.hasOwnProperty("red")?hi.transform(e):Eo.transform(e)},tt=(e,t,r)=>-r*e+r*t+e;function Wp(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function pB({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,i=0,a=0;if(!t)s=i=a=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;s=Wp(c,l,e+1/3),i=Wp(c,l,e),a=Wp(c,l,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:n}}const Hp=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},mB=[cv,hi,Eo],gB=e=>mB.find(t=>t.test(e));function Cj(e){const t=gB(e);let r=t.parse(e);return t===Eo&&(r=pB(r)),r}const i2=(e,t)=>{const r=Cj(e),n=Cj(t),s={...r};return i=>(s.red=Hp(r.red,n.red,i),s.green=Hp(r.green,n.green,i),s.blue=Hp(r.blue,n.blue,i),s.alpha=tt(r.alpha,n.alpha,i),hi.transform(s))};function vB(e){var t,r;return isNaN(e)&&Ic(e)&&(((t=e.match(eh))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(AP))===null||r===void 0?void 0:r.length)||0)>0}const o2={regex:uF,countKey:"Vars",token:"${v}",parse:it},a2={regex:AP,countKey:"Colors",token:"${c}",parse:Lt.parse},l2={regex:eh,countKey:"Numbers",token:"${n}",parse:Ui.parse};function Gp(e,{regex:t,countKey:r,token:n,parse:s}){const i=e.tokenised.match(t);i&&(e["num"+r]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(s)))}function Jd(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&Gp(r,o2),Gp(r,a2),Gp(r,l2),r}function c2(e){return Jd(e).values}function u2(e){const{values:t,numColors:r,numVars:n,tokenised:s}=Jd(e),i=t.length;return a=>{let l=s;for(let c=0;c<i;c++)c<n?l=l.replace(o2.token,a[c]):c<n+r?l=l.replace(a2.token,Lt.transform(a[c])):l=l.replace(l2.token,Sl(a[c]));return l}}const xB=e=>typeof e=="number"?0:e;function yB(e){const t=c2(e);return u2(e)(t.map(xB))}const Ms={test:vB,parse:c2,createTransformer:u2,getAnimatableNone:yB},d2=(e,t)=>r=>`${r>0?t:e}`;function f2(e,t){return typeof e=="number"?r=>tt(e,t,r):Lt.test(e)?i2(e,t):e.startsWith("var(")?d2(e,t):p2(e,t)}const h2=(e,t)=>{const r=[...e],n=r.length,s=e.map((i,a)=>f2(i,t[a]));return i=>{for(let a=0;a<n;a++)r[a]=s[a](i);return r}},bB=(e,t)=>{const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=f2(e[s],t[s]));return s=>{for(const i in n)r[i]=n[i](s);return r}},p2=(e,t)=>{const r=Ms.createTransformer(t),n=Jd(e),s=Jd(t);return n.numVars===s.numVars&&n.numColors===s.numColors&&n.numNumbers>=s.numNumbers?Ps(h2(n.values,s.values),r):d2(e,t)},rc=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},Pj=(e,t)=>r=>tt(e,t,r);function wB(e){return typeof e=="number"?Pj:typeof e=="string"?Lt.test(e)?i2:p2:Array.isArray(e)?h2:typeof e=="object"?bB:Pj}function jB(e,t,r){const n=[],s=r||wB(e[0]),i=e.length-1;for(let a=0;a<i;a++){let l=s(e[a],e[a+1]);if(t){const c=Array.isArray(t)?t[a]||it:t;l=Ps(c,l)}n.push(l)}return n}function m2(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const i=e.length;if(k0(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=jB(t,n,s),l=a.length,c=u=>{let f=0;if(l>1)for(;f<e.length-2&&!(u<e[f+1]);f++);const d=rc(e[f],e[f+1],u);return a[f](d)};return r?u=>c($s(e[0],e[i-1],u)):c}function _B(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=rc(0,t,n);e.push(tt(r,1,s))}}function SB(e){const t=[0];return _B(t,e.length-1),t}function NB(e,t){return e.map(r=>r*t)}function EB(e,t){return e.map(()=>t||ZP).splice(0,e.length-1)}function Xd({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=aB(n)?n.map(Ej):Ej(n),i={done:!1,value:t[0]},a=NB(r&&r.length===t.length?r:SB(t),e),l=m2(a,t,{ease:Array.isArray(s)?s:EB(t,s)});return{calculatedDuration:e,next:c=>(i.value=l(c),i.done=c>=e,i)}}function g2(e,t){return t?e*(1e3/t):0}const CB=5;function v2(e,t,r){const n=Math.max(t-CB,0);return g2(r-e(n),t-n)}const Kp=.001,PB=.01,Tj=10,TB=.05,kB=1;function AB({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let s,i;QF(e<=Ts(Tj));let a=1-t;a=$s(TB,kB,a),e=$s(PB,Tj,zn(e)),a<1?(s=u=>{const f=u*a,d=f*e,h=f-r,m=uv(u,a),g=Math.exp(-d);return Kp-h/m*g},i=u=>{const d=u*a*e,h=d*r+r,m=Math.pow(a,2)*Math.pow(u,2)*e,g=Math.exp(-d),v=uv(Math.pow(u,2),a);return(-s(u)+Kp>0?-1:1)*((h-m)*g)/v}):(s=u=>{const f=Math.exp(-u*e),d=(u-r)*e+1;return-Kp+f*d},i=u=>{const f=Math.exp(-u*e),d=(r-u)*(e*e);return f*d});const l=5/e,c=IB(s,i,l);if(e=Ts(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:a*2*Math.sqrt(n*u),duration:e}}}const RB=12;function IB(e,t,r){let n=r;for(let s=1;s<RB;s++)n=n-e(n)/t(n);return n}function uv(e,t){return e*Math.sqrt(1-t*t)}const OB=["duration","bounce"],DB=["stiffness","damping","mass"];function kj(e,t){return t.some(r=>e[r]!==void 0)}function $B(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!kj(e,DB)&&kj(e,OB)){const r=AB(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function x2({keyframes:e,restDelta:t,restSpeed:r,...n}){const s=e[0],i=e[e.length-1],a={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:f,velocity:d,isResolvedFromDuration:h}=$B({...n,velocity:-zn(n.velocity||0)}),m=d||0,g=c/(2*Math.sqrt(l*u)),v=i-s,y=zn(Math.sqrt(l/u)),x=Math.abs(v)<5;r||(r=x?.01:2),t||(t=x?.005:.5);let b;if(g<1){const w=uv(y,g);b=j=>{const _=Math.exp(-g*y*j);return i-_*((m+g*y*v)/w*Math.sin(w*j)+v*Math.cos(w*j))}}else if(g===1)b=w=>i-Math.exp(-y*w)*(v+(m+y*v)*w);else{const w=y*Math.sqrt(g*g-1);b=j=>{const _=Math.exp(-g*y*j),S=Math.min(w*j,300);return i-_*((m+g*y*v)*Math.sinh(S)+w*v*Math.cosh(S))/w}}return{calculatedDuration:h&&f||null,next:w=>{const j=b(w);if(h)a.done=w>=f;else{let _=m;w!==0&&(g<1?_=v2(b,w,j):_=0);const S=Math.abs(_)<=r,N=Math.abs(i-j)<=t;a.done=S&&N}return a.value=a.done?i:j,a}}}function Aj({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:l,max:c,restDelta:u=.5,restSpeed:f}){const d=e[0],h={done:!1,value:d},m=E=>l!==void 0&&E<l||c!==void 0&&E>c,g=E=>l===void 0?c:c===void 0||Math.abs(l-E)<Math.abs(c-E)?l:c;let v=r*t;const y=d+v,x=a===void 0?y:a(y);x!==y&&(v=x-d);const b=E=>-v*Math.exp(-E/n),w=E=>x+b(E),j=E=>{const C=b(E),k=w(E);h.done=Math.abs(C)<=u,h.value=h.done?x:k};let _,S;const N=E=>{m(h.value)&&(_=E,S=x2({keyframes:[h.value,g(h.value)],velocity:v2(w,E,h.value),damping:s,stiffness:i,restDelta:u,restSpeed:f}))};return N(0),{calculatedDuration:null,next:E=>{let C=!1;return!S&&_===void 0&&(C=!0,j(E),N(E)),_!==void 0&&E>_?S.next(E-_):(!C&&j(E),h)}}}const MB=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Ue.update(t,!0),stop:()=>Kn(t),now:()=>At.isProcessing?At.timestamp:performance.now()}},Rj=2e4;function Ij(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<Rj;)t+=r,n=e.next(t);return t>=Rj?1/0:t}const LB={decay:Aj,inertia:Aj,tween:Xd,keyframes:Xd,spring:x2};function Qd({autoplay:e=!0,delay:t=0,driver:r=MB,keyframes:n,type:s="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:f,onUpdate:d,...h}){let m=1,g=!1,v,y;const x=()=>{y=new Promise(M=>{v=M})};x();let b;const w=LB[s]||Xd;let j;w!==Xd&&typeof n[0]!="number"&&(j=m2([0,100],n,{clamp:!1}),n=[0,100]);const _=w({...h,keyframes:n});let S;l==="mirror"&&(S=w({...h,keyframes:[...n].reverse(),velocity:-(h.velocity||0)}));let N="idle",E=null,C=null,k=null;_.calculatedDuration===null&&i&&(_.calculatedDuration=Ij(_));const{calculatedDuration:L}=_;let A=1/0,R=1/0;L!==null&&(A=L+a,R=A*(i+1)-a);let O=0;const z=M=>{if(C===null)return;m>0&&(C=Math.min(C,M)),m<0&&(C=Math.min(M-R/m,C)),E!==null?O=E:O=Math.round(M-C)*m;const W=O-t*(m>=0?1:-1),U=m>=0?W<0:W>R;O=Math.max(W,0),N==="finished"&&E===null&&(O=R);let X=O,me=_;if(i){const H=Math.min(O,R)/A;let q=Math.floor(H),te=H%1;!te&&H>=1&&(te=1),te===1&&q--,q=Math.min(q,i+1),!!(q%2)&&(l==="reverse"?(te=1-te,a&&(te-=a/A)):l==="mirror"&&(me=S)),X=$s(0,1,te)*A}const se=U?{done:!1,value:n[0]}:me.next(X);j&&(se.value=j(se.value));let{done:Z}=se;!U&&L!==null&&(Z=m>=0?O>=R:O<=0);const oe=E===null&&(N==="finished"||N==="running"&&Z);return d&&d(se.value),oe&&I(),se},F=()=>{b&&b.stop(),b=void 0},V=()=>{N="idle",F(),v(),x(),C=k=null},I=()=>{N="finished",f&&f(),F(),v()},D=()=>{if(g)return;b||(b=r(z));const M=b.now();c&&c(),E!==null?C=M-E:(!C||N==="finished")&&(C=M),N==="finished"&&x(),k=C,E=null,N="running",b.start()};e&&D();const $={then(M,W){return y.then(M,W)},get time(){return zn(O)},set time(M){M=Ts(M),O=M,E!==null||!b||m===0?E=M:C=b.now()-M/m},get duration(){const M=_.calculatedDuration===null?Ij(_):_.calculatedDuration;return zn(M)},get speed(){return m},set speed(M){M===m||!b||(m=M,$.time=zn(O))},get state(){return N},play:D,pause:()=>{N="paused",E=O},stop:()=>{g=!0,N!=="idle"&&(N="idle",u&&u(),V())},cancel:()=>{k!==null&&z(k),V()},complete:()=>{N="finished"},sample:M=>(C=0,z(M))};return $}function FB(e){let t;return()=>(t===void 0&&(t=e()),t)}const BB=FB(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),zB=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),_u=10,UB=2e4,VB=(e,t)=>t.type==="spring"||e==="backgroundColor"||!YP(t.ease);function qB(e,t,{onUpdate:r,onComplete:n,...s}){if(!(BB()&&zB.has(t)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let a=!1,l,c,u=!1;const f=()=>{c=new Promise(w=>{l=w})};f();let{keyframes:d,duration:h=300,ease:m,times:g}=s;if(VB(t,s)){const w=Qd({...s,repeat:0,delay:0});let j={done:!1,value:d[0]};const _=[];let S=0;for(;!j.done&&S<UB;)j=w.sample(S),_.push(j.value),S+=_u;g=void 0,d=_,h=S-_u,m="linear"}const v=eB(e.owner.current,t,d,{...s,duration:h,ease:m,times:g}),y=()=>{u=!1,v.cancel()},x=()=>{u=!0,Ue.update(y),l(),f()};return v.onfinish=()=>{u||(e.set(tB(d,s)),n&&n(),x())},{then(w,j){return c.then(w,j)},attachTimeline(w){return v.timeline=w,v.onfinish=null,it},get time(){return zn(v.currentTime||0)},set time(w){v.currentTime=Ts(w)},get speed(){return v.playbackRate},set speed(w){v.playbackRate=w},get duration(){return zn(h)},play:()=>{a||(v.play(),Kn(y))},pause:()=>v.pause(),stop:()=>{if(a=!0,v.playState==="idle")return;const{currentTime:w}=v;if(w){const j=Qd({...s,autoplay:!1});e.setWithVelocity(j.sample(w-_u).value,j.sample(w).value,_u)}x()},complete:()=>{u||v.finish()},cancel:x}}function WB({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const s=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:it,pause:it,stop:it,then:i=>(i(),Promise.resolve()),cancel:it,complete:it});return t?Qd({keyframes:[0,1],duration:0,delay:t,onComplete:s}):s()}const HB={type:"spring",stiffness:500,damping:25,restSpeed:10},GB=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),KB={type:"keyframes",duration:.8},YB={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},JB=(e,{keyframes:t})=>t.length>2?KB:zi.has(e)?e.startsWith("scale")?GB(t[1]):HB:YB,dv=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Ms.test(t)||t==="0")&&!t.startsWith("url(")),XB=new Set(["brightness","contrast","saturate","opacity"]);function QB(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(eh)||[];if(!n)return e;const s=r.replace(n,"");let i=XB.has(t)?1:0;return n!==r&&(i*=100),t+"("+i+s+")"}const ZB=/([a-z-]*)\(.*?\)/g,fv={...Ms,getAnimatableNone:e=>{const t=e.match(ZB);return t?t.map(QB).join(" "):e}},e8={...RP,color:Lt,backgroundColor:Lt,outlineColor:Lt,fill:Lt,stroke:Lt,borderColor:Lt,borderTopColor:Lt,borderRightColor:Lt,borderBottomColor:Lt,borderLeftColor:Lt,filter:fv,WebkitFilter:fv},O0=e=>e8[e];function y2(e,t){let r=O0(e);return r!==fv&&(r=Ms),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const b2=e=>/^0[^.\s]+$/.test(e);function t8(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||b2(e)}function r8(e,t,r,n){const s=dv(t,r);let i;Array.isArray(r)?i=[...r]:i=[null,r];const a=n.from!==void 0?n.from:e.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?a:i[u-1]),t8(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const f=c[u];i[f]=y2(t,l)}return i}function n8({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:l,from:c,elapsed:u,...f}){return!!Object.keys(f).length}function D0(e,t){return e[t]||e.default||e}const s8={skipAnimations:!1},$0=(e,t,r,n={})=>s=>{const i=D0(n,e)||{},a=i.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Ts(a);const c=r8(t,e,r,i),u=c[0],f=c[c.length-1],d=dv(e,u),h=dv(e,f);let m={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:g=>{t.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(n8(i)||(m={...m,...JB(e,m)}),m.duration&&(m.duration=Ts(m.duration)),m.repeatDelay&&(m.repeatDelay=Ts(m.repeatDelay)),!d||!h||ZF.current||i.type===!1||s8.skipAnimations)return WB(m);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const g=qB(t,e,m);if(g)return g}return Qd(m)};function Zd(e){return!!(nr(e)&&e.add)}const w2=e=>/^\-?\d*\.?\d+$/.test(e);function M0(e,t){e.indexOf(t)===-1&&e.push(t)}function L0(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class F0{constructor(){this.subscriptions=[]}add(t){return M0(this.subscriptions,t),()=>L0(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const i8=e=>!isNaN(parseFloat(e));class o8{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,s=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:a}=At;this.lastUpdated!==a&&(this.timeDelta=i,this.lastUpdated=a,Ue.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Ue.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=i8(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new F0);const n=this.events[t].add(r);return t==="change"?()=>{n(),Ue.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?g2(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ea(e,t){return new o8(e,t)}const j2=e=>t=>t.test(e),a8={test:e=>e==="auto",parse:e=>e},_2=[Ui,we,bn,os,pF,hF,a8],Ka=e=>_2.find(j2(e)),l8=[..._2,Lt,Ms],c8=e=>l8.find(j2(e));function u8(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,ea(r))}function d8(e,t){const r=rh(e,t);let{transitionEnd:n={},transition:s={},...i}=r?e.makeTargetAnimatable(r,!1):{};i={...i,...n};for(const a in i){const l=PF(i[a]);u8(e,a,l)}}function f8(e,t,r){var n,s;const i=Object.keys(t).filter(l=>!e.hasValue(l)),a=i.length;if(a)for(let l=0;l<a;l++){const c=i[l],u=t[c];let f=null;Array.isArray(u)&&(f=u[0]),f===null&&(f=(s=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&s!==void 0?s:t[c]),f!=null&&(typeof f=="string"&&(w2(f)||b2(f))?f=parseFloat(f):!c8(f)&&Ms.test(u)&&(f=y2(c,u)),e.addValue(c,ea(f,{owner:e})),r[c]===void 0&&(r[c]=f),f!==null&&e.setBaseTarget(c,f))}}function h8(e,t){return t?(t[e]||t.default||t).from:void 0}function p8(e,t,r){const n={};for(const s in e){const i=h8(s,t);if(i!==void 0)n[s]=i;else{const a=r.getValue(s);a&&(n[s]=a.get())}}return n}function m8({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function g8(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function S2(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(i=n);const u=[],f=s&&e.animationState&&e.animationState.getState()[s];for(const d in l){const h=e.getValue(d),m=l[d];if(!h||m===void 0||f&&m8(f,d))continue;const g={delay:r,elapsed:0,...D0(i||{},d)};if(window.HandoffAppearAnimations){const x=e.getProps()[NP];if(x){const b=window.HandoffAppearAnimations(x,d,h,Ue);b!==null&&(g.elapsed=b,g.isHandoff=!0)}}let v=!g.isHandoff&&!g8(h,m);if(g.type==="spring"&&(h.getVelocity()||g.velocity)&&(v=!1),h.animation&&(v=!1),v)continue;h.start($0(d,h,m,e.shouldReduceMotion&&zi.has(d)?{type:!1}:g));const y=h.animation;Zd(c)&&(c.add(d),y.then(()=>c.remove(d))),u.push(y)}return a&&Promise.all(u).then(()=>{a&&d8(e,a)}),u}function hv(e,t,r={}){const n=rh(e,t,r.custom);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const i=n?()=>Promise.all(S2(e,n,r)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:f,staggerDirection:d}=s;return v8(e,t,u+c,f,d,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(r.delay)])}function v8(e,t,r=0,n=0,s=1,i){const a=[],l=(e.variantChildren.size-1)*n,c=s===1?(u=0)=>u*n:(u=0)=>l-u*n;return Array.from(e.variantChildren).sort(x8).forEach((u,f)=>{u.notify("AnimationStart",t),a.push(hv(u,t,{...i,delay:r+c(f)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(a)}function x8(e,t){return e.sortNodePosition(t)}function y8(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(i=>hv(e,i,r));n=Promise.all(s)}else if(typeof t=="string")n=hv(e,t,r);else{const s=typeof t=="function"?rh(e,t,r.custom):t;n=Promise.all(S2(e,s,r))}return n.then(()=>e.notify("AnimationComplete",t))}const b8=[...b0].reverse(),w8=b0.length;function j8(e){return t=>Promise.all(t.map(({animation:r,options:n})=>y8(e,r,n)))}function _8(e){let t=j8(e);const r=N8();let n=!0;const s=(c,u)=>{const f=rh(e,u);if(f){const{transition:d,transitionEnd:h,...m}=f;c={...c,...m,...h}}return c};function i(c){t=c(e)}function a(c,u){const f=e.getProps(),d=e.getVariantContext(!0)||{},h=[],m=new Set;let g={},v=1/0;for(let x=0;x<w8;x++){const b=b8[x],w=r[b],j=f[b]!==void 0?f[b]:d[b],_=ec(j),S=b===u?w.isActive:null;S===!1&&(v=x);let N=j===d[b]&&j!==f[b]&&_;if(N&&n&&e.manuallyAnimateOnMount&&(N=!1),w.protectedKeys={...g},!w.isActive&&S===null||!j&&!w.prevProp||Qf(j)||typeof j=="boolean")continue;let C=S8(w.prevProp,j)||b===u&&w.isActive&&!N&&_||x>v&&_,k=!1;const L=Array.isArray(j)?j:[j];let A=L.reduce(s,{});S===!1&&(A={});const{prevResolvedValues:R={}}=w,O={...R,...A},z=F=>{C=!0,m.has(F)&&(k=!0,m.delete(F)),w.needsAnimating[F]=!0};for(const F in O){const V=A[F],I=R[F];if(g.hasOwnProperty(F))continue;let D=!1;Yd(V)&&Yd(I)?D=!GP(V,I):D=V!==I,D?V!==void 0?z(F):m.add(F):V!==void 0&&m.has(F)?z(F):w.protectedKeys[F]=!0}w.prevProp=j,w.prevResolvedValues=A,w.isActive&&(g={...g,...A}),n&&e.blockInitialAnimation&&(C=!1),C&&(!N||k)&&h.push(...L.map(F=>({animation:F,options:{type:b,...c}})))}if(m.size){const x={};m.forEach(b=>{const w=e.getBaseTarget(b);w!==void 0&&(x[b]=w)}),h.push({animation:x})}let y=!!h.length;return n&&(f.initial===!1||f.initial===f.animate)&&!e.manuallyAnimateOnMount&&(y=!1),n=!1,y?t(h):Promise.resolve()}function l(c,u,f){var d;if(r[c].isActive===u)return Promise.resolve();(d=e.variantChildren)===null||d===void 0||d.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),r[c].isActive=u;const h=a(f,c);for(const m in r)r[m].protectedKeys={};return h}return{animateChanges:a,setActive:l,setAnimateFunction:i,getState:()=>r}}function S8(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!GP(t,e):!1}function Ks(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function N8(){return{animate:Ks(!0),whileInView:Ks(),whileHover:Ks(),whileTap:Ks(),whileDrag:Ks(),whileFocus:Ks(),exit:Ks()}}class E8 extends qs{constructor(t){super(t),t.animationState||(t.animationState=_8(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),Qf(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let C8=0;class P8 extends qs{constructor(){super(...arguments),this.id=C8++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&i.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const T8={animation:{Feature:E8},exit:{Feature:P8}},Oj=(e,t)=>Math.abs(e-t);function k8(e,t){const r=Oj(e.x,t.x),n=Oj(e.y,t.y);return Math.sqrt(r**2+n**2)}class N2{constructor(t,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=Jp(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=k8(d.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:g}=d,{timestamp:v}=At;this.history.push({...g,timestamp:v});const{onStart:y,onMove:x}=this.handlers;h||(y&&y(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=Yp(h,this.transformPagePoint),Ue.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=Jp(d.type==="pointercancel"?this.lastMoveEventInfo:Yp(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(d,y),g&&g(d,y)},!UP(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const a=th(t),l=Yp(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=At;this.history=[{...c,timestamp:u}];const{onSessionStart:f}=r;f&&f(t,Jp(l,this.history)),this.removeListeners=Ps(Bn(this.contextWindow,"pointermove",this.handlePointerMove),Bn(this.contextWindow,"pointerup",this.handlePointerUp),Bn(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Kn(this.updatePoint)}}function Yp(e,t){return t?{point:t(e.point)}:e}function Dj(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Jp({point:e},t){return{point:e,delta:Dj(e,E2(t)),offset:Dj(e,A8(t)),velocity:R8(t,.1)}}function A8(e){return e[0]}function E2(e){return e[e.length-1]}function R8(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=E2(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Ts(t)));)r--;if(!n)return{x:0,y:0};const i=zn(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function yr(e){return e.max-e.min}function pv(e,t=0,r=.01){return Math.abs(e-t)<=r}function $j(e,t,r,n=.5){e.origin=n,e.originPoint=tt(t.min,t.max,e.origin),e.scale=yr(r)/yr(t),(pv(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=tt(r.min,r.max,e.origin)-e.originPoint,(pv(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Nl(e,t,r,n){$j(e.x,t.x,r.x,n?n.originX:void 0),$j(e.y,t.y,r.y,n?n.originY:void 0)}function Mj(e,t,r){e.min=r.min+t.min,e.max=e.min+yr(t)}function I8(e,t,r){Mj(e.x,t.x,r.x),Mj(e.y,t.y,r.y)}function Lj(e,t,r){e.min=t.min-r.min,e.max=e.min+yr(t)}function El(e,t,r){Lj(e.x,t.x,r.x),Lj(e.y,t.y,r.y)}function O8(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?tt(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?tt(r,e,n.max):Math.min(e,r)),e}function Fj(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function D8(e,{top:t,left:r,bottom:n,right:s}){return{x:Fj(e.x,r,s),y:Fj(e.y,t,n)}}function Bj(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function $8(e,t){return{x:Bj(e.x,t.x),y:Bj(e.y,t.y)}}function M8(e,t){let r=.5;const n=yr(e),s=yr(t);return s>n?r=rc(t.min,t.max-n,e.min):n>s&&(r=rc(e.min,e.max-s,t.min)),$s(0,1,r)}function L8(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const mv=.35;function F8(e=mv){return e===!1?e=0:e===!0&&(e=mv),{x:zj(e,"left","right"),y:zj(e,"top","bottom")}}function zj(e,t,r){return{min:Uj(e,t),max:Uj(e,r)}}function Uj(e,t){return typeof e=="number"?e:e[t]||0}const Vj=()=>({translate:0,scale:1,origin:0,originPoint:0}),Co=()=>({x:Vj(),y:Vj()}),qj=()=>({min:0,max:0}),at=()=>({x:qj(),y:qj()});function Cr(e){return[e("x"),e("y")]}function C2({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function B8({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function z8(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function Xp(e){return e===void 0||e===1}function gv({scale:e,scaleX:t,scaleY:r}){return!Xp(e)||!Xp(t)||!Xp(r)}function ei(e){return gv(e)||P2(e)||e.z||e.rotate||e.rotateX||e.rotateY}function P2(e){return Wj(e.x)||Wj(e.y)}function Wj(e){return e&&e!=="0%"}function ef(e,t,r){const n=e-r,s=t*n;return r+s}function Hj(e,t,r,n,s){return s!==void 0&&(e=ef(e,s,n)),ef(e,r,n)+t}function vv(e,t=0,r=1,n,s){e.min=Hj(e.min,t,r,n,s),e.max=Hj(e.max,t,r,n,s)}function T2(e,{x:t,y:r}){vv(e.x,t.translate,t.scale,t.originPoint),vv(e.y,r.translate,r.scale,r.originPoint)}function U8(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let i,a;for(let l=0;l<s;l++){i=r[l],a=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Po(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,T2(e,a)),n&&ei(i.latestValues)&&Po(e,i.latestValues))}t.x=Gj(t.x),t.y=Gj(t.y)}function Gj(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function ds(e,t){e.min=e.min+t,e.max=e.max+t}function Kj(e,t,[r,n,s]){const i=t[s]!==void 0?t[s]:.5,a=tt(e.min,e.max,i);vv(e,t[r],t[n],a,t.scale)}const V8=["x","scaleX","originX"],q8=["y","scaleY","originY"];function Po(e,t){Kj(e.x,t,V8),Kj(e.y,t,q8)}function k2(e,t){return C2(z8(e.getBoundingClientRect(),t))}function W8(e,t,r){const n=k2(e,r),{scroll:s}=t;return s&&(ds(n.x,s.offset.x),ds(n.y,s.offset.y)),n}const A2=({current:e})=>e?e.ownerDocument.defaultView:null,H8=new WeakMap;class G8{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=at(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=f=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(th(f,"page").point)},i=(f,d)=>{const{drag:h,dragPropagation:m,onDragStart:g}=this.getProps();if(h&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=qP(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Cr(y=>{let x=this.getAxisMotionValue(y).get()||0;if(bn.test(x)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[y];w&&(x=yr(w)*(parseFloat(x)/100))}}this.originPoint[y]=x}),g&&Ue.update(()=>g(f,d),!1,!0);const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(f,d)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:g,onDrag:v}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:y}=d;if(m&&this.currentDirection===null){this.currentDirection=K8(y),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",d.point,y),this.updateAxis("y",d.point,y),this.visualElement.render(),v&&v(f,d)},l=(f,d)=>this.stop(f,d),c=()=>Cr(f=>{var d;return this.getAnimationState(f)==="paused"&&((d=this.getAxisMotionValue(f).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new N2(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:A2(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&Ue.update(()=>i(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!Su(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(a=O8(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;r&&No(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=D8(s.layoutBox,r):this.constraints=!1,this.elastic=F8(n),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Cr(a=>{this.getAxisMotionValue(a)&&(this.constraints[a]=L8(s.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!No(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=W8(n,s.root,this.visualElement.getTransformPagePoint());let a=$8(s.layout.layoutBox,i);if(r){const l=r(B8(a));this.hasMutatedConstraints=!!l,l&&(a=C2(l))}return a}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Cr(f=>{if(!Su(f,r,this.currentDirection))return;let d=c&&c[f]||{};a&&(d={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:n?t[f]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(f,g)});return Promise.all(u).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start($0(t,n,0,r))}stopAnimation(){Cr(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Cr(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Cr(r=>{const{drag:n}=this.getProps();if(!Su(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:a,max:l}=s.layout.layoutBox[r];i.set(t[r]-tt(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!No(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Cr(a=>{const l=this.getAxisMotionValue(a);if(l){const c=l.get();s[a]=M8({min:c,max:c},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Cr(a=>{if(!Su(a,t,null))return;const l=this.getAxisMotionValue(a),{min:c,max:u}=this.constraints[a];l.set(tt(c,u,s[a]))})}addListeners(){if(!this.visualElement.current)return;H8.set(this.visualElement,this);const t=this.visualElement.current,r=Bn(t,"pointerdown",c=>{const{drag:u,dragListener:f=!0}=this.getProps();u&&f&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();No(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),n();const a=Dn(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Cr(f=>{const d=this.getAxisMotionValue(f);d&&(this.originPoint[f]+=c[f].translate,d.set(d.get()+c[f].translate))}),this.visualElement.render())});return()=>{a(),r(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=mv,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:l}}}function Su(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function K8(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Y8 extends qs{constructor(t){super(t),this.removeGroupControls=it,this.removeListeners=it,this.controls=new G8(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||it}unmount(){this.removeGroupControls(),this.removeListeners()}}const Yj=e=>(t,r)=>{e&&Ue.update(()=>e(t,r))};class J8 extends qs{constructor(){super(...arguments),this.removePointerDownListener=it}onPointerDown(t){this.session=new N2(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:A2(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:Yj(t),onStart:Yj(r),onMove:n,onEnd:(i,a)=>{delete this.session,s&&Ue.update(()=>s(i,a))}}}mount(){this.removePointerDownListener=Bn(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function X8(){const e=p.useContext(Jf);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,s=p.useId();return p.useEffect(()=>n(s),[]),!t&&r?[!1,()=>r&&r(s)]:[!0]}const cd={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Jj(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ya={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(we.test(e))e=parseFloat(e);else return e;const r=Jj(e,t.target.x),n=Jj(e,t.target.y);return`${r}% ${n}%`}},Q8={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Ms.parse(e);if(s.length>5)return n;const i=Ms.createTransformer(e),a=typeof s[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;s[0+a]/=l,s[1+a]/=c;const u=tt(l,c,.5);return typeof s[2+a]=="number"&&(s[2+a]/=u),typeof s[3+a]=="number"&&(s[3+a]/=u),i(s)}};class Z8 extends J.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=t;oF(ez),i&&(r.group&&r.group.add(i),n&&n.register&&s&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),cd.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:i}=this.props,a=n.projection;return a&&(a.isPresent=i,s||t.layoutDependency!==r||r===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||Ue.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function R2(e){const[t,r]=X8(),n=p.useContext(j0);return J.createElement(Z8,{...e,layoutGroup:n,switchLayoutGroup:p.useContext(CP),isPresent:t,safeToRemove:r})}const ez={borderRadius:{...Ya,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ya,borderTopRightRadius:Ya,borderBottomLeftRadius:Ya,borderBottomRightRadius:Ya,boxShadow:Q8},I2=["TopLeft","TopRight","BottomLeft","BottomRight"],tz=I2.length,Xj=e=>typeof e=="string"?parseFloat(e):e,Qj=e=>typeof e=="number"||we.test(e);function rz(e,t,r,n,s,i){s?(e.opacity=tt(0,r.opacity!==void 0?r.opacity:1,nz(n)),e.opacityExit=tt(t.opacity!==void 0?t.opacity:1,0,sz(n))):i&&(e.opacity=tt(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let a=0;a<tz;a++){const l=`border${I2[a]}Radius`;let c=Zj(t,l),u=Zj(r,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||Qj(c)===Qj(u)?(e[l]=Math.max(tt(Xj(c),Xj(u),n),0),(bn.test(u)||bn.test(c))&&(e[l]+="%")):e[l]=u}(t.rotate||r.rotate)&&(e.rotate=tt(t.rotate||0,r.rotate||0,n))}function Zj(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const nz=O2(0,.5,r2),sz=O2(.5,.95,it);function O2(e,t,r){return n=>n<e?0:n>t?1:r(rc(e,t,n))}function e_(e,t){e.min=t.min,e.max=t.max}function Nr(e,t){e_(e.x,t.x),e_(e.y,t.y)}function t_(e,t,r,n,s){return e-=t,e=ef(e,1/r,n),s!==void 0&&(e=ef(e,1/s,n)),e}function iz(e,t=0,r=1,n=.5,s,i=e,a=e){if(bn.test(t)&&(t=parseFloat(t),t=tt(a.min,a.max,t/100)-a.min),typeof t!="number")return;let l=tt(i.min,i.max,n);e===i&&(l-=t),e.min=t_(e.min,t,r,l,s),e.max=t_(e.max,t,r,l,s)}function r_(e,t,[r,n,s],i,a){iz(e,t[r],t[n],t[s],t.scale,i,a)}const oz=["x","scaleX","originX"],az=["y","scaleY","originY"];function n_(e,t,r,n){r_(e.x,t,oz,r?r.x:void 0,n?n.x:void 0),r_(e.y,t,az,r?r.y:void 0,n?n.y:void 0)}function s_(e){return e.translate===0&&e.scale===1}function D2(e){return s_(e.x)&&s_(e.y)}function lz(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function $2(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function i_(e){return yr(e.x)/yr(e.y)}class cz{constructor(){this.members=[]}add(t){M0(this.members,t),t.scheduleRender()}remove(t){if(L0(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function o_(e,t,r){let n="";const s=e.x.translate/t.x,i=e.y.translate/t.y;if((s||i)&&(n=`translate3d(${s}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:u,rotateY:f}=r;c&&(n+=`rotate(${c}deg) `),u&&(n+=`rotateX(${u}deg) `),f&&(n+=`rotateY(${f}deg) `)}const a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const uz=(e,t)=>e.depth-t.depth;class dz{constructor(){this.children=[],this.isDirty=!1}add(t){M0(this.children,t),this.isDirty=!0}remove(t){L0(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(uz),this.isDirty=!1,this.children.forEach(t)}}function fz(e,t){const r=performance.now(),n=({timestamp:s})=>{const i=s-r;i>=t&&(Kn(n),e(i-t))};return Ue.read(n,!0),()=>Kn(n)}function hz(e){window.MotionDebug&&window.MotionDebug.record(e)}function pz(e){return e instanceof SVGElement&&e.tagName!=="svg"}function mz(e,t,r){const n=nr(e)?e:ea(e);return n.start($0("",n,t,r)),n.animation}const a_=["","X","Y","Z"],gz={visibility:"hidden"},l_=1e3;let vz=0;const ti={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function M2({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(a={},l=t==null?void 0:t()){this.id=vz++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ti.totalNodes=ti.resolvedTargetDeltas=ti.recalculatedProjection=0,this.nodes.forEach(bz),this.nodes.forEach(Nz),this.nodes.forEach(Ez),this.nodes.forEach(wz),hz(ti)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new dz)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new F0),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=pz(a),this.instance=a;const{layoutId:c,layout:u,visualElement:f}=this.options;if(f&&!f.current&&f.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),e){let d;const h=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=fz(h,250),cd.hasAnimatedSinceResize&&(cd.hasAnimatedSinceResize=!1,this.nodes.forEach(u_))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&f&&(c||u)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||f.getDefaultTransition()||Az,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=f.getProps(),b=!this.targetLayout||!$2(this.targetLayout,g)||m,w=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||h&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,w);const j={...D0(v,"layout"),onPlay:y,onComplete:x};(f.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else h||u_(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Kn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Cz),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const d=this.path[f];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(c_);return}this.isUpdating||this.nodes.forEach(_z),this.isUpdating=!1,this.nodes.forEach(Sz),this.nodes.forEach(xz),this.nodes.forEach(yz),this.clearAllSnapshots();const l=performance.now();At.delta=$s(0,1e3/60,l-At.timestamp),At.timestamp=l,At.isProcessing=!0,zp.update.process(At),zp.preRender.process(At),zp.render.process(At),At.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(jz),this.sharedNodes.forEach(Pz)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ue.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ue.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=at(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!D2(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,f=u!==this.prevTransformTemplateValue;a&&(l||ei(this.latestValues)||f)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),Rz(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return at();const l=a.measureViewportBox(),{scroll:c}=this.root;return c&&(ds(l.x,c.offset.x),ds(l.y,c.offset.y)),l}removeElementScroll(a){const l=at();Nr(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:f,options:d}=u;if(u!==this.root&&f&&d.layoutScroll){if(f.isRoot){Nr(l,a);const{scroll:h}=this.root;h&&(ds(l.x,-h.offset.x),ds(l.y,-h.offset.y))}ds(l.x,f.offset.x),ds(l.y,f.offset.y)}}return l}applyTransform(a,l=!1){const c=at();Nr(c,a);for(let u=0;u<this.path.length;u++){const f=this.path[u];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Po(c,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),ei(f.latestValues)&&Po(c,f.latestValues)}return ei(this.latestValues)&&Po(c,this.latestValues),c}removeTransform(a){const l=at();Nr(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!ei(u.latestValues))continue;gv(u.latestValues)&&u.updateSnapshot();const f=at(),d=u.measurePageBox();Nr(f,d),n_(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,f)}return ei(this.latestValues)&&n_(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==At.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=At.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=at(),this.relativeTargetOrigin=at(),El(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Nr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=at(),this.targetWithTransforms=at()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),I8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Nr(this.target,this.layout.layoutBox),T2(this.target,this.targetDelta)):Nr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=at(),this.relativeTargetOrigin=at(),El(this.relativeTargetOrigin,this.target,m.target),Nr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ti.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||gv(this.parent.latestValues)||P2(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===At.timestamp&&(u=!1),u)return;const{layout:f,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||d))return;Nr(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;U8(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=Co(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Co(),this.projectionDeltaWithTransform=Co());const v=this.projectionTransform;Nl(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=o_(this.projectionDelta,this.treeScale),(this.projectionTransform!==v||this.treeScale.x!==h||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),ti.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,l=!1){const c=this.snapshot,u=c?c.latestValues:{},f={...this.latestValues},d=Co();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=at(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,v=m!==g,y=this.getStack(),x=!y||y.members.length<=1,b=!!(v&&!x&&this.options.crossfade===!0&&!this.path.some(kz));this.animationProgress=0;let w;this.mixTargetDelta=j=>{const _=j/1e3;d_(d.x,a.x,_),d_(d.y,a.y,_),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(El(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Tz(this.relativeTarget,this.relativeTargetOrigin,h,_),w&&lz(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=at()),Nr(w,this.relativeTarget)),v&&(this.animationValues=f,rz(f,u,this.latestValues,_,b,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Kn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ue.update(()=>{cd.hasAnimatedSinceResize=!0,this.currentAnimation=mz(0,l_,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(l_),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:f}=a;if(!(!l||!c||!u)){if(this!==a&&this.layout&&u&&L2(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||at();const d=yr(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+d;const h=yr(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+h}Nr(l,c),Po(l,f),Nl(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new cz),this.sharedNodes.get(a).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let f=0;f<a_.length;f++){const d="rotate"+a_[f];c[d]&&(u[d]=c[d],a.setStaticValue(d,0))}a.render();for(const f in u)a.setStaticValue(f,u[f]);a.scheduleRender()}getProjectionStyles(a){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return gz;const u={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=ld(a==null?void 0:a.pointerEvents)||"",u.transform=f?f(this.latestValues,""):"none",u;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=ld(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!ei(this.latestValues)&&(v.transform=f?f({},""):"none",this.hasProjected=!1),v}const h=d.animationValues||d.latestValues;this.applyTransformsToTarget(),u.transform=o_(this.projectionDeltaWithTransform,this.treeScale,h),f&&(u.transform=f(h,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,d.animationValues?u.opacity=d===this?(c=(l=h.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const v in Gd){if(h[v]===void 0)continue;const{correct:y,applyTo:x}=Gd[v],b=u.transform==="none"?h[v]:y(h[v],d);if(x){const w=x.length;for(let j=0;j<w;j++)u[x[j]]=b}else u[v]=b}return this.options.layoutId&&(u.pointerEvents=d===this?ld(a==null?void 0:a.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(c_),this.root.sharedNodes.clear()}}}function xz(e){e.updateLayout()}function yz(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:i}=e.options,a=r.source!==e.layout.source;i==="size"?Cr(d=>{const h=a?r.measuredBox[d]:r.layoutBox[d],m=yr(h);h.min=n[d].min,h.max=h.min+m}):L2(i,r.layoutBox,n)&&Cr(d=>{const h=a?r.measuredBox[d]:r.layoutBox[d],m=yr(n[d]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+m)});const l=Co();Nl(l,n,r.layoutBox);const c=Co();a?Nl(c,e.applyTransform(s,!0),r.measuredBox):Nl(c,n,r.layoutBox);const u=!D2(l);let f=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:m}=d;if(h&&m){const g=at();El(g,r.layoutBox,h.layoutBox);const v=at();El(v,n,m.layoutBox),$2(g,v)||(f=!0),d.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=g,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:f})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function bz(e){ti.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function wz(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function jz(e){e.clearSnapshot()}function c_(e){e.clearMeasurements()}function _z(e){e.isLayoutDirty=!1}function Sz(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function u_(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Nz(e){e.resolveTargetDelta()}function Ez(e){e.calcProjection()}function Cz(e){e.resetRotation()}function Pz(e){e.removeLeadSnapshot()}function d_(e,t,r){e.translate=tt(t.translate,0,r),e.scale=tt(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function f_(e,t,r,n){e.min=tt(t.min,r.min,n),e.max=tt(t.max,r.max,n)}function Tz(e,t,r,n){f_(e.x,t.x,r.x,n),f_(e.y,t.y,r.y,n)}function kz(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Az={duration:.45,ease:[.4,0,.1,1]},h_=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),p_=h_("applewebkit/")&&!h_("chrome/")?Math.round:it;function m_(e){e.min=p_(e.min),e.max=p_(e.max)}function Rz(e){m_(e.x),m_(e.y)}function L2(e,t,r){return e==="position"||e==="preserve-aspect"&&!pv(i_(t),i_(r),.2)}const Iz=M2({attachResizeListener:(e,t)=>Dn(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Qp={current:void 0},F2=M2({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Qp.current){const e=new Iz({});e.mount(window),e.setOptions({layoutScroll:!0}),Qp.current=e}return Qp.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Oz={pan:{Feature:J8},drag:{Feature:Y8,ProjectionNode:F2,MeasureLayout:R2}},Dz=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function $z(e){const t=Dz.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function xv(e,t,r=1){const[n,s]=$z(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const a=i.trim();return w2(a)?parseFloat(a):a}else return av(s)?xv(s,t,r+1):s}function Mz(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(s=>{const i=s.get();if(!av(i))return;const a=xv(i,n);a&&s.set(a)});for(const s in t){const i=t[s];if(!av(i))continue;const a=xv(i,n);a&&(t[s]=a,r||(r={}),r[s]===void 0&&(r[s]=i))}return{target:t,transitionEnd:r}}const Lz=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),B2=e=>Lz.has(e),Fz=e=>Object.keys(e).some(B2),g_=e=>e===Ui||e===we,v_=(e,t)=>parseFloat(e.split(", ")[t]),x_=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/);if(s)return v_(s[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?v_(i[1],e):0}},Bz=new Set(["x","y","z"]),zz=Rc.filter(e=>!Bz.has(e));function Uz(e){const t=[];return zz.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const ta={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:x_(4,13),y:x_(5,14)};ta.translateX=ta.x;ta.translateY=ta.y;const Vz=(e,t,r)=>{const n=t.measureViewportBox(),s=t.current,i=getComputedStyle(s),{display:a}=i,l={};a==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(u=>{l[u]=ta[u](n,i)}),t.render();const c=t.measureViewportBox();return r.forEach(u=>{const f=t.getValue(u);f&&f.jump(l[u]),e[u]=ta[u](c,i)}),e},qz=(e,t,r={},n={})=>{t={...t},n={...n};const s=Object.keys(t).filter(B2);let i=[],a=!1;const l=[];if(s.forEach(c=>{const u=e.getValue(c);if(!e.hasValue(c))return;let f=r[c],d=Ka(f);const h=t[c];let m;if(Yd(h)){const g=h.length,v=h[0]===null?1:0;f=h[v],d=Ka(f);for(let y=v;y<g&&h[y]!==null;y++)m?k0(Ka(h[y])===m):m=Ka(h[y])}else m=Ka(h);if(d!==m)if(g_(d)&&g_(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof h=="string"?t[c]=parseFloat(h):Array.isArray(h)&&m===we&&(t[c]=h.map(parseFloat))}else d!=null&&d.transform&&(m!=null&&m.transform)&&(f===0||h===0)?f===0?u.set(m.transform(f)):t[c]=d.transform(h):(a||(i=Uz(e),a=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],u.jump(h))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=Vz(t,e,l);return i.length&&i.forEach(([f,d])=>{e.getValue(f).set(d)}),e.render(),Xf&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:n}}else return{target:t,transitionEnd:n}};function Wz(e,t,r,n){return Fz(t)?qz(e,t,r,n):{target:t,transitionEnd:n}}const Hz=(e,t,r,n)=>{const s=Mz(e,t,n);return t=s.target,n=s.transitionEnd,Wz(e,t,r,n)},yv={current:null},z2={current:!1};function Gz(){if(z2.current=!0,!!Xf)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>yv.current=e.matches;e.addListener(t),t()}else yv.current=!1}function Kz(e,t,r){const{willChange:n}=t;for(const s in t){const i=t[s],a=r[s];if(nr(i))e.addValue(s,i),Zd(n)&&n.add(s);else if(nr(a))e.addValue(s,ea(i,{owner:e})),Zd(n)&&n.remove(s);else if(a!==i)if(e.hasValue(s)){const l=e.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=e.getStaticValue(s);e.addValue(s,ea(l!==void 0?l:i,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const y_=new WeakMap,U2=Object.keys(tc),Yz=U2.length,b_=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Jz=w0.length;class Xz{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,visualState:i},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Ue.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.isControllingVariants=Zf(r),this.isVariantNode=EP(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...f}=this.scrapeMotionValuesFromProps(r,{});for(const d in f){const h=f[d];l[d]!==void 0&&nr(h)&&(h.set(l[d],!1),Zd(u)&&u.add(d))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,y_.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),z2.current||Gz(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:yv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){y_.delete(this.current),this.projection&&this.projection.unmount(),Kn(this.notifyUpdate),Kn(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=zi.has(t),s=r.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&Ue.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{s(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,s,i){let a,l;for(let c=0;c<Yz;c++){const u=U2[c],{isEnabled:f,Feature:d,ProjectionNode:h,MeasureLayout:m}=tc[u];h&&(a=h),f(r)&&(!this.features[u]&&d&&(this.features[u]=new d(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:f,dragConstraints:d,layoutScroll:h,layoutRoot:m}=r;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!f||d&&No(d),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:h,layoutRoot:m})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):at()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<b_.length;n++){const s=b_[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=t["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Kz(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<Jz;n++){const s=w0[n],i=this.props[s];(ec(i)||i===!1)&&(r[s]=i)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=ea(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,s=typeof n=="string"||typeof n=="object"?(r=T0(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!nr(i)?i:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new F0),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class V2 extends Xz{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:s},i){let a=p8(n,t||{},this);if(s&&(r&&(r=s(r)),n&&(n=s(n)),a&&(a=s(a))),i){f8(this,n,a);const l=Hz(this,n,a,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function Qz(e){return window.getComputedStyle(e)}class Zz extends V2{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(zi.has(r)){const n=O0(r);return n&&n.default||0}else{const n=Qz(t),s=(kP(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return k2(t,r)}build(t,r,n,s){S0(t,r,n,s.transformTemplate)}scrapeMotionValuesFromProps(t,r){return P0(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;nr(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,s){$P(t,r,n,s)}}class eU extends V2{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(zi.has(r)){const n=O0(r);return n&&n.default||0}return r=MP.has(r)?r:y0(r),t.getAttribute(r)}measureInstanceViewportBox(){return at()}scrapeMotionValuesFromProps(t,r){return FP(t,r)}build(t,r,n,s){E0(t,r,n,this.isSVGTag,s.transformTemplate)}renderInstance(t,r,n,s){LP(t,r,n,s)}mount(t){this.isSVGTag=C0(t.tagName),super.mount(t)}}const tU=(e,t)=>_0(e)?new eU(t,{enableHardwareAcceleration:!1}):new Zz(t,{enableHardwareAcceleration:!0}),rU={layout:{ProjectionNode:F2,MeasureLayout:R2}},nU={...T8,...YF,...Oz,...rU},le=sF((e,t)=>$F(e,t,nU,tU));function q2(){const e=p.useRef(!1);return x0(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function sU(){const e=q2(),[t,r]=p.useState(0),n=p.useCallback(()=>{e.current&&r(t+1)},[t]);return[p.useCallback(()=>Ue.postRender(n),[n]),t]}class iU extends p.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function oU({children:e,isPresent:t}){const r=p.useId(),n=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:a,top:l,left:c}=s.current;if(t||!n.current||!i||!a)return;n.current.dataset.motionPopId=r;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),p.createElement(iU,{isPresent:t,childRef:n,sizeRef:s},p.cloneElement(e,{ref:n}))}const Zp=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:a})=>{const l=BP(aU),c=p.useId(),u=p.useMemo(()=>({id:c,initial:t,isPresent:r,custom:s,onExitComplete:f=>{l.set(f,!0);for(const d of l.values())if(!d)return;n&&n()},register:f=>(l.set(f,!1),()=>l.delete(f))}),i?void 0:[r]);return p.useMemo(()=>{l.forEach((f,d)=>l.set(d,!1))},[r]),p.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),a==="popLayout"&&(e=p.createElement(oU,{isPresent:r},e)),p.createElement(Jf.Provider,{value:u},e)};function aU(){return new Map}function lU(e){return p.useEffect(()=>()=>e(),[])}const ri=e=>e.key||"";function cU(e,t){e.forEach(r=>{const n=ri(r);t.set(n,r)})}function uU(e){const t=[];return p.Children.forEach(e,r=>{p.isValidElement(r)&&t.push(r)}),t}const Ti=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:a="sync"})=>{const l=p.useContext(j0).forceRender||sU()[0],c=q2(),u=uU(e);let f=u;const d=p.useRef(new Map).current,h=p.useRef(f),m=p.useRef(new Map).current,g=p.useRef(!0);if(x0(()=>{g.current=!1,cU(u,m),h.current=f}),lU(()=>{g.current=!0,m.clear(),d.clear()}),g.current)return p.createElement(p.Fragment,null,f.map(b=>p.createElement(Zp,{key:ri(b),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:i,mode:a},b)));f=[...f];const v=h.current.map(ri),y=u.map(ri),x=v.length;for(let b=0;b<x;b++){const w=v[b];y.indexOf(w)===-1&&!d.has(w)&&d.set(w,void 0)}return a==="wait"&&d.size&&(f=[]),d.forEach((b,w)=>{if(y.indexOf(w)!==-1)return;const j=m.get(w);if(!j)return;const _=v.indexOf(w);let S=b;if(!S){const N=()=>{d.delete(w);const E=Array.from(m.keys()).filter(C=>!y.includes(C));if(E.forEach(C=>m.delete(C)),h.current=u.filter(C=>{const k=ri(C);return k===w||E.includes(k)}),!d.size){if(c.current===!1)return;l(),n&&n()}};S=p.createElement(Zp,{key:ri(j),isPresent:!1,onExitComplete:N,custom:t,presenceAffectsLayout:i,mode:a},j),d.set(w,S)}f.splice(_,0,S)}),f=f.map(b=>{const w=b.key;return d.has(w)?b:p.createElement(Zp,{key:ri(b),isPresent:!0,presenceAffectsLayout:i,mode:a},b)}),p.createElement(p.Fragment,null,d.size?f:f.map(b=>p.cloneElement(b)))},B0=Vf("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),G=J.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},i)=>{const a=n?C6:"button";return o.jsx(a,{className:he(B0({variant:t,size:r,className:e})),ref:i,...s})});G.displayName="Button";var dU=p.createContext(void 0);function W2(e){const t=p.useContext(dU);return e||t||"ltr"}var em=0;function z0(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??w_()),document.body.insertAdjacentElement("beforeend",e[1]??w_()),em++,()=>{em===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),em--}},[])}function w_(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var tm="focusScope.autoFocusOnMount",rm="focusScope.autoFocusOnUnmount",j_={bubbles:!1,cancelable:!0},fU="FocusScope",nh=p.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[l,c]=p.useState(null),u=xr(s),f=xr(i),d=p.useRef(null),h=Fe(t,v=>c(v)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(n){let v=function(w){if(m.paused||!l)return;const j=w.target;l.contains(j)?d.current=j:as(d.current,{select:!0})},y=function(w){if(m.paused||!l)return;const j=w.relatedTarget;j!==null&&(l.contains(j)||as(d.current,{select:!0}))},x=function(w){if(document.activeElement===document.body)for(const _ of w)_.removedNodes.length>0&&as(l)};document.addEventListener("focusin",v),document.addEventListener("focusout",y);const b=new MutationObserver(x);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",y),b.disconnect()}}},[n,l,m.paused]),p.useEffect(()=>{if(l){S_.add(m);const v=document.activeElement;if(!l.contains(v)){const x=new CustomEvent(tm,j_);l.addEventListener(tm,u),l.dispatchEvent(x),x.defaultPrevented||(hU(xU(H2(l)),{select:!0}),document.activeElement===v&&as(l))}return()=>{l.removeEventListener(tm,u),setTimeout(()=>{const x=new CustomEvent(rm,j_);l.addEventListener(rm,f),l.dispatchEvent(x),x.defaultPrevented||as(v??document.body,{select:!0}),l.removeEventListener(rm,f),S_.remove(m)},0)}}},[l,u,f,m]);const g=p.useCallback(v=>{if(!r&&!n||m.paused)return;const y=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,x=document.activeElement;if(y&&x){const b=v.currentTarget,[w,j]=pU(b);w&&j?!v.shiftKey&&x===j?(v.preventDefault(),r&&as(w,{select:!0})):v.shiftKey&&x===w&&(v.preventDefault(),r&&as(j,{select:!0})):x===b&&v.preventDefault()}},[r,n,m.paused]);return o.jsx(Re.div,{tabIndex:-1,...a,ref:h,onKeyDown:g})});nh.displayName=fU;function hU(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(as(n,{select:t}),document.activeElement!==r)return}function pU(e){const t=H2(e),r=__(t,e),n=__(t.reverse(),e);return[r,n]}function H2(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function __(e,t){for(const r of e)if(!mU(r,{upTo:t}))return r}function mU(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function gU(e){return e instanceof HTMLInputElement&&"select"in e}function as(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&gU(e)&&t&&e.select()}}var S_=vU();function vU(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=N_(e,t),e.unshift(t)},remove(t){var r;e=N_(e,t),(r=e[0])==null||r.resume()}}}function N_(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function xU(e){return e.filter(t=>t.tagName!=="A")}var yU=wc[" useId ".trim().toString()]||(()=>{}),bU=0;function bi(e){const[t,r]=p.useState(yU());return Hn(()=>{e||r(n=>n??String(bU++))},[e]),e||(t?`radix-${t}`:"")}const wU=["top","right","bottom","left"],Ls=Math.min,ar=Math.max,tf=Math.round,Nu=Math.floor,wn=e=>({x:e,y:e}),jU={left:"right",right:"left",bottom:"top",top:"bottom"},_U={start:"end",end:"start"};function bv(e,t,r){return ar(e,Ls(t,r))}function Yn(e,t){return typeof e=="function"?e(t):e}function Jn(e){return e.split("-")[0]}function ga(e){return e.split("-")[1]}function U0(e){return e==="x"?"y":"x"}function V0(e){return e==="y"?"height":"width"}const SU=new Set(["top","bottom"]);function gn(e){return SU.has(Jn(e))?"y":"x"}function q0(e){return U0(gn(e))}function NU(e,t,r){r===void 0&&(r=!1);const n=ga(e),s=q0(e),i=V0(s);let a=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=rf(a)),[a,rf(a)]}function EU(e){const t=rf(e);return[wv(e),t,wv(t)]}function wv(e){return e.replace(/start|end/g,t=>_U[t])}const E_=["left","right"],C_=["right","left"],CU=["top","bottom"],PU=["bottom","top"];function TU(e,t,r){switch(e){case"top":case"bottom":return r?t?C_:E_:t?E_:C_;case"left":case"right":return t?CU:PU;default:return[]}}function kU(e,t,r,n){const s=ga(e);let i=TU(Jn(e),r==="start",n);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(wv)))),i}function rf(e){return e.replace(/left|right|bottom|top/g,t=>jU[t])}function AU(e){return{top:0,right:0,bottom:0,left:0,...e}}function G2(e){return typeof e!="number"?AU(e):{top:e,right:e,bottom:e,left:e}}function nf(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function P_(e,t,r){let{reference:n,floating:s}=e;const i=gn(t),a=q0(t),l=V0(a),c=Jn(t),u=i==="y",f=n.x+n.width/2-s.width/2,d=n.y+n.height/2-s.height/2,h=n[l]/2-s[l]/2;let m;switch(c){case"top":m={x:f,y:n.y-s.height};break;case"bottom":m={x:f,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:d};break;case"left":m={x:n.x-s.width,y:d};break;default:m={x:n.x,y:n.y}}switch(ga(t)){case"start":m[a]-=h*(r&&u?-1:1);break;case"end":m[a]+=h*(r&&u?-1:1);break}return m}const RU=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:a}=r,l=i.filter(Boolean),c=await(a.isRTL==null?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:f,y:d}=P_(u,n,c),h=n,m={},g=0;for(let v=0;v<l.length;v++){const{name:y,fn:x}=l[v],{x:b,y:w,data:j,reset:_}=await x({x:f,y:d,initialPlacement:n,placement:h,strategy:s,middlewareData:m,rects:u,platform:a,elements:{reference:e,floating:t}});f=b??f,d=w??d,m={...m,[y]:{...m[y],...j}},_&&g<=50&&(g++,typeof _=="object"&&(_.placement&&(h=_.placement),_.rects&&(u=_.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):_.rects),{x:f,y:d}=P_(u,h,c)),v=-1)}return{x:f,y:d,placement:h,strategy:s,middlewareData:m}};async function nc(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:i,rects:a,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=Yn(t,e),g=G2(m),y=l[h?d==="floating"?"reference":"floating":d],x=nf(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(y)))==null||r?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:f,strategy:c})),b=d==="floating"?{x:n,y:s,width:a.floating.width,height:a.floating.height}:a.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),j=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},_=nf(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:w,strategy:c}):b);return{top:(x.top-_.top+g.top)/j.y,bottom:(_.bottom-x.bottom+g.bottom)/j.y,left:(x.left-_.left+g.left)/j.x,right:(_.right-x.right+g.right)/j.x}}const IU=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:i,platform:a,elements:l,middlewareData:c}=t,{element:u,padding:f=0}=Yn(e,t)||{};if(u==null)return{};const d=G2(f),h={x:r,y:n},m=q0(s),g=V0(m),v=await a.getDimensions(u),y=m==="y",x=y?"top":"left",b=y?"bottom":"right",w=y?"clientHeight":"clientWidth",j=i.reference[g]+i.reference[m]-h[m]-i.floating[g],_=h[m]-i.reference[m],S=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let N=S?S[w]:0;(!N||!await(a.isElement==null?void 0:a.isElement(S)))&&(N=l.floating[w]||i.floating[g]);const E=j/2-_/2,C=N/2-v[g]/2-1,k=Ls(d[x],C),L=Ls(d[b],C),A=k,R=N-v[g]-L,O=N/2-v[g]/2+E,z=bv(A,O,R),F=!c.arrow&&ga(s)!=null&&O!==z&&i.reference[g]/2-(O<A?k:L)-v[g]/2<0,V=F?O<A?O-A:O-R:0;return{[m]:h[m]+V,data:{[m]:z,centerOffset:O-z-V,...F&&{alignmentOffset:V}},reset:F}}}),OU=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:i,rects:a,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:f=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0,...y}=Yn(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const x=Jn(s),b=gn(l),w=Jn(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(u.floating)),_=h||(w||!v?[rf(l)]:EU(l)),S=g!=="none";!h&&S&&_.push(...kU(l,v,g,j));const N=[l,..._],E=await nc(t,y),C=[];let k=((n=i.flip)==null?void 0:n.overflows)||[];if(f&&C.push(E[x]),d){const O=NU(s,a,j);C.push(E[O[0]],E[O[1]])}if(k=[...k,{placement:s,overflows:C}],!C.every(O=>O<=0)){var L,A;const O=(((L=i.flip)==null?void 0:L.index)||0)+1,z=N[O];if(z&&(!(d==="alignment"?b!==gn(z):!1)||k.every(I=>gn(I.placement)===b?I.overflows[0]>0:!0)))return{data:{index:O,overflows:k},reset:{placement:z}};let F=(A=k.filter(V=>V.overflows[0]<=0).sort((V,I)=>V.overflows[1]-I.overflows[1])[0])==null?void 0:A.placement;if(!F)switch(m){case"bestFit":{var R;const V=(R=k.filter(I=>{if(S){const D=gn(I.placement);return D===b||D==="y"}return!0}).map(I=>[I.placement,I.overflows.filter(D=>D>0).reduce((D,$)=>D+$,0)]).sort((I,D)=>I[1]-D[1])[0])==null?void 0:R[0];V&&(F=V);break}case"initialPlacement":F=l;break}if(s!==F)return{reset:{placement:F}}}return{}}}};function T_(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function k_(e){return wU.some(t=>e[t]>=0)}const DU=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=Yn(e,t);switch(n){case"referenceHidden":{const i=await nc(t,{...s,elementContext:"reference"}),a=T_(i,r.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:k_(a)}}}case"escaped":{const i=await nc(t,{...s,altBoundary:!0}),a=T_(i,r.floating);return{data:{escapedOffsets:a,escaped:k_(a)}}}default:return{}}}}},K2=new Set(["left","top"]);async function $U(e,t){const{placement:r,platform:n,elements:s}=e,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),a=Jn(r),l=ga(r),c=gn(r)==="y",u=K2.has(a)?-1:1,f=i&&c?-1:1,d=Yn(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:g}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*f,y:h*u}:{x:h*u,y:m*f}}const MU=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:i,placement:a,middlewareData:l}=t,c=await $U(t,e);return a===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:a}}}}},LU=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:l={fn:y=>{let{x,y:b}=y;return{x,y:b}}},...c}=Yn(e,t),u={x:r,y:n},f=await nc(t,c),d=gn(Jn(s)),h=U0(d);let m=u[h],g=u[d];if(i){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",b=m+f[y],w=m-f[x];m=bv(b,m,w)}if(a){const y=d==="y"?"top":"left",x=d==="y"?"bottom":"right",b=g+f[y],w=g-f[x];g=bv(b,g,w)}const v=l.fn({...t,[h]:m,[d]:g});return{...v,data:{x:v.x-r,y:v.y-n,enabled:{[h]:i,[d]:a}}}}}},FU=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:i,middlewareData:a}=t,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=Yn(e,t),f={x:r,y:n},d=gn(s),h=U0(d);let m=f[h],g=f[d];const v=Yn(l,t),y=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const w=h==="y"?"height":"width",j=i.reference[h]-i.floating[w]+y.mainAxis,_=i.reference[h]+i.reference[w]-y.mainAxis;m<j?m=j:m>_&&(m=_)}if(u){var x,b;const w=h==="y"?"width":"height",j=K2.has(Jn(s)),_=i.reference[d]-i.floating[w]+(j&&((x=a.offset)==null?void 0:x[d])||0)+(j?0:y.crossAxis),S=i.reference[d]+i.reference[w]+(j?0:((b=a.offset)==null?void 0:b[d])||0)-(j?y.crossAxis:0);g<_?g=_:g>S&&(g=S)}return{[h]:m,[d]:g}}}},BU=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:i,platform:a,elements:l}=t,{apply:c=()=>{},...u}=Yn(e,t),f=await nc(t,u),d=Jn(s),h=ga(s),m=gn(s)==="y",{width:g,height:v}=i.floating;let y,x;d==="top"||d==="bottom"?(y=d,x=h===(await(a.isRTL==null?void 0:a.isRTL(l.floating))?"start":"end")?"left":"right"):(x=d,y=h==="end"?"top":"bottom");const b=v-f.top-f.bottom,w=g-f.left-f.right,j=Ls(v-f[y],b),_=Ls(g-f[x],w),S=!t.middlewareData.shift;let N=j,E=_;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(E=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(N=b),S&&!h){const k=ar(f.left,0),L=ar(f.right,0),A=ar(f.top,0),R=ar(f.bottom,0);m?E=g-2*(k!==0||L!==0?k+L:ar(f.left,f.right)):N=v-2*(A!==0||R!==0?A+R:ar(f.top,f.bottom))}await c({...t,availableWidth:E,availableHeight:N});const C=await a.getDimensions(l.floating);return g!==C.width||v!==C.height?{reset:{rects:!0}}:{}}}};function sh(){return typeof window<"u"}function va(e){return Y2(e)?(e.nodeName||"").toLowerCase():"#document"}function pr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function _n(e){var t;return(t=(Y2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Y2(e){return sh()?e instanceof Node||e instanceof pr(e).Node:!1}function rn(e){return sh()?e instanceof Element||e instanceof pr(e).Element:!1}function jn(e){return sh()?e instanceof HTMLElement||e instanceof pr(e).HTMLElement:!1}function A_(e){return!sh()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof pr(e).ShadowRoot}const zU=new Set(["inline","contents"]);function $c(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=nn(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!zU.has(s)}const UU=new Set(["table","td","th"]);function VU(e){return UU.has(va(e))}const qU=[":popover-open",":modal"];function ih(e){return qU.some(t=>{try{return e.matches(t)}catch{return!1}})}const WU=["transform","translate","scale","rotate","perspective"],HU=["transform","translate","scale","rotate","perspective","filter"],GU=["paint","layout","strict","content"];function W0(e){const t=H0(),r=rn(e)?nn(e):e;return WU.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||HU.some(n=>(r.willChange||"").includes(n))||GU.some(n=>(r.contain||"").includes(n))}function KU(e){let t=Fs(e);for(;jn(t)&&!ra(t);){if(W0(t))return t;if(ih(t))return null;t=Fs(t)}return null}function H0(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const YU=new Set(["html","body","#document"]);function ra(e){return YU.has(va(e))}function nn(e){return pr(e).getComputedStyle(e)}function oh(e){return rn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Fs(e){if(va(e)==="html")return e;const t=e.assignedSlot||e.parentNode||A_(e)&&e.host||_n(e);return A_(t)?t.host:t}function J2(e){const t=Fs(e);return ra(t)?e.ownerDocument?e.ownerDocument.body:e.body:jn(t)&&$c(t)?t:J2(t)}function sc(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=J2(e),i=s===((n=e.ownerDocument)==null?void 0:n.body),a=pr(s);if(i){const l=jv(a);return t.concat(a,a.visualViewport||[],$c(s)?s:[],l&&r?sc(l):[])}return t.concat(s,sc(s,[],r))}function jv(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function X2(e){const t=nn(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=jn(e),i=s?e.offsetWidth:r,a=s?e.offsetHeight:n,l=tf(r)!==i||tf(n)!==a;return l&&(r=i,n=a),{width:r,height:n,$:l}}function G0(e){return rn(e)?e:e.contextElement}function Lo(e){const t=G0(e);if(!jn(t))return wn(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:i}=X2(t);let a=(i?tf(r.width):r.width)/n,l=(i?tf(r.height):r.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!l||!Number.isFinite(l))&&(l=1),{x:a,y:l}}const JU=wn(0);function Q2(e){const t=pr(e);return!H0()||!t.visualViewport?JU:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function XU(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==pr(e)?!1:t}function ki(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),i=G0(e);let a=wn(1);t&&(n?rn(n)&&(a=Lo(n)):a=Lo(e));const l=XU(i,r,n)?Q2(i):wn(0);let c=(s.left+l.x)/a.x,u=(s.top+l.y)/a.y,f=s.width/a.x,d=s.height/a.y;if(i){const h=pr(i),m=n&&rn(n)?pr(n):n;let g=h,v=jv(g);for(;v&&n&&m!==g;){const y=Lo(v),x=v.getBoundingClientRect(),b=nn(v),w=x.left+(v.clientLeft+parseFloat(b.paddingLeft))*y.x,j=x.top+(v.clientTop+parseFloat(b.paddingTop))*y.y;c*=y.x,u*=y.y,f*=y.x,d*=y.y,c+=w,u+=j,g=pr(v),v=jv(g)}}return nf({width:f,height:d,x:c,y:u})}function ah(e,t){const r=oh(e).scrollLeft;return t?t.left+r:ki(_n(e)).left+r}function Z2(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-ah(e,r),s=r.top+t.scrollTop;return{x:n,y:s}}function QU(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const i=s==="fixed",a=_n(n),l=t?ih(t.floating):!1;if(n===a||l&&i)return r;let c={scrollLeft:0,scrollTop:0},u=wn(1);const f=wn(0),d=jn(n);if((d||!d&&!i)&&((va(n)!=="body"||$c(a))&&(c=oh(n)),jn(n))){const m=ki(n);u=Lo(n),f.x=m.x+n.clientLeft,f.y=m.y+n.clientTop}const h=a&&!d&&!i?Z2(a,c):wn(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+f.x+h.x,y:r.y*u.y-c.scrollTop*u.y+f.y+h.y}}function ZU(e){return Array.from(e.getClientRects())}function eV(e){const t=_n(e),r=oh(e),n=e.ownerDocument.body,s=ar(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=ar(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let a=-r.scrollLeft+ah(e);const l=-r.scrollTop;return nn(n).direction==="rtl"&&(a+=ar(t.clientWidth,n.clientWidth)-s),{width:s,height:i,x:a,y:l}}const R_=25;function tV(e,t){const r=pr(e),n=_n(e),s=r.visualViewport;let i=n.clientWidth,a=n.clientHeight,l=0,c=0;if(s){i=s.width,a=s.height;const f=H0();(!f||f&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}const u=ah(n);if(u<=0){const f=n.ownerDocument,d=f.body,h=getComputedStyle(d),m=f.compatMode==="CSS1Compat"&&parseFloat(h.marginLeft)+parseFloat(h.marginRight)||0,g=Math.abs(n.clientWidth-d.clientWidth-m);g<=R_&&(i-=g)}else u<=R_&&(i+=u);return{width:i,height:a,x:l,y:c}}const rV=new Set(["absolute","fixed"]);function nV(e,t){const r=ki(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,i=jn(e)?Lo(e):wn(1),a=e.clientWidth*i.x,l=e.clientHeight*i.y,c=s*i.x,u=n*i.y;return{width:a,height:l,x:c,y:u}}function I_(e,t,r){let n;if(t==="viewport")n=tV(e,r);else if(t==="document")n=eV(_n(e));else if(rn(t))n=nV(t,r);else{const s=Q2(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return nf(n)}function eT(e,t){const r=Fs(e);return r===t||!rn(r)||ra(r)?!1:nn(r).position==="fixed"||eT(r,t)}function sV(e,t){const r=t.get(e);if(r)return r;let n=sc(e,[],!1).filter(l=>rn(l)&&va(l)!=="body"),s=null;const i=nn(e).position==="fixed";let a=i?Fs(e):e;for(;rn(a)&&!ra(a);){const l=nn(a),c=W0(a);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&rV.has(s.position)||$c(a)&&!c&&eT(e,a))?n=n.filter(f=>f!==a):s=l,a=Fs(a)}return t.set(e,n),n}function iV(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const a=[...r==="clippingAncestors"?ih(t)?[]:sV(t,this._c):[].concat(r),n],l=a[0],c=a.reduce((u,f)=>{const d=I_(t,f,s);return u.top=ar(d.top,u.top),u.right=Ls(d.right,u.right),u.bottom=Ls(d.bottom,u.bottom),u.left=ar(d.left,u.left),u},I_(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function oV(e){const{width:t,height:r}=X2(e);return{width:t,height:r}}function aV(e,t,r){const n=jn(t),s=_n(t),i=r==="fixed",a=ki(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=wn(0);function u(){c.x=ah(s)}if(n||!n&&!i)if((va(t)!=="body"||$c(s))&&(l=oh(t)),n){const m=ki(t,!0,i,t);c.x=m.x+t.clientLeft,c.y=m.y+t.clientTop}else s&&u();i&&!n&&s&&u();const f=s&&!n&&!i?Z2(s,l):wn(0),d=a.left+l.scrollLeft-c.x-f.x,h=a.top+l.scrollTop-c.y-f.y;return{x:d,y:h,width:a.width,height:a.height}}function nm(e){return nn(e).position==="static"}function O_(e,t){if(!jn(e)||nn(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return _n(e)===r&&(r=r.ownerDocument.body),r}function tT(e,t){const r=pr(e);if(ih(e))return r;if(!jn(e)){let s=Fs(e);for(;s&&!ra(s);){if(rn(s)&&!nm(s))return s;s=Fs(s)}return r}let n=O_(e,t);for(;n&&VU(n)&&nm(n);)n=O_(n,t);return n&&ra(n)&&nm(n)&&!W0(n)?r:n||KU(e)||r}const lV=async function(e){const t=this.getOffsetParent||tT,r=this.getDimensions,n=await r(e.floating);return{reference:aV(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function cV(e){return nn(e).direction==="rtl"}const uV={convertOffsetParentRelativeRectToViewportRelativeRect:QU,getDocumentElement:_n,getClippingRect:iV,getOffsetParent:tT,getElementRects:lV,getClientRects:ZU,getDimensions:oV,getScale:Lo,isElement:rn,isRTL:cV};function rT(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function dV(e,t){let r=null,n;const s=_n(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function a(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=e.getBoundingClientRect(),{left:f,top:d,width:h,height:m}=u;if(l||t(),!h||!m)return;const g=Nu(d),v=Nu(s.clientWidth-(f+h)),y=Nu(s.clientHeight-(d+m)),x=Nu(f),w={rootMargin:-g+"px "+-v+"px "+-y+"px "+-x+"px",threshold:ar(0,Ls(1,c))||1};let j=!0;function _(S){const N=S[0].intersectionRatio;if(N!==c){if(!j)return a();N?a(!1,N):n=setTimeout(()=>{a(!1,1e-7)},1e3)}N===1&&!rT(u,e.getBoundingClientRect())&&a(),j=!1}try{r=new IntersectionObserver(_,{...w,root:s.ownerDocument})}catch{r=new IntersectionObserver(_,w)}r.observe(e)}return a(!0),i}function nT(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=G0(e),f=s||i?[...u?sc(u):[],...sc(t)]:[];f.forEach(x=>{s&&x.addEventListener("scroll",r,{passive:!0}),i&&x.addEventListener("resize",r)});const d=u&&l?dV(u,r):null;let h=-1,m=null;a&&(m=new ResizeObserver(x=>{let[b]=x;b&&b.target===u&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var w;(w=m)==null||w.observe(t)})),r()}),u&&!c&&m.observe(u),m.observe(t));let g,v=c?ki(e):null;c&&y();function y(){const x=ki(e);v&&!rT(v,x)&&r(),v=x,g=requestAnimationFrame(y)}return r(),()=>{var x;f.forEach(b=>{s&&b.removeEventListener("scroll",r),i&&b.removeEventListener("resize",r)}),d==null||d(),(x=m)==null||x.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const fV=MU,hV=LU,pV=OU,mV=BU,gV=DU,D_=IU,vV=FU,xV=(e,t,r)=>{const n=new Map,s={platform:uV,...r},i={...s.platform,_c:n};return RU(e,t,{...s,platform:i})};var yV=typeof document<"u",bV=function(){},ud=yV?p.useLayoutEffect:bV;function sf(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!sf(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&e.$$typeof)&&!sf(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function sT(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function $_(e,t){const r=sT(e);return Math.round(t*r)/r}function sm(e){const t=p.useRef(e);return ud(()=>{t.current=e}),t}function iT(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:a}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[f,d]=p.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=p.useState(n);sf(h,n)||m(n);const[g,v]=p.useState(null),[y,x]=p.useState(null),b=p.useCallback(I=>{I!==S.current&&(S.current=I,v(I))},[]),w=p.useCallback(I=>{I!==N.current&&(N.current=I,x(I))},[]),j=i||g,_=a||y,S=p.useRef(null),N=p.useRef(null),E=p.useRef(f),C=c!=null,k=sm(c),L=sm(s),A=sm(u),R=p.useCallback(()=>{if(!S.current||!N.current)return;const I={placement:t,strategy:r,middleware:h};L.current&&(I.platform=L.current),xV(S.current,N.current,I).then(D=>{const $={...D,isPositioned:A.current!==!1};O.current&&!sf(E.current,$)&&(E.current=$,jr.flushSync(()=>{d($)}))})},[h,t,r,L,A]);ud(()=>{u===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,d(I=>({...I,isPositioned:!1})))},[u]);const O=p.useRef(!1);ud(()=>(O.current=!0,()=>{O.current=!1}),[]),ud(()=>{if(j&&(S.current=j),_&&(N.current=_),j&&_){if(k.current)return k.current(j,_,R);R()}},[j,_,R,k,C]);const z=p.useMemo(()=>({reference:S,floating:N,setReference:b,setFloating:w}),[b,w]),F=p.useMemo(()=>({reference:j,floating:_}),[j,_]),V=p.useMemo(()=>{const I={position:r,left:0,top:0};if(!F.floating)return I;const D=$_(F.floating,f.x),$=$_(F.floating,f.y);return l?{...I,transform:"translate("+D+"px, "+$+"px)",...sT(F.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:D,top:$}},[r,l,F.floating,f.x,f.y]);return p.useMemo(()=>({...f,update:R,refs:z,elements:F,floatingStyles:V}),[f,R,z,F,V])}const wV=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?D_({element:n.current,padding:s}).fn(r):{}:n?D_({element:n,padding:s}).fn(r):{}}}},oT=(e,t)=>({...fV(e),options:[e,t]}),aT=(e,t)=>({...hV(e),options:[e,t]}),lT=(e,t)=>({...vV(e),options:[e,t]}),cT=(e,t)=>({...pV(e),options:[e,t]}),uT=(e,t)=>({...mV(e),options:[e,t]}),dT=(e,t)=>({...gV(e),options:[e,t]}),fT=(e,t)=>({...wV(e),options:[e,t]});var jV="Arrow",hT=p.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...i}=e;return o.jsx(Re.svg,{...i,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:o.jsx("polygon",{points:"0,0 30,0 15,10"})})});hT.displayName=jV;var _V=hT;function K0(e){const[t,r]=p.useState(void 0);return Hn(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;a=u.inlineSize,l=u.blockSize}else a=e.offsetWidth,l=e.offsetHeight;r({width:a,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var Y0="Popper",[pT,lh]=sn(Y0),[SV,mT]=pT(Y0),gT=e=>{const{__scopePopper:t,children:r}=e,[n,s]=p.useState(null);return o.jsx(SV,{scope:t,anchor:n,onAnchorChange:s,children:r})};gT.displayName=Y0;var vT="PopperAnchor",xT=p.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,i=mT(vT,r),a=p.useRef(null),l=Fe(t,a),c=p.useRef(null);return p.useEffect(()=>{const u=c.current;c.current=(n==null?void 0:n.current)||a.current,u!==c.current&&i.onAnchorChange(c.current)}),n?null:o.jsx(Re.div,{...s,ref:l})});xT.displayName=vT;var J0="PopperContent",[NV,EV]=pT(J0),yT=p.forwardRef((e,t)=>{var Z,oe,H,q,te,ue;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:f=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:g,...v}=e,y=mT(J0,r),[x,b]=p.useState(null),w=Fe(t,_e=>b(_e)),[j,_]=p.useState(null),S=K0(j),N=(S==null?void 0:S.width)??0,E=(S==null?void 0:S.height)??0,C=n+(i!=="center"?"-"+i:""),k=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},L=Array.isArray(u)?u:[u],A=L.length>0,R={padding:k,boundary:L.filter(PV),altBoundary:A},{refs:O,floatingStyles:z,placement:F,isPositioned:V,middlewareData:I}=iT({strategy:"fixed",placement:C,whileElementsMounted:(..._e)=>nT(..._e,{animationFrame:m==="always"}),elements:{reference:y.anchor},middleware:[oT({mainAxis:s+E,alignmentAxis:a}),c&&aT({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?lT():void 0,...R}),c&&cT({...R}),uT({...R,apply:({elements:_e,rects:ke,availableWidth:dt,availableHeight:cn})=>{const{width:Nn,height:Ra}=ke.reference,rs=_e.floating.style;rs.setProperty("--radix-popper-available-width",`${dt}px`),rs.setProperty("--radix-popper-available-height",`${cn}px`),rs.setProperty("--radix-popper-anchor-width",`${Nn}px`),rs.setProperty("--radix-popper-anchor-height",`${Ra}px`)}}),j&&fT({element:j,padding:l}),TV({arrowWidth:N,arrowHeight:E}),h&&dT({strategy:"referenceHidden",...R})]}),[D,$]=jT(F),M=xr(g);Hn(()=>{V&&(M==null||M())},[V,M]);const W=(Z=I.arrow)==null?void 0:Z.x,U=(oe=I.arrow)==null?void 0:oe.y,X=((H=I.arrow)==null?void 0:H.centerOffset)!==0,[me,se]=p.useState();return Hn(()=>{x&&se(window.getComputedStyle(x).zIndex)},[x]),o.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:V?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[(q=I.transformOrigin)==null?void 0:q.x,(te=I.transformOrigin)==null?void 0:te.y].join(" "),...((ue=I.hide)==null?void 0:ue.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:o.jsx(NV,{scope:r,placedSide:D,onArrowChange:_,arrowX:W,arrowY:U,shouldHideArrow:X,children:o.jsx(Re.div,{"data-side":D,"data-align":$,...v,ref:w,style:{...v.style,animation:V?void 0:"none"}})})})});yT.displayName=J0;var bT="PopperArrow",CV={top:"bottom",right:"left",bottom:"top",left:"right"},wT=p.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,i=EV(bT,n),a=CV[i.placedSide];return o.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:o.jsx(_V,{...s,ref:r,style:{...s.style,display:"block"}})})});wT.displayName=bT;function PV(e){return e!==null}var TV=e=>({name:"transformOrigin",options:e,fn(t){var y,x,b;const{placement:r,rects:n,middlewareData:s}=t,a=((y=s.arrow)==null?void 0:y.centerOffset)!==0,l=a?0:e.arrowWidth,c=a?0:e.arrowHeight,[u,f]=jT(r),d={start:"0%",center:"50%",end:"100%"}[f],h=(((x=s.arrow)==null?void 0:x.x)??0)+l/2,m=(((b=s.arrow)==null?void 0:b.y)??0)+c/2;let g="",v="";return u==="bottom"?(g=a?d:`${h}px`,v=`${-c}px`):u==="top"?(g=a?d:`${h}px`,v=`${n.floating.height+c}px`):u==="right"?(g=`${-c}px`,v=a?d:`${m}px`):u==="left"&&(g=`${n.floating.width+c}px`,v=a?d:`${m}px`),{data:{x:g,y:v}}}});function jT(e){const[t,r="center"]=e.split("-");return[t,r]}var _T=gT,X0=xT,ST=yT,NT=wT,im="rovingFocusGroup.onEntryFocus",kV={bubbles:!1,cancelable:!0},Mc="RovingFocusGroup",[_v,ET,AV]=i0(Mc),[RV,CT]=sn(Mc,[AV]),[IV,OV]=RV(Mc),PT=p.forwardRef((e,t)=>o.jsx(_v.Provider,{scope:e.__scopeRovingFocusGroup,children:o.jsx(_v.Slot,{scope:e.__scopeRovingFocusGroup,children:o.jsx(DV,{...e,ref:t})})}));PT.displayName=Mc;var DV=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:f=!1,...d}=e,h=p.useRef(null),m=Fe(t,h),g=W2(i),[v,y]=Bi({prop:a,defaultProp:l??null,onChange:c,caller:Mc}),[x,b]=p.useState(!1),w=xr(u),j=ET(r),_=p.useRef(!1),[S,N]=p.useState(0);return p.useEffect(()=>{const E=h.current;if(E)return E.addEventListener(im,w),()=>E.removeEventListener(im,w)},[w]),o.jsx(IV,{scope:r,orientation:n,dir:g,loop:s,currentTabStopId:v,onItemFocus:p.useCallback(E=>y(E),[y]),onItemShiftTab:p.useCallback(()=>b(!0),[]),onFocusableItemAdd:p.useCallback(()=>N(E=>E+1),[]),onFocusableItemRemove:p.useCallback(()=>N(E=>E-1),[]),children:o.jsx(Re.div,{tabIndex:x||S===0?-1:0,"data-orientation":n,...d,ref:m,style:{outline:"none",...e.style},onMouseDown:xe(e.onMouseDown,()=>{_.current=!0}),onFocus:xe(e.onFocus,E=>{const C=!_.current;if(E.target===E.currentTarget&&C&&!x){const k=new CustomEvent(im,kV);if(E.currentTarget.dispatchEvent(k),!k.defaultPrevented){const L=j().filter(F=>F.focusable),A=L.find(F=>F.active),R=L.find(F=>F.id===v),z=[A,R,...L].filter(Boolean).map(F=>F.ref.current);AT(z,f)}}_.current=!1}),onBlur:xe(e.onBlur,()=>b(!1))})})}),TT="RovingFocusGroupItem",kT=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:i,children:a,...l}=e,c=bi(),u=i||c,f=OV(TT,r),d=f.currentTabStopId===u,h=ET(r),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:v}=f;return p.useEffect(()=>{if(n)return m(),()=>g()},[n,m,g]),o.jsx(_v.ItemSlot,{scope:r,id:u,focusable:n,active:s,children:o.jsx(Re.span,{tabIndex:d?0:-1,"data-orientation":f.orientation,...l,ref:t,onMouseDown:xe(e.onMouseDown,y=>{n?f.onItemFocus(u):y.preventDefault()}),onFocus:xe(e.onFocus,()=>f.onItemFocus(u)),onKeyDown:xe(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){f.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const x=LV(y,f.orientation,f.dir);if(x!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=h().filter(j=>j.focusable).map(j=>j.ref.current);if(x==="last")w.reverse();else if(x==="prev"||x==="next"){x==="prev"&&w.reverse();const j=w.indexOf(y.currentTarget);w=f.loop?FV(w,j+1):w.slice(j+1)}setTimeout(()=>AT(w))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:v!=null}):a})})});kT.displayName=TT;var $V={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function MV(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function LV(e,t,r){const n=MV(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return $V[n]}function AT(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function FV(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var BV=PT,zV=kT,UV=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Xi=new WeakMap,Eu=new WeakMap,Cu={},om=0,RT=function(e){return e&&(e.host||RT(e.parentNode))},VV=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=RT(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},qV=function(e,t,r,n){var s=VV(t,Array.isArray(e)?e:[e]);Cu[r]||(Cu[r]=new WeakMap);var i=Cu[r],a=[],l=new Set,c=new Set(s),u=function(d){!d||l.has(d)||(l.add(d),u(d.parentNode))};s.forEach(u);var f=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(h){if(l.has(h))f(h);else try{var m=h.getAttribute(n),g=m!==null&&m!=="false",v=(Xi.get(h)||0)+1,y=(i.get(h)||0)+1;Xi.set(h,v),i.set(h,y),a.push(h),v===1&&g&&Eu.set(h,!0),y===1&&h.setAttribute(r,"true"),g||h.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return f(t),l.clear(),om++,function(){a.forEach(function(d){var h=Xi.get(d)-1,m=i.get(d)-1;Xi.set(d,h),i.set(d,m),h||(Eu.has(d)||d.removeAttribute(n),Eu.delete(d)),m||d.removeAttribute(r)}),om--,om||(Xi=new WeakMap,Xi=new WeakMap,Eu=new WeakMap,Cu={})}},Lc=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=t||UV(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),qV(n,s,r,"aria-hidden")):function(){return null}},Sv=function(e,t){return Sv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Sv(e,t)};function IT(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Sv(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Qe=function(){return Qe=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Qe.apply(this,arguments)};function Sn(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function OT(e,t,r,n){var s=arguments.length,i=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(i=(s<3?a(i):s>3?a(t,r,i):a(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i}function DT(e,t){return function(r,n){t(r,n,e)}}function $T(e,t,r,n,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,f=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,h=!1,m=r.length-1;m>=0;m--){var g={};for(var v in n)g[v]=v==="access"?{}:n[v];for(var v in n.access)g.access[v]=n.access[v];g.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var y=(0,r[m])(l==="accessor"?{get:f.get,set:f.set}:f[c],g);if(l==="accessor"){if(y===void 0)continue;if(y===null||typeof y!="object")throw new TypeError("Object expected");(d=a(y.get))&&(f.get=d),(d=a(y.set))&&(f.set=d),(d=a(y.init))&&s.unshift(d)}else(d=a(y))&&(l==="field"?s.unshift(d):f[c]=d)}u&&Object.defineProperty(u,n.name,f),h=!0}function MT(e,t,r){for(var n=arguments.length>2,s=0;s<t.length;s++)r=n?t[s].call(e,r):t[s].call(e);return n?r:void 0}function LT(e){return typeof e=="symbol"?e:"".concat(e)}function FT(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function BT(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function ve(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{u(n.next(f))}catch(d){a(d)}}function c(f){try{u(n.throw(f))}catch(d){a(d)}}function u(f){f.done?i(f.value):s(f.value).then(l,c)}u((n=n.apply(e,t||[])).next())})}function zT(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(f){return c([u,f])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(f){u=[6,f],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var ch=Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function UT(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&ch(t,e,r)}function of(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Q0(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(l){a={error:l}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i}function VT(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Q0(arguments[t]));return e}function qT(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,s++)n[s]=i[a];return n}function Fc(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,i;n<s;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function na(e){return this instanceof na?(this.v=e,this):new na(e)}function WT(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(m){return function(g){return Promise.resolve(g).then(m,d)}}function l(m,g){n[m]&&(s[m]=function(v){return new Promise(function(y,x){i.push([m,v,y,x])>1||c(m,v)})},g&&(s[m]=g(s[m])))}function c(m,g){try{u(n[m](g))}catch(v){h(i[0][3],v)}}function u(m){m.value instanceof na?Promise.resolve(m.value.v).then(f,d):h(i[0][2],m)}function f(m){c("next",m)}function d(m){c("throw",m)}function h(m,g){m(g),i.shift(),i.length&&c(i[0][0],i[0][1])}}function HT(e){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,i){t[s]=e[s]?function(a){return(r=!r)?{value:na(e[s](a)),done:!1}:i?i(a):a}:i}}function GT(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof of=="function"?of(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=e[i]&&function(a){return new Promise(function(l,c){a=e[i](a),s(l,c,a.done,a.value)})}}function s(i,a,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},a)}}function KT(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var WV=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Nv=function(e){return Nv=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},Nv(e)};function YT(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Nv(e),n=0;n<r.length;n++)r[n]!=="default"&&ch(t,e,r[n]);return WV(t,e),t}function JT(e){return e&&e.__esModule?e:{default:e}}function XT(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function QT(e,t,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(e,r):s?s.value=r:t.set(e,r),r}function ZT(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function ek(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,s;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var HV=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function tk(e){function t(i){e.error=e.hasError?new HV(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}var r,n=0;function s(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(s);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(s,function(a){return t(a),s()})}else n|=1}catch(a){t(a)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return s()}function rk(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,s,i,a){return n?t?".jsx":".js":s&&(!i||!a)?r:s+i+"."+a.toLowerCase()+"js"}):e}const GV={__extends:IT,__assign:Qe,__rest:Sn,__decorate:OT,__param:DT,__esDecorate:$T,__runInitializers:MT,__propKey:LT,__setFunctionName:FT,__metadata:BT,__awaiter:ve,__generator:zT,__createBinding:ch,__exportStar:UT,__values:of,__read:Q0,__spread:VT,__spreadArrays:qT,__spreadArray:Fc,__await:na,__asyncGenerator:WT,__asyncDelegator:HT,__asyncValues:GT,__makeTemplateObject:KT,__importStar:YT,__importDefault:JT,__classPrivateFieldGet:XT,__classPrivateFieldSet:QT,__classPrivateFieldIn:ZT,__addDisposableResource:ek,__disposeResources:tk,__rewriteRelativeImportExtension:rk},KV=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:ek,get __assign(){return Qe},__asyncDelegator:HT,__asyncGenerator:WT,__asyncValues:GT,__await:na,__awaiter:ve,__classPrivateFieldGet:XT,__classPrivateFieldIn:ZT,__classPrivateFieldSet:QT,__createBinding:ch,__decorate:OT,__disposeResources:tk,__esDecorate:$T,__exportStar:UT,__extends:IT,__generator:zT,__importDefault:JT,__importStar:YT,__makeTemplateObject:KT,__metadata:BT,__param:DT,__propKey:LT,__read:Q0,__rest:Sn,__rewriteRelativeImportExtension:rk,__runInitializers:MT,__setFunctionName:FT,__spread:VT,__spreadArray:Fc,__spreadArrays:qT,__values:of,default:GV},Symbol.toStringTag,{value:"Module"}));var Fo="right-scroll-bar-position",Bo="width-before-scroll-bar",YV="with-scroll-bars-hidden",JV="--removed-body-scroll-bar-size";function am(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function XV(e,t){var r=p.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var QV=typeof window<"u"?p.useLayoutEffect:p.useEffect,M_=new WeakMap;function Z0(e,t){var r=XV(t||null,function(n){return e.forEach(function(s){return am(s,n)})});return QV(function(){var n=M_.get(r);if(n){var s=new Set(n),i=new Set(e),a=r.current;s.forEach(function(l){i.has(l)||am(l,null)}),i.forEach(function(l){s.has(l)||am(l,a)})}M_.set(r,e)},[e]),r}function ZV(e){return e}function e7(e,t){t===void 0&&(t=ZV);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var a=t(i,n);return r.push(a),function(){r=r.filter(function(l){return l!==a})}},assignSyncMedium:function(i){for(n=!0;r.length;){var a=r;r=[],a.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var a=[];if(r.length){var l=r;r=[],l.forEach(i),a=r}var c=function(){var f=a;a=[],f.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(f){a.push(f),u()},filter:function(f){return a=a.filter(f),r}}}};return s}function ey(e){e===void 0&&(e={});var t=e7(null);return t.options=Qe({async:!0,ssr:!1},e),t}var nk=function(e){var t=e.sideCar,r=Sn(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return p.createElement(n,Qe({},r))};nk.isSideCarExport=!0;function ty(e,t){return e.useMedium(t),nk}var sk=ey(),lm=function(){},uh=p.forwardRef(function(e,t){var r=p.useRef(null),n=p.useState({onScrollCapture:lm,onWheelCapture:lm,onTouchMoveCapture:lm}),s=n[0],i=n[1],a=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,f=e.enabled,d=e.shards,h=e.sideCar,m=e.noRelative,g=e.noIsolation,v=e.inert,y=e.allowPinchZoom,x=e.as,b=x===void 0?"div":x,w=e.gapMode,j=Sn(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=h,S=Z0([r,t]),N=Qe(Qe({},j),s);return p.createElement(p.Fragment,null,f&&p.createElement(_,{sideCar:sk,removeScrollBar:u,shards:d,noRelative:m,noIsolation:g,inert:v,setCallbacks:i,allowPinchZoom:!!y,lockRef:r,gapMode:w}),a?p.cloneElement(p.Children.only(l),Qe(Qe({},N),{ref:S})):p.createElement(b,Qe({},N,{className:c,ref:S}),l))});uh.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};uh.classNames={fullWidth:Bo,zeroRight:Fo};var L_,t7=function(){if(L_)return L_;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function r7(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=t7();return t&&e.setAttribute("nonce",t),e}function n7(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function s7(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var i7=function(){var e=0,t=null;return{add:function(r){e==0&&(t=r7())&&(n7(t,r),s7(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},o7=function(){var e=i7();return function(t,r){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},dh=function(){var e=o7(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},a7={left:0,top:0,right:0,gap:0},cm=function(e){return parseInt(e||"",10)||0},l7=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[cm(r),cm(n),cm(s)]},c7=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return a7;var t=l7(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},u7=dh(),zo="data-scroll-locked",d7=function(e,t,r,n){var s=e.left,i=e.top,a=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(YV,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(zo,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Fo,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Bo,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(Fo," .").concat(Fo,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Bo," .").concat(Bo,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(zo,`] {
    `).concat(JV,": ").concat(l,`px;
  }
`)},F_=function(){var e=parseInt(document.body.getAttribute(zo)||"0",10);return isFinite(e)?e:0},f7=function(){p.useEffect(function(){return document.body.setAttribute(zo,(F_()+1).toString()),function(){var e=F_()-1;e<=0?document.body.removeAttribute(zo):document.body.setAttribute(zo,e.toString())}},[])},ry=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;f7();var i=p.useMemo(function(){return c7(s)},[s]);return p.createElement(u7,{styles:d7(i,!t,s,r?"":"!important")})},Ev=!1;if(typeof window<"u")try{var Pu=Object.defineProperty({},"passive",{get:function(){return Ev=!0,!0}});window.addEventListener("test",Pu,Pu),window.removeEventListener("test",Pu,Pu)}catch{Ev=!1}var Qi=Ev?{passive:!1}:!1,h7=function(e){return e.tagName==="TEXTAREA"},ik=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!h7(e)&&r[t]==="visible")},p7=function(e){return ik(e,"overflowY")},m7=function(e){return ik(e,"overflowX")},B_=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=ok(e,n);if(s){var i=ak(e,n),a=i[1],l=i[2];if(a>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},g7=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},v7=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},ok=function(e,t){return e==="v"?p7(t):m7(t)},ak=function(e,t){return e==="v"?g7(t):v7(t)},x7=function(e,t){return e==="h"&&t==="rtl"?-1:1},y7=function(e,t,r,n,s){var i=x7(e,window.getComputedStyle(t).direction),a=i*n,l=r.target,c=t.contains(l),u=!1,f=a>0,d=0,h=0;do{if(!l)break;var m=ak(e,l),g=m[0],v=m[1],y=m[2],x=v-y-i*g;(g||x)&&ok(e,l)&&(d+=x,h+=g);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(f&&(s&&Math.abs(d)<1||!s&&a>d)||!f&&(s&&Math.abs(h)<1||!s&&-a>h))&&(u=!0),u},Tu=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},z_=function(e){return[e.deltaX,e.deltaY]},U_=function(e){return e&&"current"in e?e.current:e},b7=function(e,t){return e[0]===t[0]&&e[1]===t[1]},w7=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},j7=0,Zi=[];function _7(e){var t=p.useRef([]),r=p.useRef([0,0]),n=p.useRef(),s=p.useState(j7++)[0],i=p.useState(dh)[0],a=p.useRef(e);p.useEffect(function(){a.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var v=Fc([e.lockRef.current],(e.shards||[]).map(U_),!0).filter(Boolean);return v.forEach(function(y){return y.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),v.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(v,y){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!a.current.allowPinchZoom;var x=Tu(v),b=r.current,w="deltaX"in v?v.deltaX:b[0]-x[0],j="deltaY"in v?v.deltaY:b[1]-x[1],_,S=v.target,N=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in v&&N==="h"&&S.type==="range")return!1;var E=B_(N,S);if(!E)return!0;if(E?_=N:(_=N==="v"?"h":"v",E=B_(N,S)),!E)return!1;if(!n.current&&"changedTouches"in v&&(w||j)&&(n.current=_),!_)return!0;var C=n.current||_;return y7(C,y,v,C==="h"?w:j,!0)},[]),c=p.useCallback(function(v){var y=v;if(!(!Zi.length||Zi[Zi.length-1]!==i)){var x="deltaY"in y?z_(y):Tu(y),b=t.current.filter(function(_){return _.name===y.type&&(_.target===y.target||y.target===_.shadowParent)&&b7(_.delta,x)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(a.current.shards||[]).map(U_).filter(Boolean).filter(function(_){return _.contains(y.target)}),j=w.length>0?l(y,w[0]):!a.current.noIsolation;j&&y.cancelable&&y.preventDefault()}}},[]),u=p.useCallback(function(v,y,x,b){var w={name:v,delta:y,target:x,should:b,shadowParent:S7(x)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(j){return j!==w})},1)},[]),f=p.useCallback(function(v){r.current=Tu(v),n.current=void 0},[]),d=p.useCallback(function(v){u(v.type,z_(v),v.target,l(v,e.lockRef.current))},[]),h=p.useCallback(function(v){u(v.type,Tu(v),v.target,l(v,e.lockRef.current))},[]);p.useEffect(function(){return Zi.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",c,Qi),document.addEventListener("touchmove",c,Qi),document.addEventListener("touchstart",f,Qi),function(){Zi=Zi.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,Qi),document.removeEventListener("touchmove",c,Qi),document.removeEventListener("touchstart",f,Qi)}},[]);var m=e.removeScrollBar,g=e.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:w7(s)}):null,m?p.createElement(ry,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function S7(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const N7=ty(sk,_7);var lk=p.forwardRef(function(e,t){return p.createElement(uh,Qe({},e,{ref:t,sideCar:N7}))});lk.classNames=uh.classNames;const ny=lk;var Cv=["Enter"," "],E7=["ArrowDown","PageUp","Home"],ck=["ArrowUp","PageDown","End"],C7=[...E7,...ck],P7={ltr:[...Cv,"ArrowRight"],rtl:[...Cv,"ArrowLeft"]},T7={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Bc="Menu",[ic,k7,A7]=i0(Bc),[Vi,uk]=sn(Bc,[A7,lh,CT]),fh=lh(),dk=CT(),[R7,qi]=Vi(Bc),[I7,zc]=Vi(Bc),fk=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:s,onOpenChange:i,modal:a=!0}=e,l=fh(t),[c,u]=p.useState(null),f=p.useRef(!1),d=xr(i),h=W2(s);return p.useEffect(()=>{const m=()=>{f.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>f.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),o.jsx(_T,{...l,children:o.jsx(R7,{scope:t,open:r,onOpenChange:d,content:c,onContentChange:u,children:o.jsx(I7,{scope:t,onClose:p.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:f,dir:h,modal:a,children:n})})})};fk.displayName=Bc;var O7="MenuAnchor",sy=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=fh(r);return o.jsx(X0,{...s,...n,ref:t})});sy.displayName=O7;var iy="MenuPortal",[D7,hk]=Vi(iy,{forceMount:void 0}),pk=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:s}=e,i=qi(iy,t);return o.jsx(D7,{scope:t,forceMount:r,children:o.jsx(Br,{present:r||i.open,children:o.jsx(Pc,{asChild:!0,container:s,children:n})})})};pk.displayName=iy;var Or="MenuContent",[$7,oy]=Vi(Or),mk=p.forwardRef((e,t)=>{const r=hk(Or,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,i=qi(Or,e.__scopeMenu),a=zc(Or,e.__scopeMenu);return o.jsx(ic.Provider,{scope:e.__scopeMenu,children:o.jsx(Br,{present:n||i.open,children:o.jsx(ic.Slot,{scope:e.__scopeMenu,children:a.modal?o.jsx(M7,{...s,ref:t}):o.jsx(L7,{...s,ref:t})})})})}),M7=p.forwardRef((e,t)=>{const r=qi(Or,e.__scopeMenu),n=p.useRef(null),s=Fe(t,n);return p.useEffect(()=>{const i=n.current;if(i)return Lc(i)},[]),o.jsx(ay,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:xe(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),L7=p.forwardRef((e,t)=>{const r=qi(Or,e.__scopeMenu);return o.jsx(ay,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),F7=Ci("MenuContent.ScrollLock"),ay=p.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:d,onInteractOutside:h,onDismiss:m,disableOutsideScroll:g,...v}=e,y=qi(Or,r),x=zc(Or,r),b=fh(r),w=dk(r),j=k7(r),[_,S]=p.useState(null),N=p.useRef(null),E=Fe(t,N,y.onContentChange),C=p.useRef(0),k=p.useRef(""),L=p.useRef(0),A=p.useRef(null),R=p.useRef("right"),O=p.useRef(0),z=g?ny:p.Fragment,F=g?{as:F7,allowPinchZoom:!0}:void 0,V=D=>{var Z,oe;const $=k.current+D,M=j().filter(H=>!H.disabled),W=document.activeElement,U=(Z=M.find(H=>H.ref.current===W))==null?void 0:Z.textValue,X=M.map(H=>H.textValue),me=X7(X,$,U),se=(oe=M.find(H=>H.textValue===me))==null?void 0:oe.ref.current;(function H(q){k.current=q,window.clearTimeout(C.current),q!==""&&(C.current=window.setTimeout(()=>H(""),1e3))})($),se&&setTimeout(()=>se.focus())};p.useEffect(()=>()=>window.clearTimeout(C.current),[]),z0();const I=p.useCallback(D=>{var M,W;return R.current===((M=A.current)==null?void 0:M.side)&&Z7(D,(W=A.current)==null?void 0:W.area)},[]);return o.jsx($7,{scope:r,searchRef:k,onItemEnter:p.useCallback(D=>{I(D)&&D.preventDefault()},[I]),onItemLeave:p.useCallback(D=>{var $;I(D)||(($=N.current)==null||$.focus(),S(null))},[I]),onTriggerLeave:p.useCallback(D=>{I(D)&&D.preventDefault()},[I]),pointerGraceTimerRef:L,onPointerGraceIntentChange:p.useCallback(D=>{A.current=D},[]),children:o.jsx(z,{...F,children:o.jsx(nh,{asChild:!0,trapped:s,onMountAutoFocus:xe(i,D=>{var $;D.preventDefault(),($=N.current)==null||$.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:o.jsx(Cc,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:d,onInteractOutside:h,onDismiss:m,children:o.jsx(BV,{asChild:!0,...w,dir:x.dir,orientation:"vertical",loop:n,currentTabStopId:_,onCurrentTabStopIdChange:S,onEntryFocus:xe(c,D=>{x.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:o.jsx(ST,{role:"menu","aria-orientation":"vertical","data-state":Ak(y.open),"data-radix-menu-content":"",dir:x.dir,...b,...v,ref:E,style:{outline:"none",...v.style},onKeyDown:xe(v.onKeyDown,D=>{const M=D.target.closest("[data-radix-menu-content]")===D.currentTarget,W=D.ctrlKey||D.altKey||D.metaKey,U=D.key.length===1;M&&(D.key==="Tab"&&D.preventDefault(),!W&&U&&V(D.key));const X=N.current;if(D.target!==X||!C7.includes(D.key))return;D.preventDefault();const se=j().filter(Z=>!Z.disabled).map(Z=>Z.ref.current);ck.includes(D.key)&&se.reverse(),Y7(se)}),onBlur:xe(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(C.current),k.current="")}),onPointerMove:xe(e.onPointerMove,oc(D=>{const $=D.target,M=O.current!==D.clientX;if(D.currentTarget.contains($)&&M){const W=D.clientX>O.current?"right":"left";R.current=W,O.current=D.clientX}}))})})})})})})});mk.displayName=Or;var B7="MenuGroup",ly=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Re.div,{role:"group",...n,ref:t})});ly.displayName=B7;var z7="MenuLabel",gk=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Re.div,{...n,ref:t})});gk.displayName=z7;var af="MenuItem",V_="menu.itemSelect",hh=p.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...s}=e,i=p.useRef(null),a=zc(af,e.__scopeMenu),l=oy(af,e.__scopeMenu),c=Fe(t,i),u=p.useRef(!1),f=()=>{const d=i.current;if(!r&&d){const h=new CustomEvent(V_,{bubbles:!0,cancelable:!0});d.addEventListener(V_,m=>n==null?void 0:n(m),{once:!0}),o0(d,h),h.defaultPrevented?u.current=!1:a.onClose()}};return o.jsx(vk,{...s,ref:c,disabled:r,onClick:xe(e.onClick,f),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),u.current=!0},onPointerUp:xe(e.onPointerUp,d=>{var h;u.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:xe(e.onKeyDown,d=>{const h=l.searchRef.current!=="";r||h&&d.key===" "||Cv.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});hh.displayName=af;var vk=p.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...i}=e,a=oy(af,r),l=dk(r),c=p.useRef(null),u=Fe(t,c),[f,d]=p.useState(!1),[h,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),o.jsx(ic.ItemSlot,{scope:r,disabled:n,textValue:s??h,children:o.jsx(zV,{asChild:!0,...l,focusable:!n,children:o.jsx(Re.div,{role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:u,onPointerMove:xe(e.onPointerMove,oc(g=>{n?a.onItemLeave(g):(a.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:xe(e.onPointerLeave,oc(g=>a.onItemLeave(g))),onFocus:xe(e.onFocus,()=>d(!0)),onBlur:xe(e.onBlur,()=>d(!1))})})})}),U7="MenuCheckboxItem",xk=p.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...s}=e;return o.jsx(_k,{scope:e.__scopeMenu,checked:r,children:o.jsx(hh,{role:"menuitemcheckbox","aria-checked":lf(r)?"mixed":r,...s,ref:t,"data-state":uy(r),onSelect:xe(s.onSelect,()=>n==null?void 0:n(lf(r)?!0:!r),{checkForDefaultPrevented:!1})})})});xk.displayName=U7;var yk="MenuRadioGroup",[V7,q7]=Vi(yk,{value:void 0,onValueChange:()=>{}}),bk=p.forwardRef((e,t)=>{const{value:r,onValueChange:n,...s}=e,i=xr(n);return o.jsx(V7,{scope:e.__scopeMenu,value:r,onValueChange:i,children:o.jsx(ly,{...s,ref:t})})});bk.displayName=yk;var wk="MenuRadioItem",jk=p.forwardRef((e,t)=>{const{value:r,...n}=e,s=q7(wk,e.__scopeMenu),i=r===s.value;return o.jsx(_k,{scope:e.__scopeMenu,checked:i,children:o.jsx(hh,{role:"menuitemradio","aria-checked":i,...n,ref:t,"data-state":uy(i),onSelect:xe(n.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,r)},{checkForDefaultPrevented:!1})})})});jk.displayName=wk;var cy="MenuItemIndicator",[_k,W7]=Vi(cy,{checked:!1}),Sk=p.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...s}=e,i=W7(cy,r);return o.jsx(Br,{present:n||lf(i.checked)||i.checked===!0,children:o.jsx(Re.span,{...s,ref:t,"data-state":uy(i.checked)})})});Sk.displayName=cy;var H7="MenuSeparator",Nk=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Re.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});Nk.displayName=H7;var G7="MenuArrow",Ek=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=fh(r);return o.jsx(NT,{...s,...n,ref:t})});Ek.displayName=G7;var K7="MenuSub",[noe,Ck]=Vi(K7),al="MenuSubTrigger",Pk=p.forwardRef((e,t)=>{const r=qi(al,e.__scopeMenu),n=zc(al,e.__scopeMenu),s=Ck(al,e.__scopeMenu),i=oy(al,e.__scopeMenu),a=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:e.__scopeMenu},f=p.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return p.useEffect(()=>f,[f]),p.useEffect(()=>{const d=l.current;return()=>{window.clearTimeout(d),c(null)}},[l,c]),o.jsx(sy,{asChild:!0,...u,children:o.jsx(vk,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":Ak(r.open),...e,ref:zf(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:xe(e.onPointerMove,oc(d=>{i.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!r.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{r.onOpenChange(!0),f()},100))})),onPointerLeave:xe(e.onPointerLeave,oc(d=>{var m,g;f();const h=(m=r.content)==null?void 0:m.getBoundingClientRect();if(h){const v=(g=r.content)==null?void 0:g.dataset.side,y=v==="right",x=y?-5:5,b=h[y?"left":"right"],w=h[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:b,y:h.top},{x:w,y:h.top},{x:w,y:h.bottom},{x:b,y:h.bottom}],side:v}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:xe(e.onKeyDown,d=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&d.key===" "||P7[n.dir].includes(d.key)&&(r.onOpenChange(!0),(m=r.content)==null||m.focus(),d.preventDefault())})})})});Pk.displayName=al;var Tk="MenuSubContent",kk=p.forwardRef((e,t)=>{const r=hk(Or,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,i=qi(Or,e.__scopeMenu),a=zc(Or,e.__scopeMenu),l=Ck(Tk,e.__scopeMenu),c=p.useRef(null),u=Fe(t,c);return o.jsx(ic.Provider,{scope:e.__scopeMenu,children:o.jsx(Br,{present:n||i.open,children:o.jsx(ic.Slot,{scope:e.__scopeMenu,children:o.jsx(ay,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var d;a.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:xe(e.onFocusOutside,f=>{f.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:xe(e.onEscapeKeyDown,f=>{a.onClose(),f.preventDefault()}),onKeyDown:xe(e.onKeyDown,f=>{var m;const d=f.currentTarget.contains(f.target),h=T7[a.dir].includes(f.key);d&&h&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),f.preventDefault())})})})})})});kk.displayName=Tk;function Ak(e){return e?"open":"closed"}function lf(e){return e==="indeterminate"}function uy(e){return lf(e)?"indeterminate":e?"checked":"unchecked"}function Y7(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function J7(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function X7(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let a=J7(e,Math.max(i,0));s.length===1&&(a=a.filter(u=>u!==r));const c=a.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function Q7(e,t){const{x:r,y:n}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const l=t[i],c=t[a],u=l.x,f=l.y,d=c.x,h=c.y;f>n!=h>n&&r<(d-u)*(n-f)/(h-f)+u&&(s=!s)}return s}function Z7(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Q7(r,t)}function oc(e){return t=>t.pointerType==="mouse"?e(t):void 0}var e9=fk,t9=sy,r9=pk,n9=mk,s9=ly,i9=gk,o9=hh,a9=xk,l9=bk,c9=jk,u9=Sk,d9=Nk,f9=Ek,h9=Pk,p9=kk,ph="DropdownMenu",[m9,soe]=sn(ph,[uk]),Gt=uk(),[g9,Rk]=m9(ph),Ik=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:s,defaultOpen:i,onOpenChange:a,modal:l=!0}=e,c=Gt(t),u=p.useRef(null),[f,d]=Bi({prop:s,defaultProp:i??!1,onChange:a,caller:ph});return o.jsx(g9,{scope:t,triggerId:bi(),triggerRef:u,contentId:bi(),open:f,onOpenChange:d,onOpenToggle:p.useCallback(()=>d(h=>!h),[d]),modal:l,children:o.jsx(e9,{...c,open:f,onOpenChange:d,dir:n,modal:l,children:r})})};Ik.displayName=ph;var Ok="DropdownMenuTrigger",Dk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=e,i=Rk(Ok,r),a=Gt(r);return o.jsx(t9,{asChild:!0,...a,children:o.jsx(Re.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:zf(t,i.triggerRef),onPointerDown:xe(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:xe(e.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Dk.displayName=Ok;var v9="DropdownMenuPortal",$k=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Gt(t);return o.jsx(r9,{...n,...r})};$k.displayName=v9;var Mk="DropdownMenuContent",Lk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rk(Mk,r),i=Gt(r),a=p.useRef(!1);return o.jsx(n9,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:t,onCloseAutoFocus:xe(e.onCloseAutoFocus,l=>{var c;a.current||(c=s.triggerRef.current)==null||c.focus(),a.current=!1,l.preventDefault()}),onInteractOutside:xe(e.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,f=c.button===2||u;(!s.modal||f)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Lk.displayName=Mk;var x9="DropdownMenuGroup",y9=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(s9,{...s,...n,ref:t})});y9.displayName=x9;var b9="DropdownMenuLabel",Fk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(i9,{...s,...n,ref:t})});Fk.displayName=b9;var w9="DropdownMenuItem",Bk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(o9,{...s,...n,ref:t})});Bk.displayName=w9;var j9="DropdownMenuCheckboxItem",zk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(a9,{...s,...n,ref:t})});zk.displayName=j9;var _9="DropdownMenuRadioGroup",S9=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(l9,{...s,...n,ref:t})});S9.displayName=_9;var N9="DropdownMenuRadioItem",Uk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(c9,{...s,...n,ref:t})});Uk.displayName=N9;var E9="DropdownMenuItemIndicator",Vk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(u9,{...s,...n,ref:t})});Vk.displayName=E9;var C9="DropdownMenuSeparator",qk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(d9,{...s,...n,ref:t})});qk.displayName=C9;var P9="DropdownMenuArrow",T9=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(f9,{...s,...n,ref:t})});T9.displayName=P9;var k9="DropdownMenuSubTrigger",Wk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(h9,{...s,...n,ref:t})});Wk.displayName=k9;var A9="DropdownMenuSubContent",Hk=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Gt(r);return o.jsx(p9,{...s,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Hk.displayName=A9;var R9=Ik,I9=Dk,O9=$k,Gk=Lk,Kk=Fk,Yk=Bk,Jk=zk,Xk=Uk,Qk=Vk,Zk=qk,eA=Wk,tA=Hk;const rA=R9,nA=I9,D9=J.forwardRef(({className:e,inset:t,children:r,...n},s)=>o.jsxs(eA,{ref:s,className:he("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,o.jsx(Gn,{className:"ml-auto h-4 w-4"})]}));D9.displayName=eA.displayName;const $9=J.forwardRef(({className:e,...t},r)=>o.jsx(tA,{ref:r,className:he("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));$9.displayName=tA.displayName;const dy=J.forwardRef(({className:e,sideOffset:t=4,...r},n)=>o.jsx(O9,{children:o.jsx(Gk,{ref:n,sideOffset:t,className:he("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));dy.displayName=Gk.displayName;const ac=J.forwardRef(({className:e,inset:t,...r},n)=>o.jsx(Yk,{ref:n,className:he("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));ac.displayName=Yk.displayName;const M9=J.forwardRef(({className:e,children:t,checked:r,...n},s)=>o.jsxs(Jk,{ref:s,className:he("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Qk,{children:o.jsx(Mn,{className:"h-4 w-4"})})}),t]}));M9.displayName=Jk.displayName;const L9=J.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Xk,{ref:n,className:he("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Qk,{children:o.jsx(j3,{className:"h-2 w-2 fill-current"})})}),t]}));L9.displayName=Xk.displayName;const fy=J.forwardRef(({className:e,inset:t,...r},n)=>o.jsx(Kk,{ref:n,className:he("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));fy.displayName=Kk.displayName;const hy=J.forwardRef(({className:e,...t},r)=>o.jsx(Zk,{ref:r,className:he("-mx-1 my-1 h-px bg-muted",e),...t}));hy.displayName=Zk.displayName;function mh(){const[e,t]=p.useState({width:void 0,height:void 0});return p.useEffect(()=>{function r(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)},[]),e}const F9=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class py extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class B9 extends py{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class q_ extends py{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class W_ extends py{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Pv;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Pv||(Pv={}));class z9{constructor(t,{headers:r={},customFetch:n,region:s=Pv.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=F9(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return ve(this,arguments,void 0,function*(r,n={}){var s;let i,a;try{const{headers:l,method:c,body:u,signal:f,timeout:d}=n;let h={},{region:m}=n;m||(m=this.region);const g=new URL(`${this.url}/${r}`);m&&m!=="any"&&(h["x-region"]=m,g.searchParams.set("forceFunctionRegion",m));let v;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",v=u):typeof u=="string"?(h["Content-Type"]="text/plain",v=u):typeof FormData<"u"&&u instanceof FormData?v=u:(h["Content-Type"]="application/json",v=JSON.stringify(u)):v=u;let y=f;d&&(a=new AbortController,i=setTimeout(()=>a.abort(),d),f?(y=a.signal,f.addEventListener("abort",()=>a.abort())):y=a.signal);const x=yield this.fetch(g.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),l),body:v,signal:y}).catch(_=>{throw new B9(_)}),b=x.headers.get("x-relay-error");if(b&&b==="true")throw new q_(x);if(!x.ok)throw new W_(x);let w=((s=x.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),j;return w==="application/json"?j=yield x.json():w==="application/octet-stream"||w==="application/pdf"?j=yield x.blob():w==="text/event-stream"?j=x:w==="multipart/form-data"?j=yield x.formData():j=yield x.text(),{data:j,error:null,response:x}}catch(l){return{data:null,error:l,response:l instanceof W_||l instanceof q_?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var Bt={};const xa=R$(KV);var ku={},Au={},Ru={},Iu={},Ou={},Du={},H_;function sA(){if(H_)return Du;H_=1,Object.defineProperty(Du,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Du.default=e,Du}var G_;function iA(){if(G_)return Ou;G_=1,Object.defineProperty(Ou,"__esModule",{value:!0});const t=xa.__importDefault(sA());class r{constructor(s){var i,a;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(i=s.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=s.signal,this.isMaybeSingle=(a=s.isMaybeSingle)!==null&&a!==void 0?a:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=new Headers(this.headers),this.headers.set(s,i),this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,f,d,h;let m=null,g=null,v=null,y=c.status,x=c.statusText;if(c.ok){if(this.method!=="HEAD"){const _=await c.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?g=_:g=JSON.parse(_))}const w=(f=this.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),j=(d=c.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");w&&j&&j.length>1&&(v=parseInt(j[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(m={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,v=null,y=406,x="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const w=await c.text();try{m=JSON.parse(w),Array.isArray(m)&&c.status===404&&(g=[],m=null,y=200,x="OK")}catch{c.status===404&&w===""?(y=204,x="No Content"):m={message:w}}if(m&&this.isMaybeSingle&&(!((h=m==null?void 0:m.details)===null||h===void 0)&&h.includes("0 rows"))&&(m=null,y=200,x="OK"),m&&this.shouldThrowOnError)throw new t.default(m)}return{error:m,data:g,count:v,status:y,statusText:x}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,f,d;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(f=c==null?void 0:c.stack)!==null&&f!==void 0?f:""}`,hint:"",code:`${(d=c==null?void 0:c.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,i)}returns(){return this}overrideTypes(){return this}}return Ou.default=r,Ou}var K_;function oA(){if(K_)return Iu;K_=1,Object.defineProperty(Iu,"__esModule",{value:!0});const t=xa.__importDefault(iA());class r extends t.default{select(s){let i=!1;const a=(s??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:i=!0,nullsFirst:a,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",f=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${f?`${f},`:""}${s}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:a=i}={}){const l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,i,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(u,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:i=!1,settings:a=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var f;const d=[s?"analyze":null,i?"verbose":null,a?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${h}"; options=${d};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Iu.default=r,Iu}var Y_;function my(){if(Y_)return Ru;Y_=1,Object.defineProperty(Ru,"__esModule",{value:!0});const t=xa.__importDefault(oA()),r=new RegExp("[,()]");class n extends t.default{eq(i,a){return this.url.searchParams.append(i,`eq.${a}`),this}neq(i,a){return this.url.searchParams.append(i,`neq.${a}`),this}gt(i,a){return this.url.searchParams.append(i,`gt.${a}`),this}gte(i,a){return this.url.searchParams.append(i,`gte.${a}`),this}lt(i,a){return this.url.searchParams.append(i,`lt.${a}`),this}lte(i,a){return this.url.searchParams.append(i,`lte.${a}`),this}like(i,a){return this.url.searchParams.append(i,`like.${a}`),this}likeAllOf(i,a){return this.url.searchParams.append(i,`like(all).{${a.join(",")}}`),this}likeAnyOf(i,a){return this.url.searchParams.append(i,`like(any).{${a.join(",")}}`),this}ilike(i,a){return this.url.searchParams.append(i,`ilike.${a}`),this}ilikeAllOf(i,a){return this.url.searchParams.append(i,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(i,a){return this.url.searchParams.append(i,`ilike(any).{${a.join(",")}}`),this}is(i,a){return this.url.searchParams.append(i,`is.${a}`),this}in(i,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cs.{${a.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(a)}`),this}containedBy(i,a){return typeof a=="string"?this.url.searchParams.append(i,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(i,`cd.{${a.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(a)}`),this}rangeGt(i,a){return this.url.searchParams.append(i,`sr.${a}`),this}rangeGte(i,a){return this.url.searchParams.append(i,`nxl.${a}`),this}rangeLt(i,a){return this.url.searchParams.append(i,`sl.${a}`),this}rangeLte(i,a){return this.url.searchParams.append(i,`nxr.${a}`),this}rangeAdjacent(i,a){return this.url.searchParams.append(i,`adj.${a}`),this}overlaps(i,a){return typeof a=="string"?this.url.searchParams.append(i,`ov.${a}`):this.url.searchParams.append(i,`ov.{${a.join(",")}}`),this}textSearch(i,a,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${u}fts${f}.${a}`),this}match(i){return Object.entries(i).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(i,a,l){return this.url.searchParams.append(i,`not.${a}.${l}`),this}or(i,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,a,l){return this.url.searchParams.append(i,`${a}.${l}`),this}}return Ru.default=n,Ru}var J_;function aA(){if(J_)return Au;J_=1,Object.defineProperty(Au,"__esModule",{value:!0});const t=xa.__importDefault(my());class r{constructor(s,{headers:i={},schema:a,fetch:l}){this.url=s,this.headers=new Headers(i),this.schema=a,this.fetch=l}select(s,i){const{head:a=!1,count:l}=i??{},c=a?"HEAD":"GET";let u=!1;const f=(s??"*").split("").map(d=>/\s/.test(d)&&!u?"":(d==='"'&&(u=!u),d)).join("");return this.url.searchParams.set("select",f),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:i,defaultToNull:a=!0}={}){var l;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const u=s.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(u.length>0){const f=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",f.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:i,ignoreDuplicates:a=!1,count:l,defaultToNull:c=!0}={}){var u;const f="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((h,m)=>h.concat(Object.keys(m)),[]);if(d.length>0){const h=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(s,{count:i}={}){var a;const l="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:s}={}){var i;const a="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return Au.default=r,Au}var X_;function U9(){if(X_)return ku;X_=1,Object.defineProperty(ku,"__esModule",{value:!0});const e=xa,t=e.__importDefault(aA()),r=e.__importDefault(my());class n{constructor(i,{headers:a={},schema:l,fetch:c}={}){this.url=i,this.headers=new Headers(a),this.schemaName=l,this.fetch=c}from(i){const a=new URL(`${this.url}/${i}`);return new t.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new n(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,a={},{head:l=!1,get:c=!1,count:u}={}){var f;let d;const h=new URL(`${this.url}/rpc/${i}`);let m;l||c?(d=l?"HEAD":"GET",Object.entries(a).filter(([v,y])=>y!==void 0).map(([v,y])=>[v,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([v,y])=>{h.searchParams.append(v,y)})):(d="POST",m=a);const g=new Headers(this.headers);return u&&g.set("Prefer",`count=${u}`),new r.default({method:d,url:h,headers:g,schema:this.schemaName,body:m,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}}return ku.default=n,ku}Object.defineProperty(Bt,"__esModule",{value:!0});var lA=Bt.PostgrestError=xA=Bt.PostgrestBuilder=gA=Bt.PostgrestTransformBuilder=pA=Bt.PostgrestFilterBuilder=fA=Bt.PostgrestQueryBuilder=uA=Bt.PostgrestClient=void 0;const ya=xa,cA=ya.__importDefault(U9());var uA=Bt.PostgrestClient=cA.default;const dA=ya.__importDefault(aA());var fA=Bt.PostgrestQueryBuilder=dA.default;const hA=ya.__importDefault(my());var pA=Bt.PostgrestFilterBuilder=hA.default;const mA=ya.__importDefault(oA());var gA=Bt.PostgrestTransformBuilder=mA.default;const vA=ya.__importDefault(iA());var xA=Bt.PostgrestBuilder=vA.default;const yA=ya.__importDefault(sA());lA=Bt.PostgrestError=yA.default;var bA=Bt.default={PostgrestClient:cA.default,PostgrestQueryBuilder:dA.default,PostgrestFilterBuilder:hA.default,PostgrestTransformBuilder:mA.default,PostgrestBuilder:vA.default,PostgrestError:yA.default};const V9=rN({__proto__:null,get PostgrestBuilder(){return xA},get PostgrestClient(){return uA},get PostgrestError(){return lA},get PostgrestFilterBuilder(){return pA},get PostgrestQueryBuilder(){return fA},get PostgrestTransformBuilder(){return gA},default:bA},[Bt]),{PostgrestClient:q9,PostgrestQueryBuilder:ioe,PostgrestFilterBuilder:ooe,PostgrestTransformBuilder:aoe,PostgrestBuilder:loe,PostgrestError:coe}=bA||V9;class W9{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const H9="2.81.0",G9=`realtime-js/${H9}`,wA="1.0.0",K9="2.0.0",Q_=wA,Tv=1e4,Y9=1e3,J9=100;var oi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(oi||(oi={}));var ft;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ft||(ft={}));var Pr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Pr||(Pr={}));var kv;(function(e){e.websocket="websocket"})(kv||(kv={}));var ai;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ai||(ai={}));class X9{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(t,r){if(this._isArrayBuffer(t.payload))return r(this._binaryEncodePush(t));if(t.event===this.BROADCAST&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodePush(t){const{join_ref:r,ref:n,event:s,topic:i,payload:a}=t,l=this.META_LENGTH+r.length+n.length+i.length+s.length,c=new ArrayBuffer(this.HEADER_LENGTH+l);let u=new DataView(c),f=0;u.setUint8(f++,this.KINDS.push),u.setUint8(f++,r.length),u.setUint8(f++,n.length),u.setUint8(f++,i.length),u.setUint8(f++,s.length),Array.from(r,h=>u.setUint8(f++,h.charCodeAt(0))),Array.from(n,h=>u.setUint8(f++,h.charCodeAt(0))),Array.from(i,h=>u.setUint8(f++,h.charCodeAt(0))),Array.from(s,h=>u.setUint8(f++,h.charCodeAt(0)));var d=new Uint8Array(c.byteLength+a.byteLength);return d.set(new Uint8Array(c),0),d.set(new Uint8Array(a),c.byteLength),d.buffer}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const{join_ref:s,ref:i,topic:a}=t,l=t.payload.event,c=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0),u=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+i.length+a.length+l.length,f=new ArrayBuffer(this.HEADER_LENGTH+u);let d=new DataView(f),h=0;d.setUint8(h++,this.KINDS.userBroadcastPush),d.setUint8(h++,s.length),d.setUint8(h++,i.length),d.setUint8(h++,a.length),d.setUint8(h++,l.length),d.setUint8(h++,this.BINARY_ENCODING),Array.from(s,g=>d.setUint8(h++,g.charCodeAt(0))),Array.from(i,g=>d.setUint8(h++,g.charCodeAt(0))),Array.from(a,g=>d.setUint8(h++,g.charCodeAt(0))),Array.from(l,g=>d.setUint8(h++,g.charCodeAt(0)));var m=new Uint8Array(f.byteLength+c.byteLength);return m.set(new Uint8Array(f),0),m.set(new Uint8Array(c),f.byteLength),m.buffer}_encodeJsonUserBroadcastPush(t){var r,n;const{join_ref:s,ref:i,topic:a}=t,l=t.payload.event,c=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},f=new TextEncoder().encode(JSON.stringify(c)).buffer,d=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+i.length+a.length+l.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let m=new DataView(h),g=0;m.setUint8(g++,this.KINDS.userBroadcastPush),m.setUint8(g++,s.length),m.setUint8(g++,i.length),m.setUint8(g++,a.length),m.setUint8(g++,l.length),m.setUint8(g++,this.JSON_ENCODING),Array.from(s,y=>m.setUint8(g++,y.charCodeAt(0))),Array.from(i,y=>m.setUint8(g++,y.charCodeAt(0))),Array.from(a,y=>m.setUint8(g++,y.charCodeAt(0))),Array.from(l,y=>m.setUint8(g++,y.charCodeAt(0)));var v=new Uint8Array(h.byteLength+f.byteLength);return v.set(new Uint8Array(h),0),v.set(new Uint8Array(f),h.byteLength),v.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[s,i,a,l,c]=n;return r({join_ref:s,ref:i,topic:a,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.push:return this._decodePush(t,r,s);case this.KINDS.reply:return this._decodeReply(t,r,s);case this.KINDS.broadcast:return this._decodeBroadcast(t,r,s);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodePush(t,r,n){const s=r.getUint8(1),i=r.getUint8(2),a=r.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=n.decode(t.slice(l,l+s));l=l+s;const u=n.decode(t.slice(l,l+i));l=l+i;const f=n.decode(t.slice(l,l+a));l=l+a;const d=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{join_ref:c,ref:null,topic:u,event:f,payload:d}}_decodeReply(t,r,n){const s=r.getUint8(1),i=r.getUint8(2),a=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const u=n.decode(t.slice(c,c+s));c=c+s;const f=n.decode(t.slice(c,c+i));c=c+i;const d=n.decode(t.slice(c,c+a));c=c+a;const h=n.decode(t.slice(c,c+l));c=c+l;const m=JSON.parse(n.decode(t.slice(c,t.byteLength))),g={status:h,response:m};return{join_ref:u,ref:f,topic:d,event:Pr.reply,payload:g}}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let a=this.HEADER_LENGTH+2;const l=n.decode(t.slice(a,a+s));a=a+s;const c=n.decode(t.slice(a,a+i));a=a+i;const u=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:u}}_decodeUserBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2),a=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(t.slice(c,c+s));c=c+s;const f=n.decode(t.slice(c,c+i));c=c+i;const d=n.decode(t.slice(c,c+a));c=c+a;const h=t.slice(c,t.byteLength),m=l===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,g={type:this.BROADCAST,event:f,payload:m};return a>0&&(g.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST,payload:g}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class jA{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Be;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Be||(Be={}));const Z_=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,a)=>(i[a]=Q9(a,e,t,s),i),{}):{}},Q9=(e,t,r,n)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,a=r[e];return i&&!n.includes(i)?_A(i,a):Av(a)},_A=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return rq(t,r)}switch(e){case Be.bool:return Z9(t);case Be.float4:case Be.float8:case Be.int2:case Be.int4:case Be.int8:case Be.numeric:case Be.oid:return eq(t);case Be.json:case Be.jsonb:return tq(t);case Be.timestamp:return nq(t);case Be.abstime:case Be.date:case Be.daterange:case Be.int4range:case Be.int8range:case Be.money:case Be.reltime:case Be.text:case Be.time:case Be.timestamptz:case Be.timetz:case Be.tsrange:case Be.tstzrange:return Av(t);default:return Av(t)}},Av=e=>e,Z9=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},eq=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},tq=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},rq=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const a=e.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>_A(t,l))}return e},nq=e=>typeof e=="string"?e.replace(" ","T"):e,SA=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class um{constructor(t,r,n={},s=Tv){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var e1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(e1||(e1={}));class Cl{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Cl.syncState(this.state,s,i,a),this.pendingDiffs.forEach(c=>{this.state=Cl.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Cl.syncDiff(this.state,s,i,a),l())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),a=this.transformState(r),l={},c={};return this.map(i,(u,f)=>{a[u]||(c[u]=f)}),this.map(a,(u,f)=>{const d=i[u];if(d){const h=f.map(y=>y.presence_ref),m=d.map(y=>y.presence_ref),g=f.filter(y=>m.indexOf(y.presence_ref)<0),v=d.filter(y=>h.indexOf(y.presence_ref)<0);g.length>0&&(l[u]=g),v.length>0&&(c[u]=v)}else l[u]=f}),this.syncDiff(i,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const f=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),f.length>0){const d=t[l].map(m=>m.presence_ref),h=f.filter(m=>d.indexOf(m.presence_ref)<0);t[l].unshift(...h)}n(l,f,c)}),this.map(a,(l,c)=>{let u=t[l];if(!u)return;const f=c.map(d=>d.presence_ref);u=u.filter(d=>f.indexOf(d.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var t1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(t1||(t1={}));var Pl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Pl||(Pl={}));var Tn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Tn||(Tn={}));class gy{constructor(t,r={config:{}},n){var s,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=ft.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new um(this,Pr.join,this.params,this.timeout),this.rejoinTimer=new jA(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ft.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ft.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ft.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Pr.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new Cl(this),this.broadcastEndpointURL=SA(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==ft.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&s!==void 0?s:[],f=!!this.bindings[Pl.PRESENCE]&&this.bindings[Pl.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},h={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:f}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(Tn.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(Tn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var g;if(this.socket.setAuth(),m===void 0){t==null||t(Tn.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,y=(g=v==null?void 0:v.length)!==null&&g!==void 0?g:0,x=[];for(let b=0;b<y;b++){const w=v[b],{filter:{event:j,schema:_,table:S,filter:N}}=w,E=m&&m[b];if(E&&E.event===j&&E.schema===_&&E.table===S&&E.filter===N)x.push(Object.assign(Object.assign({},w),{id:E.id}));else{this.unsubscribe(),this.state=ft.errored,t==null||t(Tn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(Tn.SUBSCRIBED);return}}).receive("error",m=>{this.state=ft.errored,t==null||t(Tn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Tn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===ft.joined&&t===Pl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var s;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ft.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Pr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new um(this,Pr.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ft.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new um(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>J9){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const a=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:f}=Pr;if(n&&[l,c,u,f].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var g,v,y;return((g=m.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(v=m.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===a}).map(m=>m.callback(h,n)):(i=this.bindings[a])===null||i===void 0||i.filter(m=>{var g,v,y,x,b,w;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const j=m.id,_=(g=m.filter)===null||g===void 0?void 0:g.event;return j&&((v=r.ids)===null||v===void 0?void 0:v.includes(j))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const j=(b=(x=m==null?void 0:m.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return j==="*"||j===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:v,table:y,commit_timestamp:x,type:b,errors:w}=g;h=Object.assign(Object.assign({},{schema:v,table:y,commit_timestamp:x,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(g))}m.callback(h,n)})}_isClosed(){return this.state===ft.closed}_isJoined(){return this.state===ft.joined}_isJoining(){return this.state===ft.joining}_isLeaving(){return this.state===ft.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&gy.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Pr.close,{},t)}_onError(t){this._on(Pr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ft.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Z_(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Z_(t.columns,t.old_record)),r}}const dm=()=>{},$u={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},sq=[1e3,2e3,5e3,1e4],iq=1e4,oq=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class aq{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Tv,this.transport=null,this.heartbeatIntervalMs=$u.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=dm,this.ref=0,this.reconnectTimer=null,this.vsn=Q_,this.logger=dm,this.conn=null,this.sendBuffer=[],this.serializer=new X9,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${kv.websocket}`,this.httpEndpoint=SA(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=W9.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case oi.connecting:return ai.Connecting;case oi.open:return ai.Open;case oi.closing:return ai.Closing;default:return ai.Closed}}isConnected(){return this.connectionState()===ai.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new gy(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,a=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Y9,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},$u.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:a}=r,l=a?`(${a})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,i,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){if(this.conn){if(this.conn.readyState===oi.open||this.conn.readyState===oi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Pr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([oq],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:G9};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Pr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new jA(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$u.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,i,a,l,c,u,f,d,h,m;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Tv,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:$u.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:dm,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Q_,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:g=>sq[g-1]||iq,this.vsn){case wA:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:(g,v)=>v(JSON.stringify(g)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:(g,v)=>v(JSON.parse(g));break;case K9:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class vy extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Ze(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class lq extends vy{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Rv extends vy{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const xy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),cq=()=>Response,Iv=e=>{if(Array.isArray(e))return e.map(r=>Iv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Iv(n)}),t},uq=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},fm=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},dq=(e,t,r)=>ve(void 0,void 0,void 0,function*(){const n=yield cq();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const i=e.status||500,a=(s==null?void 0:s.statusCode)||i+"";t(new lq(fm(s),i,a))}).catch(s=>{t(new Rv(fm(s),s))}):t(new Rv(fm(e),e))}),fq=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(uq(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function Uc(e,t,r,n,s,i){return ve(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(r,fq(t,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>dq(c,l,n))})})}function lc(e,t,r,n){return ve(this,void 0,void 0,function*(){return Uc(e,"GET",t,r,n)})}function Gr(e,t,r,n,s){return ve(this,void 0,void 0,function*(){return Uc(e,"POST",t,n,s,r)})}function Ov(e,t,r,n,s){return ve(this,void 0,void 0,function*(){return Uc(e,"PUT",t,n,s,r)})}function hq(e,t,r,n){return ve(this,void 0,void 0,function*(){return Uc(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function yy(e,t,r,n,s){return ve(this,void 0,void 0,function*(){return Uc(e,"DELETE",t,n,s,r)})}class pq{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return ve(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ze(t))return{data:null,error:t};throw t}})}}var NA;class mq{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[NA]="BlobDownloadBuilder",this.promise=null}asStream(){return new pq(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return ve(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Ze(t))return{data:null,error:t};throw t}})}}NA=Symbol.toStringTag;const gq=mq,vq={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},r1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xq{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=xy(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return ve(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},r1),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",a.cacheControl),c&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!a.duplex&&(a.duplex="half")),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),f=this._getFinalPath(u),d=yield(t=="PUT"?Ov:Gr)(this.fetch,`${this.url}/object/${f}`,i,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ze(i))return{data:null,error:i};throw i}})}upload(t,r,n){return ve(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return ve(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),a=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:r1.upsert},s),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);const d=yield Ov(this.fetch,l.toString(),c,{headers:f});return{data:{path:i,fullPath:d.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Ze(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return ve(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield Gr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),l=a.searchParams.get("token");if(!l)throw new vy("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ze(n))return{data:null,error:n};throw n}})}update(t,r,n){return ve(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return ve(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ze(s))return{data:null,error:s};throw s}})}copy(t,r,n){return ve(this,void 0,void 0,function*(){try{return{data:{path:(yield Gr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ze(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return ve(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield Gr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ze(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return ve(this,void 0,void 0,function*(){try{const s=yield Gr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ze(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=i?`?${i}`:"",l=this._getFinalPath(t),c=()=>lc(this.fetch,`${this.url}/${s}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new gq(c,this.shouldThrowOnError)}info(t){return ve(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield lc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Iv(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ze(n))return{data:null,error:n};throw n}})}exists(t){return ve(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield hq(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ze(n)&&n instanceof Rv){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return ve(this,void 0,void 0,function*(){try{return{data:yield yy(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ze(r))return{data:null,error:r};throw r}})}list(t,r,n){return ve(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},vq),r),{prefix:t||""});return{data:yield Gr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ze(s))return{data:null,error:s};throw s}})}listV2(t,r){return ve(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Gr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ze(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const EA="2.81.0",CA={"X-Client-Info":`storage-js/${EA}`};class yq{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const i=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},CA),r),this.fetch=xy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return ve(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield lc(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ze(r))return{data:null,error:r};throw r}})}getBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield lc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ze(r))return{data:null,error:r};throw r}})}createBucket(t){return ve(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Gr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ze(s))return{data:null,error:s};throw s}})}updateBucket(t,r){return ve(this,void 0,void 0,function*(){try{return{data:yield Ov(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ze(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ze(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield yy(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ze(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class bq{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},CA),r),this.fetch=xy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ze(r))return{data:null,error:r};throw r}})}listBuckets(t){return ve(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield lc(this.fetch,s,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ze(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield yy(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ze(r))return{data:null,error:r};throw r}})}}const by={"X-Client-Info":`storage-js/${EA}`,"Content-Type":"application/json"};class PA extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function lr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class hm extends PA{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class wq extends PA{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var n1;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(n1||(n1={}));const wy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),jq=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},s1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_q=(e,t,r)=>ve(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e.status||500,i=e;if(typeof i.json=="function")i.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||s+"";t(new hm(s1(a),s,l))}).catch(()=>{const a=s+"",l=i.statusText||`HTTP ${s} error`;t(new hm(l,s,a))});else{const a=s+"",l=i.statusText||`HTTP ${s} error`;t(new hm(l,s,a))}}else t(new wq(s1(e),e))}),Sq=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(jq(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),r))};function Nq(e,t,r,n,s,i){return ve(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(r,Sq(t,n,s,i)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>a(c)).catch(c=>_q(c,l,n))})})}function cr(e,t,r,n,s){return ve(this,void 0,void 0,function*(){return Nq(e,"POST",t,n,s,r)})}class Eq{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},by),r),this.fetch=wy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return ve(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}getIndex(t,r){return ve(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(lr(n))return{data:null,error:n};throw n}})}listIndexes(t){return ve(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return ve(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(lr(n))return{data:null,error:n};throw n}})}}class Cq{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},by),r),this.fetch=wy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return ve(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield cr(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}getVectors(t){return ve(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}listVectors(t){return ve(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield cr(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}queryVectors(t){return ve(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}deleteVectors(t){return ve(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield cr(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}}class Pq{constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},by),r),this.fetch=wy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}getBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:yield cr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}listBuckets(){return ve(this,arguments,void 0,function*(t={}){try{return{data:yield cr(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ve(this,void 0,void 0,function*(){try{return{data:(yield cr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(lr(r))return{data:null,error:r};throw r}})}}class Tq extends Pq{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new kq(this.url,this.headers,t,this.fetch)}}class kq extends Eq{constructor(t,r,n,s){super(t,r,s),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return ve(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return ve(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return ve(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return ve(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new Aq(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class Aq extends Cq{constructor(t,r,n,s,i){super(t,r,i),this.vectorBucketName=n,this.indexName=s}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return ve(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return ve(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return ve(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return ve(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return ve(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Rq extends yq{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new xq(this.url,this.headers,t,this.fetch)}get vectors(){return new Tq(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new bq(this.url+"/iceberg",this.headers,this.fetch)}}const Iq="2.81.0";let ll="";typeof Deno<"u"?ll="deno":typeof document<"u"?ll="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ll="react-native":ll="node";const Oq={"X-Client-Info":`supabase-js-${ll}/${Iq}`},Dq={headers:Oq},$q={schema:"public"},Mq={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Lq={},Fq=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Bq=()=>Headers,zq=(e,t,r)=>{const n=Fq(r),s=Bq();return async(i,a)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new s(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},a),{headers:u}))}};function Uq(e){return e.endsWith("/")?e:e+"/"}function Vq(e,t){var r,n;const{db:s,auth:i,realtime:a,global:l}=e,{db:c,auth:u,realtime:f,global:d}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},f),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function qq(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Uq(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const TA="2.81.0",co=30*1e3,Dv=3,pm=Dv*co,Wq="http://localhost:9999",Hq="supabase.auth.token",Gq={"X-Client-Info":`gotrue-js/${TA}`},$v="X-Supabase-Api-Version",kA={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Kq=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Yq=10*60*1e3;class cc extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function be(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Jq extends cc{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Xq(e){return be(e)&&e.name==="AuthApiError"}class li extends cc{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ws extends cc{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class qr extends Ws{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Qq(e){return be(e)&&e.name==="AuthSessionMissingError"}class eo extends Ws{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mu extends Ws{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Lu extends Ws{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Zq(e){return be(e)&&e.name==="AuthImplicitGrantRedirectError"}class i1 extends Ws{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Mv extends Ws{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function mm(e){return be(e)&&e.name==="AuthRetryableFetchError"}class o1 extends Ws{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Lv extends Ws{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const cf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),a1=` 	
\r=`.split(""),eW=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<a1.length;t+=1)e[a1[t].charCodeAt(0)]=-2;for(let t=0;t<cf.length;t+=1)e[cf[t].charCodeAt(0)]=t;return e})();function l1(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(cf[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(cf[n]),t.queuedBits-=6}}function AA(e,t,r){const n=eW[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function c1(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{nW(a,n,r)};for(let a=0;a<e.length;a+=1)AA(e.charCodeAt(a),s,i);return t.join("")}function tW(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function rW(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}tW(n,t)}}function nW(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Uo(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)AA(e.charCodeAt(s),r,n);return new Uint8Array(t)}function sW(e){const t=[];return rW(e,r=>t.push(r)),new Uint8Array(t)}function pi(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>l1(s,r,n)),l1(null,r,n),t.join("")}function iW(e){return Math.round(Date.now()/1e3)+e}function oW(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const kt=()=>typeof window<"u"&&typeof document<"u",Ys={tested:!1,writable:!1},RA=()=>{if(!kt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ys.tested)return Ys.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ys.tested=!0,Ys.writable=!0}catch{Ys.tested=!0,Ys.writable=!1}return Ys.writable};function aW(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const IA=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),lW=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",uo=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Js=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},is=async(e,t)=>{await e.removeItem(t)};class gh{constructor(){this.promise=new gh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}gh.promiseConstructor=Promise;function gm(e){const t=e.split(".");if(t.length!==3)throw new Lv("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Kq.test(t[n]))throw new Lv("JWT not in base64url format");return{header:JSON.parse(c1(t[0])),payload:JSON.parse(c1(t[1])),signature:Uo(t[2]),raw:{header:t[0],payload:t[1]}}}async function cW(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function uW(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await e(i);if(!t(i,null,a)){n(a);return}}catch(a){if(!t(i,a)){s(a);return}}})()})}function dW(e){return("0"+e.toString(16)).substr(-2)}function fW(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,dW).join("")}async function hW(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function pW(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await hW(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function to(e,t,r=!1){const n=fW();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await uo(e,`${t}-code-verifier`,s);const i=await pW(n);return[i,n===i?"plain":"s256"]}const mW=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gW(e){const t=e.headers.get($v);if(!t||!t.match(mW))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function vW(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function xW(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const yW=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ro(e){if(!yW.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function vm(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function bW(e,t){return new Proxy(e,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,s)}})}function u1(e){return JSON.parse(JSON.stringify(e))}const ni=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),wW=[502,503,504];async function d1(e){var t;if(!lW(e))throw new Mv(ni(e),0);if(wW.includes(e.status))throw new Mv(ni(e),e.status);let r;try{r=await e.json()}catch(i){throw new li(ni(i),i)}let n;const s=gW(e);if(s&&s.getTime()>=kA["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new o1(ni(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new qr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new o1(ni(r),e.status,r.weak_password.reasons);throw new Jq(ni(r),e.status||500,n)}const jW=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Se(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[$v]||(i[$v]=kA["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await _W(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function _W(e,t,r,n,s,i){const a=jW(t,n,s,i);let l;try{l=await e(r,Object.assign({},a))}catch(c){throw console.error(c),new Mv(ni(c),0)}if(l.ok||await d1(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await d1(c)}}function Wr(e){var t;let r=null;EW(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=iW(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function f1(e){const t=Wr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ps(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function SW(e){return{data:e,error:null}}function NW(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,a=Sn(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function h1(e){return e}function EW(e){return e.access_token&&e.refresh_token&&e.expires_in}const xm=["global","local","others"];class CW{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=IA(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=xm[0]){if(xm.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${xm.join(", ")}`);try{return await Se(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Se(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ps})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Sn(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:NW,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(be(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Se(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ps})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},f=await Se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:h1});if(f.error)throw f.error;const d=await f.json(),h=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(g=>{const v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);u[`${y}Page`]=v}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(be(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){ro(t);try{return await Se(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ps})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ro(t);try{return await Se(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ps})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ro(t);try{return await Se(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ps})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ro(t.userId);try{const{data:r,error:n}=await Se(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ro(t.userId),ro(t.id);try{return{data:await Se(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,i,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},f=await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:h1});if(f.error)throw f.error;const d=await f.json(),h=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(c=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(g=>{const v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);u[`${y}Page`]=v}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(be(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Se(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Se(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}}function p1(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const no={debug:!!(globalThis&&RA()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class OA extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class PW extends OA{}async function TW(e,t,r){no.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),no.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){no.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{no.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw no.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new PW(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(no.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function kW(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function DA(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function AW(e){return parseInt(e,16)}function RW(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function IW(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:i=new Date,nonce:a,notBefore:l,requestId:c,resources:u,scheme:f,uri:d,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=DA(e.address),g=f?`${f}://${n}`:n,v=e.statement?`${e.statement}
`:"",y=`${g} wants you to sign in with your Ethereum account:
${m}

${v}`;let x=`URI: ${d}
Version: ${h}
Chain ID: ${r}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(s&&(x+=`
Expiration Time: ${s.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),u){let b=`
Resources:`;for(const w of u){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);b+=`
- ${w}`}x+=b}return`${y}
${x}`}class lt extends Error{constructor({message:t,code:r,cause:n,name:s}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=s??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class uf extends lt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function OW({error:e,options:t}){var r,n,s;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new lt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new lt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new lt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new lt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new lt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new lt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new lt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new lt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if($A(a)){if(i.rp.id!==a)return new lt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new lt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new lt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new lt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new lt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function DW({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new lt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new lt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if($A(n)){if(r.rpId!==n)return new lt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new lt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new lt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new lt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class $W{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const MW=new $W;function LW(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=Sn(e,["challenge","user","excludeCredentials"]),i=Uo(t).buffer,a=Object.assign(Object.assign({},r),{id:Uo(r.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:i,user:a});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:Uo(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function FW(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Sn(e,["challenge","allowCredentials"]),s=Uo(t).buffer,i=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let a=0;a<r.length;a++){const l=r[a];i.allowCredentials[a]=Object.assign(Object.assign({},l),{id:Uo(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function BW(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:pi(new Uint8Array(e.response.attestationObject)),clientDataJSON:pi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function zW(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:pi(new Uint8Array(s.authenticatorData)),clientDataJSON:pi(new Uint8Array(s.clientDataJSON)),signature:pi(new Uint8Array(s.signature)),userHandle:s.userHandle?pi(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function $A(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function m1(){var e,t;return!!(kt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function UW(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new uf("Browser returned unexpected credential type",t)}:{data:null,error:new uf("Empty credential response",t)}}catch(t){return{data:null,error:OW({error:t,options:e})}}}async function VW(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new uf("Browser returned unexpected credential type",t)}:{data:null,error:new uf("Empty credential response",t)}}catch(t){return{data:null,error:DW({error:t,options:e})}}}const qW={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},WW={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function df(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const i in s){const a=s[i];if(a!==void 0)if(Array.isArray(a))n[i]=a;else if(r(a))n[i]=a;else if(t(a)){const l=n[i];t(l)?n[i]=df(l,a):n[i]=df(a)}else n[i]=a}return n}function HW(e,t){return df(qW,e,t||{})}function GW(e,t){return df(WW,e,t||{})}class KW{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},i){try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!a)return{data:null,error:l};const c=s??MW.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=HW(a.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:f,error:d}=await UW({publicKey:u,signal:c});return f?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}case"request":{const u=GW(a.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:f,error:d}=await VW(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:c}));return f?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}}}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new li("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new cc("rpId is required for WebAuthn authentication")};try{if(!m1())return{data:null,error:new li("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:i});if(!a)return{data:null,error:l};const{webauthn:c}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new li("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new cc("rpId is required for WebAuthn registration")};try{if(!m1())return{data:null,error:new li("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(f=>{var d;return(d=f.data)===null||d===void 0?void 0:d.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:i});return c?this._verify({factorId:a.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new li("Unexpected error in register",a)}}}}kW();const YW={url:Wq,storageKey:Hq,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Gq,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function g1(e,t,r){return await r()}const so={};class uc{get jwks(){var t,r;return(r=(t=so[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){so[this.storageKey]=Object.assign(Object.assign({},so[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=so[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){so[this.storageKey]=Object.assign(Object.assign({},so[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},YW),t);if(this.storageKey=i.storageKey,this.instanceID=(r=uc.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,uc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&kt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new CW({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=IA(i.fetch),this.lock=i.lock||g1,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:kt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=TW:this.lock=g1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new KW(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:RA()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=p1(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=p1(this.memoryStorage)),kt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${TA}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(kt()&&(r=aW(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),kt()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Zq(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return be(r)?this._returnResult({error:r}):this._returnResult({error:new li("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Wr}),{data:a,error:l}=i;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(be(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:f,password:d,options:h}=t;let m=null,g=null;this.flowType==="pkce"&&([m,g]=await to(this.storage,this.storageKey)),i=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:g},xform:Wr})}else if("phone"in t){const{phone:f,password:d,options:h}=t;i=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Wr})}else throw new Mu("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(be(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:a,options:l}=t;r=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:f1})}else if("phone"in t){const{phone:i,password:a,options:l}=t;r=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:f1})}else throw new Mu("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const i=new eo;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,i,a,l,c,u,f,d,h;let m,g;if("message"in t)m=t.message,g=t.signature;else{const{chain:v,wallet:y,statement:x,options:b}=t;let w;if(kt())if(typeof y=="object")w=y;else{const C=window;if("ethereum"in C&&typeof C.ethereum=="object"&&"request"in C.ethereum&&typeof C.ethereum.request=="function")w=C.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const j=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href),_=await w.request({method:"eth_requestAccounts"}).then(C=>C).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=DA(_[0]);let N=(n=b==null?void 0:b.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!N){const C=await w.request({method:"eth_chainId"});N=AW(C)}const E={domain:j.host,address:S,statement:x,uri:j.href,version:"1",chainId:N,nonce:(s=b==null?void 0:b.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(i=b==null?void 0:b.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=b==null?void 0:b.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=b==null?void 0:b.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=b==null?void 0:b.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(f=b==null?void 0:b.signInWithEthereum)===null||f===void 0?void 0:f.resources};m=IW(E),g=await w.request({method:"personal_sign",params:[RW(m),S]})}try{const{data:v,error:y}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:g},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Wr});if(y)throw y;if(!v||!v.session||!v.user){const x=new eo;return this._returnResult({data:{user:null,session:null},error:x})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:y})}catch(v){if(be(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(t){var r,n,s,i,a,l,c,u,f,d,h,m;let g,v;if("message"in t)g=t.message,v=t.signature;else{const{chain:y,wallet:x,statement:b,options:w}=t;let j;if(kt())if(typeof x=="object")j=x;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))j=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=x}const _=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const S=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),b?{statement:b}:null));let N;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")N=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)N=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)g=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),v=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${_.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(s=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((d=(f=w==null?void 0:w.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...w.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const S=await j.signMessage(new TextEncoder().encode(g),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=S}}try{const{data:y,error:x}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:pi(v)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Wr});if(x)throw x;if(!y||!y.session||!y.user){const b=new eo;return this._returnResult({data:{user:null,session:null},error:b})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:x})}catch(y){if(be(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async _exchangeCodeForSession(t){const r=await Js(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:a}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Wr});if(await is(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!i||!i.session||!i.user){const l=new eo;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(be(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=t,l=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Wr}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const f=new eo;return this._returnResult({data:{user:null,session:null},error:f})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,s,i,a;try{if("email"in t){const{email:l,options:c}=t;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await to(this.storage,this.storageKey));const{error:d}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:f}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f})}throw new Mu("You must provide either an email or phone number.")}catch(l){if(be(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:l}=await Se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Wr});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(be(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,a=null;this.flowType==="pkce"&&([i,a]=await to(this.storage,this.storageKey));const l=await Se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:SW});return this._returnResult(l)}catch(i){if(be(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new qr;const{error:s}=await Se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(be(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:a}=await Se(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:a,error:l}=await Se(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l})}throw new Mu("You must provide either an email or phone number and a type")}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Js(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<pm:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await Js(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=vm()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=bW(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ps}):await this._useSession(async r=>{var n,s,i;const{data:a,error:l}=r;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new qr}:await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:ps})})}catch(r){if(be(r))return Qq(r)&&(await this._removeSession(),await is(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new qr;const a=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await to(this.storage,this.storageKey));const{data:u,error:f}=await Se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:ps});if(f)throw f;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(be(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new qr;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=gm(t.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(be(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:l}=r;if(l)throw l;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new qr;const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!kt())throw new Lu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Lu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new i1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Lu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new i1("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!a||!u)throw new Lu("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(l);let h=f+d;c&&(h=parseInt(c));const m=h-f;m*1e3<=co&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const g=h-d;f-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,f):f-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,f);const{data:v,error:y}=await this._getUser(i);if(y)throw y;const x={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:h,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(be(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Js(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({error:i});const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:l}=await this.admin.signOut(a,t);if(l&&!(Xq(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await is(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=oW(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await to(this.storage,this.storageKey,!0));try{return await Se(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(be(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,l,c,u,f;const{data:d,error:h}=i;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Se(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(s)throw s;return kt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(be(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:i}}=r;if(s)throw s;const{options:a,provider:l,token:c,access_token:u,nonce:f}=t,d=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Wr}),{data:h,error:m}=d;return m?this._returnResult({data:{user:null,session:null},error:m}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new eo}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:m}))}catch(s){if(be(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await Se(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await uW(async s=>(s>0&&await cW(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Wr})),(s,i)=>{const a=200*Math.pow(2,s);return i&&mm(i)&&Date.now()+a-n<co})}catch(n){if(this._debug(r,"error",n),be(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),kt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Js(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Js(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await uo(this.userStorage,this.storageKey+"-user",a)),s.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:vm()}else if(s&&!s.user&&!s.user){const a=await Js(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(s.user=a.user,await is(this.storage,this.storageKey+"-user"),await uo(this.storage,this.storageKey,s)):s.user=vm()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<pm;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${pm}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),mm(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(s.access_token);!l&&(a!=null&&a.user)?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new qr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new gh;const{data:i,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!i.session)throw new qr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),be(i)){const a={data:null,error:i};return mm(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await uo(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=u1(s);await uo(this.storage,this.storageKey,i)}else{const s=u1(r);await uo(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await is(this.storage,this.storageKey),await is(this.storage,this.storageKey+"-code-verifier"),await is(this.storage,this.storageKey+"-user"),this.userStorage&&await is(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&kt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),co);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/co);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${co}ms, refresh threshold is ${Dv} ticks`),s<=Dv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof OA)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await to(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?this._returnResult({data:null,error:i}):await Se(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await Se(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?BW(t.webauthn.credential_response):zW(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await Se(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const a=await Se(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:LW(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:FW(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=gm(n.access_token);let a=null;i.aal&&(a=i.aal);let l=a;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await Se(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new qr})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new qr});const a=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&kt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(be(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new qr});const a=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&kt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(n){if(be(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+Yq>s)return n;const{data:i,error:a}=await Se(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:g}=await this.getSession();if(g||!m.session)return this._returnResult({data:null,error:g});n=m.session.access_token}const{header:s,payload:i,signature:a,raw:{header:l,payload:c}}=gm(n);r!=null&&r.allowExpired||vW(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:i,header:s,signature:a},error:null}}const f=xW(s.alg),d=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,a,sW(`${l}.${c}`)))throw new Lv("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(be(n))return this._returnResult({data:null,error:n});throw n}}}uc.nextInstanceID={};const JW=uc;class XW extends JW{constructor(t){super(t)}}class QW{constructor(t,r,n){var s,i,a;this.supabaseUrl=t,this.supabaseKey=r;const l=qq(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:$q,realtime:Lq,auth:Object.assign(Object.assign({},Mq),{storageKey:c}),global:Dq},f=Vq(n??{},u);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=zq(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new q9(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new Rq(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new z9(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:a,flowType:l,lock:c,debug:u,throwOnError:f},d,h){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new XW({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),d),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,flowType:l,lock:c,debug:u,throwOnError:f,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new aq(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ZW=(e,t,r)=>new QW(e,t,r);function eH(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}eH()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const MA={}.VITE_SUPABASE_URL,LA={}.VITE_SUPABASE_ANON_KEY;if(!MA||!LA)throw new Error("Missing Supabase environment variables. Please check your .env file.");const T=ZW(MA,LA,{auth:{storage:window.localStorage,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit",storageKey:"sb-yscwpxwgnhqbhkqzipag-auth-token"},db:{schema:"public"}}),v1={debug:"#6366f1",info:"#3b82f6",warn:"#f59e0b",error:"#ef4444"},x1=()=>new Date().toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3}),P={debug:(...e)=>{},info:(...e)=>{},warn:(...e)=>{console.warn(`%c[${x1()}] WARN`,`color: ${v1.warn}; font-weight: bold`,...e)},error:(...e)=>{console.error(`%c[${x1()}] ERROR`,`color: ${v1.error}; font-weight: bold`,...e)}},FA=p.createContext(null),tH=({children:e})=>{const[t,r]=p.useState([]),[n,s]=p.useState(!0),[i,a]=p.useState(null),[l,c]=p.useState(null),u=p.useCallback(async()=>{try{s(!0),a(null);const{data:{session:d}}=await T.auth.getSession();if(!d){P.debug("UsersContext: No active session, skipping fetch"),r([]),s(!1);return}const{data:h,error:m}=await T.rpc("get_accessible_users");if(m)throw P.error("UsersContext RPC error:",m),m;P.debug("UsersContext loaded",{count:(h==null?void 0:h.length)||0}),r(h||[]),c(new Date)}catch(d){P.error(" UsersContext fetch error:",d),a(d.message)}finally{s(!1)}},[]);p.useEffect(()=>{u()},[u]),p.useEffect(()=>{const{data:{subscription:d}}=T.auth.onAuthStateChange(h=>{h==="SIGNED_IN"?u():h==="SIGNED_OUT"&&(r([]),c(null))});return()=>d.unsubscribe()},[u]);const f={users:t,loading:n,error:i,refetch:u,lastFetch:l};return o.jsx(FA.Provider,{value:f,children:e})},jy=()=>{const e=p.useContext(FA);return e||{users:[],loading:!0,error:null,refetch:()=>{},lastFetch:null}};function sa(e){"@babel/helpers - typeof";return sa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sa(e)}function on(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function It(e){on(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||sa(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var rH={};function nH(){return rH}function y1(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function dd(e,t){on(2,arguments);var r=It(e),n=It(t),s=r.getTime()-n.getTime();return s<0?-1:s>0?1:s}function sH(e,t){on(2,arguments);var r=It(e),n=It(t),s=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return s*12+i}function iH(e,t){return on(2,arguments),It(e).getTime()-It(t).getTime()}var b1={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},oH="trunc";function aH(e){return e?b1[e]:b1[oH]}function lH(e){on(1,arguments);var t=It(e);return t.setHours(23,59,59,999),t}function cH(e){on(1,arguments);var t=It(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function uH(e){on(1,arguments);var t=It(e);return lH(t).getTime()===cH(t).getTime()}function dH(e,t){on(2,arguments);var r=It(e),n=It(t),s=dd(r,n),i=Math.abs(sH(r,n)),a;if(i<1)a=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-s*i);var l=dd(r,n)===-s;uH(It(e))&&i===1&&dd(e,n)===1&&(l=!1),a=s*(i-Number(l))}return a===0?0:a}function fH(e,t,r){on(2,arguments);var n=iH(e,t)/1e3;return aH(r==null?void 0:r.roundingMethod)(n)}var hH={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},pH=function(t,r,n){var s,i=hH[t];return typeof i=="string"?s=i:r===1?s=i.one:s=i.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};const mH=pH;function Vo(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var gH={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},vH={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},xH={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},yH={date:Vo({formats:gH,defaultWidth:"full"}),time:Vo({formats:vH,defaultWidth:"full"}),dateTime:Vo({formats:xH,defaultWidth:"full"})};const bH=yH;var wH={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},jH=function(t,r,n,s){return wH[t]};const _H=jH;function pn(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",s;if(n==="formatting"&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,a=r!=null&&r.width?String(r.width):i;s=e.formattingValues[a]||e.formattingValues[i]}else{var l=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[c]||e.values[l]}var u=e.argumentCallback?e.argumentCallback(t):t;return s[u]}}var SH={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},NH={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},EH={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},CH={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},PH={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},TH={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kH=function(t,r){var n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},AH={ordinalNumber:kH,era:pn({values:SH,defaultWidth:"wide"}),quarter:pn({values:NH,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:pn({values:EH,defaultWidth:"wide"}),day:pn({values:CH,defaultWidth:"wide"}),dayPeriod:pn({values:PH,defaultWidth:"wide",formattingValues:TH,defaultFormattingWidth:"wide"})};const RH=AH;function mn(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;var a=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?OH(l,function(d){return d.test(a)}):IH(l,function(d){return d.test(a)}),u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;var f=t.slice(a.length);return{value:u,rest:f}}}function IH(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function OH(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function BA(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var s=n[0],i=t.match(e.parsePattern);if(!i)return null;var a=e.valueCallback?e.valueCallback(i[0]):i[0];a=r.valueCallback?r.valueCallback(a):a;var l=t.slice(s.length);return{value:a,rest:l}}}var DH=/^(\d+)(th|st|nd|rd)?/i,$H=/\d+/i,MH={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},LH={any:[/^b/i,/^(a|c)/i]},FH={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},BH={any:[/1/i,/2/i,/3/i,/4/i]},zH={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},UH={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},VH={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},qH={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},WH={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},HH={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},GH={ordinalNumber:BA({matchPattern:DH,parsePattern:$H,valueCallback:function(t){return parseInt(t,10)}}),era:mn({matchPatterns:MH,defaultMatchWidth:"wide",parsePatterns:LH,defaultParseWidth:"any"}),quarter:mn({matchPatterns:FH,defaultMatchWidth:"wide",parsePatterns:BH,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:mn({matchPatterns:zH,defaultMatchWidth:"wide",parsePatterns:UH,defaultParseWidth:"any"}),day:mn({matchPatterns:VH,defaultMatchWidth:"wide",parsePatterns:qH,defaultParseWidth:"any"}),dayPeriod:mn({matchPatterns:WH,defaultMatchWidth:"any",parsePatterns:HH,defaultParseWidth:"any"})};const KH=GH;var YH={code:"en-US",formatDistance:mH,formatLong:bH,formatRelative:_H,localize:RH,match:KH,options:{weekStartsOn:0,firstWeekContainsDate:1}};const JH=YH;function zA(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function XH(e){return zA({},e)}var w1=1440,QH=2520,ym=43200,ZH=86400;function eG(e,t,r){var n,s;on(2,arguments);var i=nH(),a=(n=(s=r==null?void 0:r.locale)!==null&&s!==void 0?s:i.locale)!==null&&n!==void 0?n:JH;if(!a.formatDistance)throw new RangeError("locale must contain formatDistance property");var l=dd(e,t);if(isNaN(l))throw new RangeError("Invalid time value");var c=zA(XH(r),{addSuffix:!!(r!=null&&r.addSuffix),comparison:l}),u,f;l>0?(u=It(t),f=It(e)):(u=It(e),f=It(t));var d=fH(f,u),h=(y1(f)-y1(u))/1e3,m=Math.round((d-h)/60),g;if(m<2)return r!=null&&r.includeSeconds?d<5?a.formatDistance("lessThanXSeconds",5,c):d<10?a.formatDistance("lessThanXSeconds",10,c):d<20?a.formatDistance("lessThanXSeconds",20,c):d<40?a.formatDistance("halfAMinute",0,c):d<60?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",1,c):m===0?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",m,c);if(m<45)return a.formatDistance("xMinutes",m,c);if(m<90)return a.formatDistance("aboutXHours",1,c);if(m<w1){var v=Math.round(m/60);return a.formatDistance("aboutXHours",v,c)}else{if(m<QH)return a.formatDistance("xDays",1,c);if(m<ym){var y=Math.round(m/w1);return a.formatDistance("xDays",y,c)}else if(m<ZH)return g=Math.round(m/ym),a.formatDistance("aboutXMonths",g,c)}if(g=dH(f,u),g<12){var x=Math.round(m/ym);return a.formatDistance("xMonths",x,c)}else{var b=g%12,w=Math.floor(g/12);return b<3?a.formatDistance("aboutXYears",w,c):b<9?a.formatDistance("overXYears",w,c):a.formatDistance("almostXYears",w+1,c)}}function UA(e,t){return on(1,arguments),eG(e,Date.now(),t)}function tG(e,t){if(sa(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(sa(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rG(e){var t=tG(e,"string");return sa(t)=="symbol"?t:t+""}function nG(e,t,r){return(t=rG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var sG={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},iG=function(t,r,n){var s,i=sG[t];return typeof i=="string"?s=i:r===1?s=i.one:s=i.other.replace("{{count}}",String(r)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"dans "+s:"il y a "+s:s};const oG=iG;var aG={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},lG={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},cG={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},uG={date:Vo({formats:aG,defaultWidth:"full"}),time:Vo({formats:lG,defaultWidth:"full"}),dateTime:Vo({formats:cG,defaultWidth:"full"})};const dG=uG;var fG={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},hG=function(t,r,n,s){return fG[t]};const pG=hG;var mG={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},gG={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},vG={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},xG={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},yG={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},bG=function(t,r){var n=Number(t),s=r==null?void 0:r.unit;if(n===0)return"0";var i=["year","week","hour","minute","second"],a;return n===1?a=s&&i.includes(s)?"re":"er":a="me",n+a},wG={ordinalNumber:bG,era:pn({values:mG,defaultWidth:"wide"}),quarter:pn({values:gG,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:pn({values:vG,defaultWidth:"wide"}),day:pn({values:xG,defaultWidth:"wide"}),dayPeriod:pn({values:yG,defaultWidth:"wide"})};const jG=wG;var _G=/^(\d+)(ime|re|me|er|e)?/i,SG=/\d+/i,NG={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},EG={any:[/^av/i,/^ap/i]},CG={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},PG={any:[/1/i,/2/i,/3/i,/4/i]},TG={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},kG={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},AG={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},RG={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},IG={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},OG={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},DG={ordinalNumber:BA({matchPattern:_G,parsePattern:SG,valueCallback:function(t){return parseInt(t)}}),era:mn({matchPatterns:NG,defaultMatchWidth:"wide",parsePatterns:EG,defaultParseWidth:"any"}),quarter:mn({matchPatterns:CG,defaultMatchWidth:"wide",parsePatterns:PG,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:mn({matchPatterns:TG,defaultMatchWidth:"wide",parsePatterns:kG,defaultParseWidth:"any"}),day:mn({matchPatterns:AG,defaultMatchWidth:"wide",parsePatterns:RG,defaultParseWidth:"any"}),dayPeriod:mn({matchPatterns:IG,defaultMatchWidth:"any",parsePatterns:OG,defaultParseWidth:"any"})};const $G=DG;var MG={code:"fr",formatDistance:oG,formatLong:dG,formatRelative:pG,localize:jG,match:$G,options:{weekStartsOn:1,firstWeekContainsDate:4}};const VA=MG,LG=[{name:"Pipeline",path:"/admin/pipeline",icon:p0,adminOnly:!1},{name:"Agenda",path:"/admin/agenda",icon:h0,adminOnly:!1},{name:"Contacts",path:"/admin/contacts",icon:Pi,adminOnly:!1},{name:"Charly AI",path:"/admin/charly",icon:Xl,adminOnly:!1},{name:"Workflow V2",path:"/admin/workflow-v2-config",icon:ov,adminOnly:!0},{name:"Configuration IA",path:"/admin/configuration-ia",icon:hP,adminOnly:!0},{name:"Landing Page",path:"/admin/landing-page",icon:k3,adminOnly:!0}],FG=()=>{const{width:e}=mh(),t=e<768,[r,n]=p.useState(!1),{notifications:s,markNotificationAsRead:i,activeAdminUser:a,switchActiveAdminUser:l,brandName:c,logoUrl:u}=Ve();jy();const f=Te();Bf();const d=p.useMemo(()=>{const y=(a==null?void 0:a.role)==="Global Admin"||(a==null?void 0:a.role)==="Admin"||(a==null?void 0:a.role)==="platform_admin";return LG.filter(x=>!x.adminOnly||y)},[a==null?void 0:a.role]),h=s.filter(y=>!y.read),m=J.useMemo(()=>{const y={};return h.forEach(x=>{const b=x.projectName===" Message partenaire",w=x.projectName===" Message interne",j=`${x.prospectId}-${x.projectType}${b?"-partner":w?"-internal":""}`;y[j]||(y[j]={prospectId:x.prospectId,prospectName:x.prospectName,projectType:x.projectType,projectName:x.projectName,notifications:[],totalCount:0,latestTimestamp:x.timestamp}),y[j].notifications.push(x),y[j].totalCount+=x.count||1,new Date(x.timestamp)>new Date(y[j].latestTimestamp)&&(y[j].latestTimestamp=x.timestamp)}),Object.values(y).sort((x,b)=>new Date(b.latestTimestamp)-new Date(x.latestTimestamp))},[h]),g=y=>{y.notifications.forEach(j=>{i(j.id)});const x=y.projectName===" Message partenaire",b=y.projectName===" Message interne",w=x?"&channel=partner":b?"&channel=internal":"";f(`/admin/pipeline?project=${y.projectType}&prospect=${y.prospectId}${w}`)},v=()=>o.jsx(Ti,{children:r&&o.jsx(le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm",onClick:()=>n(!1),children:o.jsxs(le.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 right-0 bottom-0 w-4/5 max-w-sm bg-background p-6 shadow-xl",onClick:y=>y.stopPropagation(),children:[o.jsxs("div",{className:"flex justify-between items-center mb-8",children:[o.jsx("span",{className:"font-bold text-xl",children:"Menu Pro"}),o.jsx(G,{variant:"ghost",size:"icon",onClick:()=>n(!1),children:o.jsx(es,{className:"h-6 w-6"})})]}),o.jsxs("nav",{className:"flex flex-col space-y-2",children:[d.map(y=>o.jsxs(Ud,{to:y.path,onClick:()=>n(!1),className:({isActive:x})=>`flex items-center space-x-3 p-3 rounded-lg text-lg font-medium transition-colors ${x?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(y.icon,{className:"h-6 w-6"}),o.jsx("span",{children:y.name})]},y.name)),o.jsx("div",{className:"pt-4 mt-4 border-t",children:o.jsxs(xi,{to:"/admin/parametres",onClick:()=>n(!1),className:"flex items-center space-x-3 p-3 rounded-lg text-lg font-medium transition-colors text-gray-600 hover:bg-gray-50",children:[o.jsx(hP,{className:"h-6 w-6"}),o.jsx("span",{children:"Paramtres"})]})})]})]})})});return o.jsx(o.Fragment,{children:o.jsxs(le.header,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"bg-background/80 backdrop-blur-md shadow-sm sticky top-0 z-40 border-b border-gray-100",children:[o.jsx("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex items-center justify-between h-16",children:[o.jsx("div",{className:"flex items-center space-x-4",children:o.jsx(xi,{to:"/admin",className:"flex items-center",children:o.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[c||"Admin"," ",o.jsx("span",{className:"font-light text-blue-600",children:"Pro"})]})})}),o.jsx("nav",{className:"hidden md:flex items-center space-x-2 bg-gray-100 p-1 rounded-full",children:d.map(y=>o.jsxs(Ud,{to:y.path,className:({isActive:x})=>`flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium transition-colors ${x?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:bg-gray-200"}`,children:[o.jsx(y.icon,{className:"h-4 w-4"}),o.jsx("span",{children:y.name})]},y.name))}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs(rA,{children:[o.jsx(nA,{asChild:!0,children:o.jsxs(G,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-gray-100 relative",children:[o.jsx(Wd,{className:"h-5 w-5 text-gray-600"}),m.length>0&&o.jsx("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs font-bold text-white",children:m.reduce((y,x)=>y+x.totalCount,0)})]})}),o.jsxs(dy,{align:"end",className:"w-80",children:[o.jsx(fy,{children:"Notifications"}),o.jsx(hy,{}),m.length>0?m.map((y,x)=>o.jsx(ac,{onClick:()=>g(y),className:"cursor-pointer",children:o.jsxs("div",{className:"flex items-start space-x-3 py-2 w-full",children:[y.projectName===" Message interne"?o.jsx("div",{className:"bg-purple-100 rounded-full p-2",children:o.jsx(Mo,{className:"h-4 w-4 text-purple-600"})}):y.projectName===" Message partenaire"?o.jsx("div",{className:"bg-orange-100 rounded-full p-2",children:o.jsx(Mo,{className:"h-4 w-4 text-orange-600"})}):o.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:o.jsx(Mo,{className:"h-4 w-4 text-blue-600"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-800",children:y.projectName===" Message interne"?y.totalCount>1?` ${y.totalCount} messages internes  ${y.prospectName}`:` Message interne  ${y.prospectName}`:y.projectName===" Message partenaire"?y.totalCount>1?` ${y.totalCount} messages partenaire  ${y.prospectName}`:` Message partenaire  ${y.prospectName}`:y.totalCount>1?`${y.totalCount} nouveaux messages de ${y.prospectName}`:`Nouveau message de ${y.prospectName}`}),o.jsxs("p",{className:"text-xs text-gray-500",children:["Projet: ",y.projectType]}),o.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(y.latestTimestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]})]})},`${y.prospectId}-${y.projectType}-${x}`)):o.jsx(ac,{disabled:!0,children:o.jsx("div",{className:"text-center text-sm text-gray-500 py-4",children:"Aucune nouvelle notification"})})]})]}),o.jsx(xi,{to:"/admin/profil",children:o.jsx("div",{className:"w-8 h-8 gradient-green rounded-full flex items-center justify-center cursor-pointer",children:o.jsx(Ac,{className:"h-4 w-4 text-white"})})}),t&&o.jsx(G,{variant:"ghost",size:"icon",onClick:()=>n(!0),className:"rounded-full hover:bg-gray-100",children:o.jsx(dP,{className:"h-6 w-6"})})]})]})}),t&&o.jsx(v,{})]})})},BG=()=>{const e=t=>{B({title:` Action rapide "${t}" non implmente.`,description:"Vous pouvez demander son dveloppement ! "})};return o.jsxs("div",{className:"w-full flex-shrink-0 bg-white rounded-3xl shadow-soft flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-20 bg-gradient-to-br from-teal-400 to-green-500 rounded-t-3xl"}),o.jsx("div",{className:"relative pt-6 px-6 flex justify-center",children:o.jsx("div",{className:"w-28 h-28 rounded-full border-4 border-white shadow-lg overflow-hidden flex items-center justify-center",children:o.jsx("img",{className:"w-full h-auto object-contain rounded-full",alt:"Avatar de Charly, conseiller virtuel Evatime",src:"https://horizons-cdn.hostinger.com/43725989-d002-4543-b65c-278701925e7e/4e3f809791e357819f31c585852d3a99.png"})})})]}),o.jsxs("div",{className:"p-4 text-center",children:[o.jsx("h3",{className:"font-bold text-lg text-gray-900",children:"Bonjour "}),o.jsx("p",{className:"text-gray-600 text-xs",children:"Je suis Charly, enchant de vous connaitre !!  Posez-moi une question ou lancez une action."})]}),o.jsxs("div",{className:"px-4 grid grid-cols-2 gap-2",children:[o.jsxs(G,{variant:"outline",className:"flex items-center justify-start space-x-2 text-xs h-9",onClick:()=>e("RDV"),children:[o.jsx(h0,{className:"h-4 w-4 text-blue-500"})," ",o.jsx("span",{children:"RDV"})]}),o.jsxs(G,{variant:"outline",className:"flex items-center justify-start space-x-2 text-xs h-9",onClick:()=>e("Appel"),children:[o.jsx(kc,{className:"h-4 w-4 text-green-500"})," ",o.jsx("span",{children:"Appel"})]}),o.jsxs(G,{variant:"outline",className:"flex items-center justify-start space-x-2 text-xs h-9",onClick:()=>e("SMS"),children:[o.jsx(Mo,{className:"h-4 w-4 text-purple-500"})," ",o.jsx("span",{children:"SMS"})]}),o.jsxs(G,{variant:"outline",className:"flex items-center justify-start space-x-2 text-xs h-9",onClick:()=>e("Email"),children:[o.jsx(tn,{className:"h-4 w-4 text-orange-500"})," ",o.jsx("span",{children:"Email"})]})]}),o.jsx("div",{className:"p-4 mt-auto",children:o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"crire  Charly",className:"w-full px-4 py-2 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"}),o.jsx(G,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 text-gray-400 hover:text-green-600 h-8 w-8",onClick:()=>B({title:"Le chat n'est pas encore fonctionnel."}),children:o.jsx(fP,{className:"h-5 w-5"})})]})})]})},zG=({isDesktop:e})=>{const[t,r]=p.useState(!1),n=({onClose:s,isMobile:i})=>o.jsxs(le.div,{initial:i?{opacity:0,y:"100%"}:{opacity:0,x:"20px"},animate:{opacity:1,y:0,x:0},exit:i?{opacity:0,y:"100%"}:{opacity:0,x:"20px"},transition:{duration:.5,ease:[.22,1,.36,1]},className:i?"fixed inset-0 bg-white z-50 flex flex-col":"w-full",children:[o.jsx(BG,{}),i&&o.jsx("div",{className:"absolute top-4 right-4",children:o.jsx(G,{variant:"ghost",size:"icon",onClick:s,className:"rounded-full bg-black/20 text-white hover:bg-black/40",children:o.jsx(es,{className:"h-5 w-5"})})})]});return e?o.jsx(n,{onClose:()=>{},isMobile:!1}):o.jsxs(o.Fragment,{children:[o.jsx(le.div,{className:"fixed bottom-6 right-6 z-40",initial:{scale:0},animate:{scale:1},transition:{delay:.5},children:o.jsx(G,{onClick:()=>r(!0),className:"w-16 h-16 rounded-full gradient-green shadow-soft hover:shadow-lg transition-all duration-300 transform hover:scale-105 flex items-center justify-center",children:o.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex items-center justify-center",children:o.jsx("img",{className:"w-full h-auto object-contain",alt:"Ouvrir le chat avec Charly",src:"https://horizons-cdn.hostinger.com/43725989-d002-4543-b65c-278701925e7e/4e3f809791e357819f31c585852d3a99.png"})})})}),o.jsx(Ti,{children:t&&o.jsx(n,{onClose:()=>r(!1),isMobile:!0})})]})},UG=e=>{const[t,r]=p.useState(null),[n,s]=p.useState(null),[i,a]=p.useState(null),[l,c]=p.useState(null),[u,f]=p.useState(!0),[d,h]=p.useState(null);return p.useEffect(()=>{if(!e){r(null),s(null),a(null),c(null),f(!1);return}(async()=>{try{f(!0),h(null),r(null),s(null),a(null),c(null),P.info("[useBranding] Chargement branding pour organization:",e);const{data:g,error:v}=await T.rpc("get_organization_settings_for_org",{p_organization_id:e});if(v){P.warn("[useBranding] Erreur lors du chargement (table organization_settings peut ne pas exister):",v),f(!1);return}const y=g||null;if(!y){P.info("[useBranding] Aucun paramtre de branding trouv, utilisation des valeurs par dfaut"),f(!1);return}P.info("[useBranding] Branding charg:",y),r(y.display_name),s(y.logo_url),a(y.primary_color),c(y.secondary_color),f(!1)}catch(g){P.warn("[useBranding] Exception lors du chargement, fallback vers valeurs par dfaut:",g),f(!1)}})()},[e]),{brandName:t,logoUrl:n,primaryColor:i,secondaryColor:l,brandingLoading:u,brandingError:d}},_y=p.createContext(null),an=()=>{const e=p.useContext(_y);if(!e)throw new Error("useOrganization must be used within OrganizationProvider");return e},VG=({children:e})=>{const[t,r]=p.useState(null),[n,s]=p.useState(!0),[i,a]=p.useState(null),[l,c]=p.useState(!1),[u,f]=p.useState(null),d=p.useRef(!1),[h,m]=p.useState(!1);p.useEffect(()=>{T.auth.getSession().then(({data:{session:_}})=>{var N;const S=((N=_==null?void 0:_.user)==null?void 0:N.id)||null;f(S)});const{data:{subscription:j}}=T.auth.onAuthStateChange((_,S)=>{var E;const N=((E=S==null?void 0:S.user)==null?void 0:E.id)||null;f(C=>N!==C?N:C)});return()=>j.unsubscribe()},[]),p.useEffect(()=>{let _=null,S=!1;const N=(C,k=!1,L=null)=>{S||(_&&(clearTimeout(_),_=null),r(C),c(k),L&&a(L),!d.current&&!L&&(d.current=!0,m(!0)),s(!1))};return(async()=>{var C,k,L;try{s(!0),a(null),c(!1),_=setTimeout(()=>{S||(P.error("[OrganizationContext] Timeout rsolution organisation (10s)"),a("Dlai de connexion dpass. Le serveur ne rpond pas."),s(!1))},1e4);const A=window.location.hostname;P.info("[OrganizationContext] Hostname actuel:",A);let R=null;const{data:O,error:z}=await T.rpc("resolve_organization_from_host",{host:A});if(S)return;if(!z&&O&&(R=(O==null?void 0:O.id)||Array.isArray(O)&&((C=O[0])==null?void 0:C.id)||O,R&&typeof R=="string"?P.info("[OrganizationContext] Organization rsolue depuis hostname:",R):R=null),u){P.info("[OrganizationContext] User authentifi, vrification organization_id");const{data:I}=await T.from("users").select("organization_id").eq("user_id",u).maybeSingle();if(S)return;if(I!=null&&I.organization_id){P.info("[OrganizationContext] Organization rsolue depuis user admin:",I.organization_id),N(I.organization_id,!1);return}if(R){const{data:W}=await T.from("prospects").select("id, organization_id").eq("user_id",u).eq("organization_id",R).maybeSingle();if(S)return;if(W){P.info("[OrganizationContext] Client dj li  l'org du hostname:",R),N(R,!1);return}const{data:{session:U}}=await T.auth.getSession();if(S)return;const X=(k=U==null?void 0:U.user)==null?void 0:k.email;if(X){const{data:me,error:se}=await T.rpc("link_user_to_prospect_in_org",{p_user_id:u,p_email:X,p_organization_id:R});if(S)return;if(!se&&me){P.info("[OrganizationContext] Client li au prospect dans l'org du hostname:",R),N(R,!1);return}else se&&P.warn("[OrganizationContext] Erreur liaison prospect:",se.message)}}const{data:D}=await T.from("prospects").select("organization_id").eq("user_id",u).limit(1).maybeSingle();if(S)return;if(D!=null&&D.organization_id){P.info("[OrganizationContext] Organization rsolue depuis prospect (user_id):",D.organization_id),N(D.organization_id,!1);return}const{data:{session:$}}=await T.auth.getSession();if(S)return;const M=(L=$==null?void 0:$.user)==null?void 0:L.email;if(M){const{data:W}=await T.from("prospects").select("organization_id").eq("email",M).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(S)return;if(W!=null&&W.organization_id){P.info("[OrganizationContext] Organization rsolue depuis prospect par EMAIL:",W.organization_id),N(W.organization_id,!1);return}}}if(R){P.info("[OrganizationContext] Pas de user, utilisation hostname org:",R),N(R,!1);return}P.warn("[OrganizationContext] Aucune organisation trouve, fallback vers organisation plateforme");const{data:F,error:V}=await T.from("organizations").select("id").eq("is_platform",!0).limit(1).maybeSingle();if(S)return;if(!V&&F){const I=F.id||(F==null?void 0:F.organization_id)||F;I?(P.info("[OrganizationContext] Fallback vers organisation plateforme:",I),N(I,!0)):(P.warn("[OrganizationContext] Platform organization query returned no id, leaving organizationId null"),N(null,!0))}else P.warn("[OrganizationContext] Impossible de rcuprer l'organisation plateforme, leaving organizationId null",V),N(null,!0)}catch(A){if(_&&clearTimeout(_),S)return;P.error("[OrganizationContext] Exception lors de la rsolution:",A),P.warn("[OrganizationContext] Fallback vers organizationId = null (mode dgrad)"),N(null,!0)}})(),()=>{S=!0,_&&clearTimeout(_)}},[u]);const{brandName:g,logoUrl:v,primaryColor:y,secondaryColor:x,brandingLoading:b,brandingError:w}=UG(t);return p.useEffect(()=>{g&&(document.title=g)},[g]),p.useEffect(()=>{y&&document.documentElement.style.setProperty("--primary",y),x&&document.documentElement.style.setProperty("--secondary",x)},[y,x]),p.useEffect(()=>{},[t,u]),o.jsx(_y.Provider,{value:{organizationId:t,organizationLoading:n,organizationError:i,organizationReady:h,isPlatformOrg:l,brandName:g,logoUrl:v,primaryColor:y,secondaryColor:x,brandingLoading:b,brandingError:w},children:e})};class qA extends p.Component{constructor(r){super(r);Gs(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:null})});Gs(this,"handleGoBack",()=>{window.history.length>1?window.history.back():window.location.href="/"});Gs(this,"handleGoHome",()=>{window.location.href="/admin/pipeline"});this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(r){const n=`ERR-${Date.now()}-${Math.random().toString(36).slice(2,6).toUpperCase()}`;return{hasError:!0,error:r,errorId:n}}componentDidCatch(r,n){const{name:s="Module"}=this.props,{errorId:i}=this.state;P.error(`[ModuleBoundary] Crash dans "${s}"`,{errorId:i,module:s,message:r==null?void 0:r.message,stack:r==null?void 0:r.stack,componentStack:n==null?void 0:n.componentStack}),typeof window<"u"&&window.Sentry&&window.Sentry.captureException(r,{tags:{module:s,errorId:i},extra:{componentStack:n==null?void 0:n.componentStack}}),this.setState({errorInfo:n})}render(){const{hasError:r,error:n,errorId:s}=this.state,{children:i,name:a="Module"}=this.props;return r?o.jsx("div",{className:"flex items-center justify-center min-h-[400px] p-8",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-red-100 p-8 max-w-md w-full text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(qf,{className:"w-8 h-8 text-red-500"})}),o.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:['Module "',a,'" a rencontr une erreur']}),o.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Une erreur inattendue s'est produite. Vous pouvez ressayer ou retourner  l'accueil."}),o.jsx("div",{className:"bg-gray-50 rounded-lg px-3 py-2 mb-6",children:o.jsx("code",{className:"text-xs text-gray-500 font-mono",children:s})}),!1,o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsxs(G,{variant:"outline",onClick:this.handleGoHome,className:"flex items-center gap-2",children:[o.jsx(uP,{className:"w-4 h-4"}),"Accueil"]}),o.jsxs(G,{onClick:this.handleRetry,className:"bg-blue-600 hover:bg-blue-700 flex items-center gap-2",children:[o.jsx(Kf,{className:"w-4 h-4"}),"Ressayer"]})]}),o.jsx("p",{className:"text-xs text-gray-400 mt-6",children:"Si le problme persiste, contactez le support avec le code ci-dessus."})]})}):i}}const qG=()=>{const{width:e}=mh(),{activeAdminUser:t,setActiveAdminUser:r,adminReady:n,bootStatus:s,BOOT_STATUS:i}=Ve(),{organizationId:a,organizationLoading:l,organizationError:c}=an(),u=e<768,f=e>=1024,d=Ht(),h=Te();d.pathname.startsWith("/admin/charly"),d.pathname.startsWith("/admin/agenda"),d.pathname.startsWith("/admin/profil"),d.pathname.startsWith("/admin/pipeline")||d.pathname,d.pathname.startsWith("/admin/contacts");const m=d.pathname.startsWith("/admin/configuration-ia");d.pathname.startsWith("/admin/workflows-charly");const g=d.pathname.startsWith("/admin/landing-page"),v=m||g,y=(t==null?void 0:t.role)==="Global Admin"||(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="platform_admin";return c?o.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[o.jsx("div",{className:"flex justify-center mb-4",children:o.jsx("div",{className:"bg-red-100 rounded-full p-4",children:o.jsx("svg",{className:"h-12 w-12 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 5.636a9 9 0 010 12.728m0 0l-2.829-2.829m2.829 2.829L21 21M15.536 8.464a5 5 0 010 7.072m0 0l-2.829-2.829m-4.243 2.829a4.978 4.978 0 01-1.414-2.83m-1.414 5.658a9 9 0 01-2.167-9.238m7.824 2.167a1 1 0 111.414 1.414m-1.414-1.414L3 3m8.293 8.293l1.414 1.414"})})})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Connexion au serveur impossible"}),o.jsx("p",{className:"text-gray-600 mb-6",children:c}),o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Ressayer"}),o.jsx("button",{onClick:()=>h("/"),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:"Retour  l'accueil"})]})]})}):l||!a?o.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Connexion..."})]})}):v&&!y&&!(!n&&!t)?o.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxs("div",{className:"text-center max-w-md",children:[o.jsx("div",{className:"text-6xl mb-4",children:""}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Accs restreint"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Cette page est rserve aux administrateurs (Global Admin, Admin)."}),o.jsx("button",{onClick:()=>h("/admin/pipeline"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Retour au Pipeline"})]})}):(p.useEffect(()=>{(async()=>{const{data:{user:w}}=await T.auth.getUser();if(w&&!t){const{data:j}=await T.from("prospects").select("id").eq("user_id",w.id).single();j&&(console.warn(" Client dtect sur espace admin  dconnexion automatique"),await T.auth.signOut(),h("/"))}})()},[t,h]),p.useEffect(()=>{if(!(t!=null&&t.id))return;const b=T.channel(`admin-user-${t.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:`id=eq.${t.id}`},w=>{const j={id:w.new.id,userId:w.new.user_id,name:w.new.name,email:w.new.email,role:w.new.role,phone:w.new.phone,avatarUrl:w.new.avatar_url,managerId:w.new.manager_id,accessRights:w.new.access_rights,createdAt:w.new.created_at,updatedAt:w.new.updated_at};r(j)}).subscribe();return()=>{T.removeChannel(b)}},[t==null?void 0:t.id,r]),o.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[o.jsx(FG,{}),o.jsxs("div",{className:"flex flex-1 w-full",children:[o.jsx("main",{className:"flex-1 min-w-0 p-4 sm:p-6 lg:p-8",children:o.jsx(qA,{name:"Admin Page",children:o.jsx(Ff,{})})}),m&&f&&o.jsx("aside",{className:"w-[300px] flex-shrink-0 p-6 pr-10 hidden lg:block",children:o.jsxs("div",{className:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:" Configurer Charly"}),o.jsx("p",{className:"text-sm text-gray-600 mb-4 leading-relaxed",children:"Personnalisez les projets, workflows, formulaires et contrats pour automatiser le suivi de vos clients."}),o.jsx("a",{href:"/admin/projects-management",className:"flex items-center justify-center gap-2 w-full rounded-lg bg-blue-600 px-5 py-3 text-base font-medium text-white transition-colors hover:bg-blue-700",children:" Configurer"})]})})]}),!f&&!u&&o.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:o.jsx(zG,{isDesktop:!1})})]}))},j1=[{name:"Tableau de bord",path:"/dashboard",icon:p0,end:!0},{name:"Offres & Produits",path:"/dashboard/offres",icon:pP},{name:"Parrainage",path:"/dashboard/parrainage",icon:nv}],WG=()=>{const{width:e}=mh(),t=e<768,[r,n]=p.useState(!1),{companyLogo:s,clientNotifications:i,markClientNotificationAsRead:a,projectsData:l,brandName:c,logoUrl:u}=Ve(),f=Te(),d=i.filter(y=>!y.read),h=J.useMemo(()=>{const y={};return d.forEach(x=>{const b=`${x.projectType}`;y[b]||(y[b]={projectType:x.projectType,projectName:x.projectName,notifications:[],totalCount:0,latestTimestamp:x.timestamp}),y[b].notifications.push(x),y[b].totalCount+=x.count||1,new Date(x.timestamp)>new Date(y[b].latestTimestamp)&&(y[b].latestTimestamp=x.timestamp)}),Object.values(y).sort((x,b)=>new Date(b.latestTimestamp)-new Date(x.latestTimestamp))},[d]),m=y=>{y.notifications.forEach(x=>{a(x.id)}),f("/dashboard",{state:{openProjectType:y.projectType}})},g=()=>{f("/dashboard/profil")},v=()=>o.jsx(Ti,{children:r&&o.jsx(le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/60 backdrop-blur-sm",onClick:()=>n(!1),children:o.jsxs(le.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 right-0 bottom-0 w-4/5 max-w-sm bg-background p-6 shadow-xl",onClick:y=>y.stopPropagation(),children:[o.jsxs("div",{className:"flex justify-between items-center mb-8",children:[o.jsx("span",{className:"font-bold text-xl",children:"Menu"}),o.jsx(G,{variant:"ghost",size:"icon",onClick:()=>n(!1),children:o.jsx(es,{className:"h-6 w-6"})})]}),o.jsx("nav",{className:"flex flex-col space-y-2",children:j1.map(y=>o.jsxs(Ud,{to:y.path,end:y.end,onClick:()=>n(!1),className:({isActive:x})=>`flex items-center space-x-3 p-3 rounded-lg text-lg font-medium transition-colors ${x?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"}`,children:[o.jsx(y.icon,{className:"h-6 w-6"}),o.jsx("span",{children:y.name})]},y.name))})]})})});return o.jsxs("header",{className:"bg-background/80 backdrop-blur-md shadow-sm sticky top-0 z-40 border-b border-gray-100",children:[o.jsx("div",{className:"max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex items-center justify-between h-16",children:[o.jsx("div",{className:"flex items-center space-x-4",children:o.jsx(xi,{to:"/dashboard",className:"flex items-center",children:u?o.jsx("img",{src:u,alt:c||"Logo",className:"h-14 w-auto object-contain"}):s&&s.startsWith("data:video/mp4")?o.jsx("video",{src:s,className:"h-14 w-auto object-contain",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,preload:"auto",style:{display:"block",background:"transparent"}}):s?o.jsx("img",{src:s,alt:"Logo",className:"h-14 w-auto object-contain"}):o.jsx("div",{className:"w-10 h-10 gradient-green rounded-xl flex items-center justify-center shadow-card",children:o.jsx("span",{className:"text-white font-bold text-lg",children:c?c.charAt(0).toUpperCase():"C"})})})}),!t&&o.jsx("nav",{className:"flex items-center space-x-2 bg-gray-100 p-1 rounded-full",children:j1.map(y=>o.jsxs(Ud,{to:y.path,end:y.end,className:({isActive:x})=>`flex items-center space-x-2 px-4 py-2 rounded-full text-sm font-medium transition-colors ${x?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:bg-gray-200"}`,children:[o.jsx(y.icon,{className:"h-4 w-4"}),o.jsx("span",{children:y.name})]},y.name))}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs(rA,{children:[o.jsx(nA,{asChild:!0,children:o.jsxs(G,{variant:"ghost",size:"icon",className:"relative rounded-full hover:bg-gray-100",children:[o.jsx(Wd,{className:"h-5 w-5 text-gray-600"}),h.length>0&&o.jsx("span",{className:"absolute top-1 right-1 h-4 w-4 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:h.reduce((y,x)=>y+x.totalCount,0)})]})}),o.jsxs(dy,{align:"end",className:"w-80",children:[o.jsx(fy,{children:"Notifications"}),o.jsx(hy,{}),h.length>0?h.map((y,x)=>o.jsxs(ac,{onClick:()=>m(y),className:"cursor-pointer flex flex-col items-start py-3",children:[o.jsxs("div",{className:"flex items-center justify-between w-full mb-1",children:[o.jsx("span",{className:"font-semibold text-blue-600",children:y.projectName}),o.jsx("span",{className:"text-xs text-gray-400",children:new Date(y.latestTimestamp).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),o.jsx("p",{className:"text-sm text-gray-600",children:y.totalCount>1?`${y.totalCount} nouveaux messages`:y.notifications[0].message})]},`${y.projectType}-${x}`)):o.jsx(ac,{disabled:!0,className:"text-center py-4",children:"Aucune nouvelle notification"})]})]}),o.jsx(G,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-gray-100",onClick:g,children:o.jsx("div",{className:"w-8 h-8 gradient-blue rounded-full flex items-center justify-center",children:o.jsx(Ac,{className:"h-4 w-4 text-white"})})}),t&&o.jsx(G,{variant:"ghost",size:"icon",onClick:()=>n(!0),className:"rounded-full hover:bg-gray-100",children:o.jsx(dP,{className:"h-6 w-6"})})]})]})}),t&&o.jsx(v,{})]})},_1=()=>{mh();const{currentUser:e,setCurrentUser:t,companyLogo:r}=Ve();Te();const[n,s]=p.useState(!1);return p.useEffect(()=>{(async()=>{if(!(e!=null&&e.email)){s(!0);return}const{data:{session:a}}=await T.auth.getSession();if(!a){const l=`${window.location.origin}/dashboard`,{error:c}=await T.auth.signInWithOtp({email:e.email,options:{shouldCreateUser:!0,emailRedirectTo:l}});c?P.error("Erreur envoi magic link",{error:c.message}):B({title:" Activation requise",description:`Un lien de connexion a t envoy  ${e.email}. Cliquez dessus pour activer toutes les fonctionnalits.`,duration:1e4})}s(!0)})()},[e==null?void 0:e.email]),p.useEffect(()=>{if(!(e!=null&&e.id)||!n)return;const i=T.channel(`prospect-${e.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"prospects",filter:`id=eq.${e.id}`},a=>{const l={id:a.new.id,userId:a.new.user_id,name:a.new.name,email:a.new.email,phone:a.new.phone,company:a.new.company_name,address:a.new.address,tags:a.new.tags||[],status:a.new.status,ownerId:a.new.owner_id,hasAppointment:a.new.has_appointment,affiliateName:a.new.affiliate_name};t(l)}).subscribe();return()=>{T.removeChannel(i)}},[e==null?void 0:e.id,t]),o.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[o.jsx(WG,{}),o.jsx("div",{className:"flex flex-1 max-w-screen-xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-6 md:py-8 pb-24 md:pb-8",children:o.jsx("main",{className:"flex-1 min-w-0",children:o.jsx(qA,{name:"Espace Client",children:o.jsx(Ff,{})})})})]})},HG=()=>{const e=Te(),[t,r]=p.useState(!0),[n,s]=p.useState(null);return p.useEffect(()=>{(async()=>{try{const{data:{user:a},error:l}=await T.auth.getUser();if(l||!a){e("/platform-login");return}const{data:c,error:u}=await T.from("platform_admins").select("user_id, email").eq("user_id",a.id).maybeSingle();if(u){console.error("[PlatformLayout] Error querying platform_admins:",u),await T.auth.signOut(),e("/platform-login");return}if(!c){console.error("[PlatformLayout] User not in platform_admins"),r(!1),s(null);return}s(c),r(!1)}catch(a){console.error("[PlatformLayout] Error checking access:",a),e("/platform-login")}})()},[e]),t?o.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-gray-900 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 font-medium",children:"Vrification des accs plateforme..."})]})}):n?o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("header",{className:"bg-white border-b border-gray-200",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsx("div",{className:"flex items-center",children:o.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"EVATIME Platform"})}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("span",{className:"text-sm text-gray-600",children:(n==null?void 0:n.name)||(n==null?void 0:n.email)}),o.jsx("span",{className:"text-xs bg-gray-900 text-white px-2 py-1 rounded",children:"Platform Admin"})]})]})})}),o.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o.jsx(Ff,{})})]}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[o.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Accs refus"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Votre compte n'est pas autoris  accder  la plateforme EVATIME. Contactez un administrateur si vous pensez que c'est une erreur."}),o.jsx("button",{onClick:async()=>{await T.auth.signOut(),e("/platform-login")},className:"w-full bg-gray-900 text-white py-2 px-4 rounded hover:bg-gray-800 transition-colors",children:"Retour  la connexion"})]})})};function GG(){const[e,t]=p.useState(0),[r,n]=p.useState({}),[s,i]=p.useState(!0),a=p.useRef(null),l=p.useRef([]);return p.useEffect(()=>{let c=!0;(async()=>{try{const{data:{user:d},error:h}=await T.auth.getUser();if(h||!d){i(!1);return}const{data:m,error:g}=await T.from("partners").select("id").eq("user_id",d.id).single();if(g||!m){i(!1);return}a.current=m.id;const{data:v,error:y}=await T.from("missions").select("prospect_id, project_type").eq("partner_id",m.id);if(y)throw y;const x=(v||[]).map(E=>({prospectId:E.prospect_id,projectType:E.project_type})),b=[...new Set(x.map(E=>E.prospectId))];if(l.current=b,x.length===0){c&&(t(0),n({}),i(!1));return}const{data:w,error:j}=await T.from("chat_messages").select("id, prospect_id, project_type").eq("channel","partner").eq("partner_id",m.id).neq("sender","partner").eq("read",!1).in("prospect_id",b);if(j)throw j;if(!c)return;const _=new Set(x.map(E=>`${E.prospectId}__${E.projectType}`)),S=(w||[]).filter(E=>_.has(`${E.prospect_id}__${E.project_type}`)),N={};for(const E of S){const C=`${E.prospect_id}__${E.project_type}`;N[C]=(N[C]||0)+1}n(N),t(S.length),i(!1)}catch(d){P.error("usePartnerUnreadCount: erreur init",{err:d.message}),c&&i(!1)}})();const f=T.channel(`partner-unread-${Math.random().toString(36).slice(2)}`).on("postgres_changes",{event:"*",schema:"public",table:"chat_messages"},d=>{if(!c)return;const h=d.new;if(!h||h.channel!=="partner"||h.partner_id!==a.current||!l.current.includes(h.prospect_id))return;const m=`${h.prospect_id}__${h.project_type}`;d.eventType==="INSERT"?h.sender!=="partner"&&h.read===!1&&(n(g=>({...g,[m]:(g[m]||0)+1})),t(g=>g+1)):d.eventType==="UPDATE"&&h.read===!0&&h.sender!=="partner"&&(n(g=>{const v=g[m]||0;if(v<=1){const y={...g};return delete y[m],y}return{...g,[m]:v-1}}),t(g=>Math.max(0,g-1)))}).subscribe();return()=>{c=!1,T.removeChannel(f)}},[]),{totalUnread:e,unreadByConversation:r,loading:s}}const KG=()=>{const e=Te(),[t,r]=p.useState(!0),[n,s]=p.useState(!1);return p.useEffect(()=>{(async()=>{try{const{data:{user:l},error:c}=await T.auth.getUser();if(c||!l){P.debug("PartnerLayout: Pas d'utilisateur authentifi"),e("/partner/login");return}const{data:u,error:f}=await T.from("partners").select("id, active").eq("user_id",l.id).single();if(f||!u){P.warn("PartnerLayout: Utilisateur non-partenaire tente d'accder",{userId:l.id}),await T.auth.signOut(),e("/partner/login");return}if(!u.active){P.warn("PartnerLayout: Partenaire inactif",{partnerId:u.id}),await T.auth.signOut(),e("/partner/login");return}s(!0)}catch(l){P.error("PartnerLayout: Erreur vrification accs",{error:l.message}),e("/partner/login")}finally{r(!1)}})();const{data:{subscription:a}}=T.auth.onAuthStateChange(l=>{l==="SIGNED_OUT"&&e("/partner/login")});return()=>{a==null||a.unsubscribe()}},[e]),t?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-amber-100 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(De,{className:"w-8 h-8 text-orange-600 animate-spin mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Vrification de l'accs..."})]})}):n?o.jsx(YG,{}):null},S1=[{path:"/partner/missions",label:"MISSIONS",icon:p0},{path:"/partner/contacts",label:"CONTACTS",icon:Pi},{path:"/partner/charly",label:"CHARLY",icon:Mo},{path:"/partner/preuves",label:"PREUVES",icon:Hd}],YG=()=>{var s;const e=Te(),t=Ht(),{totalUnread:r}=GG(),n=((s=S1.find(i=>t.pathname.startsWith(i.path)))==null?void 0:s.path)||"/partner/missions";return o.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[o.jsx("main",{className:"flex-1 overflow-y-auto pb-20",children:o.jsx(Ff,{})}),o.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50 safe-area-bottom",children:o.jsx("div",{className:"max-w-lg mx-auto flex justify-around items-center h-16 px-2",children:S1.map(({path:i,label:a,icon:l})=>{const c=n===i,u=i==="/partner/charly"&&r>0;return o.jsxs("button",{onClick:()=>e(i),className:`relative flex flex-col items-center justify-center gap-1 flex-1 py-2 transition-colors ${c?"text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx(l,{className:"w-5 h-5",strokeWidth:c?2.5:1.5}),u&&o.jsx("span",{className:"absolute -top-1.5 -right-2.5 bg-red-500 text-white text-[10px] font-bold rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1 animate-pulse shadow-sm",children:r>99?"99+":r})]}),o.jsx("span",{className:`text-[10px] tracking-wide ${c?"font-bold":"font-medium"}`,children:a})]},i)})})})]})},pe=J.forwardRef(({className:e,type:t,...r},n)=>o.jsx("input",{type:t,className:he("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));pe.displayName="Input";function WA(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var vh="Checkbox",[JG,uoe]=sn(vh),[XG,Sy]=JG(vh);function QG(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:s,disabled:i,form:a,name:l,onCheckedChange:c,required:u,value:f="on",internal_do_not_use_render:d}=e,[h,m]=Bi({prop:r,defaultProp:s??!1,onChange:c,caller:vh}),[g,v]=p.useState(null),[y,x]=p.useState(null),b=p.useRef(!1),w=g?!!a||!!g.closest("form"):!0,j={checked:h,disabled:i,setChecked:m,control:g,setControl:v,name:l,form:a,value:f,hasConsumerStoppedPropagationRef:b,required:u,defaultChecked:ks(s)?!1:s,isFormControl:w,bubbleInput:y,setBubbleInput:x};return o.jsx(XG,{scope:t,...j,children:ZG(d)?d(j):n})}var HA="CheckboxTrigger",GA=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},s)=>{const{control:i,value:a,disabled:l,checked:c,required:u,setControl:f,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:g}=Sy(HA,e),v=Fe(s,f),y=p.useRef(c);return p.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const b=()=>d(y.current);return x.addEventListener("reset",b),()=>x.removeEventListener("reset",b)}},[i,d]),o.jsx(Re.button,{type:"button",role:"checkbox","aria-checked":ks(c)?"mixed":c,"aria-required":u,"data-state":QA(c),"data-disabled":l?"":void 0,disabled:l,value:a,...n,ref:v,onKeyDown:xe(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:xe(r,x=>{d(b=>ks(b)?!0:!b),g&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});GA.displayName=HA;var Ny=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:s,defaultChecked:i,required:a,disabled:l,value:c,onCheckedChange:u,form:f,...d}=e;return o.jsx(QG,{__scopeCheckbox:r,checked:s,defaultChecked:i,disabled:l,required:a,onCheckedChange:u,name:n,form:f,value:c,internal_do_not_use_render:({isFormControl:h})=>o.jsxs(o.Fragment,{children:[o.jsx(GA,{...d,ref:t,__scopeCheckbox:r}),h&&o.jsx(XA,{__scopeCheckbox:r})]})})});Ny.displayName=vh;var KA="CheckboxIndicator",YA=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...s}=e,i=Sy(KA,r);return o.jsx(Br,{present:n||ks(i.checked)||i.checked===!0,children:o.jsx(Re.span,{"data-state":QA(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});YA.displayName=KA;var JA="CheckboxBubbleInput",XA=p.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:l,disabled:c,name:u,value:f,form:d,bubbleInput:h,setBubbleInput:m}=Sy(JA,e),g=Fe(r,m),v=WA(i),y=K0(n);p.useEffect(()=>{const b=h;if(!b)return;const w=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(w,"checked").set,S=!s.current;if(v!==i&&_){const N=new Event("click",{bubbles:S});b.indeterminate=ks(i),_.call(b,ks(i)?!1:i),b.dispatchEvent(N)}},[h,v,i,s]);const x=p.useRef(ks(i)?!1:i);return o.jsx(Re.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,required:l,disabled:c,name:u,value:f,form:d,...t,tabIndex:-1,ref:g,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});XA.displayName=JA;function ZG(e){return typeof e=="function"}function ks(e){return e==="indeterminate"}function QA(e){return ks(e)?"indeterminate":e?"checked":"unchecked"}const sr=J.forwardRef(({className:e,...t},r)=>o.jsx(Ny,{ref:r,className:he("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:o.jsx(YA,{className:he("flex items-center justify-center text-current"),children:o.jsx(Mn,{className:"h-4 w-4"})})}));sr.displayName=Ny.displayName;var eK="Label",ZA=p.forwardRef((e,t)=>o.jsx(Re.label,{...e,ref:t,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));ZA.displayName=eK;var eR=ZA;const tK=Vf("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ee=J.forwardRef(({className:e,...t},r)=>o.jsx(eR,{ref:r,className:he(tK(),e),...t}));ee.displayName=eR.displayName;const mi=p.forwardRef(({className:e,...t},r)=>o.jsx("textarea",{className:he("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));mi.displayName="Textarea";let tR,rR,nR,sR,iR,oR,aR;try{const e=require("@/components/ui/dialog");tR=e.Dialog,rR=e.DialogContent,nR=e.DialogHeader,sR=e.DialogTitle,iR=e.DialogDescription,oR=e.DialogFooter,aR=e.DialogClose}catch{console.warn("Dialog components not available, using fallback")}const rK=({open:e,onOpenChange:t,children:r})=>e?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-auto",children:r})}):null,nK=({children:e,className:t})=>o.jsx("div",{className:t,children:e}),sK=({children:e})=>o.jsx("div",{className:"p-6 pb-4",children:e}),iK=({children:e})=>o.jsx("h2",{className:"text-lg font-semibold",children:e}),oK=({children:e})=>o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e}),aK=({children:e})=>o.jsx("div",{className:"flex justify-end gap-2 p-6 pt-4",children:e}),lK=({children:e,asChild:t,...r})=>t?J.cloneElement(e,r):o.jsx("button",{...r,children:e}),cK=({open:e,onOpenChange:t,onAddProspect:r})=>{const{currentUser:n,activeAdminUser:s,projectsData:i={},formContactConfig:a=[]}=Ve(),l=Object.values(i).filter(k=>k.isPublic),c=()=>{const k=a.reduce((L,A)=>(L[A.id]="",L),{});return k.tags=[],k},[u,f]=p.useState(c()),[d,h]=p.useState(!0);p.useEffect(()=>{e&&(f(c()),h(!0))},[e,a]);const m=k=>{const{id:L,value:A}=k.target;f(R=>({...R,[L]:A}))},g=k=>{f(L=>{const A=L.tags.includes(k)?L.tags.filter(R=>R!==k):[...L.tags,k];return{...L,tags:A}})},v=k=>{if(!k.show_if_conditions||k.show_if_conditions.length===0)return!0;const L=k.condition_operator||"AND",A=k.show_if_conditions.map(R=>{const O=u[R.field];return R.equals==="has_value"?O&&O.trim()!=="":O===R.equals});return L==="AND"?A.every(R=>R):A.some(R=>R)},y=()=>{const k=[];return a.forEach((L,A)=>{if(L.is_repeater&&L.type==="select"&&u[L.id]){const R=parseInt(u[L.id])||0,O=L.repeats_fields||[];for(let z=0;z<R;z++)O.forEach(F=>{const V=a.find(I=>I.id===F);V&&k.push({...V,id:`${F}_repeat_${z}`,name:`${V.name} (${z+1})`,isRepeated:!0,originalId:F,repeatIndex:z})})}}),k},x=[...a,...y()],b=async k=>{k.preventDefault();const L=a.find(O=>O.required);if(L&&!u[L.id]){B({title:"Champs requis",description:`Le champ "${L.name.replace("*","")}" est obligatoire.`,variant:"destructive"});return}if(!u.email){B({title:"Champs requis",description:"L'email est obligatoire.",variant:"destructive"});return}const A=d&&u.email&&u.email.trim()!=="";console.log("[SafeAddProspectModal]  Submit check:",{sendInvitationCheckbox:d,email:u.email,sendInvitationFinal:A});const R={...u,tags:u.tags,hasAppointment:!1,sendInvitation:A};await r(R),t(!1)},w=tR||rK,j=rR||nK,_=nR||sK,S=sR||iK,N=iR||oK,E=oR||aK,C=aR||lK;return o.jsx(w,{open:e,onOpenChange:t,children:o.jsxs(j,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto",children:[o.jsxs(_,{children:[o.jsx(S,{children:"Ajouter un nouveau prospect"}),o.jsx(N,{children:"Remplissez les informations pour crer un nouveau prospect."})]}),o.jsxs("form",{onSubmit:b,children:[o.jsxs("div",{className:"grid gap-4 py-4 px-6",children:[x.filter(k=>!k.isRepeated||k.isRepeated).map(k=>!k.isRepeated&&!v(k)?null:o.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[o.jsx(ee,{htmlFor:k.id,className:"text-right",children:k.name}),k.type==="select"?o.jsxs("select",{id:k.id,value:u[k.id]||"",onChange:m,className:"col-span-3 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",required:k.required,children:[o.jsx("option",{value:"",children:"-- Slectionner --"}),(k.options||[]).map((L,A)=>o.jsx("option",{value:L,children:L},A))]}):k.type==="textarea"?o.jsx(mi,{id:k.id,value:u[k.id]||"",onChange:m,placeholder:k.placeholder,className:"col-span-3",rows:4,required:k.required}):k.type==="file"?o.jsx(pe,{id:k.id,type:"file",onChange:L=>{var R;const A=(R=L.target.files)==null?void 0:R[0];A&&f(O=>({...O,[k.id]:A}))},className:"col-span-3",required:k.required}):o.jsx(pe,{id:k.id,type:k.type,value:u[k.id]||"",onChange:m,placeholder:k.placeholder,className:"col-span-3",required:k.required})]},k.id)),o.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[o.jsx(ee,{htmlFor:"sendInvitation",className:"text-right",children:"Invitation"}),o.jsxs("div",{className:"col-span-3 flex items-center space-x-2",children:[o.jsx(sr,{id:"sendInvitation",checked:d,onCheckedChange:k=>{console.log("[SafeAddProspectModal] sendInvitation changed to:",k),h(!!k)},disabled:!u.email||u.email.trim()===""}),o.jsxs(ee,{htmlFor:"sendInvitation",className:`font-normal cursor-pointer ${!u.email||u.email.trim()===""?"text-gray-400":""}`,children:["Envoyer une invitation au client",(!u.email||u.email.trim()==="")&&o.jsx("span",{className:"text-xs text-gray-400 ml-1",children:"(email requis)"})]})]})]}),l.length>0&&o.jsxs("div",{className:"grid grid-cols-4 items-start gap-4",children:[o.jsx(ee,{className:"text-right pt-2",children:"Projets"}),o.jsx("div",{className:"col-span-3 grid grid-cols-2 gap-2",children:l.map(k=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(sr,{id:`tag-${k.type}`,checked:u.tags.includes(k.type),onCheckedChange:()=>g(k.type)}),o.jsx(ee,{htmlFor:`tag-${k.type}`,className:"font-normal",children:k.title})]},k.type))})]})]}),o.jsxs(E,{children:[o.jsx(C,{asChild:!0,children:o.jsx(G,{type:"button",variant:"secondary",onClick:()=>t(!1),children:"Annuler"})}),o.jsx(G,{type:"submit",children:"Crer le prospect"})]})]})]})})};var xh="Dialog",[lR,cR]=sn(xh),[uK,ln]=lR(xh),uR=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,l=p.useRef(null),c=p.useRef(null),[u,f]=Bi({prop:n,defaultProp:s??!1,onChange:i,caller:xh});return o.jsx(uK,{scope:t,triggerRef:l,contentRef:c,contentId:bi(),titleId:bi(),descriptionId:bi(),open:u,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(d=>!d),[f]),modal:a,children:r})};uR.displayName=xh;var dR="DialogTrigger",fR=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ln(dR,r),i=Fe(t,s.triggerRef);return o.jsx(Re.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Py(s.open),...n,ref:i,onClick:xe(e.onClick,s.onOpenToggle)})});fR.displayName=dR;var Ey="DialogPortal",[dK,hR]=lR(Ey,{forceMount:void 0}),pR=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,i=ln(Ey,t);return o.jsx(dK,{scope:t,forceMount:r,children:p.Children.map(n,a=>o.jsx(Br,{present:r||i.open,children:o.jsx(Pc,{asChild:!0,container:s,children:a})}))})};pR.displayName=Ey;var ff="DialogOverlay",mR=p.forwardRef((e,t)=>{const r=hR(ff,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,i=ln(ff,e.__scopeDialog);return i.modal?o.jsx(Br,{present:n||i.open,children:o.jsx(hK,{...s,ref:t})}):null});mR.displayName=ff;var fK=Ci("DialogOverlay.RemoveScroll"),hK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ln(ff,r);return o.jsx(ny,{as:fK,allowPinchZoom:!0,shards:[s.contentRef],children:o.jsx(Re.div,{"data-state":Py(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Ai="DialogContent",gR=p.forwardRef((e,t)=>{const r=hR(Ai,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,i=ln(Ai,e.__scopeDialog);return o.jsx(Br,{present:n||i.open,children:i.modal?o.jsx(pK,{...s,ref:t}):o.jsx(mK,{...s,ref:t})})});gR.displayName=Ai;var pK=p.forwardRef((e,t)=>{const r=ln(Ai,e.__scopeDialog),n=p.useRef(null),s=Fe(t,r.contentRef,n);return p.useEffect(()=>{const i=n.current;if(i)return Lc(i)},[]),o.jsx(vR,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xe(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=r.triggerRef.current)==null||a.focus()}),onPointerDownOutside:xe(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0;(a.button===2||l)&&i.preventDefault()}),onFocusOutside:xe(e.onFocusOutside,i=>i.preventDefault())})}),mK=p.forwardRef((e,t)=>{const r=ln(Ai,e.__scopeDialog),n=p.useRef(!1),s=p.useRef(!1);return o.jsx(vR,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,l;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((u=r.triggerRef.current)==null?void 0:u.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),vR=p.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,l=ln(Ai,r),c=p.useRef(null),u=Fe(t,c);return z0(),o.jsxs(o.Fragment,{children:[o.jsx(nh,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:o.jsx(Cc,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Py(l.open),...a,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),o.jsxs(o.Fragment,{children:[o.jsx(vK,{titleId:l.titleId}),o.jsx(yK,{contentRef:c,descriptionId:l.descriptionId})]})]})}),Cy="DialogTitle",xR=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ln(Cy,r);return o.jsx(Re.h2,{id:s.titleId,...n,ref:t})});xR.displayName=Cy;var yR="DialogDescription",bR=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ln(yR,r);return o.jsx(Re.p,{id:s.descriptionId,...n,ref:t})});bR.displayName=yR;var wR="DialogClose",jR=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ln(wR,r);return o.jsx(Re.button,{type:"button",...n,ref:t,onClick:xe(e.onClick,()=>s.onOpenChange(!1))})});jR.displayName=wR;function Py(e){return e?"open":"closed"}var _R="DialogTitleWarning",[gK,SR]=N6(_R,{contentName:Ai,titleName:Cy,docsSlug:"dialog"}),vK=({titleId:e})=>{const t=SR(_R),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},xK="DialogDescriptionWarning",yK=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${SR(xK).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},NR=uR,ER=fR,CR=pR,Ty=mR,ky=gR,Ay=xR,Ry=bR,yh=jR;const bh=NR,doe=ER,bK=CR,foe=yh,PR=J.forwardRef(({className:e,...t},r)=>o.jsx(Ty,{ref:r,className:he("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));PR.displayName=Ty.displayName;const Vc=J.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(bK,{children:[o.jsx(PR,{}),o.jsxs(ky,{ref:n,className:he("fixed left-1/2 top-1/2 z-50 flex w-full max-w-lg -translate-x-1/2 -translate-y-1/2 flex-col border bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg max-h-[90vh]",e),...r,children:[t,o.jsxs(yh,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[o.jsx(es,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Vc.displayName=ky.displayName;const qc=({className:e,...t})=>o.jsx("div",{className:he("flex flex-col space-y-1.5 text-center sm:text-left p-6",e),...t});qc.displayName="DialogHeader";const TR=({className:e,...t})=>o.jsx("div",{className:he("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 p-6 border-t",e),...t});TR.displayName="DialogFooter";const Wc=J.forwardRef(({className:e,...t},r)=>o.jsx(Ay,{ref:r,className:he("text-lg font-semibold leading-none tracking-tight",e),...t}));Wc.displayName=Ay.displayName;const wh=J.forwardRef(({className:e,...t},r)=>o.jsx(Ry,{ref:r,className:he("text-sm text-muted-foreground",e),...t}));wh.displayName=Ry.displayName;let kR;kR=cK;const wK={ACC:"bg-blue-100 text-blue-800",Autonomie:"bg-green-100 text-green-800",Centrale:"bg-orange-100 text-orange-800",Investissement:"bg-teal-100 text-teal-800",ProducteurPro:"bg-purple-100 text-purple-800"},jK=({open:e,onOpenChange:t,onAddProspect:r})=>{const{formContactConfig:n=[],projectsData:s={},activeAdminUser:i}=Ve(),[a,l]=p.useState({}),[c,u]=p.useState([]),f=Object.values(s).filter(g=>g.isPublic);p.useEffect(()=>{if(e){const g={};n.forEach(v=>{g[v.id]=""}),l(g),u([])}},[e,n]);const d=g=>{const{id:v,value:y}=g.target;l(x=>({...x,[v]:y}))},h=g=>{u(v=>v.includes(g)?v.filter(x=>x!==g):[...v,g])},m=g=>{if(g.preventDefault(),!a.name||!a.email){B({title:"Champs requis",description:"Le nom et l'email sont obligatoires.",variant:"destructive"});return}const v={id:`prospect-${Date.now()}`,...a,tags:c,hasAppointment:!1,ownerId:(i==null?void 0:i.id)||"user-1"};r(v),B({title:" Prospect ajout !",description:`${v.name} a t ajout  la colonne "Intress".`}),t(!1)};return e?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsx("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-auto",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ajouter un nouveau prospect"}),o.jsxs("form",{onSubmit:m,className:"space-y-4",children:[n.map(g=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:g.name}),o.jsx(pe,{id:g.id,type:g.type,value:a[g.id]||"",onChange:d,placeholder:g.placeholder,required:g.required})]},g.id)),f.length>0&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projets"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:f.map(g=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(sr,{id:`tag-${g.type}`,checked:c.includes(g.type),onCheckedChange:()=>h(g.type)}),o.jsx("label",{htmlFor:`tag-${g.type}`,className:"text-sm",children:g.title})]},g.type))})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[o.jsx(G,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Annuler"}),o.jsx(G,{type:"submit",children:"Crer le prospect"})]})]})]})})}):null},_K=()=>{var oe;const e=Ve(),{activeAdminUser:t,projectsData:r={},globalPipelineSteps:n=[],prospects:s,prospectsLoading:i,addProspect:a,updateProspect:l,deleteProspect:c}=e||{},{users:u,loading:f}=jy(),d=p.useMemo(()=>u.reduce((H,q)=>(H[q.user_id]=q,H),{}),[u]),[h,m]=p.useState([]),[g,v]=p.useState(null),[y,x]=p.useState(!1),[b,w]=p.useState(""),[j,_]=p.useState([]),[S,N]=p.useState(null),[E,C]=p.useState(!1),[k,L]=p.useState(!1),A=p.useRef(null),R=p.useRef(null),O=j.length===0?"Tags":j.length===1?((oe=r[j[0]])==null?void 0:oe.title)||j[0]:`${j.length} tags`,z=Te();Ht(),p.useMemo(()=>(s==null?void 0:s.find(H=>H.id===g))||null,[s,g]);const F=p.useMemo(()=>!t||!u?[]:(t.role==="Global Admin"||t.role==="Admin",u),[t,u]),V=p.useMemo(()=>{var H;return S?((H=F.find(q=>q.user_id===S))==null?void 0:H.name)||"Utilisateur inconnu":F.length===1?F[0].name:"Tous les utilisateurs"},[S,F]);p.useEffect(()=>{t&&S===null&&(F.length===1?N(F[0].user_id):F.length>1&&N(null))},[t,S,F]);const I=p.useMemo(()=>{const H=new Set;s.forEach(ue=>{(ue.tags||[]).forEach(_e=>H.add(_e))});const q=Array.from(H),te=Object.keys(r);return q.length>0?q:te},[s,r]),D=p.useMemo(()=>s.filter(q=>{var ke,dt;const te=((ke=q.name)==null?void 0:ke.toLowerCase().includes(b.toLowerCase()))||((dt=q.email)==null?void 0:dt.toLowerCase().includes(b.toLowerCase())),ue=j.length===0||q.tags&&j.some(cn=>q.tags.includes(cn)),_e=!S||q.ownerId===S;return te&&ue&&_e}),[s,b,j,S,t]);p.useEffect(()=>{if(!E&&!k)return;const H=q=>{var _e,ke;const te=(_e=A.current)==null?void 0:_e.contains(q.target),ue=(ke=R.current)==null?void 0:ke.contains(q.target);te||C(!1),ue||L(!1)};return document.addEventListener("mousedown",H),()=>document.removeEventListener("mousedown",H)},[E,k]);const $=H=>{m(H?D.map(q=>q.id):[])},M=(H,q)=>{m(q?[...h,H]:h.filter(te=>te!==H))},W=H=>{B({title:` L'action "${H}" n'est pas encore implmente.`,description:"Ceci est une maquette cliquable. La fonctionnalit peut tre demande. "})},U=H=>{_(q=>q.includes(H)?q.filter(te=>te!==H):[...q,H])},X=H=>{N(H),L(!1)},me=H=>{const q=H.tags&&H.tags.length>0?H.tags[0]:"ACC";z(`/admin/pipeline?project=${q}&prospect=${H.id}`)},se=async H=>{var q,te;try{const ue=((q=n[0])==null?void 0:q.step_id)||((te=n[0])==null?void 0:te.id),_e=await a({...H,status:ue,ownerId:t==null?void 0:t.user_id});if(H.sendInvitation&&_e.email)try{const ke=`${window.location.origin}/dashboard`;P.info("[Contacts] Envoi Magic Link",{email:_e.email,org:organizationId});const{error:dt}=await T.auth.signInWithOtp({email:_e.email.trim(),options:{shouldCreateUser:!0,emailRedirectTo:ke,data:{organization_id:organizationId}}});dt?(P.error("[Contacts] Erreur Magic Link",dt),B({title:"Contact cr",description:` Invitation non envoye: ${dt.message}`,variant:"warning"})):(P.info("[Contacts] Magic Link envoy",{email:_e.email}),B({title:" Contact cr",description:`Invitation envoye  ${_e.email}`,className:"bg-green-500 text-white"}))}catch(ke){P.error("[Contacts] Exception Magic Link",ke),B({title:"Contact cr",description:` Erreur envoi invitation: ${ke.message}`,variant:"warning"})}x(!1)}catch{B({title:"Erreur",description:"Impossible d'ajouter le contact.",variant:"destructive"})}},Z=kR||jK;return i?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[o.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4 rounded-lg shadow-soft",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contacts"}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[o.jsx(Pi,{className:"w-4 h-4"}),o.jsxs("span",{children:[D.length," contact",D.length>1?"s":""]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{ref:A,className:"relative inline-block text-left",children:[o.jsxs(G,{type:"button",variant:"outline",className:"flex items-center space-x-2 bg-white",onClick:()=>C(H=>!H),children:[o.jsx("span",{children:O}),o.jsx(Ds,{className:"h-4 w-4"})]}),E&&o.jsx("div",{className:"absolute z-50 mt-1 w-44 origin-top-right rounded-md border border-gray-200 bg-white shadow-soft",children:o.jsxs("div",{className:"py-1",children:[I.map(H=>{var q;return o.jsxs("label",{className:"flex items-center px-3 py-2 text-sm hover:bg-gray-100 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:j.includes(H),onChange:()=>U(H),className:"mr-3 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),o.jsx("span",{children:((q=r[H])==null?void 0:q.title)||H})]},H)}),j.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"border-t border-gray-200 my-1"}),o.jsx("button",{onClick:()=>_([]),className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-gray-100",children:"Effacer la slection"})]})]})})]}),o.jsxs("div",{ref:R,className:"relative inline-block text-left",children:[o.jsxs(G,{type:"button",variant:"outline",className:"flex items-center space-x-2 bg-white",onClick:()=>L(H=>!H),disabled:!F.length,children:[o.jsx("span",{children:V}),o.jsx(Ds,{className:"h-4 w-4"})]}),k&&o.jsx("div",{className:"absolute z-50 mt-1 w-52 origin-top-right rounded-md border border-gray-200 bg-white shadow-soft",children:o.jsxs("div",{className:"py-1",children:[F.length>1&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:`block w-full px-3 py-2 text-left text-sm hover:bg-gray-100 ${S?"":"bg-gray-50 font-medium"}`,onClick:()=>X(null),children:"Tous les utilisateurs"}),o.jsx("div",{className:"border-t border-gray-100 my-1"})]}),F.map(H=>o.jsx("button",{type:"button",className:`block w-full px-3 py-2 text-left text-sm hover:bg-gray-100 ${S===H.user_id?"bg-gray-50 font-medium":""}`,onClick:()=>X(H.user_id),children:H.name},H.id))]})})]}),o.jsxs("div",{className:"relative w-64",children:[o.jsx(Zo,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx(pe,{placeholder:"Rechercher...",className:"pl-10 bg-white",value:b,onChange:H=>w(H.target.value)})]}),o.jsxs(G,{onClick:()=>x(!0),className:"bg-green-600 hover:bg-green-700",children:[o.jsx(hr,{className:"mr-2 h-4 w-4"})," Nouveau"]})]})]})}),o.jsx(Ti,{children:h.length>0&&o.jsxs(le.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-white p-3 rounded-lg shadow-soft flex flex-col sm:flex-row items-center justify-between",children:[o.jsxs("span",{className:"text-sm font-medium text-gray-700 mb-2 sm:mb-0",children:[h.length," contact",h.length>1?"s":""," slectionn",h.length>1?"s":""]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs(G,{variant:"outline",size:"sm",onClick:()=>W("Envoyer SMS"),children:[o.jsx(Mo,{className:"h-4 w-4 sm:mr-2"})," ",o.jsx("span",{className:"hidden sm:inline",children:"SMS"})]}),o.jsxs(G,{variant:"outline",size:"sm",onClick:()=>W("Envoyer Email"),children:[o.jsx(tn,{className:"h-4 w-4 sm:mr-2"})," ",o.jsx("span",{className:"hidden sm:inline",children:"Email"})]}),o.jsxs(G,{variant:"outline",size:"sm",onClick:()=>W("Appel par Charly"),children:[o.jsx(Xl,{className:"h-4 w-4 sm:mr-2"})," ",o.jsx("span",{className:"hidden sm:inline",children:"Appel IA"})]})]})]})}),o.jsx("div",{className:"bg-white rounded-lg shadow-soft overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[o.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"p-4",children:o.jsx(sr,{onCheckedChange:$,checked:h.length===D.length&&D.length>0,"aria-label":"Select all contacts"})}),o.jsx("th",{scope:"col",className:"px-6 py-3",children:"Nom"}),o.jsx("th",{scope:"col",className:"px-6 py-3 hidden md:table-cell",children:"Tlphone"}),o.jsx("th",{scope:"col",className:"px-6 py-3 hidden lg:table-cell",children:"Email"}),o.jsx("th",{scope:"col",className:"px-6 py-3 hidden sm:table-cell",children:"Tags"}),o.jsx("th",{scope:"col",className:"px-6 py-3 hidden md:table-cell",children:"Utilisateur"})]})}),o.jsx("tbody",{children:D.map(H=>{var q;return o.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50 cursor-pointer",onClick:()=>me(H),children:[o.jsx("td",{className:"w-4 p-4",onClick:te=>te.stopPropagation(),children:o.jsx(sr,{onCheckedChange:te=>M(H.id,te),checked:h.includes(H.id),"aria-labelledby":`contact-name-${H.id}`})}),o.jsx("td",{id:`contact-name-${H.id}`,className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap",children:H.name}),o.jsx("td",{className:"px-6 py-4 hidden md:table-cell",children:H.phone}),o.jsx("td",{className:"px-6 py-4 hidden lg:table-cell",children:H.email}),o.jsx("td",{className:"px-6 py-4 hidden sm:table-cell",children:o.jsx("div",{className:"flex flex-wrap gap-1",children:(H.tags||[]).map(te=>{var ke,dt;const ue=((ke=r[te])==null?void 0:ke.color)||wK[te]||"bg-gray-100 text-gray-800",_e=((dt=r[te])==null?void 0:dt.title)||te;return o.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${ue}`,children:_e},te)})})}),o.jsx("td",{className:"px-6 py-4 hidden md:table-cell",children:((q=d[H.ownerId])==null?void 0:q.name)||"Non assign"})]},H.id)})})]})}),o.jsx(Z,{open:y,onOpenChange:x,onAddProspect:se})]})};var AR="AlertDialog",[SK,hoe]=sn(AR,[cR]),ts=cR(),RR=e=>{const{__scopeAlertDialog:t,...r}=e,n=ts(t);return o.jsx(NR,{...n,...r,modal:!0})};RR.displayName=AR;var NK="AlertDialogTrigger",IR=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=ts(r);return o.jsx(ER,{...s,...n,ref:t})});IR.displayName=NK;var EK="AlertDialogPortal",OR=e=>{const{__scopeAlertDialog:t,...r}=e,n=ts(t);return o.jsx(CR,{...n,...r})};OR.displayName=EK;var CK="AlertDialogOverlay",DR=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=ts(r);return o.jsx(Ty,{...s,...n,ref:t})});DR.displayName=CK;var qo="AlertDialogContent",[PK,TK]=SK(qo),kK=T6("AlertDialogContent"),$R=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...s}=e,i=ts(r),a=p.useRef(null),l=Fe(t,a),c=p.useRef(null);return o.jsx(gK,{contentName:qo,titleName:MR,docsSlug:"alert-dialog",children:o.jsx(PK,{scope:r,cancelRef:c,children:o.jsxs(ky,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:xe(s.onOpenAutoFocus,u=>{var f;u.preventDefault(),(f=c.current)==null||f.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[o.jsx(kK,{children:n}),o.jsx(RK,{contentRef:a})]})})})});$R.displayName=qo;var MR="AlertDialogTitle",LR=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=ts(r);return o.jsx(Ay,{...s,...n,ref:t})});LR.displayName=MR;var FR="AlertDialogDescription",BR=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=ts(r);return o.jsx(Ry,{...s,...n,ref:t})});BR.displayName=FR;var AK="AlertDialogAction",zR=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=ts(r);return o.jsx(yh,{...s,...n,ref:t})});zR.displayName=AK;var UR="AlertDialogCancel",VR=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:s}=TK(UR,r),i=ts(r),a=Fe(t,s);return o.jsx(yh,{...i,...n,ref:a})});VR.displayName=UR;var RK=({contentRef:e})=>{const t=`\`${qo}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${qo}\` by passing a \`${FR}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${qo}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},IK=RR,OK=IR,DK=OR,qR=DR,WR=$R,HR=zR,GR=VR,KR=LR,YR=BR;const Hc=IK,jh=OK,$K=DK,JR=J.forwardRef(({className:e,...t},r)=>o.jsx(qR,{className:he("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));JR.displayName=qR.displayName;const ba=J.forwardRef(({className:e,...t},r)=>o.jsxs($K,{children:[o.jsx(JR,{}),o.jsx(WR,{ref:r,className:he("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));ba.displayName=WR.displayName;const wa=({className:e,...t})=>o.jsx("div",{className:he("flex flex-col space-y-2 text-center sm:text-left",e),...t});wa.displayName="AlertDialogHeader";const ja=({className:e,...t})=>o.jsx("div",{className:he("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});ja.displayName="AlertDialogFooter";const _a=J.forwardRef(({className:e,...t},r)=>o.jsx(KR,{ref:r,className:he("text-lg font-semibold",e),...t}));_a.displayName=KR.displayName;const Sa=J.forwardRef(({className:e,...t},r)=>o.jsx(YR,{ref:r,className:he("text-sm text-muted-foreground",e),...t}));Sa.displayName=YR.displayName;const Na=J.forwardRef(({className:e,...t},r)=>o.jsx(HR,{ref:r,className:he(B0(),e),...t}));Na.displayName=HR.displayName;const Ea=J.forwardRef(({className:e,...t},r)=>o.jsx(GR,{ref:r,className:he(B0({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Ea.displayName=GR.displayName;function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},je.apply(null,arguments)}function N1(e,[t,r]){return Math.min(r,Math.max(t,e))}function vt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function Iy(e,t=[]){let r=[];function n(i,a){const l=p.createContext(a),c=r.length;r=[...r,a];function u(d){const{scope:h,children:m,...g}=d,v=(h==null?void 0:h[e][c])||l,y=p.useMemo(()=>g,Object.values(g));return p.createElement(v.Provider,{value:y},m)}function f(d,h){const m=(h==null?void 0:h[e][c])||l,g=p.useContext(m);if(g)return g;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,f]}const s=()=>{const i=r.map(a=>p.createContext(a));return function(l){const c=(l==null?void 0:l[e])||i;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,MK(s,...t)]}function MK(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:c,scopeName:u})=>{const d=c(i)[`__scope${u}`];return{...l,...d}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}function LK(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function XR(...e){return t=>e.forEach(r=>LK(r,t))}function Dt(...e){return p.useCallback(XR(...e),e)}const dc=p.forwardRef((e,t)=>{const{children:r,...n}=e,s=p.Children.toArray(r),i=s.find(BK);if(i){const a=i.props.children,l=s.map(c=>c===i?p.Children.count(a)>1?p.Children.only(null):p.isValidElement(a)?a.props.children:null:c);return p.createElement(Fv,je({},n,{ref:t}),p.isValidElement(a)?p.cloneElement(a,void 0,l):null)}return p.createElement(Fv,je({},n,{ref:t}),r)});dc.displayName="Slot";const Fv=p.forwardRef((e,t)=>{const{children:r,...n}=e;return p.isValidElement(r)?p.cloneElement(r,{...zK(n,r.props),ref:t?XR(t,r.ref):r.ref}):p.Children.count(r)>1?p.Children.only(null):null});Fv.displayName="SlotClone";const FK=({children:e})=>p.createElement(p.Fragment,null,e);function BK(e){return p.isValidElement(e)&&e.type===FK}function zK(e,t){const r={...t};for(const n in t){const s=e[n],i=t[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...l)=>{i(...l),s(...l)}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}function UK(e){const t=e+"CollectionProvider",[r,n]=Iy(t),[s,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=m=>{const{scope:g,children:v}=m,y=J.useRef(null),x=J.useRef(new Map).current;return J.createElement(s,{scope:g,itemMap:x,collectionRef:y},v)},l=e+"CollectionSlot",c=J.forwardRef((m,g)=>{const{scope:v,children:y}=m,x=i(l,v),b=Dt(g,x.collectionRef);return J.createElement(dc,{ref:b},y)}),u=e+"CollectionItemSlot",f="data-radix-collection-item",d=J.forwardRef((m,g)=>{const{scope:v,children:y,...x}=m,b=J.useRef(null),w=Dt(g,b),j=i(u,v);return J.useEffect(()=>(j.itemMap.set(b,{ref:b,...x}),()=>void j.itemMap.delete(b))),J.createElement(dc,{[f]:"",ref:w},y)});function h(m){const g=i(e+"CollectionConsumer",m);return J.useCallback(()=>{const y=g.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${f}]`));return Array.from(g.itemMap.values()).sort((j,_)=>x.indexOf(j.ref.current)-x.indexOf(_.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:a,Slot:c,ItemSlot:d},h,n]}const VK=p.createContext(void 0);function qK(e){const t=p.useContext(VK);return e||t||"ltr"}const WK=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ct=WK.reduce((e,t)=>{const r=p.forwardRef((n,s)=>{const{asChild:i,...a}=n,l=i?dc:t;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,je({},a,{ref:s}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function HK(e,t){e&&jr.flushSync(()=>e.dispatchEvent(t))}function Xn(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...r)=>{var n;return(n=t.current)===null||n===void 0?void 0:n.call(t,...r)},[])}function GK(e,t=globalThis==null?void 0:globalThis.document){const r=Xn(e);p.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n),()=>t.removeEventListener("keydown",n)},[r,t])}const Bv="dismissableLayer.update",KK="dismissableLayer.pointerDownOutside",YK="dismissableLayer.focusOutside";let E1;const JK=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),XK=p.forwardRef((e,t)=>{var r;const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:l,onDismiss:c,...u}=e,f=p.useContext(JK),[d,h]=p.useState(null),m=(r=d==null?void 0:d.ownerDocument)!==null&&r!==void 0?r:globalThis==null?void 0:globalThis.document,[,g]=p.useState({}),v=Dt(t,E=>h(E)),y=Array.from(f.layers),[x]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),b=y.indexOf(x),w=d?y.indexOf(d):-1,j=f.layersWithOutsidePointerEventsDisabled.size>0,_=w>=b,S=QK(E=>{const C=E.target,k=[...f.branches].some(L=>L.contains(C));!_||k||(i==null||i(E),l==null||l(E),E.defaultPrevented||c==null||c())},m),N=ZK(E=>{const C=E.target;[...f.branches].some(L=>L.contains(C))||(a==null||a(E),l==null||l(E),E.defaultPrevented||c==null||c())},m);return GK(E=>{w===f.layers.size-1&&(s==null||s(E),!E.defaultPrevented&&c&&(E.preventDefault(),c()))},m),p.useEffect(()=>{if(d)return n&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(E1=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(d)),f.layers.add(d),C1(),()=>{n&&f.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=E1)}},[d,m,n,f]),p.useEffect(()=>()=>{d&&(f.layers.delete(d),f.layersWithOutsidePointerEventsDisabled.delete(d),C1())},[d,f]),p.useEffect(()=>{const E=()=>g({});return document.addEventListener(Bv,E),()=>document.removeEventListener(Bv,E)},[]),p.createElement(Ct.div,je({},u,{ref:v,style:{pointerEvents:j?_?"auto":"none":void 0,...e.style},onFocusCapture:vt(e.onFocusCapture,N.onFocusCapture),onBlurCapture:vt(e.onBlurCapture,N.onBlurCapture),onPointerDownCapture:vt(e.onPointerDownCapture,S.onPointerDownCapture)}))});function QK(e,t=globalThis==null?void 0:globalThis.document){const r=Xn(e),n=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let u=function(){QR(KK,r,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=u,t.addEventListener("click",s.current,{once:!0})):u()}n.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function ZK(e,t=globalThis==null?void 0:globalThis.document){const r=Xn(e),n=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!n.current&&QR(YK,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function C1(){const e=new CustomEvent(Bv);document.dispatchEvent(e)}function QR(e,t,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?HK(s,i):s.dispatchEvent(i)}let bm=0;function eY(){p.useEffect(()=>{var e,t;const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=r[0])!==null&&e!==void 0?e:P1()),document.body.insertAdjacentElement("beforeend",(t=r[1])!==null&&t!==void 0?t:P1()),bm++,()=>{bm===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),bm--}},[])}function P1(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}const wm="focusScope.autoFocusOnMount",jm="focusScope.autoFocusOnUnmount",T1={bubbles:!1,cancelable:!0},tY=p.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[l,c]=p.useState(null),u=Xn(s),f=Xn(i),d=p.useRef(null),h=Dt(t,v=>c(v)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(n){let v=function(w){if(m.paused||!l)return;const j=w.target;l.contains(j)?d.current=j:ls(d.current,{select:!0})},y=function(w){if(m.paused||!l)return;const j=w.relatedTarget;j!==null&&(l.contains(j)||ls(d.current,{select:!0}))},x=function(w){const j=document.activeElement;for(const _ of w)_.removedNodes.length>0&&(l!=null&&l.contains(j)||ls(l))};document.addEventListener("focusin",v),document.addEventListener("focusout",y);const b=new MutationObserver(x);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",y),b.disconnect()}}},[n,l,m.paused]),p.useEffect(()=>{if(l){A1.add(m);const v=document.activeElement;if(!l.contains(v)){const x=new CustomEvent(wm,T1);l.addEventListener(wm,u),l.dispatchEvent(x),x.defaultPrevented||(rY(aY(ZR(l)),{select:!0}),document.activeElement===v&&ls(l))}return()=>{l.removeEventListener(wm,u),setTimeout(()=>{const x=new CustomEvent(jm,T1);l.addEventListener(jm,f),l.dispatchEvent(x),x.defaultPrevented||ls(v??document.body,{select:!0}),l.removeEventListener(jm,f),A1.remove(m)},0)}}},[l,u,f,m]);const g=p.useCallback(v=>{if(!r&&!n||m.paused)return;const y=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,x=document.activeElement;if(y&&x){const b=v.currentTarget,[w,j]=nY(b);w&&j?!v.shiftKey&&x===j?(v.preventDefault(),r&&ls(w,{select:!0})):v.shiftKey&&x===w&&(v.preventDefault(),r&&ls(j,{select:!0})):x===b&&v.preventDefault()}},[r,n,m.paused]);return p.createElement(Ct.div,je({tabIndex:-1},a,{ref:h,onKeyDown:g}))});function rY(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(ls(n,{select:t}),document.activeElement!==r)return}function nY(e){const t=ZR(e),r=k1(t,e),n=k1(t.reverse(),e);return[r,n]}function ZR(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function k1(e,t){for(const r of e)if(!sY(r,{upTo:t}))return r}function sY(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function iY(e){return e instanceof HTMLInputElement&&"select"in e}function ls(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&iY(e)&&t&&e.select()}}const A1=oY();function oY(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=R1(e,t),e.unshift(t)},remove(t){var r;e=R1(e,t),(r=e[0])===null||r===void 0||r.resume()}}}function R1(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function aY(e){return e.filter(t=>t.tagName!=="A")}const Lr=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},lY=wc["useId".toString()]||(()=>{});let cY=0;function eI(e){const[t,r]=p.useState(lY());return Lr(()=>{e||r(n=>n??String(cY++))},[e]),e||(t?`radix-${t}`:"")}function uY(e){const[t,r]=p.useState(void 0);return Lr(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;a=u.inlineSize,l=u.blockSize}else a=e.offsetWidth,l=e.offsetHeight;r({width:a,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}const tI="Popper",[rI,nI]=Iy(tI),[dY,sI]=rI(tI),fY=e=>{const{__scopePopper:t,children:r}=e,[n,s]=p.useState(null);return p.createElement(dY,{scope:t,anchor:n,onAnchorChange:s},r)},hY="PopperAnchor",pY=p.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,i=sI(hY,r),a=p.useRef(null),l=Dt(t,a);return p.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||a.current)}),n?null:p.createElement(Ct.div,je({},s,{ref:l}))}),iI="PopperContent",[mY,poe]=rI(iI),gY=p.forwardRef((e,t)=>{var r,n,s,i,a,l,c,u;const{__scopePopper:f,side:d="bottom",sideOffset:h=0,align:m="center",alignOffset:g=0,arrowPadding:v=0,collisionBoundary:y=[],collisionPadding:x=0,sticky:b="partial",hideWhenDetached:w=!1,avoidCollisions:j=!0,onPlaced:_,...S}=e,N=sI(iI,f),[E,C]=p.useState(null),k=Dt(t,ke=>C(ke)),[L,A]=p.useState(null),R=uY(L),O=(r=R==null?void 0:R.width)!==null&&r!==void 0?r:0,z=(n=R==null?void 0:R.height)!==null&&n!==void 0?n:0,F=d+(m!=="center"?"-"+m:""),V=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},I=Array.isArray(y)?y:[y],D=I.length>0,$={padding:V,boundary:I.filter(vY),altBoundary:D},{refs:M,floatingStyles:W,placement:U,isPositioned:X,middlewareData:me}=iT({strategy:"fixed",placement:F,whileElementsMounted:nT,elements:{reference:N.anchor},middleware:[oT({mainAxis:h+z,alignmentAxis:g}),j&&aT({mainAxis:!0,crossAxis:!1,limiter:b==="partial"?lT():void 0,...$}),j&&cT({...$}),uT({...$,apply:({elements:ke,rects:dt,availableWidth:cn,availableHeight:Nn})=>{const{width:Ra,height:rs}=dt.reference,Ki=ke.floating.style;Ki.setProperty("--radix-popper-available-width",`${cn}px`),Ki.setProperty("--radix-popper-available-height",`${Nn}px`),Ki.setProperty("--radix-popper-anchor-width",`${Ra}px`),Ki.setProperty("--radix-popper-anchor-height",`${rs}px`)}}),L&&fT({element:L,padding:v}),xY({arrowWidth:O,arrowHeight:z}),w&&dT({strategy:"referenceHidden"})]}),[se,Z]=oI(U),oe=Xn(_);Lr(()=>{X&&(oe==null||oe())},[X,oe]);const H=(s=me.arrow)===null||s===void 0?void 0:s.x,q=(i=me.arrow)===null||i===void 0?void 0:i.y,te=((a=me.arrow)===null||a===void 0?void 0:a.centerOffset)!==0,[ue,_e]=p.useState();return Lr(()=>{E&&_e(window.getComputedStyle(E).zIndex)},[E]),p.createElement("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:X?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ue,"--radix-popper-transform-origin":[(l=me.transformOrigin)===null||l===void 0?void 0:l.x,(c=me.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:e.dir},p.createElement(mY,{scope:f,placedSide:se,onArrowChange:A,arrowX:H,arrowY:q,shouldHideArrow:te},p.createElement(Ct.div,je({"data-side":se,"data-align":Z},S,{ref:k,style:{...S.style,animation:X?void 0:"none",opacity:(u=me.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function vY(e){return e!==null}const xY=e=>({name:"transformOrigin",options:e,fn(t){var r,n,s,i,a;const{placement:l,rects:c,middlewareData:u}=t,d=((r=u.arrow)===null||r===void 0?void 0:r.centerOffset)!==0,h=d?0:e.arrowWidth,m=d?0:e.arrowHeight,[g,v]=oI(l),y={start:"0%",center:"50%",end:"100%"}[v],x=((n=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&n!==void 0?n:0)+h/2,b=((i=(a=u.arrow)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0)+m/2;let w="",j="";return g==="bottom"?(w=d?y:`${x}px`,j=`${-m}px`):g==="top"?(w=d?y:`${x}px`,j=`${c.floating.height+m}px`):g==="right"?(w=`${-m}px`,j=d?y:`${b}px`):g==="left"&&(w=`${c.floating.width+m}px`,j=d?y:`${b}px`),{data:{x:w,y:j}}}});function oI(e){const[t,r="center"]=e.split("-");return[t,r]}const yY=fY,bY=pY,wY=gY,jY=p.forwardRef((e,t)=>{var r;const{container:n=globalThis==null||(r=globalThis.document)===null||r===void 0?void 0:r.body,...s}=e;return n?Mf.createPortal(p.createElement(Ct.div,je({},s,{ref:t})),n):null});function I1({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,s]=_Y({defaultProp:t,onChange:r}),i=e!==void 0,a=i?e:n,l=Xn(r),c=p.useCallback(u=>{if(i){const d=typeof u=="function"?u(e):u;d!==e&&l(d)}else s(u)},[i,e,s,l]);return[a,c]}function _Y({defaultProp:e,onChange:t}){const r=p.useState(e),[n]=r,s=p.useRef(n),i=Xn(t);return p.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),r}function SY(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}const NY=p.forwardRef((e,t)=>p.createElement(Ct.span,je({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}})));var aI=ey(),_m=function(){},_h=p.forwardRef(function(e,t){var r=p.useRef(null),n=p.useState({onScrollCapture:_m,onWheelCapture:_m,onTouchMoveCapture:_m}),s=n[0],i=n[1],a=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,f=e.enabled,d=e.shards,h=e.sideCar,m=e.noIsolation,g=e.inert,v=e.allowPinchZoom,y=e.as,x=y===void 0?"div":y,b=Sn(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),w=h,j=Z0([r,t]),_=Qe(Qe({},b),s);return p.createElement(p.Fragment,null,f&&p.createElement(w,{sideCar:aI,removeScrollBar:u,shards:d,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!v,lockRef:r}),a?p.cloneElement(p.Children.only(l),Qe(Qe({},_),{ref:j})):p.createElement(x,Qe({},_,{className:c,ref:j}),l))});_h.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};_h.classNames={fullWidth:Bo,zeroRight:Fo};var zv=!1;if(typeof window<"u")try{var Fu=Object.defineProperty({},"passive",{get:function(){return zv=!0,!0}});window.addEventListener("test",Fu,Fu),window.removeEventListener("test",Fu,Fu)}catch{zv=!1}var io=zv?{passive:!1}:!1,EY=function(e){return e.tagName==="TEXTAREA"},lI=function(e,t){var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!EY(e)&&r[t]==="visible")},CY=function(e){return lI(e,"overflowY")},PY=function(e){return lI(e,"overflowX")},O1=function(e,t){var r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var n=cI(e,r);if(n){var s=uI(e,r),i=s[1],a=s[2];if(i>a)return!0}r=r.parentNode}while(r&&r!==document.body);return!1},TY=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},kY=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},cI=function(e,t){return e==="v"?CY(t):PY(t)},uI=function(e,t){return e==="v"?TY(t):kY(t)},AY=function(e,t){return e==="h"&&t==="rtl"?-1:1},RY=function(e,t,r,n,s){var i=AY(e,window.getComputedStyle(t).direction),a=i*n,l=r.target,c=t.contains(l),u=!1,f=a>0,d=0,h=0;do{var m=uI(e,l),g=m[0],v=m[1],y=m[2],x=v-y-i*g;(g||x)&&cI(e,l)&&(d+=x,h+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(f&&(s&&d===0||!s&&a>d)||!f&&(s&&h===0||!s&&-a>h))&&(u=!0),u},Bu=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},D1=function(e){return[e.deltaX,e.deltaY]},$1=function(e){return e&&"current"in e?e.current:e},IY=function(e,t){return e[0]===t[0]&&e[1]===t[1]},OY=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},DY=0,oo=[];function $Y(e){var t=p.useRef([]),r=p.useRef([0,0]),n=p.useRef(),s=p.useState(DY++)[0],i=p.useState(function(){return dh()})[0],a=p.useRef(e);p.useEffect(function(){a.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var v=Fc([e.lockRef.current],(e.shards||[]).map($1),!0).filter(Boolean);return v.forEach(function(y){return y.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),v.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(v,y){if("touches"in v&&v.touches.length===2)return!a.current.allowPinchZoom;var x=Bu(v),b=r.current,w="deltaX"in v?v.deltaX:b[0]-x[0],j="deltaY"in v?v.deltaY:b[1]-x[1],_,S=v.target,N=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in v&&N==="h"&&S.type==="range")return!1;var E=O1(N,S);if(!E)return!0;if(E?_=N:(_=N==="v"?"h":"v",E=O1(N,S)),!E)return!1;if(!n.current&&"changedTouches"in v&&(w||j)&&(n.current=_),!_)return!0;var C=n.current||_;return RY(C,y,v,C==="h"?w:j,!0)},[]),c=p.useCallback(function(v){var y=v;if(!(!oo.length||oo[oo.length-1]!==i)){var x="deltaY"in y?D1(y):Bu(y),b=t.current.filter(function(_){return _.name===y.type&&_.target===y.target&&IY(_.delta,x)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(a.current.shards||[]).map($1).filter(Boolean).filter(function(_){return _.contains(y.target)}),j=w.length>0?l(y,w[0]):!a.current.noIsolation;j&&y.cancelable&&y.preventDefault()}}},[]),u=p.useCallback(function(v,y,x,b){var w={name:v,delta:y,target:x,should:b};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(j){return j!==w})},1)},[]),f=p.useCallback(function(v){r.current=Bu(v),n.current=void 0},[]),d=p.useCallback(function(v){u(v.type,D1(v),v.target,l(v,e.lockRef.current))},[]),h=p.useCallback(function(v){u(v.type,Bu(v),v.target,l(v,e.lockRef.current))},[]);p.useEffect(function(){return oo.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",c,io),document.addEventListener("touchmove",c,io),document.addEventListener("touchstart",f,io),function(){oo=oo.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,io),document.removeEventListener("touchmove",c,io),document.removeEventListener("touchstart",f,io)}},[]);var m=e.removeScrollBar,g=e.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:OY(s)}):null,m?p.createElement(ry,{gapMode:"margin"}):null)}const MY=ty(aI,$Y);var dI=p.forwardRef(function(e,t){return p.createElement(_h,Qe({},e,{ref:t,sideCar:MY}))});dI.classNames=_h.classNames;const LY=dI,FY=[" ","Enter","ArrowUp","ArrowDown"],BY=[" ","Enter"],Sh="Select",[Nh,Eh,zY]=UK(Sh),[Ca,moe]=Iy(Sh,[zY,nI]),Oy=nI(),[UY,Wi]=Ca(Sh),[VY,qY]=Ca(Sh),WY=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:i,value:a,defaultValue:l,onValueChange:c,dir:u,name:f,autoComplete:d,disabled:h,required:m}=e,g=Oy(t),[v,y]=p.useState(null),[x,b]=p.useState(null),[w,j]=p.useState(!1),_=qK(u),[S=!1,N]=I1({prop:n,defaultProp:s,onChange:i}),[E,C]=I1({prop:a,defaultProp:l,onChange:c}),k=p.useRef(null),L=v?!!v.closest("form"):!0,[A,R]=p.useState(new Set),O=Array.from(A).map(z=>z.props.value).join(";");return p.createElement(yY,g,p.createElement(UY,{required:m,scope:t,trigger:v,onTriggerChange:y,valueNode:x,onValueNodeChange:b,valueNodeHasChildren:w,onValueNodeHasChildrenChange:j,contentId:eI(),value:E,onValueChange:C,open:S,onOpenChange:N,dir:_,triggerPointerDownPosRef:k,disabled:h},p.createElement(Nh.Provider,{scope:t},p.createElement(VY,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(z=>{R(F=>new Set(F).add(z))},[]),onNativeOptionRemove:p.useCallback(z=>{R(F=>{const V=new Set(F);return V.delete(z),V})},[])},r)),L?p.createElement(mI,{key:O,"aria-hidden":!0,required:m,tabIndex:-1,name:f,autoComplete:d,value:E,onChange:z=>C(z.target.value),disabled:h},E===void 0?p.createElement("option",{value:""}):null,Array.from(A)):null))},HY="SelectTrigger",GY=p.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,i=Oy(r),a=Wi(HY,r),l=a.disabled||n,c=Dt(t,a.onTriggerChange),u=Eh(r),[f,d,h]=gI(g=>{const v=u().filter(b=>!b.disabled),y=v.find(b=>b.value===a.value),x=vI(v,g,y);x!==void 0&&a.onValueChange(x.value)}),m=()=>{l||(a.onOpenChange(!0),h())};return p.createElement(bY,je({asChild:!0},i),p.createElement(Ct.button,je({type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":a.value===void 0?"":void 0},s,{ref:c,onClick:vt(s.onClick,g=>{g.currentTarget.focus()}),onPointerDown:vt(s.onPointerDown,g=>{const v=g.target;v.hasPointerCapture(g.pointerId)&&v.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&(m(),a.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)},g.preventDefault())}),onKeyDown:vt(s.onKeyDown,g=>{const v=f.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&d(g.key),!(v&&g.key===" ")&&FY.includes(g.key)&&(m(),g.preventDefault())})})))}),KY="SelectValue",YY=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:i,placeholder:a,...l}=e,c=Wi(KY,r),{onValueNodeHasChildrenChange:u}=c,f=i!==void 0,d=Dt(t,c.onValueNodeChange);return Lr(()=>{u(f)},[u,f]),p.createElement(Ct.span,je({},l,{ref:d,style:{pointerEvents:"none"}}),c.value===void 0&&a!==void 0?a:i)}),JY=p.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return p.createElement(Ct.span,je({"aria-hidden":!0},s,{ref:t}),n||"")}),XY=e=>p.createElement(jY,je({asChild:!0},e)),ia="SelectContent",QY=p.forwardRef((e,t)=>{const r=Wi(ia,e.__scopeSelect),[n,s]=p.useState();if(Lr(()=>{s(new DocumentFragment)},[]),!r.open){const i=n;return i?jr.createPortal(p.createElement(fI,{scope:e.__scopeSelect},p.createElement(Nh.Slot,{scope:e.__scopeSelect},p.createElement("div",null,e.children))),i):null}return p.createElement(ZY,je({},e,{ref:t}))}),kn=10,[fI,Hi]=Ca(ia),ZY=p.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:l,sideOffset:c,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:g,hideWhenDetached:v,avoidCollisions:y,...x}=e,b=Wi(ia,r),[w,j]=p.useState(null),[_,S]=p.useState(null),N=Dt(t,Z=>j(Z)),[E,C]=p.useState(null),[k,L]=p.useState(null),A=Eh(r),[R,O]=p.useState(!1),z=p.useRef(!1);p.useEffect(()=>{if(w)return Lc(w)},[w]),eY();const F=p.useCallback(Z=>{const[oe,...H]=A().map(ue=>ue.ref.current),[q]=H.slice(-1),te=document.activeElement;for(const ue of Z)if(ue===te||(ue==null||ue.scrollIntoView({block:"nearest"}),ue===oe&&_&&(_.scrollTop=0),ue===q&&_&&(_.scrollTop=_.scrollHeight),ue==null||ue.focus(),document.activeElement!==te))return},[A,_]),V=p.useCallback(()=>F([E,w]),[F,E,w]);p.useEffect(()=>{R&&V()},[R,V]);const{onOpenChange:I,triggerPointerDownPosRef:D}=b;p.useEffect(()=>{if(w){let Z={x:0,y:0};const oe=q=>{var te,ue,_e,ke;Z={x:Math.abs(Math.round(q.pageX)-((te=(ue=D.current)===null||ue===void 0?void 0:ue.x)!==null&&te!==void 0?te:0)),y:Math.abs(Math.round(q.pageY)-((_e=(ke=D.current)===null||ke===void 0?void 0:ke.y)!==null&&_e!==void 0?_e:0))}},H=q=>{Z.x<=10&&Z.y<=10?q.preventDefault():w.contains(q.target)||I(!1),document.removeEventListener("pointermove",oe),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",H,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",H,{capture:!0})}}},[w,I,D]),p.useEffect(()=>{const Z=()=>I(!1);return window.addEventListener("blur",Z),window.addEventListener("resize",Z),()=>{window.removeEventListener("blur",Z),window.removeEventListener("resize",Z)}},[I]);const[$,M]=gI(Z=>{const oe=A().filter(te=>!te.disabled),H=oe.find(te=>te.ref.current===document.activeElement),q=vI(oe,Z,H);q&&setTimeout(()=>q.ref.current.focus())}),W=p.useCallback((Z,oe,H)=>{const q=!z.current&&!H;(b.value!==void 0&&b.value===oe||q)&&(C(Z),q&&(z.current=!0))},[b.value]),U=p.useCallback(()=>w==null?void 0:w.focus(),[w]),X=p.useCallback((Z,oe,H)=>{const q=!z.current&&!H;(b.value!==void 0&&b.value===oe||q)&&L(Z)},[b.value]),me=n==="popper"?M1:eJ,se=me===M1?{side:l,sideOffset:c,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:g,hideWhenDetached:v,avoidCollisions:y}:{};return p.createElement(fI,{scope:r,content:w,viewport:_,onViewportChange:S,itemRefCallback:W,selectedItem:E,onItemLeave:U,itemTextRefCallback:X,focusSelectedItem:V,selectedItemText:k,position:n,isPositioned:R,searchRef:$},p.createElement(LY,{as:dc,allowPinchZoom:!0},p.createElement(tY,{asChild:!0,trapped:b.open,onMountAutoFocus:Z=>{Z.preventDefault()},onUnmountAutoFocus:vt(s,Z=>{var oe;(oe=b.trigger)===null||oe===void 0||oe.focus({preventScroll:!0}),Z.preventDefault()})},p.createElement(XK,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:Z=>Z.preventDefault(),onDismiss:()=>b.onOpenChange(!1)},p.createElement(me,je({role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:Z=>Z.preventDefault()},x,se,{onPlaced:()=>O(!0),ref:N,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:vt(x.onKeyDown,Z=>{const oe=Z.ctrlKey||Z.altKey||Z.metaKey;if(Z.key==="Tab"&&Z.preventDefault(),!oe&&Z.key.length===1&&M(Z.key),["ArrowUp","ArrowDown","Home","End"].includes(Z.key)){let q=A().filter(te=>!te.disabled).map(te=>te.ref.current);if(["ArrowUp","End"].includes(Z.key)&&(q=q.slice().reverse()),["ArrowUp","ArrowDown"].includes(Z.key)){const te=Z.target,ue=q.indexOf(te);q=q.slice(ue+1)}setTimeout(()=>F(q)),Z.preventDefault()}})}))))))}),eJ=p.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,i=Wi(ia,r),a=Hi(ia,r),[l,c]=p.useState(null),[u,f]=p.useState(null),d=Dt(t,N=>f(N)),h=Eh(r),m=p.useRef(!1),g=p.useRef(!0),{viewport:v,selectedItem:y,selectedItemText:x,focusSelectedItem:b}=a,w=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&v&&y&&x){const N=i.trigger.getBoundingClientRect(),E=u.getBoundingClientRect(),C=i.valueNode.getBoundingClientRect(),k=x.getBoundingClientRect();if(i.dir!=="rtl"){const te=k.left-E.left,ue=C.left-te,_e=N.left-ue,ke=N.width+_e,dt=Math.max(ke,E.width),cn=window.innerWidth-kn,Nn=N1(ue,[kn,cn-dt]);l.style.minWidth=ke+"px",l.style.left=Nn+"px"}else{const te=E.right-k.right,ue=window.innerWidth-C.right-te,_e=window.innerWidth-N.right-ue,ke=N.width+_e,dt=Math.max(ke,E.width),cn=window.innerWidth-kn,Nn=N1(ue,[kn,cn-dt]);l.style.minWidth=ke+"px",l.style.right=Nn+"px"}const L=h(),A=window.innerHeight-kn*2,R=v.scrollHeight,O=window.getComputedStyle(u),z=parseInt(O.borderTopWidth,10),F=parseInt(O.paddingTop,10),V=parseInt(O.borderBottomWidth,10),I=parseInt(O.paddingBottom,10),D=z+F+R+I+V,$=Math.min(y.offsetHeight*5,D),M=window.getComputedStyle(v),W=parseInt(M.paddingTop,10),U=parseInt(M.paddingBottom,10),X=N.top+N.height/2-kn,me=A-X,se=y.offsetHeight/2,Z=y.offsetTop+se,oe=z+F+Z,H=D-oe;if(oe<=X){const te=y===L[L.length-1].ref.current;l.style.bottom="0px";const ue=u.clientHeight-v.offsetTop-v.offsetHeight,_e=Math.max(me,se+(te?U:0)+ue+V),ke=oe+_e;l.style.height=ke+"px"}else{const te=y===L[0].ref.current;l.style.top="0px";const _e=Math.max(X,z+v.offsetTop+(te?W:0)+se)+H;l.style.height=_e+"px",v.scrollTop=oe-X+v.offsetTop}l.style.margin=`${kn}px 0`,l.style.minHeight=$+"px",l.style.maxHeight=A+"px",n==null||n(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,l,u,v,y,x,i.dir,n]);Lr(()=>w(),[w]);const[j,_]=p.useState();Lr(()=>{u&&_(window.getComputedStyle(u).zIndex)},[u]);const S=p.useCallback(N=>{N&&g.current===!0&&(w(),b==null||b(),g.current=!1)},[w,b]);return p.createElement(tJ,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:S},p.createElement("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j}},p.createElement(Ct.div,je({},s,{ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}}))))}),M1=p.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=kn,...i}=e,a=Oy(r);return p.createElement(wY,je({},a,i,{ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[tJ,Dy]=Ca(ia,{}),L1="SelectViewport",rJ=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Hi(L1,r),i=Dy(L1,r),a=Dt(t,s.onViewportChange),l=p.useRef(0);return p.createElement(p.Fragment,null,p.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),p.createElement(Nh.Slot,{scope:r},p.createElement(Ct.div,je({"data-radix-select-viewport":"",role:"presentation"},n,{ref:a,style:{position:"relative",flex:1,overflow:"auto",...n.style},onScroll:vt(n.onScroll,c=>{const u=c.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:d}=i;if(d!=null&&d.current&&f){const h=Math.abs(l.current-u.scrollTop);if(h>0){const m=window.innerHeight-kn*2,g=parseFloat(f.style.minHeight),v=parseFloat(f.style.height),y=Math.max(g,v);if(y<m){const x=y+h,b=Math.min(m,x),w=x-b;f.style.height=b+"px",f.style.bottom==="0px"&&(u.scrollTop=w>0?w:0,f.style.justifyContent="flex-end")}}}l.current=u.scrollTop})}))))}),nJ="SelectGroup",[goe,sJ]=Ca(nJ),iJ="SelectLabel",oJ=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=sJ(iJ,r);return p.createElement(Ct.div,je({id:s.id},n,{ref:t}))}),Uv="SelectItem",[aJ,hI]=Ca(Uv),lJ=p.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:i,...a}=e,l=Wi(Uv,r),c=Hi(Uv,r),u=l.value===n,[f,d]=p.useState(i??""),[h,m]=p.useState(!1),g=Dt(t,x=>{var b;return(b=c.itemRefCallback)===null||b===void 0?void 0:b.call(c,x,n,s)}),v=eI(),y=()=>{s||(l.onValueChange(n),l.onOpenChange(!1))};return p.createElement(aJ,{scope:r,value:n,disabled:s,textId:v,isSelected:u,onItemTextChange:p.useCallback(x=>{d(b=>{var w;return b||((w=x==null?void 0:x.textContent)!==null&&w!==void 0?w:"").trim()})},[])},p.createElement(Nh.ItemSlot,{scope:r,value:n,disabled:s,textValue:f},p.createElement(Ct.div,je({role:"option","aria-labelledby":v,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1},a,{ref:g,onFocus:vt(a.onFocus,()=>m(!0)),onBlur:vt(a.onBlur,()=>m(!1)),onPointerUp:vt(a.onPointerUp,y),onPointerMove:vt(a.onPointerMove,x=>{if(s){var b;(b=c.onItemLeave)===null||b===void 0||b.call(c)}else x.currentTarget.focus({preventScroll:!0})}),onPointerLeave:vt(a.onPointerLeave,x=>{if(x.currentTarget===document.activeElement){var b;(b=c.onItemLeave)===null||b===void 0||b.call(c)}}),onKeyDown:vt(a.onKeyDown,x=>{var b;((b=c.searchRef)===null||b===void 0?void 0:b.current)!==""&&x.key===" "||(BY.includes(x.key)&&y(),x.key===" "&&x.preventDefault())})}))))}),zu="SelectItemText",cJ=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...i}=e,a=Wi(zu,r),l=Hi(zu,r),c=hI(zu,r),u=qY(zu,r),[f,d]=p.useState(null),h=Dt(t,x=>d(x),c.onItemTextChange,x=>{var b;return(b=l.itemTextRefCallback)===null||b===void 0?void 0:b.call(l,x,c.value,c.disabled)}),m=f==null?void 0:f.textContent,g=p.useMemo(()=>p.createElement("option",{key:c.value,value:c.value,disabled:c.disabled},m),[c.disabled,c.value,m]),{onNativeOptionAdd:v,onNativeOptionRemove:y}=u;return Lr(()=>(v(g),()=>y(g)),[v,y,g]),p.createElement(p.Fragment,null,p.createElement(Ct.span,je({id:c.textId},i,{ref:h})),c.isSelected&&a.valueNode&&!a.valueNodeHasChildren?jr.createPortal(i.children,a.valueNode):null)}),uJ="SelectItemIndicator",dJ=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return hI(uJ,r).isSelected?p.createElement(Ct.span,je({"aria-hidden":!0},n,{ref:t})):null}),F1="SelectScrollUpButton",fJ=p.forwardRef((e,t)=>{const r=Hi(F1,e.__scopeSelect),n=Dy(F1,e.__scopeSelect),[s,i]=p.useState(!1),a=Dt(t,n.onScrollButtonChange);return Lr(()=>{if(r.viewport&&r.isPositioned){let c=function(){const u=l.scrollTop>0;i(u)};const l=r.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),s?p.createElement(pI,je({},e,{ref:a,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null}),B1="SelectScrollDownButton",hJ=p.forwardRef((e,t)=>{const r=Hi(B1,e.__scopeSelect),n=Dy(B1,e.__scopeSelect),[s,i]=p.useState(!1),a=Dt(t,n.onScrollButtonChange);return Lr(()=>{if(r.viewport&&r.isPositioned){let c=function(){const u=l.scrollHeight-l.clientHeight,f=Math.ceil(l.scrollTop)<u;i(f)};const l=r.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),s?p.createElement(pI,je({},e,{ref:a,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null}),pI=p.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,i=Hi("SelectScrollButton",r),a=p.useRef(null),l=Eh(r),c=p.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),Lr(()=>{var u;const f=l().find(d=>d.ref.current===document.activeElement);f==null||(u=f.ref.current)===null||u===void 0||u.scrollIntoView({block:"nearest"})},[l]),p.createElement(Ct.div,je({"aria-hidden":!0},s,{ref:t,style:{flexShrink:0,...s.style},onPointerDown:vt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(n,50))}),onPointerMove:vt(s.onPointerMove,()=>{var u;(u=i.onItemLeave)===null||u===void 0||u.call(i),a.current===null&&(a.current=window.setInterval(n,50))}),onPointerLeave:vt(s.onPointerLeave,()=>{c()})}))}),pJ=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return p.createElement(Ct.div,je({"aria-hidden":!0},n,{ref:t}))}),mI=p.forwardRef((e,t)=>{const{value:r,...n}=e,s=p.useRef(null),i=Dt(t,s),a=SY(r);return p.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(c,"value").set;if(a!==r&&f){const d=new Event("change",{bubbles:!0});f.call(l,r),l.dispatchEvent(d)}},[a,r]),p.createElement(NY,{asChild:!0},p.createElement("select",je({},n,{ref:i,defaultValue:r})))});mI.displayName="BubbleSelect";function gI(e){const t=Xn(e),r=p.useRef(""),n=p.useRef(0),s=p.useCallback(a=>{const l=r.current+a;t(l),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=p.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,i]}function vI(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let a=mJ(e,Math.max(i,0));s.length===1&&(a=a.filter(u=>u!==r));const c=a.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function mJ(e,t){return e.map((r,n)=>e[(t+n)%e.length])}const gJ=WY,xI=GY,vJ=YY,xJ=JY,yJ=XY,yI=QY,bJ=rJ,bI=oJ,wI=lJ,wJ=cJ,jJ=dJ,_J=fJ,SJ=hJ,jI=pJ,Xt=gJ,Qt=vJ,zt=J.forwardRef(({className:e,children:t,iconClassName:r,...n},s)=>o.jsxs(xI,{ref:s,className:he("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...n,children:[t,o.jsx(xJ,{asChild:!0,children:o.jsx(Ds,{className:he("h-4 w-4 opacity-50",r)})})]}));zt.displayName=xI.displayName;const Ut=J.forwardRef(({className:e,children:t,position:r="popper",...n},s)=>o.jsx(yJ,{children:o.jsxs(yI,{ref:s,className:he("relative z-50 min-w-[8rem] rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[o.jsx(_J,{className:"hidden",children:o.jsx(b3,{className:"h-4 w-4"})}),o.jsx(bJ,{className:he("p-1 max-h-[300px] overflow-y-auto",r==="popper"&&"w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),o.jsx(SJ,{className:"hidden",children:o.jsx(Ds,{className:"h-4 w-4"})})]})}));Ut.displayName=yI.displayName;const NJ=J.forwardRef(({className:e,...t},r)=>o.jsx(bI,{ref:r,className:he("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));NJ.displayName=bI.displayName;const Pe=J.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(wI,{ref:n,className:he("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(jJ,{children:o.jsx(Mn,{className:"h-4 w-4"})})}),o.jsx(wJ,{children:t})]}));Pe.displayName=wI.displayName;const EJ=J.forwardRef(({className:e,...t},r)=>o.jsx(jI,{ref:r,className:he("-mx-1 my-1 h-px bg-muted",e),...t}));EJ.displayName=jI.displayName;function _I({organizationId:e=null,enabled:t=!0}={}){const[r,n]=p.useState({}),[s,i]=p.useState(!0),[a,l]=p.useState(null),c=h=>{const m={};return h.forEach(g=>{m[g.prompt_id]={id:g.prompt_id,name:g.name,tone:g.tone,projectId:g.project_id,stepsConfig:g.steps_config||{},createdAt:new Date(g.created_at).getTime(),updatedAt:new Date(g.updated_at).getTime()}}),m};return p.useEffect(()=>{if(!t||!e){n({}),i(!1);return}(async()=>{try{i(!0);const{data:g,error:v}=await T.rpc("get_prompts_for_org",{p_organization_id:e});if(v)throw v;const y=c(g||[]);P.debug("Prompts loaded",{count:Object.keys(y).length}),n(y),l(null)}catch(g){P.error(" Error loading prompts:",g),l(g.message)}finally{i(!1)}})();const m=T.channel(`prompts-changes-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"prompts",filter:`organization_id=eq.${e}`},g=>{var v;if(P.debug("Real-time prompts event",{eventType:g.eventType}),!((v=g.new)!=null&&v.organization_id&&g.new.organization_id!==e))if(g.eventType==="INSERT"){const y=g.new;n(x=>({...x,[y.prompt_id]:{id:y.prompt_id,name:y.name,tone:y.tone,projectId:y.project_id,stepsConfig:y.steps_config||{},createdAt:new Date(y.created_at).getTime(),updatedAt:new Date(y.updated_at).getTime()}}))}else if(g.eventType==="UPDATE"){const y=g.new;n(x=>({...x,[y.prompt_id]:{id:y.prompt_id,name:y.name,tone:y.tone,projectId:y.project_id,stepsConfig:y.steps_config||{},createdAt:new Date(y.created_at).getTime(),updatedAt:new Date(y.updated_at).getTime()}}))}else g.eventType==="DELETE"&&n(y=>{const x={...y};return delete x[g.old.prompt_id],x})}).subscribe(g=>{});return()=>{T.removeChannel(m)}},[e,t]),{prompts:r,loading:s,error:a,savePrompt:async(h,m)=>{try{if(!e)throw new Error("organization_id requis pour enregistrer un prompt");const g={prompt_id:h,name:m.name,tone:m.tone,project_id:m.projectId,steps_config:m.stepsConfig||{},organization_id:e},{data:v,error:y}=await T.from("prompts").upsert(g,{onConflict:"prompt_id"}).select().single();if(y)throw y;return P.debug("Prompt saved to Supabase",{promptId:v==null?void 0:v.prompt_id}),v&&n(x=>({...x,[v.prompt_id]:{id:v.prompt_id,name:v.name,tone:v.tone,projectId:v.project_id,stepsConfig:v.steps_config||{},createdAt:new Date(v.created_at).getTime(),updatedAt:new Date(v.updated_at).getTime()}})),{success:!0,data:v}}catch(g){return P.error("Error saving prompt:",g),{success:!1,error:g.message}}},deletePrompt:async h=>{try{const{error:m}=await T.from("prompts").delete().eq("prompt_id",h);if(m)throw m;return n(g=>{const v={...g};return delete v[h],v}),P.debug("Prompt deleted from Supabase",{promptId:h}),{success:!0}}catch(m){return P.error(" Error deleting prompt:",m),{success:!1,error:m.message}}},refresh:async()=>{if(e)try{const{data:h,error:m}=await T.rpc("get_prompts_for_org",{p_organization_id:e});if(m)throw m;const g=c(h||[]);n(g)}catch(h){P.error(" Error refreshing prompts:",h)}}}}function CJ(e=null){const[t,r]=p.useState([]),[n,s]=p.useState(!0),[i,a]=p.useState(null),l=d=>d.map(h=>({id:h.id,name:h.name,projectType:h.project_type,contentHtml:h.content_html,version:h.version,isActive:h.is_active,createdAt:h.created_at,updatedAt:h.updated_at}));return p.useEffect(()=>{if(!e){r([]),s(!1);return}(async()=>{try{s(!0);const{data:m,error:g}=await T.from("contract_templates").select("*").eq("organization_id",e).order("created_at",{ascending:!1});if(g)throw g;const v=l(m||[]);r(v),a(null)}catch(m){P.error("Erreur chargement contract_templates:",{error:m.message}),a(m.message)}finally{s(!1)}})();const h=T.channel(`contract-templates-changes-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"contract_templates",filter:`organization_id=eq.${e}`},m=>{var g;if(!((g=m.new)!=null&&g.organization_id&&m.new.organization_id!==e))if(m.eventType==="INSERT"){const v={id:m.new.id,name:m.new.name,projectType:m.new.project_type,contentHtml:m.new.content_html,version:m.new.version,isActive:m.new.is_active,createdAt:m.new.created_at,updatedAt:m.new.updated_at};r(y=>[v,...y])}else if(m.eventType==="UPDATE"){const v={id:m.new.id,name:m.new.name,projectType:m.new.project_type,contentHtml:m.new.content_html,version:m.new.version,isActive:m.new.is_active,createdAt:m.new.created_at,updatedAt:m.new.updated_at};r(y=>y.map(x=>x.id===v.id?v:x))}else m.eventType==="DELETE"&&r(v=>v.filter(y=>y.id!==m.old.id))}).subscribe();return()=>{T.removeChannel(h)}},[e]),{templates:t,loading:n,error:i,createTemplate:async d=>{try{if(!e)throw new Error("organization_id requis pour crer un template");const h={name:d.name,project_type:d.projectType||"ACC",content_html:d.contentHtml||"",version:1,is_active:!0,organization_id:e},{data:m,error:g}=await T.from("contract_templates").insert(h).select().single();if(g)throw g;return{success:!0,data:m}}catch(h){return P.error("Erreur cration contract_template:",{error:h.message}),{success:!1,error:h.message}}},updateTemplate:async(d,h)=>{try{const m={name:h.name,project_type:h.projectType,content_html:h.contentHtml},{data:g,error:v}=await T.from("contract_templates").update(m).eq("id",d).select().single();if(v)throw v;return{success:!0,data:g}}catch(m){return P.error("Erreur mise  jour contract_template:",{error:m.message}),{success:!1,error:m.message}}},deactivateTemplate:async d=>{try{const{data:h,error:m}=await T.from("contract_templates").update({is_active:!1}).eq("id",d).select().single();if(m)throw m;return{success:!0,data:h}}catch(h){return P.error("Erreur dsactivation contract_template:",{error:h.message}),{success:!1,error:h.message}}}}}function $y(e=null){const[t,r]=p.useState({}),[n,s]=p.useState(!0),[i,a]=p.useState(null),l=f=>{const d={};return f.forEach(h=>{d[h.form_id]={id:h.form_id,name:h.name,fields:h.fields||[],projectIds:h.project_ids||[],audience:h.audience||"client",createdAt:new Date(h.created_at).getTime(),updatedAt:new Date(h.updated_at).getTime()}}),d};return p.useEffect(()=>{if(!e){r({}),s(!1);return}(async()=>{try{s(!0);const{data:h,error:m}=await T.from("forms").select("*").or(`organization_id.eq.${e},organization_id.is.null`).order("created_at",{ascending:!1});if(m)throw m;const g=l(h||[]);r(g),a(null)}catch(h){P.error("Erreur chargement forms:",{error:h.message}),a(h.message)}finally{s(!1)}})();const d=T.channel(`forms-changes-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"forms",filter:`organization_id=eq.${e}`},h=>{if(h.eventType==="INSERT"){const m=h.new;r(g=>({...g,[m.form_id]:{id:m.form_id,name:m.name,fields:m.fields||[],projectIds:m.project_ids||[],audience:m.audience||"client",createdAt:new Date(m.created_at).getTime(),updatedAt:new Date(m.updated_at).getTime()}}))}else if(h.eventType==="UPDATE"){const m=h.new;r(g=>({...g,[m.form_id]:{id:m.form_id,name:m.name,fields:m.fields||[],projectIds:m.project_ids||[],audience:m.audience||"client",createdAt:new Date(m.created_at).getTime(),updatedAt:new Date(m.updated_at).getTime()}}))}else h.eventType==="DELETE"&&r(m=>{const g={...m};return delete g[h.old.form_id],g})}).subscribe();return()=>{T.removeChannel(d)}},[e]),{forms:t,loading:n,error:i,saveForm:async(f,d)=>{if(!e)return{success:!1,error:"organization_id requis"};try{const h={form_id:f,name:d.name,fields:d.fields||[],project_ids:d.projectIds||[],audience:d.audience||"client",organization_id:e},{data:m,error:g}=await T.from("forms").upsert(h,{onConflict:"form_id"}).select().single();if(g)throw g;return{success:!0,data:m}}catch(h){return P.error("Erreur sauvegarde form:",{error:h.message}),{success:!1,error:h.message}}},deleteForm:async f=>{try{const{error:d}=await T.from("forms").delete().eq("form_id",f);if(d)throw d;return{success:!0}}catch(d){return P.error("Erreur suppression form:",{error:d.message}),{success:!1,error:d.message}}}}}const My=(e,t=!0)=>{const[r,n]=p.useState([]),[s,i]=p.useState(!0),[a,l]=p.useState(null),c=p.useCallback(async()=>{try{i(!0),l(null);const{data:d,error:h}=await T.from("partners").select("*").order("created_at",{ascending:!1});if(h)throw h;const{data:m,error:g}=await T.from("missions").select("partner_id");if(g)throw g;const v=(m||[]).reduce((x,b)=>(x[b.partner_id]=(x[b.partner_id]||0)+1,x),{}),y=(d||[]).map(x=>({id:x.id,userId:x.user_id,organizationId:x.organization_id,companyName:x.company_name,contactFirstName:x.contact_first_name,contactLastName:x.contact_last_name,contactEmail:x.email,name:x.company_name,email:x.email,phone:x.phone,avatarUrl:x.avatar_url,specialty:x.specialty,active:x.active,isActive:x.active,createdAt:x.created_at,updatedAt:x.updated_at,missionsCount:v[x.id]||0}));n(y)}catch(d){console.error("[useSupabasePartners] Erreur:",d),l(d.message)}finally{i(!1)}},[]),u=p.useCallback(async(d,h)=>{try{const{error:m}=await T.from("partners").update({active:h,updated_at:new Date().toISOString()}).eq("id",d);if(m)throw m;return n(g=>g.map(v=>v.id===d?{...v,active:h}:v)),{success:!0}}catch(m){return console.error("[useSupabasePartners] Erreur toggle:",m),{success:!1,error:m.message}}},[]),f=p.useCallback(async d=>{try{const{data:h,error:m}=await T.from("partners").select("*").eq("id",d).single();if(m)throw m;const{data:g,error:v}=await T.from("missions").select(`
          id,
          title,
          status,
          source,
          project_type,
          step_name,
          due_date,
          completed_at,
          created_at
        `).eq("partner_id",d).order("created_at",{ascending:!1});if(v)throw v;return{partner:{id:h.id,userId:h.user_id,organizationId:h.organization_id,name:h.name,email:h.email,phone:h.phone,avatarUrl:h.avatar_url,specialty:h.specialty,active:h.active,createdAt:h.created_at,updatedAt:h.updated_at},missions:(g||[]).map(y=>({id:y.id,title:y.title,status:y.status,source:y.source,projectType:y.project_type,stepName:y.step_name,dueDate:y.due_date,completedAt:y.completed_at,createdAt:y.created_at}))}}catch(h){return console.error("[useSupabasePartners] Erreur getPartnerWithMissions:",h),{partner:null,missions:[],error:h.message}}},[]);return p.useEffect(()=>{if(!t||!e)return;c();const d=T.channel(`partners-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"partners",filter:`organization_id=eq.${e}`},()=>{c()}).subscribe();return()=>{T.removeChannel(d)}},[c,t,e]),{partners:r,loading:s,error:a,refetch:c,togglePartnerActive:u,getPartnerWithMissions:f}},vn=({activeModule:e})=>{const t=Ht(),r=[{id:"workflows",path:"/admin/workflows-charly",label:"Workflows",icon:"",color:"bg-green-600 hover:bg-green-700",activeColor:"bg-green-600"},{id:"projets",path:"/admin/projects-management",label:"Projets",icon:"",color:"bg-blue-600 hover:bg-blue-700",activeColor:"bg-blue-600"},{id:"formulaires",path:"/admin/forms-management",label:"Formulaires",icon:"",color:"bg-teal-600 hover:bg-teal-700",activeColor:"bg-teal-600"},{id:"contrats",path:"/admin/contract-templates",label:"Contrats",icon:"",color:"bg-purple-600 hover:bg-purple-700",activeColor:"bg-purple-600"},{id:"catalogue",path:"/admin/project-display",label:"Catalogue Client",icon:"",color:"bg-indigo-600 hover:bg-indigo-700",activeColor:"bg-indigo-600"},{id:"partenaires",path:"/admin/partners",label:"Partenaires",icon:"",color:"bg-orange-600 hover:bg-orange-700",activeColor:"bg-orange-600"}];return o.jsx("div",{className:"px-6 pt-4 pb-2",children:o.jsx("div",{className:"flex items-center justify-center gap-3",children:r.map(n=>{const s=e===n.id||t.pathname===n.path;return o.jsxs(xi,{to:n.path,className:`
                flex items-center gap-2.5 px-5 py-3 rounded-xl text-base font-semibold transition-all duration-200
                ${s?`${n.activeColor} text-white shadow-lg scale-105`:"bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800 hover:scale-102"}
              `,children:[o.jsx("span",{className:"text-lg",children:n.icon}),o.jsx("span",{children:n.label})]},n.path)})})})},PJ=({action:e,onChange:t,onDelete:r,forms:n,contractTemplates:s,partners:i=[]})=>{const a=(f,d)=>{t({...e,[f]:d})},l=()=>{const f=[...e.checklist||[],{id:`task-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,text:""}];a("checklist",f)},c=(f,d)=>{const h=[...e.checklist||[]];h[f].text=d,a("checklist",h)},u=f=>{const d=[...e.checklist||[]];d.splice(f,1),a("checklist",d)};return o.jsxs("div",{className:"p-4 bg-white rounded-lg border space-y-4",children:[e.order!==void 0&&e.waitForPrevious&&o.jsx("div",{className:"flex items-center gap-2 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:o.jsxs("span",{className:"text-sm text-blue-700",children:[" ",o.jsxs("strong",{children:["Action #",e.order+1]})," - S'enverra automatiquement aprs validation de l'action prcdente"]})}),e.order!==void 0&&!e.waitForPrevious&&o.jsx("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded-lg",children:o.jsxs("span",{className:"text-sm text-green-700",children:[" ",o.jsxs("strong",{children:["Action #",e.order+1]})," - S'enverra immdiatement"]})}),o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex-grow",children:[o.jsx(ee,{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"Type d'action"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",onClick:()=>{a("hasClientAction",!0),e.type==="partner_task"&&(a("type","none"),a("partnerId",null),a("partnerInstructions",null),a("isBlocking",null))},className:`flex-1 p-3 rounded-lg border-2 transition-all ${e.hasClientAction===!0&&e.type!=="partner_task"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-medium text-sm",children:"Associe au client"})]})}),o.jsx("button",{type:"button",onClick:()=>{a("hasClientAction",!1),e.type==="partner_task"&&(a("type","none"),a("partnerId",null),a("partnerInstructions",null),a("isBlocking",null))},className:`flex-1 p-3 rounded-lg border-2 transition-all ${e.hasClientAction===!1&&e.type!=="partner_task"?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-medium text-sm",children:"Associe au commercial"})]})}),o.jsx("button",{type:"button",onClick:()=>{console.log(" Clic sur Associe au partenaire",{action:e,partners:i}),t({...e,type:"partner_task",hasClientAction:null,formId:null,templateId:null,documentType:null})},className:`flex-1 p-3 rounded-lg border-2 transition-all ${e.type==="partner_task"?"border-orange-500 bg-orange-50 text-orange-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-medium text-sm",children:"Associe au partenaire"})]})})]})]}),o.jsx(G,{variant:"ghost",size:"icon",onClick:r,className:"ml-2",children:o.jsx(Fn,{className:"h-4 w-4 text-red-500"})})]}),e.type==="partner_task"?o.jsxs("div",{className:"space-y-4 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[!i||i.filter(f=>f.isActive).length===0?o.jsxs("div",{className:"text-center py-4",children:[o.jsx("div",{className:"text-3xl mb-2",children:""}),o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Aucun partenaire disponible"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Invitez-en un depuis l'onglet Partenaires."})]}):o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{className:"text-sm font-medium text-gray-700",children:"Partenaire assign"}),o.jsxs(Xt,{value:e.partnerId||"",onValueChange:f=>a("partnerId",f),children:[o.jsx(zt,{children:o.jsx(Qt,{placeholder:"Slectionner un partenaire"})}),o.jsx(Ut,{children:i.filter(f=>f.isActive).map(f=>o.jsxs(Pe,{value:f.id,children:[f.companyName," (",f.contactEmail,")"]},f.id))})]}),!e.partnerId&&o.jsx("p",{className:"text-xs text-red-500",children:" Partenaire obligatoire pour sauvegarder"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{className:"text-sm font-medium text-gray-700",children:"Instructions pour le partenaire"}),o.jsx(mi,{value:e.partnerInstructions||"",onChange:f=>a("partnerInstructions",f.target.value),placeholder:"Ex: Effectuer la visite technique et remplir le rapport...",className:"min-h-[100px]"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Ces instructions seront visibles par le partenaire dans sa vue mobile"})]}),o.jsxs("div",{className:"flex items-center space-x-2 pt-2 border-t",children:[o.jsx(sr,{id:`blocking-${e.id}`,checked:e.isBlocking!==!1,onCheckedChange:f=>a("isBlocking",f)}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(ee,{htmlFor:`blocking-${e.id}`,className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Action bloquante"}),o.jsx("p",{className:"text-xs text-gray-500",children:e.isBlocking!==!1?" Le projet ne peut pas avancer tant que le partenaire n'a pas termin":" Le projet peut continuer mme si la mission n'est pas termine"})]})]})]}):e.hasClientAction!==!1?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{children:"Message  dire"}),o.jsx(mi,{placeholder:"Ex: Bonjour, merci de complter les informations...",value:e.message,onChange:f=>a("message",f.target.value)})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{children:"Action  associer"}),o.jsxs(Xt,{value:e.type,onValueChange:f=>a("type",f),children:[o.jsx(zt,{children:o.jsx(Qt,{placeholder:"Choisir une action"})}),o.jsxs(Ut,{children:[o.jsx(Pe,{value:"none",children:"Aucune"}),o.jsx(Pe,{value:"show_form",children:"Afficher un formulaire"}),o.jsx(Pe,{value:"start_signature",children:"Lancer une signature"}),o.jsx(Pe,{value:"request_document",children:"Demander un document"}),o.jsx(Pe,{value:"open_payment",children:"Ouvrir un paiement"})]})]})]}),o.jsxs(Ti,{children:[e.type==="show_form"&&o.jsxs(le.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-2 overflow-hidden",children:[o.jsx(ee,{children:"Formulaire  afficher"}),o.jsxs(Xt,{value:e.formId,onValueChange:f=>a("formId",f),children:[o.jsx(zt,{children:o.jsx(Qt,{placeholder:"Choisir un formulaire"})}),o.jsx(Ut,{children:Object.values(n).filter(f=>f.audience==="client"||!f.audience).map(f=>o.jsx(Pe,{value:f.id,children:f.name},f.id))})]})]}),e.type==="request_document"&&o.jsxs(le.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-2 overflow-hidden",children:[o.jsx(ee,{children:"Type de document attendu"}),o.jsx("input",{type:"text",value:e.documentType||"",onChange:f=>a("documentType",f.target.value),placeholder:"Ex: Facture EDF, RIB, Titre de proprit...",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.type==="start_signature"&&o.jsxs(le.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-2 overflow-hidden",children:[o.jsx(ee,{children:"Template de contrat  utiliser"}),o.jsxs(Xt,{value:e.templateId,onValueChange:f=>a("templateId",f),children:[o.jsx(zt,{children:o.jsx(Qt,{placeholder:"Slectionner un template"})}),o.jsx(Ut,{children:s.filter(f=>f.isActive).map(f=>o.jsx(Pe,{value:f.id,children:f.name},f.id))})]}),!e.templateId&&o.jsx("p",{className:"text-xs text-red-500",children:" Template obligatoire pour sauvegarder"})]}),e.type==="start_signature"&&o.jsx(le.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 overflow-hidden border-t pt-4",children:o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{className:"font-semibold text-gray-700",children:"Formulaire source des donnes"}),o.jsxs(Xt,{value:e.formId||"",onValueChange:f=>a("formId",f),children:[o.jsx(zt,{className:"w-full",children:o.jsx(Qt,{placeholder:"Slectionner un formulaire"})}),o.jsxs(Ut,{children:[Array.isArray(n)&&n.map(f=>o.jsx(Pe,{value:f.id,children:f.name},f.id)),(!Array.isArray(n)||n.length===0)&&o.jsx("div",{className:"px-2 py-1.5 text-sm text-gray-500",children:"Aucun formulaire disponible"})]})]}),o.jsx("p",{className:"text-xs text-blue-600",children:" Les donnes du formulaire seront injectes directement dans le contrat"})]})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{children:"Mode de gestion"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",onClick:()=>a("managementMode","automatic"),className:`flex-1 p-3 rounded-lg border-2 transition-all ${(e.managementMode||"automatic")==="automatic"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-medium text-sm",children:"Gr par l'IA"})]})}),o.jsx("button",{type:"button",onClick:()=>a("managementMode","manual"),className:`flex-1 p-3 rounded-lg border-2 transition-all ${e.managementMode==="manual"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-medium text-sm",children:"Gr par commercial"})]})})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(e.managementMode||"automatic")==="automatic"?" Envoy automatiquement par Charly AI":" Le commercial devra envoyer manuellement"}),o.jsx(Ti,{children:e.managementMode==="manual"&&o.jsxs(le.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"pt-3 border-t overflow-hidden space-y-3",children:[o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(sr,{id:`create-task-${e.id}`,checked:e.createTask!==!1,onCheckedChange:f=>a("createTask",f)}),o.jsxs("div",{className:"space-y-1 flex-1",children:[o.jsx(ee,{htmlFor:`create-task-${e.id}`,className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Crer automatiquement une tche pour le commercial"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Une tche sera envoye au commercial ds que cette tape devient l'tape en cours."})]})]}),e.createTask!==!1&&o.jsxs("div",{className:"space-y-2 ml-6",children:[o.jsx(ee,{className:"text-sm",children:"Titre de la tche"}),o.jsx("input",{type:"text",value:e.taskTitle||"Action requise pour ce client",onChange:f=>a("taskTitle",f.target.value),placeholder:"Action requise pour ce client",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})})]}),e.type==="show_form"&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{children:"Mode de vrification"}),o.jsxs(Xt,{value:e.verificationMode||"human",onValueChange:f=>a("verificationMode",f),children:[o.jsx(zt,{children:o.jsx(Qt,{placeholder:"Choisir le mode de vrification"})}),o.jsxs(Ut,{children:[o.jsx(Pe,{value:"none",children:"Pas de vrification (auto-validation)"}),o.jsx(Pe,{value:"ai",children:"IA automatique"}),o.jsx(Pe,{value:"human",children:"Humain (commercial vrifie)"})]})]}),o.jsxs("p",{className:"text-xs text-gray-500",children:[e.verificationMode==="none"&&" Valid automatiquement ds que le client termine",e.verificationMode==="ai"&&" L'IA analysera et validera automatiquement",(!e.verificationMode||e.verificationMode==="human")&&" Une tche sera cre pour que le commercial vrifie"]}),(!e.verificationMode||e.verificationMode==="human")&&o.jsxs("div",{className:"space-y-4 mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{className:"text-sm font-medium text-gray-700",children:" Message si valid"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Ce message sera envoy automatiquement dans le chat quand le commercial valide le formulaire"}),o.jsx(mi,{value:e.approvalMessage||"Merci ! Votre formulaire a t valid.",onChange:f=>a("approvalMessage",f.target.value),placeholder:"Merci ! Votre formulaire a t valid.",className:"min-h-[60px]"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{className:"text-sm font-medium text-gray-700",children:" Message si rejet"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Message prdfini affich au commercial. Il pourra ajouter sa raison de refus avant d'envoyer dans le chat."}),o.jsx(mi,{value:e.rejectionMessage||"Oups !! Votre formulaire a t rejet pour la raison suivante :",onChange:f=>a("rejectionMessage",f.target.value),placeholder:"Oups !! Votre formulaire a t rejet pour la raison suivante :",className:"min-h-[60px]"})]})]})]})]}):o.jsxs("div",{className:"space-y-3",children:[o.jsx(ee,{className:"text-sm font-medium text-gray-700",children:"Checklist de tches pour le commercial"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Liste des tches  effectuer manuellement pour cette action"}),o.jsx("div",{className:"space-y-2",children:(e.checklist||[]).map((f,d)=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text",value:f.text,onChange:h=>c(d,h.target.value),placeholder:"Ex: Vrifier le document",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),o.jsx(G,{variant:"ghost",size:"icon",onClick:()=>u(d),className:"h-8 w-8",children:o.jsx(Fn,{className:"h-4 w-4 text-red-500"})})]},f.id))}),o.jsxs(G,{variant:"outline",size:"sm",onClick:l,className:"w-full border-dashed",children:[o.jsx(hr,{className:"h-4 w-4 mr-2"})," Ajouter une tche"]})]})]})},TJ=()=>{var V;const{projectsData:e={}}=Ve(),{organizationId:t}=an(),{forms:r,loading:n}=$y(t),s=p.useMemo(()=>Object.values(r||{}),[r]),{prompts:i,loading:a,savePrompt:l,deletePrompt:c}=_I({organizationId:t}),{templates:u,loading:f}=CJ(t),{partners:d,loading:h}=My(t),m=p.useMemo(()=>i,[i]),[g,v]=p.useState(null),[y,x]=p.useState(!1),[b,w]=p.useState({name:"",tone:"",projectId:null,stepsConfig:{}}),[j,_]=p.useState(null);p.useEffect(()=>{w(g?JSON.parse(JSON.stringify(g)):{name:"",tone:"",projectId:null,stepsConfig:{}})},[g]);const S=p.useMemo(()=>Object.values(e||{}).map(I=>({value:I.type,label:I.title})),[e]),N=p.useMemo(()=>{var I;return b.projectId?((I=e==null?void 0:e[b.projectId])==null?void 0:I.steps)||[]:[]},[b.projectId,e]),E=I=>{w(D=>({...D,projectId:I,stepsConfig:{}})),_(null)},C=I=>{_(j===I?null:I)},k=(I,D,$)=>{const M={...b.stepsConfig};M[I]||(M[I]={actions:[],autoCompleteStep:!1}),M[I].actions[D]=$,w(W=>({...W,stepsConfig:M}))},L=I=>{const D={...b.stepsConfig};D[I]||(D[I]={actions:[],autoCompleteStep:!1});const M=(D[I].actions||[]).length;D[I].actions.push({id:`action-${Date.now()}`,message:"",type:"none",hasClientAction:!0,order:M,waitForPrevious:M>0}),w(W=>({...W,stepsConfig:D}))},A=(I,D)=>{const $={...b.stepsConfig};$[I]&&$[I].actions.splice(D,1),w(M=>({...M,stepsConfig:$}))},R=(I,D,$)=>{const M={...b.stepsConfig};M[I]||(M[I]={actions:[],autoCompleteStep:!1}),M[I][D]=$,w(W=>({...W,stepsConfig:M}))},O=async()=>{if(!b.name||!b.tone||!b.projectId){B({title:"Champs manquants",description:"Veuillez remplir le nom, le ton et le projet.",variant:"destructive"});return}x(!0);const I={...b,id:(g==null?void 0:g.id)||`prompt-${Date.now()}`},D=I.id||`prompt-${Date.now()}-${Math.random().toString(36).slice(2,7)}`;try{const $=await l(D,{name:I.name,tone:I.tone,projectId:I.projectId,stepsConfig:I.stepsConfig||{}});$.success?(B({title:" Prompt enregistr !",description:`Le prompt "${I.name}" a t sauvegard dans Supabase.`,className:"bg-green-500 text-white"}),v(null)):B({title:" Erreur",description:`Impossible d'enregistrer le prompt : ${$.error}`,variant:"destructive"})}finally{x(!1)}},z=async I=>{const D=await c(I);D.success?B({title:" Prompt supprim !",description:"Le prompt a t supprim de Supabase.",className:"bg-green-500 text-white"}):B({title:" Erreur",description:`Impossible de supprimer le prompt : ${D.error}`,variant:"destructive"})},F=I=>{v(I)};return o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"workflows"}),o.jsxs("div",{className:"flex flex-1 gap-6 p-6",children:[o.jsx("div",{className:"w-[25%] flex-shrink-0",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-card h-full flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Workflows Charly"}),o.jsxs(G,{onClick:()=>F(null),className:"bg-indigo-600 hover:bg-indigo-700 w-full",children:[o.jsx(hr,{className:"mr-2 h-4 w-4"})," Crer un nouveau prompt"]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-3",children:Object.values(m).length>0?Object.values(m).map(I=>{var D;return o.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors ${(g==null?void 0:g.id)===I.id?"bg-indigo-50 border-2 border-indigo-500":"bg-gray-50 hover:bg-gray-100"}`,onClick:()=>F(I),children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Xl,{className:"h-5 w-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:I.name}),o.jsx("p",{className:"text-xs text-gray-500",children:((D=e[I.projectId])==null?void 0:D.title)||"Projet inconnu"})]})]}),o.jsxs(Hc,{children:[o.jsx(jh,{asChild:!0,children:o.jsx(G,{variant:"destructive",size:"icon",className:"h-8 w-8",onClick:$=>$.stopPropagation(),children:o.jsx(Fn,{className:"h-4 w-4"})})}),o.jsxs(ba,{children:[o.jsxs(wa,{children:[o.jsxs(_a,{children:['Supprimer "',I.name,'" ?']}),o.jsx(Sa,{children:"Cette action est irrversible."})]}),o.jsxs(ja,{children:[o.jsx(Ea,{children:"Annuler"}),o.jsx(Na,{onClick:()=>z(I.id),className:"bg-red-600 hover:bg-red-700",children:"Supprimer"})]})]})]})]},I.id)}):o.jsxs("div",{className:"text-center text-gray-500 py-8",children:[o.jsx(Xl,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("p",{className:"mt-2",children:"Aucun prompt cr. Cliquez sur le bouton pour en ajouter un."})]})})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-card p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:g?"Modifier le prompt":"Crer un nouveau prompt"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Paramtrez votre prompt pour gnrer des communications personnalises."})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"prompt-name",children:"Nom du prompt"}),o.jsx(pe,{id:"prompt-name",placeholder:"Ex: Relance aprs RDV",value:b.name,onChange:I=>w(D=>({...D,name:I.target.value}))})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"prompt-tone",children:"Ton"}),o.jsxs(Xt,{value:b.tone,onValueChange:I=>w(D=>({...D,tone:I})),children:[o.jsx(zt,{id:"prompt-tone",children:o.jsx(Qt,{placeholder:"Choisir un ton"})}),o.jsxs(Ut,{children:[o.jsx(Pe,{value:"professionnel",children:"Professionnel"}),o.jsx(Pe,{value:"detendu",children:"Dtendu"}),o.jsx(Pe,{value:"humain",children:"Humain"})]})]})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"prompt-project",children:"Projet"}),o.jsxs(Xt,{value:b.projectId,onValueChange:E,children:[o.jsx(zt,{id:"prompt-project",children:o.jsx(Qt,{placeholder:"Choisir un projet"})}),o.jsx(Ut,{children:S.map(I=>o.jsx(Pe,{value:I.value,children:I.label},I.value))})]})]})]}),b.projectId&&o.jsxs(le.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"pt-4 border-t",children:[o.jsxs("h4",{className:"font-semibold text-gray-700 mb-3",children:['tapes du projet "',(V=e[b.projectId])==null?void 0:V.title,'"']}),o.jsx("div",{className:"space-y-2",children:N.map((I,D)=>{var $,M;return o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>C(D),className:"w-full flex items-center justify-between gap-3 p-3 bg-gray-50 hover:bg-gray-100 rounded-md transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-lg",children:I.icon}),o.jsx("span",{className:"text-sm font-medium text-gray-800",children:I.name})]}),j===D?o.jsx(Ds,{className:"h-5 w-5"}):o.jsx(Gn,{className:"h-5 w-5"})]}),o.jsx(Ti,{children:j===D&&o.jsx(le.div,{initial:{opacity:0,height:0,marginTop:0},animate:{opacity:1,height:"auto",marginTop:"0.5rem"},exit:{opacity:0,height:0,marginTop:0},className:"pl-8 bg-gray-50/50 rounded-b-md",children:o.jsxs("div",{className:"p-4 space-y-4",children:[((($=b.stepsConfig[D])==null?void 0:$.actions)||[]).map((W,U)=>o.jsx(PJ,{action:W,onChange:X=>k(D,U,X),onDelete:()=>A(D,U),forms:s||[],contractTemplates:u||[],partners:d||[]},W.id)),o.jsxs(G,{variant:"outline",size:"sm",onClick:()=>L(D),className:"w-full border-dashed",children:[o.jsx(hr,{className:"h-4 w-4 mr-2"})," Ajouter un message + action"]}),o.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t mt-4",children:[o.jsx(sr,{id:`form-complete-step-${D}`,checked:((M=b.stepsConfig[D])==null?void 0:M.autoCompleteStep)||!1,onCheckedChange:W=>R(D,"autoCompleteStep",W)}),o.jsx(ee,{htmlFor:`form-complete-step-${D}`,className:"text-sm text-gray-600",children:"Si action valide, passer automatiquement  l'tape suivante"})]})]})})})]},D)})})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[o.jsx(G,{variant:"outline",onClick:()=>v(null),disabled:y,children:"Annuler"}),o.jsx(G,{onClick:O,className:"bg-green-600 hover:bg-green-700",disabled:y,children:y?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrement..."]}):"Enregistrer le prompt"})]})]})]})})]})]})},cl=p.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:he("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));cl.displayName="Card";const ul=p.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:he("flex flex-col space-y-1.5 p-6",e),...t}));ul.displayName="CardHeader";const dl=p.forwardRef(({className:e,...t},r)=>o.jsx("h3",{ref:r,className:he("text-2xl font-semibold leading-none tracking-tight",e),...t}));dl.displayName="CardTitle";const SI=p.forwardRef(({className:e,...t},r)=>o.jsx("p",{ref:r,className:he("text-sm text-muted-foreground",e),...t}));SI.displayName="CardDescription";const fl=p.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:he("p-6 pt-0",e),...t}));fl.displayName="CardContent";const kJ=p.forwardRef(({className:e,...t},r)=>o.jsx("div",{ref:r,className:he("flex items-center p-6 pt-0",e),...t}));kJ.displayName="CardFooter";var Ch="Switch",[AJ,voe]=sn(Ch),[RJ,IJ]=AJ(Ch),NI=p.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:s,defaultChecked:i,required:a,disabled:l,value:c="on",onCheckedChange:u,form:f,...d}=e,[h,m]=p.useState(null),g=Fe(t,w=>m(w)),v=p.useRef(!1),y=h?f||!!h.closest("form"):!0,[x,b]=Bi({prop:s,defaultProp:i??!1,onChange:u,caller:Ch});return o.jsxs(RJ,{scope:r,checked:x,disabled:l,children:[o.jsx(Re.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":TI(x),"data-disabled":l?"":void 0,disabled:l,value:c,...d,ref:g,onClick:xe(e.onClick,w=>{b(j=>!j),y&&(v.current=w.isPropagationStopped(),v.current||w.stopPropagation())})}),y&&o.jsx(PI,{control:h,bubbles:!v.current,name:n,value:c,checked:x,required:a,disabled:l,form:f,style:{transform:"translateX(-100%)"}})]})});NI.displayName=Ch;var EI="SwitchThumb",CI=p.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,s=IJ(EI,r);return o.jsx(Re.span,{"data-state":TI(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:t})});CI.displayName=EI;var OJ="SwitchBubbleInput",PI=p.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...s},i)=>{const a=p.useRef(null),l=Fe(a,i),c=WA(r),u=K0(t);return p.useEffect(()=>{const f=a.current;if(!f)return;const d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(c!==r&&m){const g=new Event("click",{bubbles:n});m.call(f,r),f.dispatchEvent(g)}},[c,r,n]),o.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});PI.displayName=OJ;function TI(e){return e?"checked":"unchecked"}var kI=NI,DJ=CI;const Ph=J.forwardRef(({className:e,...t},r)=>o.jsx(kI,{className:he("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-green-500 data-[state=unchecked]:bg-input",e),...t,ref:r,children:o.jsx(DJ,{className:he("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ph.displayName=kI.displayName;const Cn=({value:e,onSave:t,placeholder:r="Cliquez pour modifier...",className:n="",inputClassName:s="",multiline:i=!1,as:a="span",disabled:l=!1})=>{const[c,u]=p.useState(!1),[f,d]=p.useState(e||""),[h,m]=p.useState(!1),g=p.useRef(null);p.useEffect(()=>{c||d(e||"")},[e,c]),p.useEffect(()=>{c&&g.current&&(g.current.focus(),i||g.current.select())},[c,i]);const v=()=>{!l&&!c&&u(!0)},y=async()=>{if(f===e){u(!1);return}try{m(!0),await t(f),u(!1)}catch(N){console.error("InlineEditable save error:",N)}finally{m(!1)}},x=()=>{d(e||""),u(!1)},b=N=>{N.key==="Enter"&&!i?(N.preventDefault(),y()):N.key==="Escape"&&x()},w=N=>{var E,C;((C=(E=N.relatedTarget)==null?void 0:E.dataset)==null?void 0:C.action)!=="cancel"&&y()},j=a,_=e||r,S=!e;if(c){const N=i?"textarea":"input";return o.jsxs("div",{className:"inline-flex items-center gap-2 w-full",children:[o.jsx(N,{ref:g,type:"text",value:f,onChange:E=>d(E.target.value),onKeyDown:b,onBlur:w,disabled:h,className:he("flex-1 px-3 py-2 border border-blue-400 rounded-lg","focus:outline-none focus:ring-2 focus:ring-blue-500","bg-white text-gray-900",i&&"min-h-[80px] resize-y",h&&"opacity-50 cursor-not-allowed",s),placeholder:r,rows:i?3:void 0}),o.jsx("button",{type:"button",onClick:y,disabled:h,className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Enregistrer",children:h?o.jsx("div",{className:"w-4 h-4 border-2 border-green-600 border-t-transparent rounded-full animate-spin"}):o.jsx(Mn,{className:"w-4 h-4"})}),o.jsx("button",{type:"button","data-action":"cancel",onClick:x,disabled:h,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors",title:"Annuler",children:o.jsx(es,{className:"w-4 h-4"})})]})}return o.jsxs(j,{onClick:v,className:he("group cursor-pointer inline-flex items-center gap-2","hover:bg-blue-50 rounded-lg px-2 py-1 -mx-2 -my-1","transition-colors duration-150",S&&"text-gray-400 italic",l&&"cursor-not-allowed opacity-50",n),title:l?void 0:"Cliquez pour modifier",children:[o.jsx("span",{children:_}),!l&&o.jsx(O3,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})},$J=({value:e,onSave:t,className:r="",disabled:n=!1})=>{const[s,i]=p.useState(!1),[a,l]=p.useState(e||""),c=p.useRef(null),u=["","","","","","","","","","","","","","","","","","","","","","","",""];p.useEffect(()=>{s||l(e||"")},[e,s]),p.useEffect(()=>{if(s){const d=h=>{c.current&&!c.current.contains(h.target)&&i(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)}},[s]);const f=async d=>{try{await t(d),l(d),i(!1)}catch(h){console.error("InlineEditableIcon save error:",h)}};return s?o.jsxs("div",{className:"relative inline-block",ref:c,children:[o.jsx("button",{type:"button",className:"text-4xl",children:a}),o.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 p-3 bg-white rounded-xl shadow-xl border border-gray-200 z-50 grid grid-cols-8 gap-2 min-w-[280px]",children:u.map(d=>o.jsx("button",{type:"button",onClick:()=>f(d),className:"w-8 h-8 flex items-center justify-center text-xl hover:bg-blue-50 hover:scale-125 rounded-lg transition-all duration-150",children:d},d))})]}):o.jsx("button",{type:"button",onClick:()=>!n&&i(!0),disabled:n,className:he("text-4xl hover:scale-110 transition-transform cursor-pointer",n&&"cursor-not-allowed opacity-50",r),title:n?void 0:"Cliquez pour changer l'icne",children:e||""})},MJ=e=>{const[t,r]=p.useState(null),[n,s]=p.useState(!0),[i,a]=p.useState(null),l=p.useRef(!1),c=()=>({hero_title:"",hero_subtitle:"Suivez l'avancement de votre projet en temps rel",hero_cta_text:"Je dmarre mon projet",hero_cta_link:"/inscription",show_how_it_works:!0,how_it_works_title:"Comment a marche ?",how_it_works_subtitle:"",blocks:u()}),u=()=>[{id:1,icon:"1",title:"tude",description:"Analyse de votre projet",tag:""},{id:2,icon:"2",title:"Installation",description:"Ralisation des travaux",tag:""},{id:3,icon:"3",title:"Suivi",description:"Accompagnement continu",tag:""}],f=async()=>{if(!e){s(!1);return}try{s(!0);const{data:x,error:b}=await T.from("organization_settings").select("*").eq("organization_id",e).single();if(b&&b.code!=="PGRST116")throw b;r(x),a(null)}catch(x){P.error("[useLandingPageConfig] Erreur chargement:",{error:x.message}),a(x.message)}finally{s(!1)}};p.useEffect(()=>{f()},[e]),p.useEffect(()=>{if(!e)return;const x=T.channel(`org-settings-landing-${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"organization_settings",filter:`organization_id=eq.${e}`},b=>{r(w=>JSON.stringify(w)===JSON.stringify(b.new)?w:(l.current=!1,b.new))}).subscribe();return()=>{T.removeChannel(x)}},[e]);const d=()=>{const x=(t==null?void 0:t.landing_page_config)||{},b=c();return{hero_title:x.hero_title||b.hero_title,hero_subtitle:x.hero_subtitle||b.hero_subtitle,hero_cta_text:x.hero_cta_text||b.hero_cta_text,hero_cta_link:x.hero_cta_link||b.hero_cta_link,show_how_it_works:x.show_how_it_works!==void 0?x.show_how_it_works:b.show_how_it_works,how_it_works_title:x.how_it_works_title||b.how_it_works_title,how_it_works_subtitle:x.how_it_works_subtitle||b.how_it_works_subtitle,blocks:x.blocks||b.blocks}},h=async(x,b)=>{if(!e)return P.error("[useLandingPageConfig] Pas d'organizationId"),!1;try{l.current=!0;const j={...(t==null?void 0:t.landing_page_config)||{},[x]:b},{error:_}=await T.from("organization_settings").update({landing_page_config:j,updated_at:new Date().toISOString()}).eq("organization_id",e);if(_)throw l.current=!1,_;return r(S=>({...S,landing_page_config:j,updated_at:new Date().toISOString()})),!0}catch(w){return P.error("[useLandingPageConfig] Erreur update field:",{error:w.message,field:x}),B({title:"Erreur",description:"Impossible de sauvegarder la modification.",variant:"destructive"}),!1}},m=async(x,b)=>{if(!e)return P.error("[useLandingPageConfig] Pas d'organizationId"),!1;try{l.current=!0;const w=(t==null?void 0:t.landing_page_config)||{},_=(w.blocks||u()).map(E=>E.id===x?{...E,...b}:E),S={...w,blocks:_},{error:N}=await T.from("organization_settings").update({landing_page_config:S,updated_at:new Date().toISOString()}).eq("organization_id",e);if(N)throw l.current=!1,N;return r(E=>({...E,landing_page_config:S,updated_at:new Date().toISOString()})),!0}catch(w){return P.error("[useLandingPageConfig] Erreur update block:",{error:w.message,blockId:x}),B({title:"Erreur",description:"Impossible de sauvegarder le bloc.",variant:"destructive"}),!1}},g=async x=>{if(!e)return P.error("[useLandingPageConfig] Pas d'organizationId"),!1;try{l.current=!0;const{error:b}=await T.from("organization_settings").update({landing_page_config:x,updated_at:new Date().toISOString()}).eq("organization_id",e);if(b)throw l.current=!1,b;return r(w=>({...w,landing_page_config:x,updated_at:new Date().toISOString()})),B({title:"Sauvegard !",description:"La configuration de la landing page a t mise  jour.",className:"bg-green-500 text-white"}),!0}catch(b){return P.error("[useLandingPageConfig] Erreur save config:",{error:b.message}),B({title:"Erreur",description:"Impossible de sauvegarder la configuration.",variant:"destructive"}),!1}},v=async()=>g(c()),y=d();return{settings:t,loading:n,error:i,landingConfig:y,getLandingConfig:d,updateLandingField:h,updateLandingBlock:m,saveLandingConfig:g,resetToDefaults:v,refetch:f}},LJ=()=>{const{organizationId:e,logoUrl:t,brandName:r}=an(),{loading:n,getLandingConfig:s,updateLandingField:i,updateLandingBlock:a,resetToDefaults:l}=MJ(e),[c,u]=p.useState(!0),[f,d]=p.useState(!1),h=s(),m=h.hero_title||`Bienvenue chez ${r||"votre entreprise"}`,g=h.hero_subtitle||"Suivez l'avancement de votre projet en temps rel",v=async(b,w)=>{await i(b,w)&&B({title:" Sauvegard",description:"Modification enregistre.",className:"bg-green-500 text-white",duration:2e3})},y=async(b,w,j)=>{const _=h.blocks.find(N=>N.id===b);await a(b,{..._,[w]:j})&&B({title:" Sauvegard",description:"Bloc mis  jour.",className:"bg-green-500 text-white",duration:2e3})},x=async()=>{confirm("tes-vous sr de vouloir rinitialiser la landing page aux valeurs par dfaut ?")&&(d(!0),await l(),d(!1),B({title:" Rinitialis",description:"La landing page a t rinitialise.",className:"bg-blue-500 text-white"}))};return n?o.jsx("div",{className:"flex items-center justify-center h-96",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Chargement de la configuration..."})]})}):o.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:" Landing Page"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Personnalisez la page d'accueil publique de votre entreprise. Cliquez sur n'importe quel texte pour le modifier."})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs(G,{variant:"outline",onClick:()=>u(!c),className:"gap-2",children:[c?o.jsx(Ql,{className:"w-4 h-4"}):o.jsx(Zl,{className:"w-4 h-4"}),c?"Masquer preview":"Afficher preview"]}),o.jsxs(G,{variant:"outline",onClick:x,disabled:f,className:"gap-2 text-orange-600 hover:text-orange-700 hover:bg-orange-50",children:[f?o.jsx(De,{className:"w-4 h-4 animate-spin"}):o.jsx(D3,{className:"w-4 h-4"}),"Rinitialiser"]})]})]}),o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:o.jsxs("p",{className:"text-blue-800 text-sm",children:[" ",o.jsx("strong",{children:"Astuce :"})," Cliquez directement sur les textes pour les modifier. Les modifications sont sauvegardes automatiquement. Le logo utilis est celui configur dans les paramtres de votre organisation."]})}),c&&o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden",children:[o.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[t?o.jsx("img",{src:t,alt:r||"Logo",className:"h-10 w-auto object-contain"}):o.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center",children:o.jsx("span",{className:"text-white font-bold",children:(r==null?void 0:r.charAt(0))||"E"})}),o.jsx("span",{className:"font-semibold text-gray-700",children:r||"Votre entreprise"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:"px-4 py-2 rounded-full bg-[#22c55e] text-white text-sm font-medium",children:"Espace Pro"}),o.jsx("span",{className:"px-4 py-2 rounded-full bg-[#0ea5e9] text-white text-sm font-medium",children:"Espace Client"})]})]}),o.jsxs("div",{className:"relative px-8 py-16 bg-gradient-to-b from-white to-green-50/30",children:[o.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-green-100/50 rounded-full blur-3xl"})}),o.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto text-center space-y-6",children:[o.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 leading-tight",children:o.jsx(Cn,{value:m,onSave:b=>v("hero_title",b),placeholder:`Bienvenue chez ${r||"votre entreprise"}`,className:"text-4xl md:text-5xl font-bold",inputClassName:"text-3xl font-bold text-center"})}),o.jsx("p",{className:"text-xl md:text-2xl text-gray-600 italic",children:o.jsx(Cn,{value:g,onSave:b=>v("hero_subtitle",b),placeholder:"Suivez l'avancement de votre projet en temps rel",className:"text-xl md:text-2xl text-gray-600 italic",inputClassName:"text-xl italic text-center"})}),o.jsxs("div",{className:"flex items-center justify-center gap-4 pt-4",children:[o.jsx("button",{className:"px-8 py-4 bg-[#22c55e] hover:bg-[#16a34a] text-white rounded-full font-semibold text-lg transition-colors",children:o.jsx(Cn,{value:h.hero_cta_text,onSave:b=>v("hero_cta_text",b),placeholder:"Texte du bouton...",className:"text-white font-semibold",inputClassName:"text-center"})}),h.show_how_it_works!==!1&&o.jsx("span",{className:"text-[#22c55e] font-medium cursor-pointer hover:text-[#16a34a]",children:o.jsx(Cn,{value:h.how_it_works_title,onSave:b=>v("how_it_works_title",b),placeholder:"Comment a marche ?",className:"text-[#22c55e] font-medium",inputClassName:"text-center"})})]}),o.jsx("p",{className:"text-xs text-gray-400 text-center mt-2",children:"Le bouton redirige toujours vers la cration de compte"})]})]}),o.jsx("div",{className:"px-8 py-4 bg-gray-50 border-t border-b border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between max-w-4xl mx-auto",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:'Section "Comment a marche"'}),o.jsx("p",{className:"text-sm text-gray-500",children:"Afficher les 3 blocs explicatifs sur la landing page"})]}),o.jsx(Ph,{checked:h.show_how_it_works!==!1,onCheckedChange:b=>v("show_how_it_works",b)})]})}),h.show_how_it_works!==!1&&o.jsx("div",{className:"px-8 py-16 bg-white",children:o.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-12",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:o.jsx(Cn,{value:h.how_it_works_title,onSave:b=>v("how_it_works_title",b),placeholder:"Titre de la section...",className:"text-3xl font-bold",inputClassName:"text-2xl font-bold text-center"})}),o.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:o.jsx(Cn,{value:h.how_it_works_subtitle,onSave:b=>v("how_it_works_subtitle",b),placeholder:"Description de la section...",className:"text-gray-600",inputClassName:"text-center",multiline:!0})})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:h.blocks.map(b=>o.jsxs(cl,{className:"text-center hover:shadow-lg transition-shadow",children:[o.jsxs(ul,{className:"pb-2",children:[o.jsx("div",{className:"flex justify-center mb-2",children:o.jsx($J,{value:b.icon,onSave:w=>y(b.id,"icon",w)})}),o.jsx(dl,{className:"text-lg",children:o.jsx(Cn,{value:b.title,onSave:w=>y(b.id,"title",w),placeholder:"Titre du bloc...",className:"text-lg font-semibold",inputClassName:"text-center font-semibold"})})]}),o.jsxs(fl,{className:"space-y-3",children:[o.jsx(SI,{children:o.jsx(Cn,{value:b.description,onSave:w=>y(b.id,"description",w),placeholder:"Description du bloc...",className:"text-gray-600 text-sm",inputClassName:"text-center text-sm",multiline:!0})}),o.jsx("div",{className:"inline-block px-3 py-1 bg-gray-100 rounded-full text-xs text-gray-600",children:o.jsx(Cn,{value:b.tag,onSave:w=>y(b.id,"tag",w),placeholder:"Tag du bloc...",className:"text-xs",inputClassName:"text-xs text-center"})})]})]},b.id))})]})}),o.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4 text-center text-sm text-gray-500",children:"Prvisualisation de votre landing page  Les modifications sont sauvegardes en temps rel"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs(cl,{children:[o.jsx(ul,{className:"pb-2",children:o.jsx(dl,{className:"text-sm font-medium text-gray-600",children:"Hero Section"})}),o.jsxs(fl,{children:[o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"2 textes"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Titre + sous-titre + 2 CTAs"})]})]}),o.jsxs(cl,{children:[o.jsx(ul,{className:"pb-2",children:o.jsx(dl,{className:"text-sm font-medium text-gray-600",children:"Comment a marche"})}),o.jsxs(fl,{children:[o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"3 blocs"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Icne + titre + description + tag"})]})]}),o.jsxs(cl,{children:[o.jsx(ul,{className:"pb-2",children:o.jsx(dl,{className:"text-sm font-medium text-gray-600",children:"Branding"})}),o.jsxs(fl,{children:[o.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r||"Non dfini"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Logo depuis les paramtres org"})]})]})]})]})};var Th="Popover",[AI,xoe]=sn(Th,[lh]),Gc=lh(),[FJ,Hs]=AI(Th),RI=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,l=Gc(t),c=p.useRef(null),[u,f]=p.useState(!1),[d,h]=Bi({prop:n,defaultProp:s??!1,onChange:i,caller:Th});return o.jsx(_T,{...l,children:o.jsx(FJ,{scope:t,contentId:bi(),triggerRef:c,open:d,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:u,onCustomAnchorAdd:p.useCallback(()=>f(!0),[]),onCustomAnchorRemove:p.useCallback(()=>f(!1),[]),modal:a,children:r})})};RI.displayName=Th;var II="PopoverAnchor",BJ=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Hs(II,r),i=Gc(r),{onCustomAnchorAdd:a,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(a(),()=>l()),[a,l]),o.jsx(X0,{...i,...n,ref:t})});BJ.displayName=II;var OI="PopoverTrigger",DI=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Hs(OI,r),i=Gc(r),a=Fe(t,s.triggerRef),l=o.jsx(Re.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":BI(s.open),...n,ref:a,onClick:xe(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:o.jsx(X0,{asChild:!0,...i,children:l})});DI.displayName=OI;var Ly="PopoverPortal",[zJ,UJ]=AI(Ly,{forceMount:void 0}),$I=e=>{const{__scopePopover:t,forceMount:r,children:n,container:s}=e,i=Hs(Ly,t);return o.jsx(zJ,{scope:t,forceMount:r,children:o.jsx(Br,{present:r||i.open,children:o.jsx(Pc,{asChild:!0,container:s,children:n})})})};$I.displayName=Ly;var oa="PopoverContent",MI=p.forwardRef((e,t)=>{const r=UJ(oa,e.__scopePopover),{forceMount:n=r.forceMount,...s}=e,i=Hs(oa,e.__scopePopover);return o.jsx(Br,{present:n||i.open,children:i.modal?o.jsx(qJ,{...s,ref:t}):o.jsx(WJ,{...s,ref:t})})});MI.displayName=oa;var VJ=Ci("PopoverContent.RemoveScroll"),qJ=p.forwardRef((e,t)=>{const r=Hs(oa,e.__scopePopover),n=p.useRef(null),s=Fe(t,n),i=p.useRef(!1);return p.useEffect(()=>{const a=n.current;if(a)return Lc(a)},[]),o.jsx(ny,{as:VJ,allowPinchZoom:!0,children:o.jsx(LI,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xe(e.onCloseAutoFocus,a=>{var l;a.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:xe(e.onPointerDownOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:xe(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),WJ=p.forwardRef((e,t)=>{const r=Hs(oa,e.__scopePopover),n=p.useRef(!1),s=p.useRef(!1);return o.jsx(LI,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,l;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((u=r.triggerRef.current)==null?void 0:u.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),LI=p.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:f,...d}=e,h=Hs(oa,r),m=Gc(r);return z0(),o.jsx(nh,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:o.jsx(Cc,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>h.onOpenChange(!1),children:o.jsx(ST,{"data-state":BI(h.open),role:"dialog",id:h.contentId,...m,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),FI="PopoverClose",HJ=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Hs(FI,r);return o.jsx(Re.button,{type:"button",...n,ref:t,onClick:xe(e.onClick,()=>s.onOpenChange(!1))})});HJ.displayName=FI;var GJ="PopoverArrow",KJ=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Gc(r);return o.jsx(NT,{...s,...n,ref:t})});KJ.displayName=GJ;function BI(e){return e?"open":"closed"}var YJ=RI,JJ=DI,XJ=$I,zI=MI;const UI=YJ,VI=JJ,Fy=J.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},s)=>o.jsx(XJ,{children:o.jsx(zI,{ref:s,align:t,sideOffset:r,className:he("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Fy.displayName=zI.displayName;function z1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function U1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z1(Object(r),!0).forEach(function(n){nG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yt(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var V1=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Sm=function(){return Math.random().toString(36).substring(7).split("").join(".")},q1={INIT:"@@redux/INIT"+Sm(),REPLACE:"@@redux/REPLACE"+Sm(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Sm()}};function QJ(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function qI(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Yt(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Yt(1));return r(qI)(e,t)}if(typeof e!="function")throw new Error(Yt(2));var s=e,i=t,a=[],l=a,c=!1;function u(){l===a&&(l=a.slice())}function f(){if(c)throw new Error(Yt(3));return i}function d(v){if(typeof v!="function")throw new Error(Yt(4));if(c)throw new Error(Yt(5));var y=!0;return u(),l.push(v),function(){if(y){if(c)throw new Error(Yt(6));y=!1,u();var b=l.indexOf(v);l.splice(b,1),a=null}}}function h(v){if(!QJ(v))throw new Error(Yt(7));if(typeof v.type>"u")throw new Error(Yt(8));if(c)throw new Error(Yt(9));try{c=!0,i=s(i,v)}finally{c=!1}for(var y=a=l,x=0;x<y.length;x++){var b=y[x];b()}return v}function m(v){if(typeof v!="function")throw new Error(Yt(10));s=v,h({type:q1.REPLACE})}function g(){var v,y=d;return v={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error(Yt(11));function w(){b.next&&b.next(f())}w();var j=y(w);return{unsubscribe:j}}},v[V1]=function(){return this},v}return h({type:q1.INIT}),n={dispatch:h,subscribe:d,getState:f,replaceReducer:m},n[V1]=g,n}function W1(e,t){return function(){return t(e.apply(this,arguments))}}function H1(e,t){if(typeof e=="function")return W1(e,t);if(typeof e!="object"||e===null)throw new Error(Yt(16));var r={};for(var n in e){var s=e[n];typeof s=="function"&&(r[n]=W1(s,t))}return r}function WI(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,s){return function(){return n(s.apply(void 0,arguments))}})}function ZJ(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var s=n.apply(void 0,arguments),i=function(){throw new Error(Yt(15))},a={getState:s.getState,dispatch:function(){return i.apply(void 0,arguments)}},l=t.map(function(c){return c(a)});return i=WI.apply(void 0,l)(s.dispatch),U1(U1({},s),{},{dispatch:i})}}}var HI={exports:{}},GI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=p;function eX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tX=typeof Object.is=="function"?Object.is:eX,rX=aa.useState,nX=aa.useEffect,sX=aa.useLayoutEffect,iX=aa.useDebugValue;function oX(e,t){var r=t(),n=rX({inst:{value:r,getSnapshot:t}}),s=n[0].inst,i=n[1];return sX(function(){s.value=r,s.getSnapshot=t,Nm(s)&&i({inst:s})},[e,r,t]),nX(function(){return Nm(s)&&i({inst:s}),e(function(){Nm(s)&&i({inst:s})})},[e]),iX(r),r}function Nm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!tX(e,r)}catch{return!0}}function aX(e,t){return t()}var lX=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?aX:oX;GI.useSyncExternalStore=aa.useSyncExternalStore!==void 0?aa.useSyncExternalStore:lX;HI.exports=GI;var KI=HI.exports,cX={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kh=p,uX=KI;function dX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fX=typeof Object.is=="function"?Object.is:dX,hX=uX.useSyncExternalStore,pX=kh.useRef,mX=kh.useEffect,gX=kh.useMemo,vX=kh.useDebugValue;cX.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var i=pX(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=gX(function(){function c(m){if(!u){if(u=!0,f=m,m=n(m),s!==void 0&&a.hasValue){var g=a.value;if(s(g,m))return d=g}return d=m}if(g=d,fX(f,m))return g;var v=n(m);return s!==void 0&&s(g,v)?(f=m,g):(f=m,d=v)}var u=!1,f,d,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,s]);var l=hX(e,i[0],i[1]);return mX(function(){a.hasValue=!0,a.value=l},[l]),vX(l),l};function xX(e){e()}let YI=xX;const yX=e=>YI=e,bX=()=>YI,G1=Symbol.for("react-redux-context"),K1=typeof globalThis<"u"?globalThis:{};function wX(){var e;if(!p.createContext)return{};const t=(e=K1[G1])!=null?e:K1[G1]=new Map;let r=t.get(p.createContext);return r||(r=p.createContext(null),t.set(p.createContext,r)),r}const JI=wX(),jX=()=>{throw new Error("uSES not initialized!")};function XI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var QI={exports:{}},Me={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wt=typeof Symbol=="function"&&Symbol.for,By=wt?Symbol.for("react.element"):60103,zy=wt?Symbol.for("react.portal"):60106,Ah=wt?Symbol.for("react.fragment"):60107,Rh=wt?Symbol.for("react.strict_mode"):60108,Ih=wt?Symbol.for("react.profiler"):60114,Oh=wt?Symbol.for("react.provider"):60109,Dh=wt?Symbol.for("react.context"):60110,Uy=wt?Symbol.for("react.async_mode"):60111,$h=wt?Symbol.for("react.concurrent_mode"):60111,Mh=wt?Symbol.for("react.forward_ref"):60112,Lh=wt?Symbol.for("react.suspense"):60113,_X=wt?Symbol.for("react.suspense_list"):60120,Fh=wt?Symbol.for("react.memo"):60115,Bh=wt?Symbol.for("react.lazy"):60116,SX=wt?Symbol.for("react.block"):60121,NX=wt?Symbol.for("react.fundamental"):60117,EX=wt?Symbol.for("react.responder"):60118,CX=wt?Symbol.for("react.scope"):60119;function _r(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case By:switch(e=e.type,e){case Uy:case $h:case Ah:case Ih:case Rh:case Lh:return e;default:switch(e=e&&e.$$typeof,e){case Dh:case Mh:case Bh:case Fh:case Oh:return e;default:return t}}case zy:return t}}}function ZI(e){return _r(e)===$h}Me.AsyncMode=Uy;Me.ConcurrentMode=$h;Me.ContextConsumer=Dh;Me.ContextProvider=Oh;Me.Element=By;Me.ForwardRef=Mh;Me.Fragment=Ah;Me.Lazy=Bh;Me.Memo=Fh;Me.Portal=zy;Me.Profiler=Ih;Me.StrictMode=Rh;Me.Suspense=Lh;Me.isAsyncMode=function(e){return ZI(e)||_r(e)===Uy};Me.isConcurrentMode=ZI;Me.isContextConsumer=function(e){return _r(e)===Dh};Me.isContextProvider=function(e){return _r(e)===Oh};Me.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===By};Me.isForwardRef=function(e){return _r(e)===Mh};Me.isFragment=function(e){return _r(e)===Ah};Me.isLazy=function(e){return _r(e)===Bh};Me.isMemo=function(e){return _r(e)===Fh};Me.isPortal=function(e){return _r(e)===zy};Me.isProfiler=function(e){return _r(e)===Ih};Me.isStrictMode=function(e){return _r(e)===Rh};Me.isSuspense=function(e){return _r(e)===Lh};Me.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Ah||e===$h||e===Ih||e===Rh||e===Lh||e===_X||typeof e=="object"&&e!==null&&(e.$$typeof===Bh||e.$$typeof===Fh||e.$$typeof===Oh||e.$$typeof===Dh||e.$$typeof===Mh||e.$$typeof===NX||e.$$typeof===EX||e.$$typeof===CX||e.$$typeof===SX)};Me.typeOf=_r;QI.exports=Me;var PX=QI.exports,Vy=PX,TX={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},kX={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},AX={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},eO={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},qy={};qy[Vy.ForwardRef]=AX;qy[Vy.Memo]=eO;function Y1(e){return Vy.isMemo(e)?eO:qy[e.$$typeof]||TX}var RX=Object.defineProperty,IX=Object.getOwnPropertyNames,J1=Object.getOwnPropertySymbols,OX=Object.getOwnPropertyDescriptor,DX=Object.getPrototypeOf,X1=Object.prototype;function tO(e,t,r){if(typeof t!="string"){if(X1){var n=DX(t);n&&n!==X1&&tO(e,n,r)}var s=IX(t);J1&&(s=s.concat(J1(t)));for(var i=Y1(e),a=Y1(t),l=0;l<s.length;++l){var c=s[l];if(!kX[c]&&!(r&&r[c])&&!(a&&a[c])&&!(i&&i[c])){var u=OX(t,c);try{RX(e,c,u)}catch{}}}}return e}var $X=tO;const Q1=Di($X);var rO={exports:{}},Le={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy=Symbol.for("react.element"),Hy=Symbol.for("react.portal"),zh=Symbol.for("react.fragment"),Uh=Symbol.for("react.strict_mode"),Vh=Symbol.for("react.profiler"),qh=Symbol.for("react.provider"),Wh=Symbol.for("react.context"),MX=Symbol.for("react.server_context"),Hh=Symbol.for("react.forward_ref"),Gh=Symbol.for("react.suspense"),Kh=Symbol.for("react.suspense_list"),Yh=Symbol.for("react.memo"),Jh=Symbol.for("react.lazy"),LX=Symbol.for("react.offscreen"),nO;nO=Symbol.for("react.module.reference");function zr(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Wy:switch(e=e.type,e){case zh:case Vh:case Uh:case Gh:case Kh:return e;default:switch(e=e&&e.$$typeof,e){case MX:case Wh:case Hh:case Jh:case Yh:case qh:return e;default:return t}}case Hy:return t}}}Le.ContextConsumer=Wh;Le.ContextProvider=qh;Le.Element=Wy;Le.ForwardRef=Hh;Le.Fragment=zh;Le.Lazy=Jh;Le.Memo=Yh;Le.Portal=Hy;Le.Profiler=Vh;Le.StrictMode=Uh;Le.Suspense=Gh;Le.SuspenseList=Kh;Le.isAsyncMode=function(){return!1};Le.isConcurrentMode=function(){return!1};Le.isContextConsumer=function(e){return zr(e)===Wh};Le.isContextProvider=function(e){return zr(e)===qh};Le.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Wy};Le.isForwardRef=function(e){return zr(e)===Hh};Le.isFragment=function(e){return zr(e)===zh};Le.isLazy=function(e){return zr(e)===Jh};Le.isMemo=function(e){return zr(e)===Yh};Le.isPortal=function(e){return zr(e)===Hy};Le.isProfiler=function(e){return zr(e)===Vh};Le.isStrictMode=function(e){return zr(e)===Uh};Le.isSuspense=function(e){return zr(e)===Gh};Le.isSuspenseList=function(e){return zr(e)===Kh};Le.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===zh||e===Vh||e===Uh||e===Gh||e===Kh||e===LX||typeof e=="object"&&e!==null&&(e.$$typeof===Jh||e.$$typeof===Yh||e.$$typeof===qh||e.$$typeof===Wh||e.$$typeof===Hh||e.$$typeof===nO||e.getModuleId!==void 0)};Le.typeOf=zr;rO.exports=Le;var FX=rO.exports;const BX=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function zX(e,t,r,n,{areStatesEqual:s,areOwnPropsEqual:i,areStatePropsEqual:a}){let l=!1,c,u,f,d,h;function m(b,w){return c=b,u=w,f=e(c,u),d=t(n,u),h=r(f,d,u),l=!0,h}function g(){return f=e(c,u),t.dependsOnOwnProps&&(d=t(n,u)),h=r(f,d,u),h}function v(){return e.dependsOnOwnProps&&(f=e(c,u)),t.dependsOnOwnProps&&(d=t(n,u)),h=r(f,d,u),h}function y(){const b=e(c,u),w=!a(b,f);return f=b,w&&(h=r(f,d,u)),h}function x(b,w){const j=!i(w,u),_=!s(b,c,w,u);return c=b,u=w,j&&_?g():j?v():_?y():h}return function(w,j){return l?x(w,j):m(w,j)}}function UX(e,t){let{initMapStateToProps:r,initMapDispatchToProps:n,initMergeProps:s}=t,i=XI(t,BX);const a=r(e,i),l=n(e,i),c=s(e,i);return zX(a,l,c,e,i)}function VX(e,t){const r={};for(const n in e){const s=e[n];typeof s=="function"&&(r[n]=(...i)=>t(s(...i)))}return r}function Vv(e){return function(r){const n=e(r);function s(){return n}return s.dependsOnOwnProps=!1,s}}function Z1(e){return e.dependsOnOwnProps?!!e.dependsOnOwnProps:e.length!==1}function sO(e,t){return function(n,{displayName:s}){const i=function(l,c){return i.dependsOnOwnProps?i.mapToProps(l,c):i.mapToProps(l,void 0)};return i.dependsOnOwnProps=!0,i.mapToProps=function(l,c){i.mapToProps=e,i.dependsOnOwnProps=Z1(e);let u=i(l,c);return typeof u=="function"&&(i.mapToProps=u,i.dependsOnOwnProps=Z1(u),u=i(l,c)),u},i}}function Gy(e,t){return(r,n)=>{throw new Error(`Invalid value of type ${typeof e} for ${t} argument when connecting component ${n.wrappedComponentName}.`)}}function qX(e){return e&&typeof e=="object"?Vv(t=>VX(e,t)):e?typeof e=="function"?sO(e):Gy(e,"mapDispatchToProps"):Vv(t=>({dispatch:t}))}function WX(e){return e?typeof e=="function"?sO(e):Gy(e,"mapStateToProps"):Vv(()=>({}))}function HX(e,t,r){return je({},r,e,t)}function GX(e){return function(r,{displayName:n,areMergedPropsEqual:s}){let i=!1,a;return function(c,u,f){const d=e(c,u,f);return i?s(d,a)||(a=d):(i=!0,a=d),a}}}function KX(e){return e?typeof e=="function"?GX(e):Gy(e,"mergeProps"):()=>HX}function YX(){const e=bX();let t=null,r=null;return{clear(){t=null,r=null},notify(){e(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){let n=[],s=t;for(;s;)n.push(s),s=s.next;return n},subscribe(n){let s=!0,i=r={callback:n,next:null,prev:r};return i.prev?i.prev.next=i:t=i,function(){!s||t===null||(s=!1,i.next?i.next.prev=i.prev:r=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}const eS={notify(){},get:()=>[]};function iO(e,t){let r,n=eS,s=0,i=!1;function a(v){f();const y=n.subscribe(v);let x=!1;return()=>{x||(x=!0,y(),d())}}function l(){n.notify()}function c(){g.onStateChange&&g.onStateChange()}function u(){return i}function f(){s++,r||(r=t?t.addNestedSub(c):e.subscribe(c),n=YX())}function d(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=eS)}function h(){i||(i=!0,f())}function m(){i&&(i=!1,d())}const g={addNestedSub:a,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:h,tryUnsubscribe:m,getListeners:()=>n};return g}const JX=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",hf=JX?p.useLayoutEffect:p.useEffect;function tS(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Em(e,t){if(tS(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(t,r[s])||!tS(e[r[s]],t[r[s]]))return!1;return!0}const XX=["reactReduxForwardedRef"];let oO=jX;const QX=e=>{oO=e},ZX=[null,null];function eQ(e,t,r){hf(()=>e(...t),r)}function tQ(e,t,r,n,s,i){e.current=n,r.current=!1,s.current&&(s.current=null,i())}function rQ(e,t,r,n,s,i,a,l,c,u,f){if(!e)return()=>{};let d=!1,h=null;const m=()=>{if(d||!l.current)return;const v=t.getState();let y,x;try{y=n(v,s.current)}catch(b){x=b,h=b}x||(h=null),y===i.current?a.current||u():(i.current=y,c.current=y,a.current=!0,f())};return r.onStateChange=m,r.trySubscribe(),m(),()=>{if(d=!0,r.tryUnsubscribe(),r.onStateChange=null,h)throw h}}function nQ(e,t){return e===t}function aO(e,t,r,{pure:n,areStatesEqual:s=nQ,areOwnPropsEqual:i=Em,areStatePropsEqual:a=Em,areMergedPropsEqual:l=Em,forwardRef:c=!1,context:u=JI}={}){const f=u,d=WX(e),h=qX(t),m=KX(r),g=!!e;return y=>{const x=y.displayName||y.name||"Component",b=`Connect(${x})`,w={shouldHandleStateChanges:g,displayName:b,wrappedComponentName:x,WrappedComponent:y,initMapStateToProps:d,initMapDispatchToProps:h,initMergeProps:m,areStatesEqual:s,areStatePropsEqual:a,areOwnPropsEqual:i,areMergedPropsEqual:l};function j(N){const[E,C,k]=p.useMemo(()=>{const{reactReduxForwardedRef:ue}=N,_e=XI(N,XX);return[N.context,ue,_e]},[N]),L=p.useMemo(()=>E&&E.Consumer&&FX.isContextConsumer(p.createElement(E.Consumer,null))?E:f,[E,f]),A=p.useContext(L),R=!!N.store&&!!N.store.getState&&!!N.store.dispatch,O=!!A&&!!A.store,z=R?N.store:A.store,F=O?A.getServerState:z.getState,V=p.useMemo(()=>UX(z.dispatch,w),[z]),[I,D]=p.useMemo(()=>{if(!g)return ZX;const ue=iO(z,R?void 0:A.subscription),_e=ue.notifyNestedSubs.bind(ue);return[ue,_e]},[z,R,A]),$=p.useMemo(()=>R?A:je({},A,{subscription:I}),[R,A,I]),M=p.useRef(),W=p.useRef(k),U=p.useRef(),X=p.useRef(!1);p.useRef(!1);const me=p.useRef(!1),se=p.useRef();hf(()=>(me.current=!0,()=>{me.current=!1}),[]);const Z=p.useMemo(()=>()=>U.current&&k===W.current?U.current:V(z.getState(),k),[z,k]),oe=p.useMemo(()=>_e=>I?rQ(g,z,I,V,W,M,X,me,U,D,_e):()=>{},[I]);eQ(tQ,[W,M,X,k,U,D]);let H;try{H=oO(oe,Z,F?()=>V(F(),k):Z)}catch(ue){throw se.current&&(ue.message+=`
The error may be correlated with this previous error:
${se.current.stack}

`),ue}hf(()=>{se.current=void 0,U.current=void 0,M.current=H});const q=p.useMemo(()=>p.createElement(y,je({},H,{ref:C})),[C,y,H]);return p.useMemo(()=>g?p.createElement(L.Provider,{value:$},q):q,[L,q,$])}const S=p.memo(j);if(S.WrappedComponent=y,S.displayName=j.displayName=b,c){const E=p.forwardRef(function(k,L){return p.createElement(S,je({},k,{reactReduxForwardedRef:L}))});return E.displayName=b,E.WrappedComponent=y,Q1(E,y)}return Q1(S,y)}}function sQ({store:e,context:t,children:r,serverState:n,stabilityCheck:s="once",noopCheck:i="once"}){const a=p.useMemo(()=>{const u=iO(e);return{store:e,subscription:u,getServerState:n?()=>n:void 0,stabilityCheck:s,noopCheck:i}},[e,n,s,i]),l=p.useMemo(()=>e.getState(),[e]);hf(()=>{const{subscription:u}=a;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),l!==e.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[a,l]);const c=t||JI;return p.createElement(c.Provider,{value:a},r)}QX(KI.useSyncExternalStore);yX(jr.unstable_batchedUpdates);function iQ(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function lO(e,t){var r=p.useState(function(){return{inputs:t,result:e()}})[0],n=p.useRef(!0),s=p.useRef(r),i=n.current||!!(t&&s.current.inputs&&iQ(t,s.current.inputs)),a=i?s.current:{inputs:t,result:e()};return p.useEffect(function(){n.current=!1,s.current=a},[a]),a.result}function oQ(e,t){return lO(function(){return e},t)}var Ae=lO,ye=oQ,aQ=!0,Cm="Invariant failed";function lQ(e,t){if(!e){if(aQ)throw new Error(Cm);var r=typeof t=="function"?t():t,n=r?"".concat(Cm,": ").concat(r):Cm;throw new Error(n)}}var Xr=function(t){var r=t.top,n=t.right,s=t.bottom,i=t.left,a=n-i,l=s-r,c={top:r,right:n,bottom:s,left:i,width:a,height:l,x:i,y:r,center:{x:(n+i)/2,y:(s+r)/2}};return c},Ky=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},rS=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},cQ=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},Pm={top:0,right:0,bottom:0,left:0},Yy=function(t){var r=t.borderBox,n=t.margin,s=n===void 0?Pm:n,i=t.border,a=i===void 0?Pm:i,l=t.padding,c=l===void 0?Pm:l,u=Xr(Ky(r,s)),f=Xr(rS(r,a)),d=Xr(rS(f,c));return{marginBox:u,borderBox:Xr(r),paddingBox:f,contentBox:d,margin:s,border:a,padding:c}},Er=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var s=Number(r);return isNaN(s)&&lQ(!1),s},uQ=function(){return{x:window.pageXOffset,y:window.pageYOffset}},pf=function(t,r){var n=t.borderBox,s=t.border,i=t.margin,a=t.padding,l=cQ(n,r);return Yy({borderBox:l,border:s,margin:i,padding:a})},mf=function(t,r){return r===void 0&&(r=uQ()),pf(t,r)},cO=function(t,r){var n={top:Er(r.marginTop),right:Er(r.marginRight),bottom:Er(r.marginBottom),left:Er(r.marginLeft)},s={top:Er(r.paddingTop),right:Er(r.paddingRight),bottom:Er(r.paddingBottom),left:Er(r.paddingLeft)},i={top:Er(r.borderTopWidth),right:Er(r.borderRightWidth),bottom:Er(r.borderBottomWidth),left:Er(r.borderLeftWidth)};return Yy({borderBox:t,margin:n,padding:s,border:i})},uO=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return cO(r,n)},nS=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function dQ(e,t){return!!(e===t||nS(e)&&nS(t))}function fQ(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!dQ(e[r],t[r]))return!1;return!0}function yt(e,t){t===void 0&&(t=fQ);var r=null;function n(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];if(r&&r.lastThis===this&&t(s,r.lastArgs))return r.lastResult;var a=e.apply(this,s);return r={lastResult:a,lastArgs:s,lastThis:this},a}return n.clear=function(){r=null},n}var hQ=function(t){var r=[],n=null,s=function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return s.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},s};const fc=hQ;function dO(e,t){}dO.bind(null,"warn");dO.bind(null,"error");function As(){}function pQ(e,t){return{...e,...t}}function Rr(e,t,r){const n=t.map(s=>{const i=pQ(r,s.options);return e.addEventListener(s.eventName,s.fn,i),function(){e.removeEventListener(s.eventName,s.fn,i)}});return function(){n.forEach(i=>{i()})}}const mQ="Invariant failed";class gf extends Error{}gf.prototype.toString=function(){return this.message};function ne(e,t){if(!e)throw new gf(mQ)}let gQ=class extends J.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=As,this.onWindowError=r=>{const n=this.getCallbacks();n.isDragging()&&n.tryAbort(),r.error instanceof gf&&r.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=r=>{this.callbacks=r}}componentDidMount(){this.unbind=Rr(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof gf){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}};const vQ=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,vf=e=>e+1,xQ=e=>`
  You have lifted an item in position ${vf(e.source.index)}
`,fO=(e,t)=>{const r=e.droppableId===t.droppableId,n=vf(e.index),s=vf(t.index);return r?`
      You have moved the item from position ${n}
      to position ${s}
    `:`
    You have moved the item from position ${n}
    in list ${e.droppableId}
    to list ${t.droppableId}
    in position ${s}
  `},hO=(e,t,r)=>t.droppableId===r.droppableId?`
      The item ${e}
      has been combined with ${r.draggableId}`:`
      The item ${e}
      in list ${t.droppableId}
      has been combined with ${r.draggableId}
      in list ${r.droppableId}
    `,yQ=e=>{const t=e.destination;if(t)return fO(e.source,t);const r=e.combine;return r?hO(e.draggableId,e.source,r):"You are over an area that cannot be dropped on"},sS=e=>`
  The item has returned to its starting position
  of ${vf(e.index)}
`,bQ=e=>{if(e.reason==="CANCEL")return`
      Movement cancelled.
      ${sS(e.source)}
    `;const t=e.destination,r=e.combine;return t?`
      You have dropped the item.
      ${fO(e.source,t)}
    `:r?`
      You have dropped the item.
      ${hO(e.draggableId,e.source,r)}
    `:`
    The item has been dropped while not over a drop area.
    ${sS(e.source)}
  `},wQ={dragHandleUsageInstructions:vQ,onDragStart:xQ,onDragUpdate:yQ,onDragEnd:bQ};var fd=wQ;const bt={x:0,y:0},St=(e,t)=>({x:e.x+t.x,y:e.y+t.y}),dr=(e,t)=>({x:e.x-t.x,y:e.y-t.y}),Rs=(e,t)=>e.x===t.x&&e.y===t.y,Pa=e=>({x:e.x!==0?-e.x:0,y:e.y!==0?-e.y:0}),Ri=(e,t,r=0)=>e==="x"?{x:t,y:r}:{x:r,y:t},hc=(e,t)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),iS=(e,t)=>Math.min(...t.map(r=>hc(e,r))),pO=e=>t=>({x:e(t.x),y:e(t.y)});var jQ=(e,t)=>{const r=Xr({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r};const Kc=(e,t)=>({top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}),oS=e=>[{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.left,y:e.bottom},{x:e.right,y:e.bottom}],_Q={top:0,right:0,bottom:0,left:0},SQ=(e,t)=>t?Kc(e,t.scroll.diff.displacement):e,NQ=(e,t,r)=>r&&r.increasedBy?{...e,[t.end]:e[t.end]+r.increasedBy[t.line]}:e,EQ=(e,t)=>t&&t.shouldClipSubject?jQ(t.pageMarginBox,e):Xr(e);var la=({page:e,withPlaceholder:t,axis:r,frame:n})=>{const s=SQ(e.marginBox,n),i=NQ(s,r,t),a=EQ(i,n);return{page:e,withPlaceholder:t,active:a}},Jy=(e,t)=>{e.frame||ne(!1);const r=e.frame,n=dr(t,r.scroll.initial),s=Pa(n),i={...r,scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:s},max:r.scroll.max}},a=la({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:i});return{...e,frame:i,subject:a}};const mO=yt(e=>e.reduce((t,r)=>(t[r.descriptor.id]=r,t),{})),gO=yt(e=>e.reduce((t,r)=>(t[r.descriptor.id]=r,t),{})),Xh=yt(e=>Object.values(e)),CQ=yt(e=>Object.values(e));var Ta=yt((e,t)=>CQ(t).filter(n=>e===n.descriptor.droppableId).sort((n,s)=>n.descriptor.index-s.descriptor.index));function Xy(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function Qh(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var Zh=yt((e,t)=>t.filter(r=>r.descriptor.id!==e.descriptor.id)),PQ=({isMovingForward:e,draggable:t,destination:r,insideDestination:n,previousImpact:s})=>{if(!r.isCombineEnabled||!Xy(s))return null;function a(m){const g={type:"COMBINE",combine:{draggableId:m,droppableId:r.descriptor.id}};return{...s,at:g}}const l=s.displaced.all,c=l.length?l[0]:null;if(e)return c?a(c):null;const u=Zh(t,n);if(!c){if(!u.length)return null;const m=u[u.length-1];return a(m.descriptor.id)}const f=u.findIndex(m=>m.descriptor.id===c);f===-1&&ne(!1);const d=f-1;if(d<0)return null;const h=u[d];return a(h.descriptor.id)},ka=(e,t)=>e.descriptor.droppableId===t.descriptor.id;const vO={point:bt,value:0},pc={invisible:{},visible:{},all:[]},TQ={displaced:pc,displacedBy:vO,at:null};var kQ=TQ,Dr=(e,t)=>r=>e<=r&&r<=t,xO=e=>{const t=Dr(e.top,e.bottom),r=Dr(e.left,e.right);return n=>{if(t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right))return!0;const i=t(n.top)||t(n.bottom),a=r(n.left)||r(n.right);if(i&&a)return!0;const c=n.top<e.top&&n.bottom>e.bottom,u=n.left<e.left&&n.right>e.right;return c&&u?!0:c&&a||u&&i}},AQ=e=>{const t=Dr(e.top,e.bottom),r=Dr(e.left,e.right);return n=>t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right)};const Qy={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},yO={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var RQ=e=>t=>{const r=Dr(t.top,t.bottom),n=Dr(t.left,t.right);return s=>e===Qy?r(s.top)&&r(s.bottom):n(s.left)&&n(s.right)};const IQ=(e,t)=>{const r=t.frame?t.frame.scroll.diff.displacement:bt;return Kc(e,r)},OQ=(e,t,r)=>t.subject.active?r(t.subject.active)(e):!1,DQ=(e,t,r)=>r(t)(e),Zy=({target:e,destination:t,viewport:r,withDroppableDisplacement:n,isVisibleThroughFrameFn:s})=>{const i=n?IQ(e,t):e;return OQ(i,t,s)&&DQ(i,r,s)},$Q=e=>Zy({...e,isVisibleThroughFrameFn:xO}),bO=e=>Zy({...e,isVisibleThroughFrameFn:AQ}),MQ=e=>Zy({...e,isVisibleThroughFrameFn:RQ(e.destination.axis)}),LQ=(e,t,r)=>{if(typeof r=="boolean")return r;if(!t)return!0;const{invisible:n,visible:s}=t;if(n[e])return!1;const i=s[e];return i?i.shouldAnimate:!0};function FQ(e,t){const r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return Xr(Ky(r,n))}function mc({afterDragging:e,destination:t,displacedBy:r,viewport:n,forceShouldAnimate:s,last:i}){return e.reduce(function(l,c){const u=FQ(c,r),f=c.descriptor.id;if(l.all.push(f),!$Q({target:u,destination:t,viewport:n,withDroppableDisplacement:!0}))return l.invisible[c.descriptor.id]=!0,l;const h=LQ(f,i,s),m={draggableId:f,shouldAnimate:h};return l.visible[f]=m,l},{all:[],visible:{},invisible:{}})}function BQ(e,t){if(!e.length)return 0;const r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function aS({insideDestination:e,inHomeList:t,displacedBy:r,destination:n}){const s=BQ(e,{inHomeList:t});return{displaced:pc,displacedBy:r,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:s}}}}function xf({draggable:e,insideDestination:t,destination:r,viewport:n,displacedBy:s,last:i,index:a,forceShouldAnimate:l}){const c=ka(e,r);if(a==null)return aS({insideDestination:t,inHomeList:c,displacedBy:s,destination:r});const u=t.find(g=>g.descriptor.index===a);if(!u)return aS({insideDestination:t,inHomeList:c,displacedBy:s,destination:r});const f=Zh(e,t),d=t.indexOf(u),h=f.slice(d);return{displaced:mc({afterDragging:h,destination:r,displacedBy:s,last:i,viewport:n.frame,forceShouldAnimate:l}),displacedBy:s,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:a}}}}function Bs(e,t){return!!t.effected[e]}var zQ=({isMovingForward:e,destination:t,draggables:r,combine:n,afterCritical:s})=>{if(!t.isCombineEnabled)return null;const i=n.draggableId,l=r[i].descriptor.index;return Bs(i,s)?e?l:l-1:e?l+1:l},UQ=({isMovingForward:e,isInHomeList:t,insideDestination:r,location:n})=>{if(!r.length)return null;const s=n.index,i=e?s+1:s-1,a=r[0].descriptor.index,l=r[r.length-1].descriptor.index,c=t?l:l+1;return i<a||i>c?null:i},VQ=({isMovingForward:e,isInHomeList:t,draggable:r,draggables:n,destination:s,insideDestination:i,previousImpact:a,viewport:l,afterCritical:c})=>{const u=a.at;if(u||ne(!1),u.type==="REORDER"){const d=UQ({isMovingForward:e,isInHomeList:t,location:u.destination,insideDestination:i});return d==null?null:xf({draggable:r,insideDestination:i,destination:s,viewport:l,last:a.displaced,displacedBy:a.displacedBy,index:d})}const f=zQ({isMovingForward:e,destination:s,displaced:a.displaced,draggables:n,combine:u.combine,afterCritical:c});return f==null?null:xf({draggable:r,insideDestination:i,destination:s,viewport:l,last:a.displaced,displacedBy:a.displacedBy,index:f})},qQ=({displaced:e,afterCritical:t,combineWith:r,displacedBy:n})=>{const s=!!(e.visible[r]||e.invisible[r]);return Bs(r,t)?s?bt:Pa(n.point):s?n.point:bt},WQ=({afterCritical:e,impact:t,draggables:r})=>{const n=Qh(t);n||ne(!1);const s=n.draggableId,i=r[s].page.borderBox.center,a=qQ({displaced:t.displaced,afterCritical:e,combineWith:s,displacedBy:t.displacedBy});return St(i,a)};const wO=(e,t)=>t.margin[e.start]+t.borderBox[e.size]/2,HQ=(e,t)=>t.margin[e.end]+t.borderBox[e.size]/2,eb=(e,t,r)=>t[e.crossAxisStart]+r.margin[e.crossAxisStart]+r.borderBox[e.crossAxisSize]/2,lS=({axis:e,moveRelativeTo:t,isMoving:r})=>Ri(e.line,t.marginBox[e.end]+wO(e,r),eb(e,t.marginBox,r)),cS=({axis:e,moveRelativeTo:t,isMoving:r})=>Ri(e.line,t.marginBox[e.start]-HQ(e,r),eb(e,t.marginBox,r)),GQ=({axis:e,moveInto:t,isMoving:r})=>Ri(e.line,t.contentBox[e.start]+wO(e,r),eb(e,t.contentBox,r));var KQ=({impact:e,draggable:t,draggables:r,droppable:n,afterCritical:s})=>{const i=Ta(n.descriptor.id,r),a=t.page,l=n.axis;if(!i.length)return GQ({axis:l,moveInto:n.page,isMoving:a});const{displaced:c,displacedBy:u}=e,f=c.all[0];if(f){const h=r[f];if(Bs(f,s))return cS({axis:l,moveRelativeTo:h.page,isMoving:a});const m=pf(h.page,u.point);return cS({axis:l,moveRelativeTo:m,isMoving:a})}const d=i[i.length-1];if(d.descriptor.id===t.descriptor.id)return a.borderBox.center;if(Bs(d.descriptor.id,s)){const h=pf(d.page,Pa(s.displacedBy.point));return lS({axis:l,moveRelativeTo:h,isMoving:a})}return lS({axis:l,moveRelativeTo:d.page,isMoving:a})},qv=(e,t)=>{const r=e.frame;return r?St(t,r.scroll.diff.displacement):t};const YQ=({impact:e,draggable:t,droppable:r,draggables:n,afterCritical:s})=>{const i=t.page.borderBox.center,a=e.at;return!r||!a?i:a.type==="REORDER"?KQ({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:s}):WQ({impact:e,draggables:n,afterCritical:s})};var ep=e=>{const t=YQ(e),r=e.droppable;return r?qv(r,t):t},jO=(e,t)=>{const r=dr(t,e.scroll.initial),n=Pa(r);return{frame:Xr({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}}};function uS(e,t){return e.map(r=>t[r])}function JQ(e,t){for(let r=0;r<t.length;r++){const n=t[r].visible[e];if(n)return n}return null}var XQ=({impact:e,viewport:t,destination:r,draggables:n,maxScrollChange:s})=>{const i=jO(t,St(t.scroll.current,s)),a=r.frame?Jy(r,St(r.frame.scroll.current,s)):r,l=e.displaced,c=mc({afterDragging:uS(l.all,n),destination:r,displacedBy:e.displacedBy,viewport:i.frame,last:l,forceShouldAnimate:!1}),u=mc({afterDragging:uS(l.all,n),destination:a,displacedBy:e.displacedBy,viewport:t.frame,last:l,forceShouldAnimate:!1}),f={},d={},h=[l,c,u];return l.all.forEach(g=>{const v=JQ(g,h);if(v){d[g]=v;return}f[g]=!0}),{...e,displaced:{all:l.all,invisible:f,visible:d}}},QQ=(e,t)=>St(e.scroll.diff.displacement,t),tb=({pageBorderBoxCenter:e,draggable:t,viewport:r})=>{const n=QQ(r,e),s=dr(n,t.page.borderBox.center);return St(t.client.borderBox.center,s)},_O=({draggable:e,destination:t,newPageBorderBoxCenter:r,viewport:n,withDroppableDisplacement:s,onlyOnMainAxis:i=!1})=>{const a=dr(r,e.page.borderBox.center),c={target:Kc(e.page.borderBox,a),destination:t,withDroppableDisplacement:s,viewport:n};return i?MQ(c):bO(c)},ZQ=({isMovingForward:e,draggable:t,destination:r,draggables:n,previousImpact:s,viewport:i,previousPageBorderBoxCenter:a,previousClientSelection:l,afterCritical:c})=>{if(!r.isEnabled)return null;const u=Ta(r.descriptor.id,n),f=ka(t,r),d=PQ({isMovingForward:e,draggable:t,destination:r,insideDestination:u,previousImpact:s})||VQ({isMovingForward:e,isInHomeList:f,draggable:t,draggables:n,destination:r,insideDestination:u,previousImpact:s,viewport:i,afterCritical:c});if(!d)return null;const h=ep({impact:d,draggable:t,droppable:r,draggables:n,afterCritical:c});if(_O({draggable:t,destination:r,newPageBorderBoxCenter:h,viewport:i.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:tb({pageBorderBoxCenter:h,draggable:t,viewport:i}),impact:d,scrollJumpRequest:null};const g=dr(h,a),v=XQ({impact:d,viewport:i,destination:r,draggables:n,maxScrollChange:g});return{clientSelection:l,impact:v,scrollJumpRequest:g}};const $t=e=>{const t=e.subject.active;return t||ne(!1),t};var eZ=({isMovingForward:e,pageBorderBoxCenter:t,source:r,droppables:n,viewport:s})=>{const i=r.subject.active;if(!i)return null;const a=r.axis,l=Dr(i[a.start],i[a.end]),c=Xh(n).filter(f=>f!==r).filter(f=>f.isEnabled).filter(f=>!!f.subject.active).filter(f=>xO(s.frame)($t(f))).filter(f=>{const d=$t(f);return e?i[a.crossAxisEnd]<d[a.crossAxisEnd]:d[a.crossAxisStart]<i[a.crossAxisStart]}).filter(f=>{const d=$t(f),h=Dr(d[a.start],d[a.end]);return l(d[a.start])||l(d[a.end])||h(i[a.start])||h(i[a.end])}).sort((f,d)=>{const h=$t(f)[a.crossAxisStart],m=$t(d)[a.crossAxisStart];return e?h-m:m-h}).filter((f,d,h)=>$t(f)[a.crossAxisStart]===$t(h[0])[a.crossAxisStart]);if(!c.length)return null;if(c.length===1)return c[0];const u=c.filter(f=>Dr($t(f)[a.start],$t(f)[a.end])(t[a.line]));return u.length===1?u[0]:u.length>1?u.sort((f,d)=>$t(f)[a.start]-$t(d)[a.start])[0]:c.sort((f,d)=>{const h=iS(t,oS($t(f))),m=iS(t,oS($t(d)));return h!==m?h-m:$t(f)[a.start]-$t(d)[a.start]})[0]};const dS=(e,t)=>{const r=e.page.borderBox.center;return Bs(e.descriptor.id,t)?dr(r,t.displacedBy.point):r},tZ=(e,t)=>{const r=e.page.borderBox;return Bs(e.descriptor.id,t)?Kc(r,Pa(t.displacedBy.point)):r};var rZ=({pageBorderBoxCenter:e,viewport:t,destination:r,insideDestination:n,afterCritical:s})=>n.filter(a=>bO({target:tZ(a,s),destination:r,viewport:t.frame,withDroppableDisplacement:!0})).sort((a,l)=>{const c=hc(e,qv(r,dS(a,s))),u=hc(e,qv(r,dS(l,s)));return c<u?-1:u<c?1:a.descriptor.index-l.descriptor.index})[0]||null,Yc=yt(function(t,r){const n=r[t.line];return{value:n,point:Ri(t.line,n)}});const nZ=(e,t,r)=>{const n=e.axis;if(e.descriptor.mode==="virtual")return Ri(n.line,t[n.line]);const s=e.subject.page.contentBox[n.size],c=Ta(e.descriptor.id,r).reduce((u,f)=>u+f.client.marginBox[n.size],0)+t[n.line]-s;return c<=0?null:Ri(n.line,c)},SO=(e,t)=>({...e,scroll:{...e.scroll,max:t}}),NO=(e,t,r)=>{const n=e.frame;ka(t,e)&&ne(!1),e.subject.withPlaceholder&&ne(!1);const s=Yc(e.axis,t.displaceBy).point,i=nZ(e,s,r),a={placeholderSize:s,increasedBy:i,oldFrameMaxScroll:e.frame?e.frame.scroll.max:null};if(!n){const f=la({page:e.subject.page,withPlaceholder:a,axis:e.axis,frame:e.frame});return{...e,subject:f}}const l=i?St(n.scroll.max,i):n.scroll.max,c=SO(n,l),u=la({page:e.subject.page,withPlaceholder:a,axis:e.axis,frame:c});return{...e,subject:u,frame:c}},sZ=e=>{const t=e.subject.withPlaceholder;t||ne(!1);const r=e.frame;if(!r){const a=la({page:e.subject.page,axis:e.axis,frame:null,withPlaceholder:null});return{...e,subject:a}}const n=t.oldFrameMaxScroll;n||ne(!1);const s=SO(r,n),i=la({page:e.subject.page,axis:e.axis,frame:s,withPlaceholder:null});return{...e,subject:i,frame:s}};var iZ=({previousPageBorderBoxCenter:e,moveRelativeTo:t,insideDestination:r,draggable:n,draggables:s,destination:i,viewport:a,afterCritical:l})=>{if(!t){if(r.length)return null;const d={displaced:pc,displacedBy:vO,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:0}}},h=ep({impact:d,draggable:n,droppable:i,draggables:s,afterCritical:l}),m=ka(n,i)?i:NO(i,n,s);return _O({draggable:n,destination:m,newPageBorderBoxCenter:h,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?d:null}const c=e[i.axis.line]<=t.page.borderBox.center[i.axis.line],u=(()=>{const d=t.descriptor.index;return t.descriptor.id===n.descriptor.id||c?d:d+1})(),f=Yc(i.axis,n.displaceBy);return xf({draggable:n,insideDestination:r,destination:i,viewport:a,displacedBy:f,last:pc,index:u})},oZ=({isMovingForward:e,previousPageBorderBoxCenter:t,draggable:r,isOver:n,draggables:s,droppables:i,viewport:a,afterCritical:l})=>{const c=eZ({isMovingForward:e,pageBorderBoxCenter:t,source:n,droppables:i,viewport:a});if(!c)return null;const u=Ta(c.descriptor.id,s),f=rZ({pageBorderBoxCenter:t,viewport:a,destination:c,insideDestination:u,afterCritical:l}),d=iZ({previousPageBorderBoxCenter:t,destination:c,draggable:r,draggables:s,moveRelativeTo:f,insideDestination:u,viewport:a,afterCritical:l});if(!d)return null;const h=ep({impact:d,draggable:r,droppable:c,draggables:s,afterCritical:l});return{clientSelection:tb({pageBorderBoxCenter:h,draggable:r,viewport:a}),impact:d,scrollJumpRequest:null}},mr=e=>{const t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const aZ=(e,t)=>{const r=mr(e);return r?t[r]:null};var lZ=({state:e,type:t})=>{const r=aZ(e.impact,e.dimensions.droppables),n=!!r,s=e.dimensions.droppables[e.critical.droppable.id],i=r||s,a=i.axis.direction,l=a==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||a==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(l&&!n)return null;const c=t==="MOVE_DOWN"||t==="MOVE_RIGHT",u=e.dimensions.draggables[e.critical.draggable.id],f=e.current.page.borderBoxCenter,{draggables:d,droppables:h}=e.dimensions;return l?ZQ({isMovingForward:c,previousPageBorderBoxCenter:f,draggable:u,destination:i,draggables:d,viewport:e.viewport,previousClientSelection:e.current.client.selection,previousImpact:e.impact,afterCritical:e.afterCritical}):oZ({isMovingForward:c,previousPageBorderBoxCenter:f,draggable:u,isOver:i,draggables:d,droppables:h,viewport:e.viewport,afterCritical:e.afterCritical})};function si(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function EO(e){const t=Dr(e.top,e.bottom),r=Dr(e.left,e.right);return function(s){return t(s.y)&&r(s.x)}}function cZ(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function uZ({pageBorderBox:e,draggable:t,candidates:r}){const n=t.page.borderBox.center,s=r.map(i=>{const a=i.axis,l=Ri(i.axis.line,e.center[a.line],i.page.borderBox.center[a.crossAxisLine]);return{id:i.descriptor.id,distance:hc(n,l)}}).sort((i,a)=>a.distance-i.distance);return s[0]?s[0].id:null}function dZ({pageBorderBox:e,draggable:t,droppables:r}){const n=Xh(r).filter(s=>{if(!s.isEnabled)return!1;const i=s.subject.active;if(!i||!cZ(e,i))return!1;if(EO(i)(e.center))return!0;const a=s.axis,l=i.center[a.crossAxisLine],c=e[a.crossAxisStart],u=e[a.crossAxisEnd],f=Dr(i[a.crossAxisStart],i[a.crossAxisEnd]),d=f(c),h=f(u);return!d&&!h?!0:d?c<l:u>l});return n.length?n.length===1?n[0].descriptor.id:uZ({pageBorderBox:e,draggable:t,candidates:n}):null}const CO=(e,t)=>Xr(Kc(e,t));var fZ=(e,t)=>{const r=e.frame;return r?CO(t,r.scroll.diff.value):t};function PO({displaced:e,id:t}){return!!(e.visible[t]||e.invisible[t])}function hZ({draggable:e,closest:t,inHomeList:r}){return t?r&&t.descriptor.index>e.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var pZ=({pageBorderBoxWithDroppableScroll:e,draggable:t,destination:r,insideDestination:n,last:s,viewport:i,afterCritical:a})=>{const l=r.axis,c=Yc(r.axis,t.displaceBy),u=c.value,f=e[l.start],d=e[l.end],m=Zh(t,n).find(v=>{const y=v.descriptor.id,x=v.page.borderBox.center[l.line],b=Bs(y,a),w=PO({displaced:s,id:y});return b?w?d<=x:f<x-u:w?d<=x+u:f<x})||null,g=hZ({draggable:t,closest:m,inHomeList:ka(t,r)});return xf({draggable:t,insideDestination:n,destination:r,viewport:i,last:s,displacedBy:c,index:g})};const mZ=4;var gZ=({draggable:e,pageBorderBoxWithDroppableScroll:t,previousImpact:r,destination:n,insideDestination:s,afterCritical:i})=>{if(!n.isCombineEnabled)return null;const a=n.axis,l=Yc(n.axis,e.displaceBy),c=l.value,u=t[a.start],f=t[a.end],h=Zh(e,s).find(g=>{const v=g.descriptor.id,y=g.page.borderBox,b=y[a.size]/mZ,w=Bs(v,i),j=PO({displaced:r.displaced,id:v});return w?j?f>y[a.start]+b&&f<y[a.end]-b:u>y[a.start]-c+b&&u<y[a.end]-c-b:j?f>y[a.start]+c+b&&f<y[a.end]+c-b:u>y[a.start]+b&&u<y[a.end]-b});return h?{displacedBy:l,displaced:r.displaced,at:{type:"COMBINE",combine:{draggableId:h.descriptor.id,droppableId:n.descriptor.id}}}:null},TO=({pageOffset:e,draggable:t,draggables:r,droppables:n,previousImpact:s,viewport:i,afterCritical:a})=>{const l=CO(t.page.borderBox,e),c=dZ({pageBorderBox:l,draggable:t,droppables:n});if(!c)return kQ;const u=n[c],f=Ta(u.descriptor.id,r),d=fZ(u,l);return gZ({pageBorderBoxWithDroppableScroll:d,draggable:t,previousImpact:s,destination:u,insideDestination:f,afterCritical:a})||pZ({pageBorderBoxWithDroppableScroll:d,draggable:t,destination:u,insideDestination:f,last:s.displaced,viewport:i,afterCritical:a})},rb=(e,t)=>({...e,[t.descriptor.id]:t});const vZ=({previousImpact:e,impact:t,droppables:r})=>{const n=mr(e),s=mr(t);if(!n||n===s)return r;const i=r[n];if(!i.subject.withPlaceholder)return r;const a=sZ(i);return rb(r,a)};var xZ=({draggable:e,draggables:t,droppables:r,previousImpact:n,impact:s})=>{const i=vZ({previousImpact:n,impact:s,droppables:r}),a=mr(s);if(!a)return i;const l=r[a];if(ka(e,l)||l.subject.withPlaceholder)return i;const c=NO(l,e,t);return rb(i,c)},Tl=({state:e,clientSelection:t,dimensions:r,viewport:n,impact:s,scrollJumpRequest:i})=>{const a=n||e.viewport,l=r||e.dimensions,c=t||e.current.client.selection,u=dr(c,e.initial.client.selection),f={offset:u,selection:c,borderBoxCenter:St(e.initial.client.borderBoxCenter,u)},d={selection:St(f.selection,a.scroll.current),borderBoxCenter:St(f.borderBoxCenter,a.scroll.current),offset:St(f.offset,a.scroll.diff.value)},h={client:f,page:d};if(e.phase==="COLLECTING")return{...e,dimensions:l,viewport:a,current:h};const m=l.draggables[e.critical.draggable.id],g=s||TO({pageOffset:d.offset,draggable:m,draggables:l.draggables,droppables:l.droppables,previousImpact:e.impact,viewport:a,afterCritical:e.afterCritical}),v=xZ({draggable:m,impact:g,previousImpact:e.impact,draggables:l.draggables,droppables:l.droppables});return{...e,current:h,dimensions:{draggables:l.draggables,droppables:v},impact:g,viewport:a,scrollJumpRequest:i||null,forceShouldAnimate:i?!1:null}};function yZ(e,t){return e.map(r=>t[r])}var kO=({impact:e,viewport:t,draggables:r,destination:n,forceShouldAnimate:s})=>{const i=e.displaced,a=yZ(i.all,r),l=mc({afterDragging:a,destination:n,displacedBy:e.displacedBy,viewport:t.frame,forceShouldAnimate:s,last:i});return{...e,displaced:l}},AO=({impact:e,draggable:t,droppable:r,draggables:n,viewport:s,afterCritical:i})=>{const a=ep({impact:e,draggable:t,draggables:n,droppable:r,afterCritical:i});return tb({pageBorderBoxCenter:a,draggable:t,viewport:s})},RO=({state:e,dimensions:t,viewport:r})=>{e.movementMode!=="SNAP"&&ne(!1);const n=e.impact,s=r||e.viewport,i=t||e.dimensions,{draggables:a,droppables:l}=i,c=a[e.critical.draggable.id],u=mr(n);u||ne(!1);const f=l[u],d=kO({impact:n,viewport:s,destination:f,draggables:a}),h=AO({impact:d,draggable:c,droppable:f,draggables:a,viewport:s,afterCritical:e.afterCritical});return Tl({impact:d,clientSelection:h,state:e,dimensions:i,viewport:s})},bZ=e=>({index:e.index,droppableId:e.droppableId}),IO=({draggable:e,home:t,draggables:r,viewport:n})=>{const s=Yc(t.axis,e.displaceBy),i=Ta(t.descriptor.id,r),a=i.indexOf(e);a===-1&&ne(!1);const l=i.slice(a+1),c=l.reduce((h,m)=>(h[m.descriptor.id]=!0,h),{}),u={inVirtualList:t.descriptor.mode==="virtual",displacedBy:s,effected:c};return{impact:{displaced:mc({afterDragging:l,destination:t,displacedBy:s,last:null,viewport:n.frame,forceShouldAnimate:!1}),displacedBy:s,at:{type:"REORDER",destination:bZ(e.descriptor)}},afterCritical:u}},wZ=(e,t)=>({draggables:e.draggables,droppables:rb(e.droppables,t)}),jZ=({draggable:e,offset:t,initialWindowScroll:r})=>{const n=pf(e.client,t),s=mf(n,r);return{...e,placeholder:{...e.placeholder,client:n},client:n,page:s}},_Z=e=>{const t=e.frame;return t||ne(!1),t},SZ=({additions:e,updatedDroppables:t,viewport:r})=>{const n=r.scroll.diff.value;return e.map(s=>{const i=s.descriptor.droppableId,a=t[i],c=_Z(a).scroll.diff.value,u=St(n,c);return jZ({draggable:s,offset:u,initialWindowScroll:r.scroll.initial})})},NZ=({state:e,published:t})=>{const r=t.modified.map(x=>{const b=e.dimensions.droppables[x.droppableId];return Jy(b,x.scroll)}),n={...e.dimensions.droppables,...mO(r)},s=gO(SZ({additions:t.additions,updatedDroppables:n,viewport:e.viewport})),i={...e.dimensions.draggables,...s};t.removals.forEach(x=>{delete i[x]});const a={droppables:n,draggables:i},l=mr(e.impact),c=l?a.droppables[l]:null,u=a.draggables[e.critical.draggable.id],f=a.droppables[e.critical.droppable.id],{impact:d,afterCritical:h}=IO({draggable:u,home:f,draggables:i,viewport:e.viewport}),m=c&&c.isCombineEnabled?e.impact:d,g=TO({pageOffset:e.current.page.offset,draggable:a.draggables[e.critical.draggable.id],draggables:a.draggables,droppables:a.droppables,previousImpact:m,viewport:e.viewport,afterCritical:h}),v={...e,phase:"DRAGGING",impact:g,onLiftImpact:d,dimensions:a,afterCritical:h,forceShouldAnimate:!1};return e.phase==="COLLECTING"?v:{...v,phase:"DROP_PENDING",reason:e.reason,isWaiting:!1}};const Wv=e=>e.movementMode==="SNAP",Tm=(e,t,r)=>{const n=wZ(e.dimensions,t);return!Wv(e)||r?Tl({state:e,dimensions:n}):RO({state:e,dimensions:n})};function km(e){return e.isDragging&&e.movementMode==="SNAP"?{...e,scrollJumpRequest:null}:e}const fS={phase:"IDLE",completed:null,shouldFlush:!1};var EZ=(e=fS,t)=>{if(t.type==="FLUSH")return{...fS,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&ne(!1);const{critical:r,clientSelection:n,viewport:s,dimensions:i,movementMode:a}=t.payload,l=i.draggables[r.draggable.id],c=i.droppables[r.droppable.id],u={selection:n,borderBoxCenter:l.client.borderBox.center,offset:bt},f={client:u,page:{selection:St(u.selection,s.scroll.initial),borderBoxCenter:St(u.selection,s.scroll.initial),offset:St(u.selection,s.scroll.diff.value)}},d=Xh(i.droppables).every(v=>!v.isFixedOnPage),{impact:h,afterCritical:m}=IO({draggable:l,home:c,draggables:i.draggables,viewport:s});return{phase:"DRAGGING",isDragging:!0,critical:r,movementMode:a,dimensions:i,initial:f,current:f,isWindowScrollAllowed:d,impact:h,afterCritical:m,onLiftImpact:h,viewport:s,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"?e:(e.phase!=="DRAGGING"&&ne(!1),{...e,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||ne(!1),NZ({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;si(e)||ne(!1);const{client:r}=t.payload;return Rs(r,e.current.client.selection)?e:Tl({state:e,clientSelection:r,impact:Wv(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return km(e);si(e)||ne(!1);const{id:r,newScroll:n}=t.payload,s=e.dimensions.droppables[r];if(!s)return e;const i=Jy(s,n);return Tm(e,i,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;si(e)||ne(!1);const{id:r,isEnabled:n}=t.payload,s=e.dimensions.droppables[r];s||ne(!1),s.isEnabled===n&&ne(!1);const i={...s,isEnabled:n};return Tm(e,i,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;si(e)||ne(!1);const{id:r,isCombineEnabled:n}=t.payload,s=e.dimensions.droppables[r];s||ne(!1),s.isCombineEnabled===n&&ne(!1);const i={...s,isCombineEnabled:n};return Tm(e,i,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;si(e)||ne(!1),e.isWindowScrollAllowed||ne(!1);const r=t.payload.newScroll;if(Rs(e.viewport.scroll.current,r))return km(e);const n=jO(e.viewport,r);return Wv(e)?RO({state:e,viewport:n}):Tl({state:e,viewport:n})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!si(e))return e;const r=t.payload.maxScroll;if(Rs(r,e.viewport.scroll.max))return e;const n={...e.viewport,scroll:{...e.viewport.scroll,max:r}};return{...e,viewport:n}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&ne(!1);const r=lZ({state:e,type:t.type});return r?Tl({state:e,impact:r.impact,clientSelection:r.clientSelection,scrollJumpRequest:r.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){const r=t.payload.reason;return e.phase!=="COLLECTING"&&ne(!1),{...e,phase:"DROP_PENDING",isWaiting:!0,reason:r}}if(t.type==="DROP_ANIMATE"){const{completed:r,dropDuration:n,newHomeClientOffset:s}=t.payload;return e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||ne(!1),{phase:"DROP_ANIMATING",completed:r,dropDuration:n,newHomeClientOffset:s,dimensions:e.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:r}=t.payload;return{phase:"IDLE",completed:r,shouldFlush:!1}}return e};const CZ=e=>({type:"BEFORE_INITIAL_CAPTURE",payload:e}),PZ=e=>({type:"LIFT",payload:e}),TZ=e=>({type:"INITIAL_PUBLISH",payload:e}),kZ=e=>({type:"PUBLISH_WHILE_DRAGGING",payload:e}),AZ=()=>({type:"COLLECTION_STARTING",payload:null}),RZ=e=>({type:"UPDATE_DROPPABLE_SCROLL",payload:e}),IZ=e=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:e}),OZ=e=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:e}),OO=e=>({type:"MOVE",payload:e}),DZ=e=>({type:"MOVE_BY_WINDOW_SCROLL",payload:e}),$Z=e=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:e}),MZ=()=>({type:"MOVE_UP",payload:null}),LZ=()=>({type:"MOVE_DOWN",payload:null}),FZ=()=>({type:"MOVE_RIGHT",payload:null}),BZ=()=>({type:"MOVE_LEFT",payload:null}),nb=()=>({type:"FLUSH",payload:null}),zZ=e=>({type:"DROP_ANIMATE",payload:e}),sb=e=>({type:"DROP_COMPLETE",payload:e}),DO=e=>({type:"DROP",payload:e}),UZ=e=>({type:"DROP_PENDING",payload:e}),$O=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var VZ=e=>({getState:t,dispatch:r})=>n=>s=>{if(s.type!=="LIFT"){n(s);return}const{id:i,clientSelection:a,movementMode:l}=s.payload,c=t();c.phase==="DROP_ANIMATING"&&r(sb({completed:c.completed})),t().phase!=="IDLE"&&ne(!1),r(nb()),r(CZ({draggableId:i,movementMode:l}));const f={draggableId:i,scrollOptions:{shouldPublishImmediately:l==="SNAP"}},{critical:d,dimensions:h,viewport:m}=e.startPublishing(f);r(TZ({critical:d,dimensions:h,clientSelection:a,movementMode:l,viewport:m}))},qZ=e=>()=>t=>r=>{r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)};const ib={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},gc={opacity:{drop:0,combining:.7},scale:{drop:.75}},MO={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Xs=`${MO.outOfTheWay}s ${ib.outOfTheWay}`,kl={fluid:`opacity ${Xs}`,snap:`transform ${Xs}, opacity ${Xs}`,drop:e=>{const t=`${e}s ${ib.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${Xs}`,placeholder:`height ${Xs}, width ${Xs}, margin ${Xs}`},hS=e=>Rs(e,bt)?void 0:`translate(${e.x}px, ${e.y}px)`,Hv={moveTo:hS,drop:(e,t)=>{const r=hS(e);if(r)return t?`${r} scale(${gc.scale.drop})`:r}},{minDropTime:Gv,maxDropTime:LO}=MO,WZ=LO-Gv,pS=1500,HZ=.6;var GZ=({current:e,destination:t,reason:r})=>{const n=hc(e,t);if(n<=0)return Gv;if(n>=pS)return LO;const s=n/pS,i=Gv+WZ*s,a=r==="CANCEL"?i*HZ:i;return Number(a.toFixed(2))},KZ=({impact:e,draggable:t,dimensions:r,viewport:n,afterCritical:s})=>{const{draggables:i,droppables:a}=r,l=mr(e),c=l?a[l]:null,u=a[t.descriptor.droppableId],f=AO({impact:e,draggable:t,draggables:i,afterCritical:s,droppable:c||u,viewport:n});return dr(f,t.client.borderBox.center)},YZ=({draggables:e,reason:t,lastImpact:r,home:n,viewport:s,onLiftImpact:i})=>!r.at||t!=="DROP"?{impact:kO({draggables:e,impact:i,destination:n,viewport:s,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:r.at.type==="REORDER"?{impact:r,didDropInsideDroppable:!0}:{impact:{...r,displaced:pc},didDropInsideDroppable:!0};const JZ=({getState:e,dispatch:t})=>r=>n=>{if(n.type!=="DROP"){r(n);return}const s=e(),i=n.payload.reason;if(s.phase==="COLLECTING"){t(UZ({reason:i}));return}if(s.phase==="IDLE")return;s.phase==="DROP_PENDING"&&s.isWaiting&&ne(!1),s.phase==="DRAGGING"||s.phase==="DROP_PENDING"||ne(!1);const l=s.critical,c=s.dimensions,u=c.draggables[s.critical.draggable.id],{impact:f,didDropInsideDroppable:d}=YZ({reason:i,lastImpact:s.impact,afterCritical:s.afterCritical,onLiftImpact:s.onLiftImpact,home:s.dimensions.droppables[s.critical.droppable.id],viewport:s.viewport,draggables:s.dimensions.draggables}),h=d?Xy(f):null,m=d?Qh(f):null,g={index:l.draggable.index,droppableId:l.droppable.id},v={draggableId:u.descriptor.id,type:u.descriptor.type,source:g,reason:i,mode:s.movementMode,destination:h,combine:m},y=KZ({impact:f,draggable:u,dimensions:c,viewport:s.viewport,afterCritical:s.afterCritical}),x={critical:s.critical,afterCritical:s.afterCritical,result:v,impact:f};if(!(!Rs(s.current.client.offset,y)||!!v.combine)){t(sb({completed:x}));return}const w=GZ({current:s.current.client.offset,destination:y,reason:i});t(zZ({newHomeClientOffset:y,dropDuration:w,completed:x}))};var XZ=JZ,FO=()=>({x:window.pageXOffset,y:window.pageYOffset});function QZ(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||e()}}}function ZZ({onWindowScroll:e}){function t(){e(FO())}const r=fc(t),n=QZ(r);let s=As;function i(){return s!==As}function a(){i()&&ne(!1),s=Rr(window,[n])}function l(){i()||ne(!1),r.cancel(),s(),s=As}return{start:a,stop:l,isActive:i}}const eee=e=>e.type==="DROP_COMPLETE"||e.type==="DROP_ANIMATE"||e.type==="FLUSH",tee=e=>{const t=ZZ({onWindowScroll:r=>{e.dispatch(DZ({newScroll:r}))}});return r=>n=>{!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&eee(n)&&t.stop(),r(n)}};var ree=tee,nee=e=>{let t=!1,r=!1;const n=setTimeout(()=>{r=!0}),s=i=>{t||r||(t=!0,e(i),clearTimeout(n))};return s.wasCalled=()=>t,s},see=()=>{const e=[],t=s=>{const i=e.findIndex(l=>l.timerId===s);i===-1&&ne(!1);const[a]=e.splice(i,1);a.callback()};return{add:s=>{const i=setTimeout(()=>t(i)),a={timerId:i,callback:s};e.push(a)},flush:()=>{if(!e.length)return;const s=[...e];e.length=0,s.forEach(i=>{clearTimeout(i.timerId),i.callback()})}}};const iee=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.droppableId===t.droppableId&&e.index===t.index,oee=(e,t)=>e==null&&t==null?!0:e==null||t==null?!1:e.draggableId===t.draggableId&&e.droppableId===t.droppableId,aee=(e,t)=>{if(e===t)return!0;const r=e.draggable.id===t.draggable.id&&e.draggable.droppableId===t.draggable.droppableId&&e.draggable.type===t.draggable.type&&e.draggable.index===t.draggable.index,n=e.droppable.id===t.droppable.id&&e.droppable.type===t.droppable.type;return r&&n},Ja=(e,t)=>{t()},Uu=(e,t)=>({draggableId:e.draggable.id,type:e.droppable.type,source:{droppableId:e.droppable.id,index:e.draggable.index},mode:t});function Am(e,t,r,n){if(!e){r(n(t));return}const s=nee(r);e(t,{announce:s}),s.wasCalled()||r(n(t))}var lee=(e,t)=>{const r=see();let n=null;const s=(d,h)=>{n&&ne(!1),Ja("onBeforeCapture",()=>{const m=e().onBeforeCapture;m&&m({draggableId:d,mode:h})})},i=(d,h)=>{n&&ne(!1),Ja("onBeforeDragStart",()=>{const m=e().onBeforeDragStart;m&&m(Uu(d,h))})},a=(d,h)=>{n&&ne(!1);const m=Uu(d,h);n={mode:h,lastCritical:d,lastLocation:m.source,lastCombine:null},r.add(()=>{Ja("onDragStart",()=>Am(e().onDragStart,m,t,fd.onDragStart))})},l=(d,h)=>{const m=Xy(h),g=Qh(h);n||ne(!1);const v=!aee(d,n.lastCritical);v&&(n.lastCritical=d);const y=!iee(n.lastLocation,m);y&&(n.lastLocation=m);const x=!oee(n.lastCombine,g);if(x&&(n.lastCombine=g),!v&&!y&&!x)return;const b={...Uu(d,n.mode),combine:g,destination:m};r.add(()=>{Ja("onDragUpdate",()=>Am(e().onDragUpdate,b,t,fd.onDragUpdate))})},c=()=>{n||ne(!1),r.flush()},u=d=>{n||ne(!1),n=null,Ja("onDragEnd",()=>Am(e().onDragEnd,d,t,fd.onDragEnd))};return{beforeCapture:s,beforeStart:i,start:a,update:l,flush:c,drop:u,abort:()=>{if(!n)return;const d={...Uu(n.lastCritical,n.mode),combine:null,destination:null,reason:"CANCEL"};u(d)}}},cee=(e,t)=>{const r=lee(e,t);return n=>s=>i=>{if(i.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(i.payload.draggableId,i.payload.movementMode);return}if(i.type==="INITIAL_PUBLISH"){const l=i.payload.critical;r.beforeStart(l,i.payload.movementMode),s(i),r.start(l,i.payload.movementMode);return}if(i.type==="DROP_COMPLETE"){const l=i.payload.completed.result;r.flush(),s(i),r.drop(l);return}if(s(i),i.type==="FLUSH"){r.abort();return}const a=n.getState();a.phase==="DRAGGING"&&r.update(a.critical,a.impact)}};const uee=e=>t=>r=>{if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}const n=e.getState();n.phase!=="DROP_ANIMATING"&&ne(!1),e.dispatch(sb({completed:n.completed}))};var dee=uee;const fee=e=>{let t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return s=>i=>{if((i.type==="FLUSH"||i.type==="DROP_COMPLETE"||i.type==="DROP_ANIMATION_FINISHED")&&n(),s(i),i.type!=="DROP_ANIMATE")return;const a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){e.getState().phase==="DROP_ANIMATING"&&e.dispatch($O())}};r=requestAnimationFrame(()=>{r=null,t=Rr(window,[a])})}};var hee=fee,pee=e=>()=>t=>r=>{(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)},mee=e=>{let t=!1;return()=>r=>n=>{if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;const s=n.payload.completed.result;s.combine&&e.tryShiftRecord(s.draggableId,s.combine.draggableId),e.tryRestoreFocusRecorded()}}}};const gee=e=>e.type==="DROP_COMPLETE"||e.type==="DROP_ANIMATE"||e.type==="FLUSH";var vee=e=>t=>r=>n=>{if(gee(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);const s=t.getState();s.phase!=="DRAGGING"&&ne(!1),e.start(s);return}r(n),e.scroll(t.getState())};const xee=e=>t=>r=>{if(t(r),r.type!=="PUBLISH_WHILE_DRAGGING")return;const n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(DO({reason:n.reason})))};var yee=xee;const bee=WI;var wee=({dimensionMarshal:e,focusMarshal:t,styleMarshal:r,getResponders:n,announce:s,autoScroller:i})=>qI(EZ,bee(ZJ(qZ(r),pee(e),VZ(e),XZ,dee,hee,yee,vee(i),ree,mee(t),cee(n,s))));const Rm=()=>({additions:{},removals:{},modified:{}});function jee({registry:e,callbacks:t}){let r=Rm(),n=null;const s=()=>{n||(t.collectionStarting(),n=requestAnimationFrame(()=>{n=null;const{additions:c,removals:u,modified:f}=r,d=Object.keys(c).map(g=>e.draggable.getById(g).getDimension(bt)).sort((g,v)=>g.descriptor.index-v.descriptor.index),h=Object.keys(f).map(g=>{const y=e.droppable.getById(g).callbacks.getScrollWhileDragging();return{droppableId:g,scroll:y}}),m={additions:d,removals:Object.keys(u),modified:h};r=Rm(),t.publish(m)}))};return{add:c=>{const u=c.descriptor.id;r.additions[u]=c,r.modified[c.descriptor.droppableId]=!0,r.removals[u]&&delete r.removals[u],s()},remove:c=>{const u=c.descriptor;r.removals[u.id]=!0,r.modified[u.droppableId]=!0,r.additions[u.id]&&delete r.additions[u.id],s()},stop:()=>{n&&(cancelAnimationFrame(n),n=null,r=Rm())}}}var BO=({scrollHeight:e,scrollWidth:t,height:r,width:n})=>{const s=dr({x:t,y:e},{x:n,y:r});return{x:Math.max(0,s.x),y:Math.max(0,s.y)}},zO=()=>{const e=document.documentElement;return e||ne(!1),e},UO=()=>{const e=zO();return BO({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight})},_ee=()=>{const e=FO(),t=UO(),r=e.y,n=e.x,s=zO(),i=s.clientWidth,a=s.clientHeight,l=n+i,c=r+a;return{frame:Xr({top:r,left:n,right:l,bottom:c}),scroll:{initial:e,current:e,max:t,diff:{value:bt,displacement:bt}}}},See=({critical:e,scrollOptions:t,registry:r})=>{const n=_ee(),s=n.scroll.current,i=e.droppable,a=r.droppable.getAllByType(i.type).map(f=>f.callbacks.getDimensionAndWatchScroll(s,t)),l=r.draggable.getAllByType(e.draggable.type).map(f=>f.getDimension(s));return{dimensions:{draggables:gO(l),droppables:mO(a)},critical:e,viewport:n}};function mS(e,t,r){return!(r.descriptor.id===t.id||r.descriptor.type!==t.type||e.droppable.getById(r.descriptor.droppableId).descriptor.mode!=="virtual")}var Nee=(e,t)=>{let r=null;const n=jee({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),s=(h,m)=>{e.droppable.exists(h)||ne(!1),r&&t.updateDroppableIsEnabled({id:h,isEnabled:m})},i=(h,m)=>{r&&(e.droppable.exists(h)||ne(!1),t.updateDroppableIsCombineEnabled({id:h,isCombineEnabled:m}))},a=(h,m)=>{r&&(e.droppable.exists(h)||ne(!1),t.updateDroppableScroll({id:h,newScroll:m}))},l=(h,m)=>{r&&e.droppable.getById(h).callbacks.scroll(m)},c=()=>{if(!r)return;n.stop();const h=r.critical.droppable;e.droppable.getAllByType(h.type).forEach(m=>m.callbacks.dragStopped()),r.unsubscribe(),r=null},u=h=>{r||ne(!1);const m=r.critical.draggable;h.type==="ADDITION"&&mS(e,m,h.value)&&n.add(h.value),h.type==="REMOVAL"&&mS(e,m,h.value)&&n.remove(h.value)};return{updateDroppableIsEnabled:s,updateDroppableIsCombineEnabled:i,scrollDroppable:l,updateDroppableScroll:a,startPublishing:h=>{r&&ne(!1);const m=e.draggable.getById(h.draggableId),g=e.droppable.getById(m.descriptor.droppableId),v={draggable:m.descriptor,droppable:g.descriptor},y=e.subscribe(u);return r={critical:v,unsubscribe:y},See({critical:v,registry:e,scrollOptions:h.scrollOptions})},stopPublishing:c}},VO=(e,t)=>e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP",Eee=e=>{window.scrollBy(e.x,e.y)};const Cee=yt(e=>Xh(e).filter(t=>!(!t.isEnabled||!t.frame))),Pee=(e,t)=>Cee(t).find(n=>(n.frame||ne(!1),EO(n.frame.pageMarginBox)(e)))||null;var Tee=({center:e,destination:t,droppables:r})=>{if(t){const s=r[t];return s.frame?s:null}return Pee(e,r)};const vc={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:e=>e**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var kee=(e,t,r=()=>vc)=>{const n=r(),s=e[t.size]*n.startFromPercentage,i=e[t.size]*n.maxScrollAtPercentage;return{startScrollingFrom:s,maxScrollValueAt:i}},qO=({startOfRange:e,endOfRange:t,current:r})=>{const n=t-e;return n===0?0:(r-e)/n},ob=1,Aee=(e,t,r=()=>vc)=>{const n=r();if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return n.maxPixelScroll;if(e===t.startScrollingFrom)return ob;const i=1-qO({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),a=n.maxPixelScroll*n.ease(i);return Math.ceil(a)},Ree=(e,t,r)=>{const n=r(),s=n.durationDampening.accelerateAt,i=n.durationDampening.stopDampeningAt,a=t,l=i,u=Date.now()-a;if(u>=i)return e;if(u<s)return ob;const f=qO({startOfRange:s,endOfRange:l,current:u}),d=e*n.ease(f);return Math.ceil(d)},gS=({distanceToEdge:e,thresholds:t,dragStartTime:r,shouldUseTimeDampening:n,getAutoScrollerOptions:s})=>{const i=Aee(e,t,s);return i===0?0:n?Math.max(Ree(i,r,s),ob):i},vS=({container:e,distanceToEdges:t,dragStartTime:r,axis:n,shouldUseTimeDampening:s,getAutoScrollerOptions:i})=>{const a=kee(e,n,i);return t[n.end]<t[n.start]?gS({distanceToEdge:t[n.end],thresholds:a,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:i}):-1*gS({distanceToEdge:t[n.start],thresholds:a,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:i})},Iee=({container:e,subject:t,proposedScroll:r})=>{const n=t.height>e.height,s=t.width>e.width;return!s&&!n?r:s&&n?null:{x:s?0:r.x,y:n?0:r.y}};const Oee=pO(e=>e===0?0:e);var WO=({dragStartTime:e,container:t,subject:r,center:n,shouldUseTimeDampening:s,getAutoScrollerOptions:i})=>{const a={top:n.y-t.top,right:t.right-n.x,bottom:t.bottom-n.y,left:n.x-t.left},l=vS({container:t,distanceToEdges:a,dragStartTime:e,axis:Qy,shouldUseTimeDampening:s,getAutoScrollerOptions:i}),c=vS({container:t,distanceToEdges:a,dragStartTime:e,axis:yO,shouldUseTimeDampening:s,getAutoScrollerOptions:i}),u=Oee({x:c,y:l});if(Rs(u,bt))return null;const f=Iee({container:t,subject:r,proposedScroll:u});return f?Rs(f,bt)?null:f:null};const Dee=pO(e=>e===0?0:e>0?1:-1),ab=(()=>{const e=(t,r)=>t<0?t:t>r?t-r:0;return({current:t,max:r,change:n})=>{const s=St(t,n),i={x:e(s.x,r.x),y:e(s.y,r.y)};return Rs(i,bt)?null:i}})(),HO=({max:e,current:t,change:r})=>{const n={x:Math.max(t.x,e.x),y:Math.max(t.y,e.y)},s=Dee(r),i=ab({max:n,current:t,change:s});return!i||s.x!==0&&i.x===0||s.y!==0&&i.y===0},lb=(e,t)=>HO({current:e.scroll.current,max:e.scroll.max,change:t}),$ee=(e,t)=>{if(!lb(e,t))return null;const r=e.scroll.max,n=e.scroll.current;return ab({current:n,max:r,change:t})},cb=(e,t)=>{const r=e.frame;return r?HO({current:r.scroll.current,max:r.scroll.max,change:t}):!1},Mee=(e,t)=>{const r=e.frame;return!r||!cb(e,t)?null:ab({current:r.scroll.current,max:r.scroll.max,change:t})};var Lee=({viewport:e,subject:t,center:r,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:i})=>{const a=WO({dragStartTime:n,container:e.frame,subject:t,center:r,shouldUseTimeDampening:s,getAutoScrollerOptions:i});return a&&lb(e,a)?a:null},Fee=({droppable:e,subject:t,center:r,dragStartTime:n,shouldUseTimeDampening:s,getAutoScrollerOptions:i})=>{const a=e.frame;if(!a)return null;const l=WO({dragStartTime:n,container:a.pageMarginBox,subject:t,center:r,shouldUseTimeDampening:s,getAutoScrollerOptions:i});return l&&cb(e,l)?l:null},xS=({state:e,dragStartTime:t,shouldUseTimeDampening:r,scrollWindow:n,scrollDroppable:s,getAutoScrollerOptions:i})=>{const a=e.current.page.borderBoxCenter,c=e.dimensions.draggables[e.critical.draggable.id].page.marginBox;if(e.isWindowScrollAllowed){const d=e.viewport,h=Lee({dragStartTime:t,viewport:d,subject:c,center:a,shouldUseTimeDampening:r,getAutoScrollerOptions:i});if(h){n(h);return}}const u=Tee({center:a,destination:mr(e.impact),droppables:e.dimensions.droppables});if(!u)return;const f=Fee({dragStartTime:t,droppable:u,subject:c,center:a,shouldUseTimeDampening:r,getAutoScrollerOptions:i});f&&s(u.descriptor.id,f)},Bee=({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:r=()=>vc})=>{const n=fc(e),s=fc(t);let i=null;const a=u=>{i||ne(!1);const{shouldUseTimeDampening:f,dragStartTime:d}=i;xS({state:u,scrollWindow:n,scrollDroppable:s,dragStartTime:d,shouldUseTimeDampening:f,getAutoScrollerOptions:r})};return{start:u=>{i&&ne(!1);const f=Date.now();let d=!1;const h=()=>{d=!0};xS({state:u,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:h,scrollDroppable:h,getAutoScrollerOptions:r}),i={dragStartTime:f,shouldUseTimeDampening:d},d&&a(u)},stop:()=>{i&&(n.cancel(),s.cancel(),i=null)},scroll:a}},zee=({move:e,scrollDroppable:t,scrollWindow:r})=>{const n=(l,c)=>{const u=St(l.current.client.selection,c);e({client:u})},s=(l,c)=>{if(!cb(l,c))return c;const u=Mee(l,c);if(!u)return t(l.descriptor.id,c),null;const f=dr(c,u);return t(l.descriptor.id,f),dr(c,f)},i=(l,c,u)=>{if(!l||!lb(c,u))return u;const f=$ee(c,u);if(!f)return r(u),null;const d=dr(u,f);return r(d),dr(u,d)};return l=>{const c=l.scrollJumpRequest;if(!c)return;const u=mr(l.impact);u||ne(!1);const f=s(l.dimensions.droppables[u],c);if(!f)return;const d=l.viewport,h=i(l.isWindowScrollAllowed,d,f);h&&n(l,h)}},Uee=({scrollDroppable:e,scrollWindow:t,move:r,getAutoScrollerOptions:n})=>{const s=Bee({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:n}),i=zee({move:r,scrollWindow:t,scrollDroppable:e});return{scroll:c=>{if(!(n().disabled||c.phase!=="DRAGGING")){if(c.movementMode==="FLUID"){s.scroll(c);return}c.scrollJumpRequest&&i(c)}},start:s.start,stop:s.stop}};const ca="data-rfd",ua=(()=>{const e=`${ca}-drag-handle`;return{base:e,draggableId:`${e}-draggable-id`,contextId:`${e}-context-id`}})(),Kv=(()=>{const e=`${ca}-draggable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),Vee=(()=>{const e=`${ca}-droppable`;return{base:e,contextId:`${e}-context-id`,id:`${e}-id`}})(),yS={contextId:`${ca}-scroll-container-context-id`},qee=e=>t=>`[${t}="${e}"]`,Xa=(e,t)=>e.map(r=>{const n=r.styles[t];return n?`${r.selector} { ${n} }`:""}).join(" "),Wee="pointer-events: none;";var Hee=e=>{const t=qee(e),r=(()=>{const l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(ua.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:Wee,dropAnimating:l}}})(),n=(()=>{const l=`
      transition: ${kl.outOfTheWay};
    `;return{selector:t(Kv.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}})(),s={selector:t(Vee.contextId),styles:{always:"overflow-anchor: none;"}},a=[n,r,s,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:Xa(a,"always"),resting:Xa(a,"resting"),dragging:Xa(a,"dragging"),dropAnimating:Xa(a,"dropAnimating"),userCancel:Xa(a,"userCancel")}};const Gee=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect;var gr=Gee;const Im=()=>{const e=document.querySelector("head");return e||ne(!1),e},bS=e=>{const t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.type="text/css",t};function Kee(e,t){const r=Ae(()=>Hee(e),[e]),n=p.useRef(null),s=p.useRef(null),i=ye(yt(d=>{const h=s.current;h||ne(!1),h.textContent=d}),[]),a=ye(d=>{const h=n.current;h||ne(!1),h.textContent=d},[]);gr(()=>{!n.current&&!s.current||ne(!1);const d=bS(t),h=bS(t);return n.current=d,s.current=h,d.setAttribute(`${ca}-always`,e),h.setAttribute(`${ca}-dynamic`,e),Im().appendChild(d),Im().appendChild(h),a(r.always),i(r.resting),()=>{const m=g=>{const v=g.current;v||ne(!1),Im().removeChild(v),g.current=null};m(n),m(s)}},[t,a,i,r.always,r.resting,e]);const l=ye(()=>i(r.dragging),[i,r.dragging]),c=ye(d=>{if(d==="DROP"){i(r.dropAnimating);return}i(r.userCancel)},[i,r.dropAnimating,r.userCancel]),u=ye(()=>{s.current&&i(r.resting)},[i,r.resting]);return Ae(()=>({dragging:l,dropping:c,resting:u}),[l,c,u])}function GO(e,t){return Array.from(e.querySelectorAll(t))}var KO=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window;function tp(e){return e instanceof KO(e).HTMLElement}function Yee(e,t){const r=`[${ua.contextId}="${e}"]`,n=GO(document,r);if(!n.length)return null;const s=n.find(i=>i.getAttribute(ua.draggableId)===t);return!s||!tp(s)?null:s}function Jee(e){const t=p.useRef({}),r=p.useRef(null),n=p.useRef(null),s=p.useRef(!1),i=ye(function(h,m){const g={id:h,focus:m};return t.current[h]=g,function(){const y=t.current;y[h]!==g&&delete y[h]}},[]),a=ye(function(h){const m=Yee(e,h);m&&m!==document.activeElement&&m.focus()},[e]),l=ye(function(h,m){r.current===h&&(r.current=m)},[]),c=ye(function(){n.current||s.current&&(n.current=requestAnimationFrame(()=>{n.current=null;const h=r.current;h&&a(h)}))},[a]),u=ye(function(h){r.current=null;const m=document.activeElement;m&&m.getAttribute(ua.draggableId)===h&&(r.current=h)},[]);return gr(()=>(s.current=!0,function(){s.current=!1;const h=n.current;h&&cancelAnimationFrame(h)}),[]),Ae(()=>({register:i,tryRecordFocus:u,tryRestoreFocusRecorded:c,tryShiftRecord:l}),[i,u,c,l])}function Xee(){const e={draggables:{},droppables:{}},t=[];function r(d){return t.push(d),function(){const m=t.indexOf(d);m!==-1&&t.splice(m,1)}}function n(d){t.length&&t.forEach(h=>h(d))}function s(d){return e.draggables[d]||null}function i(d){const h=s(d);return h||ne(!1),h}const a={register:d=>{e.draggables[d.descriptor.id]=d,n({type:"ADDITION",value:d})},update:(d,h)=>{const m=e.draggables[h.descriptor.id];m&&m.uniqueId===d.uniqueId&&(delete e.draggables[h.descriptor.id],e.draggables[d.descriptor.id]=d)},unregister:d=>{const h=d.descriptor.id,m=s(h);m&&d.uniqueId===m.uniqueId&&(delete e.draggables[h],e.droppables[d.descriptor.droppableId]&&n({type:"REMOVAL",value:d}))},getById:i,findById:s,exists:d=>!!s(d),getAllByType:d=>Object.values(e.draggables).filter(h=>h.descriptor.type===d)};function l(d){return e.droppables[d]||null}function c(d){const h=l(d);return h||ne(!1),h}const u={register:d=>{e.droppables[d.descriptor.id]=d},unregister:d=>{const h=l(d.descriptor.id);h&&d.uniqueId===h.uniqueId&&delete e.droppables[d.descriptor.id]},getById:c,findById:l,exists:d=>!!l(d),getAllByType:d=>Object.values(e.droppables).filter(h=>h.descriptor.type===d)};function f(){e.draggables={},e.droppables={},t.length=0}return{draggable:a,droppable:u,subscribe:r,clean:f}}function Qee(){const e=Ae(Xee,[]);return p.useEffect(()=>function(){J.version.startsWith("16")||J.version.startsWith("17")?requestAnimationFrame(e.clean):e.clean()},[e]),e}var ub=J.createContext(null),yf=()=>{const e=document.body;return e||ne(!1),e};const Zee={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"};var ete=Zee;const tte=e=>`rfd-announcement-${e}`;function rte(e){const t=Ae(()=>tte(e),[e]),r=p.useRef(null);return p.useEffect(function(){const i=document.createElement("div");return r.current=i,i.id=t,i.setAttribute("aria-live","assertive"),i.setAttribute("aria-atomic","true"),je(i.style,ete),yf().appendChild(i),function(){setTimeout(function(){const c=yf();c.contains(i)&&c.removeChild(i),i===r.current&&(r.current=null)})}},[t]),ye(s=>{const i=r.current;if(i){i.textContent=s;return}},[])}let nte=0;const YO={separator:"::"};function ste(e,t=YO){return Ae(()=>`${e}${t.separator}${nte++}`,[t.separator,e])}function ite(e,t=YO){const r=J.useId();return Ae(()=>`${e}${t.separator}${r}`,[t.separator,e,r])}var db="useId"in J?ite:ste;function ote({contextId:e,uniqueId:t}){return`rfd-hidden-text-${e}-${t}`}function ate({contextId:e,text:t}){const r=db("hidden-text",{separator:"-"}),n=Ae(()=>ote({contextId:e,uniqueId:r}),[r,e]);return p.useEffect(function(){const i=document.createElement("div");return i.id=n,i.textContent=t,i.style.display="none",yf().appendChild(i),function(){const l=yf();l.contains(i)&&l.removeChild(i)}},[n,t]),n}var rp=J.createContext(null);function JO(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),t}function lte(){let e=null;function t(){return!!e}function r(a){return a===e}function n(a){e&&ne(!1);const l={abandon:a};return e=l,l}function s(){e||ne(!1),e=null}function i(){e&&(e.abandon(),s())}return{isClaimed:t,isActive:r,claim:n,release:s,tryAbandon:i}}function xc(e){return e.phase==="IDLE"||e.phase==="DROP_ANIMATING"?!1:e.isDragging}const cte=9,ute=13,fb=27,XO=32,dte=33,fte=34,hte=35,pte=36,mte=37,gte=38,vte=39,xte=40,yte={[ute]:!0,[cte]:!0};var QO=e=>{yte[e.keyCode]&&e.preventDefault()};const bte=(()=>{const e="visibilitychange";return typeof document>"u"?e:[e,`ms${e}`,`webkit${e}`,`moz${e}`,`o${e}`].find(n=>`on${n}`in document)||e})();var np=bte;const ZO=0,wS=5;function wte(e,t){return Math.abs(t.x-e.x)>=wS||Math.abs(t.y-e.y)>=wS}const jS={type:"IDLE"};function jte({cancel:e,completed:t,getPhase:r,setPhase:n}){return[{eventName:"mousemove",fn:s=>{const{button:i,clientX:a,clientY:l}=s;if(i!==ZO)return;const c={x:a,y:l},u=r();if(u.type==="DRAGGING"){s.preventDefault(),u.actions.move(c);return}u.type!=="PENDING"&&ne(!1);const f=u.point;if(!wte(f,c))return;s.preventDefault();const d=u.actions.fluidLift(c);n({type:"DRAGGING",actions:d})}},{eventName:"mouseup",fn:s=>{const i=r();if(i.type!=="DRAGGING"){e();return}s.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:s=>{r().type==="DRAGGING"&&s.preventDefault(),e()}},{eventName:"keydown",fn:s=>{if(r().type==="PENDING"){e();return}if(s.keyCode===fb){s.preventDefault(),e();return}QO(s)}},{eventName:"resize",fn:e},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{r().type==="PENDING"&&e()}},{eventName:"webkitmouseforcedown",fn:s=>{const i=r();if(i.type==="IDLE"&&ne(!1),i.actions.shouldRespectForcePress()){e();return}s.preventDefault()}},{eventName:np,fn:e}]}function _te(e){const t=p.useRef(jS),r=p.useRef(As),n=Ae(()=>({eventName:"mousedown",fn:function(d){if(d.defaultPrevented||d.button!==ZO||d.ctrlKey||d.metaKey||d.shiftKey||d.altKey)return;const h=e.findClosestDraggableId(d);if(!h)return;const m=e.tryGetLock(h,a,{sourceEvent:d});if(!m)return;d.preventDefault();const g={x:d.clientX,y:d.clientY};r.current(),u(m,g)}}),[e]),s=Ae(()=>({eventName:"webkitmouseforcewillbegin",fn:f=>{if(f.defaultPrevented)return;const d=e.findClosestDraggableId(f);if(!d)return;const h=e.findOptionsForDraggable(d);h&&(h.shouldRespectForcePress||e.canGetLock(d)&&f.preventDefault())}}),[e]),i=ye(function(){const d={passive:!1,capture:!0};r.current=Rr(window,[s,n],d)},[s,n]),a=ye(()=>{t.current.type!=="IDLE"&&(t.current=jS,r.current(),i())},[i]),l=ye(()=>{const f=t.current;a(),f.type==="DRAGGING"&&f.actions.cancel({shouldBlockNextClick:!0}),f.type==="PENDING"&&f.actions.abort()},[a]),c=ye(function(){const d={capture:!0,passive:!1},h=jte({cancel:l,completed:a,getPhase:()=>t.current,setPhase:m=>{t.current=m}});r.current=Rr(window,h,d)},[l,a]),u=ye(function(d,h){t.current.type!=="IDLE"&&ne(!1),t.current={type:"PENDING",point:h,actions:d},c()},[c]);gr(function(){return i(),function(){r.current()}},[i])}function Ste(){}const Nte={[fte]:!0,[dte]:!0,[pte]:!0,[hte]:!0};function Ete(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:s=>{if(s.keyCode===fb){s.preventDefault(),r();return}if(s.keyCode===XO){s.preventDefault(),n();return}if(s.keyCode===xte){s.preventDefault(),e.moveDown();return}if(s.keyCode===gte){s.preventDefault(),e.moveUp();return}if(s.keyCode===vte){s.preventDefault(),e.moveRight();return}if(s.keyCode===mte){s.preventDefault(),e.moveLeft();return}if(Nte[s.keyCode]){s.preventDefault();return}QO(s)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:np,fn:r}]}function Cte(e){const t=p.useRef(Ste),r=Ae(()=>({eventName:"keydown",fn:function(i){if(i.defaultPrevented||i.keyCode!==XO)return;const a=e.findClosestDraggableId(i);if(!a)return;const l=e.tryGetLock(a,f,{sourceEvent:i});if(!l)return;i.preventDefault();let c=!0;const u=l.snapLift();t.current();function f(){c||ne(!1),c=!1,t.current(),n()}t.current=Rr(window,Ete(u,f),{capture:!0,passive:!1})}}),[e]),n=ye(function(){const i={passive:!1,capture:!0};t.current=Rr(window,[r],i)},[r]);gr(function(){return n(),function(){t.current()}},[n])}const Om={type:"IDLE"},Pte=120,Tte=.15;function kte({cancel:e,getPhase:t}){return[{eventName:"orientationchange",fn:e},{eventName:"resize",fn:e},{eventName:"contextmenu",fn:r=>{r.preventDefault()}},{eventName:"keydown",fn:r=>{if(t().type!=="DRAGGING"){e();return}r.keyCode===fb&&r.preventDefault(),e()}},{eventName:np,fn:e}]}function Ate({cancel:e,completed:t,getPhase:r}){return[{eventName:"touchmove",options:{capture:!1},fn:n=>{const s=r();if(s.type!=="DRAGGING"){e();return}s.hasMoved=!0;const{clientX:i,clientY:a}=n.touches[0],l={x:i,y:a};n.preventDefault(),s.actions.move(l)}},{eventName:"touchend",fn:n=>{const s=r();if(s.type!=="DRAGGING"){e();return}n.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:n=>{if(r().type!=="DRAGGING"){e();return}n.preventDefault(),e()}},{eventName:"touchforcechange",fn:n=>{const s=r();s.type==="IDLE"&&ne(!1);const i=n.touches[0];if(!i||!(i.force>=Tte))return;const l=s.actions.shouldRespectForcePress();if(s.type==="PENDING"){l&&e();return}if(l){if(s.hasMoved){n.preventDefault();return}e();return}n.preventDefault()}},{eventName:np,fn:e}]}function Rte(e){const t=p.useRef(Om),r=p.useRef(As),n=ye(function(){return t.current},[]),s=ye(function(m){t.current=m},[]),i=Ae(()=>({eventName:"touchstart",fn:function(m){if(m.defaultPrevented)return;const g=e.findClosestDraggableId(m);if(!g)return;const v=e.tryGetLock(g,l,{sourceEvent:m});if(!v)return;const y=m.touches[0],{clientX:x,clientY:b}=y,w={x,y:b};r.current(),d(v,w)}}),[e]),a=ye(function(){const m={capture:!0,passive:!1};r.current=Rr(window,[i],m)},[i]),l=ye(()=>{const h=t.current;h.type!=="IDLE"&&(h.type==="PENDING"&&clearTimeout(h.longPressTimerId),s(Om),r.current(),a())},[a,s]),c=ye(()=>{const h=t.current;l(),h.type==="DRAGGING"&&h.actions.cancel({shouldBlockNextClick:!0}),h.type==="PENDING"&&h.actions.abort()},[l]),u=ye(function(){const m={capture:!0,passive:!1},g={cancel:c,completed:l,getPhase:n},v=Rr(window,Ate(g),m),y=Rr(window,kte(g),m);r.current=function(){v(),y()}},[c,n,l]),f=ye(function(){const m=n();m.type!=="PENDING"&&ne(!1);const g=m.actions.fluidLift(m.point);s({type:"DRAGGING",actions:g,hasMoved:!1})},[n,s]),d=ye(function(m,g){n().type!=="IDLE"&&ne(!1);const v=setTimeout(f,Pte);s({type:"PENDING",point:g,actions:m,longPressTimerId:v}),u()},[u,n,s,f]);gr(function(){return a(),function(){r.current();const g=n();g.type==="PENDING"&&(clearTimeout(g.longPressTimerId),s(Om))}},[n,a,s]),gr(function(){return Rr(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const Ite=["input","button","textarea","select","option","optgroup","video","audio"];function eD(e,t){if(t==null)return!1;if(Ite.includes(t.tagName.toLowerCase()))return!0;const n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:eD(e,t.parentElement)}function Ote(e,t){const r=t.target;return tp(r)?eD(e,r):!1}var Dte=e=>Xr(e.getBoundingClientRect()).center;function $te(e){return e instanceof KO(e).Element}const Mte=(()=>{const e="matches";return typeof document>"u"?e:[e,"msMatchesSelector","webkitMatchesSelector"].find(n=>n in Element.prototype)||e})();function tD(e,t){return e==null?null:e[Mte](t)?e:tD(e.parentElement,t)}function Lte(e,t){return e.closest?e.closest(t):tD(e,t)}function Fte(e){return`[${ua.contextId}="${e}"]`}function Bte(e,t){const r=t.target;if(!$te(r))return null;const n=Fte(e),s=Lte(r,n);return!s||!tp(s)?null:s}function zte(e,t){const r=Bte(e,t);return r?r.getAttribute(ua.draggableId):null}function Ute(e,t){const r=`[${Kv.contextId}="${e}"]`,s=GO(document,r).find(i=>i.getAttribute(Kv.id)===t);return!s||!tp(s)?null:s}function Vte(e){e.preventDefault()}function Vu({expected:e,phase:t,isLockActive:r,shouldWarn:n}){return!(!r()||e!==t)}function rD({lockAPI:e,store:t,registry:r,draggableId:n}){if(e.isClaimed())return!1;const s=r.draggable.findById(n);return!(!s||!s.options.isEnabled||!VO(t.getState(),n))}function qte({lockAPI:e,contextId:t,store:r,registry:n,draggableId:s,forceSensorStop:i,sourceEvent:a}){if(!rD({lockAPI:e,store:r,registry:n,draggableId:s}))return null;const c=n.draggable.getById(s),u=Ute(t,c.descriptor.id);if(!u||a&&!c.options.canDragInteractiveElements&&Ote(u,a))return null;const f=e.claim(i||As);let d="PRE_DRAG";function h(){return c.options.shouldRespectForcePress}function m(){return e.isActive(f)}function g(_,S){Vu({expected:_,phase:d,isLockActive:m,shouldWarn:!0})&&r.dispatch(S())}const v=g.bind(null,"DRAGGING");function y(_){function S(){e.release(),d="COMPLETED"}d!=="PRE_DRAG"&&(S(),ne(!1)),r.dispatch(PZ(_.liftActionArgs)),d="DRAGGING";function N(E,C={shouldBlockNextClick:!1}){if(_.cleanup(),C.shouldBlockNextClick){const k=Rr(window,[{eventName:"click",fn:Vte,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(k)}S(),r.dispatch(DO({reason:E}))}return{isActive:()=>Vu({expected:"DRAGGING",phase:d,isLockActive:m,shouldWarn:!1}),shouldRespectForcePress:h,drop:E=>N("DROP",E),cancel:E=>N("CANCEL",E),..._.actions}}function x(_){const S=fc(E=>{v(()=>OO({client:E}))});return{...y({liftActionArgs:{id:s,clientSelection:_,movementMode:"FLUID"},cleanup:()=>S.cancel(),actions:{move:S}}),move:S}}function b(){const _={moveUp:()=>v(MZ),moveRight:()=>v(FZ),moveDown:()=>v(LZ),moveLeft:()=>v(BZ)};return y({liftActionArgs:{id:s,clientSelection:Dte(u),movementMode:"SNAP"},cleanup:As,actions:_})}function w(){Vu({expected:"PRE_DRAG",phase:d,isLockActive:m,shouldWarn:!0})&&e.release()}return{isActive:()=>Vu({expected:"PRE_DRAG",phase:d,isLockActive:m,shouldWarn:!1}),shouldRespectForcePress:h,fluidLift:x,snapLift:b,abort:w}}const Wte=[_te,Cte,Rte];function Hte({contextId:e,store:t,registry:r,customSensors:n,enableDefaultSensors:s}){const i=[...s?Wte:[],...n||[]],a=p.useState(()=>lte())[0],l=ye(function(y,x){xc(y)&&!xc(x)&&a.tryAbandon()},[a]);gr(function(){let y=t.getState();return t.subscribe(()=>{const b=t.getState();l(y,b),y=b})},[a,t,l]),gr(()=>a.tryAbandon,[a.tryAbandon]);const c=ye(v=>rD({lockAPI:a,registry:r,store:t,draggableId:v}),[a,r,t]),u=ye((v,y,x)=>qte({lockAPI:a,registry:r,contextId:e,store:t,draggableId:v,forceSensorStop:y||null,sourceEvent:x&&x.sourceEvent?x.sourceEvent:null}),[e,a,r,t]),f=ye(v=>zte(e,v),[e]),d=ye(v=>{const y=r.draggable.findById(v);return y?y.options:null},[r.draggable]),h=ye(function(){a.isClaimed()&&(a.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(nb()))},[a,t]),m=ye(()=>a.isClaimed(),[a]),g=Ae(()=>({canGetLock:c,tryGetLock:u,findClosestDraggableId:f,findOptionsForDraggable:d,tryReleaseLock:h,isLockClaimed:m}),[c,u,f,d,h,m]);for(let v=0;v<i.length;v++)i[v](g)}const Gte=e=>({onBeforeCapture:t=>{const r=()=>{e.onBeforeCapture&&e.onBeforeCapture(t)};J.version.startsWith("16")||J.version.startsWith("17")?r():jr.flushSync(r)},onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragUpdate:e.onDragUpdate}),Kte=e=>({...vc,...e.autoScrollerOptions,durationDampening:{...vc.durationDampening,...e.autoScrollerOptions}});function Qa(e){return e.current||ne(!1),e.current}function Yte(e){const{contextId:t,setCallbacks:r,sensors:n,nonce:s,dragHandleUsageInstructions:i}=e,a=p.useRef(null),l=JO(e),c=ye(()=>Gte(l.current),[l]),u=ye(()=>Kte(l.current),[l]),f=rte(t),d=ate({contextId:t,text:i}),h=Kee(t,s),m=ye(k=>{Qa(a).dispatch(k)},[]),g=Ae(()=>H1({publishWhileDragging:kZ,updateDroppableScroll:RZ,updateDroppableIsEnabled:IZ,updateDroppableIsCombineEnabled:OZ,collectionStarting:AZ},m),[m]),v=Qee(),y=Ae(()=>Nee(v,g),[v,g]),x=Ae(()=>Uee({scrollWindow:Eee,scrollDroppable:y.scrollDroppable,getAutoScrollerOptions:u,...H1({move:OO},m)}),[y.scrollDroppable,m,u]),b=Jee(t),w=Ae(()=>wee({announce:f,autoScroller:x,dimensionMarshal:y,focusMarshal:b,getResponders:c,styleMarshal:h}),[f,x,y,b,c,h]);a.current=w;const j=ye(()=>{const k=Qa(a);k.getState().phase!=="IDLE"&&k.dispatch(nb())},[]),_=ye(()=>{const k=Qa(a).getState();return k.phase==="DROP_ANIMATING"?!0:k.phase==="IDLE"?!1:k.isDragging},[]),S=Ae(()=>({isDragging:_,tryAbort:j}),[_,j]);r(S);const N=ye(k=>VO(Qa(a).getState(),k),[]),E=ye(()=>si(Qa(a).getState()),[]),C=Ae(()=>({marshal:y,focus:b,contextId:t,canLift:N,isMovementAllowed:E,dragHandleUsageInstructionsId:d,registry:v}),[t,y,d,b,N,E,v]);return Hte({contextId:t,store:w,registry:v,customSensors:n||null,enableDefaultSensors:e.enableDefaultSensors!==!1}),p.useEffect(()=>j,[j]),J.createElement(rp.Provider,{value:C},J.createElement(sQ,{context:ub,store:w},e.children))}let Jte=0;function Xte(){return Ae(()=>`${Jte++}`,[])}function Qte(){return J.useId()}var Zte="useId"in J?Qte:Xte;function ere(e){const t=Zte(),r=e.dragHandleUsageInstructions||fd.dragHandleUsageInstructions;return J.createElement(gQ,null,n=>J.createElement(Yte,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd,autoScrollerOptions:e.autoScrollerOptions},e.children))}const _S={dragging:5e3,dropAnimating:4500},tre=(e,t)=>t?kl.drop(t.duration):e?kl.snap:kl.fluid,rre=(e,t)=>{if(e)return t?gc.opacity.drop:gc.opacity.combining},nre=e=>e.forceShouldAnimate!=null?e.forceShouldAnimate:e.mode==="SNAP";function sre(e){const r=e.dimension.client,{offset:n,combineWith:s,dropping:i}=e,a=!!s,l=nre(e),c=!!i,u=c?Hv.drop(n,a):Hv.moveTo(n);return{position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:tre(l,i),transform:u,opacity:rre(a,c),zIndex:c?_S.dropAnimating:_S.dragging,pointerEvents:"none"}}function ire(e){return{transform:Hv.moveTo(e.offset),transition:e.shouldAnimateDisplacement?void 0:"none"}}function ore(e){return e.type==="DRAGGING"?sre(e):ire(e)}function are(e,t,r=bt){const n=window.getComputedStyle(t),s=t.getBoundingClientRect(),i=cO(s,n),a=mf(i,r),l={client:i,tagName:t.tagName.toLowerCase(),display:n.display},c={x:i.marginBox.width,y:i.marginBox.height};return{descriptor:e,placeholder:l,displaceBy:c,client:i,page:a}}function lre(e){const t=db("draggable"),{descriptor:r,registry:n,getDraggableRef:s,canDragInteractiveElements:i,shouldRespectForcePress:a,isEnabled:l}=e,c=Ae(()=>({canDragInteractiveElements:i,shouldRespectForcePress:a,isEnabled:l}),[i,l,a]),u=ye(m=>{const g=s();return g||ne(!1),are(r,g,m)},[r,s]),f=Ae(()=>({uniqueId:t,descriptor:r,options:c,getDimension:u}),[r,u,c,t]),d=p.useRef(f),h=p.useRef(!0);gr(()=>(n.draggable.register(d.current),()=>n.draggable.unregister(d.current)),[n.draggable]),gr(()=>{if(h.current){h.current=!1;return}const m=d.current;d.current=f,n.draggable.update(f,m)},[f,n.draggable])}var hb=J.createContext(null);function bf(e){const t=p.useContext(e);return t||ne(!1),t}function cre(e){e.preventDefault()}const ure=e=>{const t=p.useRef(null),r=ye((S=null)=>{t.current=S},[]),n=ye(()=>t.current,[]),{contextId:s,dragHandleUsageInstructionsId:i,registry:a}=bf(rp),{type:l,droppableId:c}=bf(hb),u=Ae(()=>({id:e.draggableId,index:e.index,type:l,droppableId:c}),[e.draggableId,e.index,l,c]),{children:f,draggableId:d,isEnabled:h,shouldRespectForcePress:m,canDragInteractiveElements:g,isClone:v,mapped:y,dropAnimationFinished:x}=e;if(!v){const S=Ae(()=>({descriptor:u,registry:a,getDraggableRef:n,canDragInteractiveElements:g,shouldRespectForcePress:m,isEnabled:h}),[u,a,n,g,m,h]);lre(S)}const b=Ae(()=>h?{tabIndex:0,role:"button","aria-describedby":i,"data-rfd-drag-handle-draggable-id":d,"data-rfd-drag-handle-context-id":s,draggable:!1,onDragStart:cre}:null,[s,i,d,h]),w=ye(S=>{y.type==="DRAGGING"&&y.dropping&&S.propertyName==="transform"&&(J.version.startsWith("16")||J.version.startsWith("17")?x():jr.flushSync(x))},[x,y]),j=Ae(()=>{const S=ore(y),N=y.type==="DRAGGING"&&y.dropping?w:void 0;return{innerRef:r,draggableProps:{"data-rfd-draggable-context-id":s,"data-rfd-draggable-id":d,style:S,onTransitionEnd:N},dragHandleProps:b}},[s,b,d,y,w,r]),_=Ae(()=>({draggableId:u.id,type:u.type,source:{index:u.index,droppableId:u.droppableId}}),[u.droppableId,u.id,u.index,u.type]);return J.createElement(J.Fragment,null,f(j,y.snapshot,_))};var dre=ure,nD=(e,t)=>e===t,sD=e=>{const{combine:t,destination:r}=e;return r?r.droppableId:t?t.droppableId:null};const fre=e=>e.combine?e.combine.draggableId:null,hre=e=>e.at&&e.at.type==="COMBINE"?e.at.combine.draggableId:null;function pre(){const e=yt((s,i)=>({x:s,y:i})),t=yt((s,i,a=null,l=null,c=null)=>({isDragging:!0,isClone:i,isDropAnimating:!!c,dropAnimation:c,mode:s,draggingOver:a,combineWith:l,combineTargetFor:null})),r=yt((s,i,a,l,c=null,u=null,f=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:u,mode:i,offset:s,dimension:a,forceShouldAnimate:f,snapshot:t(i,l,c,u,null)}}));return(s,i)=>{if(xc(s)){if(s.critical.draggable.id!==i.draggableId)return null;const a=s.current.client.offset,l=s.dimensions.draggables[i.draggableId],c=mr(s.impact),u=hre(s.impact),f=s.forceShouldAnimate;return r(e(a.x,a.y),s.movementMode,l,i.isClone,c,u,f)}if(s.phase==="DROP_ANIMATING"){const a=s.completed;if(a.result.draggableId!==i.draggableId)return null;const l=i.isClone,c=s.dimensions.draggables[i.draggableId],u=a.result,f=u.mode,d=sD(u),h=fre(u),g={duration:s.dropDuration,curve:ib.drop,moveTo:s.newHomeClientOffset,opacity:h?gc.opacity.drop:null,scale:h?gc.scale.drop:null};return{mapped:{type:"DRAGGING",offset:s.newHomeClientOffset,dimension:c,dropping:g,draggingOver:d,combineWith:h,mode:f,forceShouldAnimate:null,snapshot:t(f,l,d,h,g)}}}return null}}function iD(e=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}const mre={mapped:{type:"SECONDARY",offset:bt,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:iD(null)}};function gre(){const e=yt((a,l)=>({x:a,y:l})),t=yt(iD),r=yt((a,l=null,c)=>({mapped:{type:"SECONDARY",offset:a,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}})),n=a=>a?r(bt,a,!0):null,s=(a,l,c,u)=>{const f=c.displaced.visible[a],d=!!(u.inVirtualList&&u.effected[a]),h=Qh(c),m=h&&h.draggableId===a?l:null;if(!f){if(!d)return n(m);if(c.displaced.invisible[a])return null;const y=Pa(u.displacedBy.point),x=e(y.x,y.y);return r(x,m,!0)}if(d)return n(m);const g=c.displacedBy.point,v=e(g.x,g.y);return r(v,m,f.shouldAnimate)};return(a,l)=>{if(xc(a))return a.critical.draggable.id===l.draggableId?null:s(l.draggableId,a.critical.draggable.id,a.impact,a.afterCritical);if(a.phase==="DROP_ANIMATING"){const c=a.completed;return c.result.draggableId===l.draggableId?null:s(l.draggableId,c.result.draggableId,c.impact,c.afterCritical)}return null}}const vre=()=>{const e=pre(),t=gre();return(n,s)=>e(n,s)||t(n,s)||mre},xre={dropAnimationFinished:$O},yre=aO(vre,xre,null,{context:ub,areStatePropsEqual:nD})(dre);var bre=yre;function oD(e){return bf(hb).isUsingCloneFor===e.draggableId&&!e.isClone?null:J.createElement(bre,e)}function wre(e){const t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return J.createElement(oD,je({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}const aD=e=>t=>e===t,jre=aD("scroll"),_re=aD("auto"),SS=(e,t)=>t(e.overflowX)||t(e.overflowY),Sre=e=>{const t=window.getComputedStyle(e),r={overflowX:t.overflowX,overflowY:t.overflowY};return SS(r,jre)||SS(r,_re)},Nre=()=>!1,lD=e=>e==null?null:e===document.body?Nre()?e:null:e===document.documentElement?null:Sre(e)?e:lD(e.parentElement);var Yv=e=>({x:e.scrollLeft,y:e.scrollTop});const cD=e=>e?window.getComputedStyle(e).position==="fixed"?!0:cD(e.parentElement):!1;var Ere=e=>{const t=lD(e),r=cD(e);return{closestScrollable:t,isFixedOnPage:r}},Cre=({descriptor:e,isEnabled:t,isCombineEnabled:r,isFixedOnPage:n,direction:s,client:i,page:a,closest:l})=>{const c=(()=>{if(!l)return null;const{scrollSize:h,client:m}=l,g=BO({scrollHeight:h.scrollHeight,scrollWidth:h.scrollWidth,height:m.paddingBox.height,width:m.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:m,scrollSize:h,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:g,diff:{value:bt,displacement:bt}}}})(),u=s==="vertical"?Qy:yO,f=la({page:a,withPlaceholder:null,axis:u,frame:c});return{descriptor:e,isCombineEnabled:r,isFixedOnPage:n,axis:u,isEnabled:t,client:i,page:a,frame:c,subject:f}};const Pre=(e,t)=>{const r=uO(e);if(!t||e!==t)return r;const n=r.paddingBox.top-t.scrollTop,s=r.paddingBox.left-t.scrollLeft,i=n+t.scrollHeight,a=s+t.scrollWidth,c=Ky({top:n,right:a,bottom:i,left:s},r.border);return Yy({borderBox:c,margin:r.margin,border:r.border,padding:r.padding})};var Tre=({ref:e,descriptor:t,env:r,windowScroll:n,direction:s,isDropDisabled:i,isCombineEnabled:a,shouldClipSubject:l})=>{const c=r.closestScrollable,u=Pre(e,c),f=mf(u,n),d=(()=>{if(!c)return null;const m=uO(c),g={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:m,page:mf(m,n),scroll:Yv(c),scrollSize:g,shouldClipSubject:l}})();return Cre({descriptor:t,isEnabled:!i,isCombineEnabled:a,isFixedOnPage:r.isFixedOnPage,direction:s,client:u,page:f,closest:d})};const kre={passive:!1},Are={passive:!0};var NS=e=>e.shouldPublishImmediately?kre:Are;const qu=e=>e&&e.env.closestScrollable||null;function Rre(e){const t=p.useRef(null),r=bf(rp),n=db("droppable"),{registry:s,marshal:i}=r,a=JO(e),l=Ae(()=>({id:e.droppableId,type:e.type,mode:e.mode}),[e.droppableId,e.mode,e.type]),c=p.useRef(l),u=Ae(()=>yt((j,_)=>{t.current||ne(!1);const S={x:j,y:_};i.updateDroppableScroll(l.id,S)}),[l.id,i]),f=ye(()=>{const j=t.current;return!j||!j.env.closestScrollable?bt:Yv(j.env.closestScrollable)},[]),d=ye(()=>{const j=f();u(j.x,j.y)},[f,u]),h=Ae(()=>fc(d),[d]),m=ye(()=>{const j=t.current,_=qu(j);if(j&&_||ne(!1),j.scrollOptions.shouldPublishImmediately){d();return}h()},[h,d]),g=ye((j,_)=>{t.current&&ne(!1);const S=a.current,N=S.getDroppableRef();N||ne(!1);const E=Ere(N),C={ref:N,descriptor:l,env:E,scrollOptions:_};t.current=C;const k=Tre({ref:N,descriptor:l,env:E,windowScroll:j,direction:S.direction,isDropDisabled:S.isDropDisabled,isCombineEnabled:S.isCombineEnabled,shouldClipSubject:!S.ignoreContainerClipping}),L=E.closestScrollable;return L&&(L.setAttribute(yS.contextId,r.contextId),L.addEventListener("scroll",m,NS(C.scrollOptions))),k},[r.contextId,l,m,a]),v=ye(()=>{const j=t.current,_=qu(j);return j&&_||ne(!1),Yv(_)},[]),y=ye(()=>{const j=t.current;j||ne(!1);const _=qu(j);t.current=null,_&&(h.cancel(),_.removeAttribute(yS.contextId),_.removeEventListener("scroll",m,NS(j.scrollOptions)))},[m,h]),x=ye(j=>{const _=t.current;_||ne(!1);const S=qu(_);S||ne(!1),S.scrollTop+=j.y,S.scrollLeft+=j.x},[]),b=Ae(()=>({getDimensionAndWatchScroll:g,getScrollWhileDragging:v,dragStopped:y,scroll:x}),[y,g,v,x]),w=Ae(()=>({uniqueId:n,descriptor:l,callbacks:b}),[b,l,n]);gr(()=>(c.current=w.descriptor,s.droppable.register(w),()=>{t.current&&y(),s.droppable.unregister(w)}),[b,l,y,w,i,s.droppable]),gr(()=>{t.current&&i.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,i]),gr(()=>{t.current&&i.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,i])}function Dm(){}const ES={width:0,height:0,margin:_Q},Ire=({isAnimatingOpenOnMount:e,placeholder:t,animate:r})=>e||r==="close"?ES:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},Ore=({isAnimatingOpenOnMount:e,placeholder:t,animate:r})=>{const n=Ire({isAnimatingOpenOnMount:e,placeholder:t,animate:r});return{display:t.display,boxSizing:"border-box",width:n.width,height:n.height,marginTop:n.margin.top,marginRight:n.margin.right,marginBottom:n.margin.bottom,marginLeft:n.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:r!=="none"?kl.placeholder:null}},Dre=e=>{const t=p.useRef(null),r=ye(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:n,onTransitionEnd:s,onClose:i,contextId:a}=e,[l,c]=p.useState(e.animate==="open");p.useEffect(()=>l?n!=="open"?(r(),c(!1),Dm):t.current?Dm:(t.current=setTimeout(()=>{t.current=null,c(!1)}),r):Dm,[n,l,r]);const u=ye(d=>{d.propertyName==="height"&&(s(),n==="close"&&i())},[n,i,s]),f=Ore({isAnimatingOpenOnMount:l,animate:e.animate,placeholder:e.placeholder});return J.createElement(e.placeholder.tagName,{style:f,"data-rfd-placeholder-context-id":a,onTransitionEnd:u,ref:e.innerRef})};var $re=J.memo(Dre);class Mre extends J.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,r){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:r.isVisible?{isVisible:!0,data:r.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const Lre=e=>{const t=p.useContext(rp);t||ne(!1);const{contextId:r,isMovementAllowed:n}=t,s=p.useRef(null),i=p.useRef(null),{children:a,droppableId:l,type:c,mode:u,direction:f,ignoreContainerClipping:d,isDropDisabled:h,isCombineEnabled:m,snapshot:g,useClone:v,updateViewportMaxScroll:y,getContainerForClone:x}=e,b=ye(()=>s.current,[]),w=ye((L=null)=>{s.current=L},[]);ye(()=>i.current,[]);const j=ye((L=null)=>{i.current=L},[]),_=ye(()=>{n()&&y({maxScroll:UO()})},[n,y]);Rre({droppableId:l,type:c,mode:u,direction:f,isDropDisabled:h,isCombineEnabled:m,ignoreContainerClipping:d,getDroppableRef:b});const S=Ae(()=>J.createElement(Mre,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},({onClose:L,data:A,animate:R})=>J.createElement($re,{placeholder:A,onClose:L,innerRef:j,animate:R,contextId:r,onTransitionEnd:_})),[r,_,e.placeholder,e.shouldAnimatePlaceholder,j]),N=Ae(()=>({innerRef:w,placeholder:S,droppableProps:{"data-rfd-droppable-id":l,"data-rfd-droppable-context-id":r}}),[r,l,S,w]),E=v?v.dragging.draggableId:null,C=Ae(()=>({droppableId:l,type:c,isUsingCloneFor:E}),[l,E,c]);function k(){if(!v)return null;const{dragging:L,render:A}=v,R=J.createElement(oD,{draggableId:L.draggableId,index:L.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(O,z)=>A(O,z,L));return Mf.createPortal(R,x())}return J.createElement(hb.Provider,{value:C},a(N,g),k())};var Fre=Lre;function Bre(){return document.body||ne(!1),document.body}const CS={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Bre},uD=e=>{let t={...e},r;for(r in CS)e[r]===void 0&&(t={...t,[r]:CS[r]});return t},$m=(e,t)=>e===t.droppable.type,PS=(e,t)=>t.draggables[e.draggable.id],zre=()=>{const e={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...e,shouldAnimatePlaceholder:!1},r=yt(i=>({draggableId:i.id,type:i.type,source:{index:i.index,droppableId:i.droppableId}})),n=yt((i,a,l,c,u,f)=>{const d=u.descriptor.id;if(u.descriptor.droppableId===i){const g=f?{render:f,dragging:r(u.descriptor)}:null,v={isDraggingOver:l,draggingOverWith:l?d:null,draggingFromThisWith:d,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!1,snapshot:v,useClone:g}}if(!a)return t;if(!c)return e;const m={isDraggingOver:l,draggingOverWith:d,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!0,snapshot:m,useClone:null}});return(i,a)=>{const l=uD(a),c=l.droppableId,u=l.type,f=!l.isDropDisabled,d=l.renderClone;if(xc(i)){const h=i.critical;if(!$m(u,h))return t;const m=PS(h,i.dimensions),g=mr(i.impact)===c;return n(c,f,g,g,m,d)}if(i.phase==="DROP_ANIMATING"){const h=i.completed;if(!$m(u,h.critical))return t;const m=PS(h.critical,i.dimensions);return n(c,f,sD(h.result)===c,mr(h.impact)===c,m,d)}if(i.phase==="IDLE"&&i.completed&&!i.shouldFlush){const h=i.completed;if(!$m(u,h.critical))return t;const m=mr(h.impact)===c,g=!!(h.impact.at&&h.impact.at.type==="COMBINE"),v=h.critical.droppable.id===c;return m?g?e:t:v?e:t}return t}},Ure={updateViewportMaxScroll:$Z},Vre=aO(zre,Ure,(e,t,r)=>({...uD(r),...e,...t}),{context:ub,areStatePropsEqual:nD})(Fre);var qre=Vre;const Wre=["","","","","","","","","","","","","","","","","","","","","","",""],Mm=({value:e,onChange:t})=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(pe,{value:e,onChange:r=>t(r.target.value),className:"w-16 text-center text-xl"}),o.jsxs(UI,{children:[o.jsx(VI,{asChild:!0,children:o.jsx(G,{type:"button",variant:"outline",size:"sm",className:"h-10 w-10 p-0",title:"Choisir un emoji",children:o.jsx(Ds,{className:"h-4 w-4"})})}),o.jsx(Fy,{className:"w-72 p-3",align:"start",children:o.jsx("div",{className:"flex flex-wrap gap-1 max-h-96 overflow-y-auto",children:Wre.map(r=>o.jsx("button",{type:"button",onClick:()=>t(r),className:"w-10 h-10 flex items-center justify-center text-xl hover:bg-gray-100 rounded-md transition-colors",children:r},r))})})]})]}),Hre=[{value:"bg-blue-100 text-blue-800",label:"Bleu",preview:"bg-blue-100"},{value:"bg-green-100 text-green-800",label:"Vert",preview:"bg-green-100"},{value:"bg-yellow-100 text-yellow-800",label:"Jaune",preview:"bg-yellow-100"},{value:"bg-red-100 text-red-800",label:"Rouge",preview:"bg-red-100"},{value:"bg-purple-100 text-purple-800",label:"Violet",preview:"bg-purple-100"},{value:"bg-pink-100 text-pink-800",label:"Rose",preview:"bg-pink-100"},{value:"bg-indigo-100 text-indigo-800",label:"Indigo",preview:"bg-indigo-100"},{value:"bg-orange-100 text-orange-800",label:"Orange",preview:"bg-orange-100"},{value:"bg-teal-100 text-teal-800",label:"Turquoise",preview:"bg-teal-100"},{value:"bg-gray-100 text-gray-800",label:"Gris",preview:"bg-gray-100"}],dD=({project:e,onSave:t,onCancel:r,globalPipelineSteps:n=[],isSaving:s=!1})=>{var _;const{organizationReady:i}=an(),a=()=>{var E;const S=e?JSON.parse(JSON.stringify(e)):{type:"",title:"",clientTitle:"",icon:"",color:"gradient-blue",steps:[],isPublic:!0},N=((E=n&&n[0])==null?void 0:E.id)??null;return S.steps=Array.isArray(S.steps)?S.steps.map(C=>({...C,id:C.id||`step-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,globalStepId:C.globalStepId??N})):[],S},[l,c]=p.useState(null),[u,f]=p.useState(""),[d,h]=p.useState(""),m=p.useMemo(()=>!n||!Array.isArray(n)?[]:n.map(S=>o.jsx(Pe,{value:S.id,children:S.label},S.id)),[n]);p.useEffect(()=>{!i||!n||!Array.isArray(n)||(c(a()),f(""),h(""))},[e,n,i]),p.useEffect(()=>{!i||!n||n.length===0||l!=null&&l.steps&&c(S=>{var L;const N=new Set(n.map(A=>A.id)),E=((L=n[0])==null?void 0:L.id)??null;let C=!1;const k=(S.steps||[]).map(A=>{const O=A.globalStepId&&N.has(A.globalStepId)?A.globalStepId:E??null;return O!==A.globalStepId?(C=!0,{...A,globalStepId:O}):A});return C?{...S,steps:k}:S})},[n,i,(_=l==null?void 0:l.steps)==null?void 0:_.length]);const g=p.useCallback((S,N,E)=>{c(C=>{const k=[...C.steps];return k[S]={...k[S],[N]:E},{...C,steps:k}})},[]),v=p.useCallback(()=>{var E;if(!u.trim())return;const S=((E=n[0])==null?void 0:E.id)??null,N={id:`step-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,name:u,status:"pending",icon:d,descriptions:{},globalStepId:S};c(C=>({...C,steps:[...C.steps,N]})),f(""),h("")},[u,d,n]),y=p.useCallback(S=>{c(N=>({...N,steps:N.steps.filter((E,C)=>C!==S)}))},[]),x=S=>{if(!S.destination)return;const N=Array.from(l.steps),[E]=N.splice(S.source.index,1);N.splice(S.destination.index,0,E),c(C=>({...C,steps:N}))},b=()=>{typeof document<"u"&&(document.body.style.overflow="hidden")},w=S=>{typeof document<"u"&&(document.body.style.overflow=""),x(S)},j=()=>{const S=e&&e.type,N={...l,type:S?l.type:S6(l.title)||`project-${Date.now()}`,id:l.id||Date.now()};if(!N.title){B({title:"Titre manquant",description:"Veuillez donner un titre  votre projet.",variant:"destructive"});return}N.clientTitle||(N.clientTitle=N.title),t(N)};return l?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between pb-4 border-b",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Paramtres du Projet"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Ph,{id:"isPublic",checked:l.isPublic,onCheckedChange:S=>c(N=>({...N,isPublic:S}))}),o.jsx(ee,{htmlFor:"isPublic",children:"En ligne"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"project-title",children:"Titre du Projet (Interne)"}),o.jsx(pe,{id:"project-title",value:l.title,onChange:S=>c(N=>({...N,title:S.target.value}))})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"project-client-title",children:"Nom affich au client"}),o.jsx(pe,{id:"project-client-title",value:l.clientTitle,onChange:S=>c(N=>({...N,clientTitle:S.target.value}))})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"project-icon",children:"Icne (Emoji)"}),o.jsx(Mm,{value:l.icon,onChange:S=>c(N=>({...N,icon:S}))})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"project-color",children:"Couleur du Badge"}),o.jsxs(Xt,{value:l.color||"bg-blue-100 text-blue-800",onValueChange:S=>c(N=>({...N,color:S})),children:[o.jsx(zt,{id:"project-color",children:o.jsx(Qt,{placeholder:"Choisir une couleur"})}),o.jsx(Ut,{children:Hre.map(S=>o.jsx(Pe,{value:S.value,children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`w-4 h-4 rounded-full ${S.preview} border border-gray-300`}),S.label]})},S.value))})]})]})]}),o.jsx("h3",{className:"text-md font-semibold text-gray-700 pt-4 border-t",children:"tapes de la Timeline"}),o.jsx(ere,{onDragStart:b,onDragEnd:w,children:o.jsx(qre,{droppableId:"steps",children:S=>o.jsxs("div",{...S.droppableProps,ref:S.innerRef,className:"space-y-3",children:[l.steps.map((N,E)=>o.jsx(wre,{draggableId:N.id,index:E,children:(C,k)=>{const L=k.isDragging?{...C.draggableProps.style,position:"relative",left:"auto",top:"auto"}:C.draggableProps.style;return o.jsx("div",{ref:C.innerRef,...C.draggableProps,style:L,className:`rounded-xl border border-gray-200 bg-white p-3 shadow-sm transition-all ${k.isDragging?"ring-2 ring-purple-200 shadow-lg":""}`,children:o.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3 md:flex-1",children:[o.jsx("div",{...C.dragHandleProps,className:"text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing",children:o.jsx(A3,{className:"h-5 w-5"})}),o.jsx(Mm,{value:N.icon,onChange:A=>g(E,"icon",A)}),o.jsx(pe,{value:N.name,onChange:A=>g(E,"name",A.target.value),placeholder:"Nom de l'tape",className:"flex-1"})]}),o.jsxs("div",{className:"flex items-center gap-2 md:w-72",children:[o.jsxs(Xt,{value:N.globalStepId??"",onValueChange:A=>g(E,"globalStepId",A||null),children:[o.jsx(zt,{className:"bg-white",children:o.jsx(Qt,{placeholder:"Associer  une tape globale"})}),o.jsxs(Ut,{children:[o.jsx(Pe,{value:"",children:"Non assigne"}),m]})]}),o.jsx(G,{variant:"ghost",size:"icon",onClick:()=>y(E),children:o.jsx(Fn,{className:"h-4 w-4 text-red-500"})})]})]})})}},N.id)),S.placeholder]})})}),o.jsxs("div",{className:"flex items-end gap-2 pt-4 border-t",children:[o.jsxs("div",{className:"flex-grow",children:[o.jsx(ee,{children:"Ajouter une tape"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(Mm,{value:d,onChange:h}),o.jsx(pe,{value:u,onChange:S=>f(S.target.value),placeholder:"Nom de la nouvelle tape",className:"flex-1"})]})]}),o.jsx(G,{onClick:v,children:o.jsx(hr,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[o.jsx(G,{variant:"outline",onClick:r,disabled:s,children:"Annuler"}),o.jsx(G,{onClick:j,className:"bg-green-600 hover:bg-green-700",disabled:s,children:s?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrement..."]}):"Enregistrer le projet"})]})]}):o.jsx("div",{className:"flex items-center justify-center p-8",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})},Gre=({open:e,onOpenChange:t,onSave:r,globalPipelineSteps:n=[],isSaving:s=!1})=>{const{projectsData:i={}}=Ve(),[a,l]=p.useState(1),[c,u]=p.useState(null),f=g=>{const v=i==null?void 0:i[g];if(!v){B({title:"Modle introuvable",description:"Le modle de projet n'existe plus.",variant:"destructive"});return}const y={...JSON.parse(JSON.stringify(v)),title:`${v.title} (Copie)`,clientTitle:`${v.clientTitle} (Copie)`,type:`${v.type}-copie-${Date.now()}`,isPublic:!0};u(y),l(2)},d=()=>{var v;const g=((v=n[0])==null?void 0:v.id)??null;u({type:"",title:"",clientTitle:"",icon:"",color:"gradient-blue",steps:[{name:"Nouvelle tape",status:"pending",icon:"",descriptions:{},globalStepId:g}],isPublic:!0}),l(2)},h=g=>{r(g),l(1),u(null),t(!1)},m=()=>{l(1),u(null),t(!1)};return o.jsx(bh,{open:e,onOpenChange:g=>{g?t(!0):m()},children:o.jsxs(Vc,{className:"sm:max-w-2xl",children:[o.jsxs(qc,{children:[o.jsx(Wc,{children:a===1?"Crer un nouveau projet":"Modifier le projet"}),o.jsx(wh,{children:a===1?"Choisissez un modle de base ou partez de zro.":"Personnalisez le titre, l'icne et les tapes de votre nouveau projet."})]}),a===1&&o.jsxs("div",{className:"p-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[Object.values(i).map(g=>o.jsxs(le.button,{onClick:()=>f(g.type),className:"p-4 border rounded-lg hover:shadow-lg hover:border-blue-500 transition-all text-center space-y-2",whileHover:{y:-5},children:[o.jsx("span",{className:"text-4xl",children:g.icon}),o.jsx("p",{className:"font-semibold",children:g.title})]},g.type)),o.jsxs(le.button,{onClick:d,className:"p-4 border border-dashed rounded-lg hover:shadow-lg hover:border-green-500 transition-all text-center space-y-2 flex flex-col items-center justify-center",whileHover:{y:-5},children:[o.jsx(hr,{className:"h-10 w-10 text-gray-400 mb-2"}),o.jsx("p",{className:"font-semibold",children:"Partir de zro"})]})]}),a===2&&c&&o.jsx("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:o.jsx(dD,{project:c,onSave:h,onCancel:m,globalPipelineSteps:n,isSaving:s})})]})})},Kre=()=>{const{projectsData:e={},setProjectsData:t,deleteProjectTemplate:r,globalPipelineSteps:n=[]}=Ve(),[s,i]=p.useState(!1),[a,l]=p.useState(null),[c,u]=p.useState(!1),f=async g=>{l(null),u(!0);const v={...e||{},[g.type]:g};t(v).then(()=>{B({title:"Projet enregistr !",description:`Le projet "${g.title}" a t sauvegard.`,className:"bg-green-500 text-white"})}).catch(y=>{B({title:"Erreur !",description:"Impossible de sauvegarder le projet. Rechargez la page.",variant:"destructive"})}).finally(()=>{u(!1)})},d=g=>{const v=e==null?void 0:e[g];if(v!=null&&v.isPublic){B({title:"Impossible de supprimer",description:"Dsactivez ce projet avant de le supprimer.",variant:"destructive"});return}h(g)},h=async g=>{try{const v=e==null?void 0:e[g];if(!v||!v.id)throw new Error("Template introuvable ou ID manquant");await r(v.id),B({title:"Projet supprim !",description:`Le projet "${v.title}" a t supprim de la base de donnes.`,className:"bg-green-500 text-white"})}catch(v){P.error("Erreur suppression projet",{error:v.message}),B({title:"Erreur !",description:v.message||"Impossible de supprimer le projet.",variant:"destructive"})}},m=g=>{l(g)};return o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"projets"}),o.jsxs("div",{className:"flex flex-1 gap-6 p-6",children:[o.jsx("div",{className:"w-[25%] flex-shrink-0",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-card h-full flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Gestion des Projets"}),o.jsxs(G,{onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 w-full",children:[o.jsx(hr,{className:"mr-2 h-4 w-4"})," Crer un projet"]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-3",children:Object.values(e||{}).length>0?Object.values(e||{}).map(g=>o.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors ${(a==null?void 0:a.type)===g.type?"bg-blue-50 border-2 border-blue-500":"bg-gray-50 hover:bg-gray-100"}`,onClick:()=>m(g),children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-2xl",children:g.icon}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:g.title}),o.jsx("p",{className:"text-xs text-gray-500",children:g.isPublic?" En ligne":" Hors ligne"})]})]}),o.jsxs(Hc,{children:[o.jsx(jh,{asChild:!0,children:o.jsx(G,{variant:"destructive",size:"icon",className:"h-8 w-8",onClick:v=>v.stopPropagation(),children:o.jsx(Fn,{className:"h-4 w-4"})})}),o.jsxs(ba,{children:[o.jsxs(wa,{children:[o.jsxs(_a,{children:['Supprimer "',g.title,'" ?']}),o.jsx(Sa,{children:"Cette action est irrversible et supprimera ce modle de projet."})]}),o.jsxs(ja,{children:[o.jsx(Ea,{children:"Annuler"}),o.jsx(Na,{onClick:()=>d(g.type),className:"bg-red-600 hover:bg-red-700",children:"Supprimer"})]})]})]})]},g.type)):o.jsxs("div",{className:"text-center text-gray-500 py-8",children:[o.jsx(sv,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("p",{className:"mt-2",children:"Aucun projet cr. Cliquez sur le bouton pour en ajouter un."})]})})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-card p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:a?`Modifier "${a.title}"`:"Slectionnez un projet"}),o.jsx("p",{className:"text-sm text-gray-500",children:a?"Personnalisez les paramtres de votre projet et grez ses tapes.":"Cliquez sur un projet dans la liste pour le modifier."})]}),a?o.jsx(dD,{project:a,onSave:f,onCancel:()=>l(null),globalPipelineSteps:n,isSaving:c}):o.jsxs("div",{className:"text-center py-20 text-gray-400",children:[o.jsx(sv,{className:"mx-auto h-20 w-20 mb-4"}),o.jsx("p",{className:"text-lg",children:"Slectionnez un projet  modifier"}),o.jsx("p",{className:"text-sm mt-2",children:"ou crez-en un nouveau"})]})]})})]}),o.jsx(Gre,{open:s,onOpenChange:i,onSave:f,globalPipelineSteps:n,isSaving:c})]})};var TS=1,Yre=.9,Jre=.8,Xre=.17,Lm=.1,Fm=.999,Qre=.9999,Zre=.99,ene=/[\\\/_+.#"@\[\(\{&]/,tne=/[\\\/_+.#"@\[\(\{&]/g,rne=/[\s-]/,fD=/[\s-]/g;function Jv(e,t,r,n,s,i,a){if(i===t.length)return s===e.length?TS:Zre;var l=`${s},${i}`;if(a[l]!==void 0)return a[l];for(var c=n.charAt(i),u=r.indexOf(c,s),f=0,d,h,m,g;u>=0;)d=Jv(e,t,r,n,u+1,i+1,a),d>f&&(u===s?d*=TS:ene.test(e.charAt(u-1))?(d*=Jre,m=e.slice(s,u-1).match(tne),m&&s>0&&(d*=Math.pow(Fm,m.length))):rne.test(e.charAt(u-1))?(d*=Yre,g=e.slice(s,u-1).match(fD),g&&s>0&&(d*=Math.pow(Fm,g.length))):(d*=Xre,s>0&&(d*=Math.pow(Fm,u-s))),e.charAt(u)!==t.charAt(i)&&(d*=Qre)),(d<Lm&&r.charAt(u-1)===n.charAt(i+1)||n.charAt(i+1)===n.charAt(i)&&r.charAt(u-1)!==n.charAt(i))&&(h=Jv(e,t,r,n,u+1,i+2,a),h*Lm>d&&(d=h*Lm)),d>f&&(f=d),u=r.indexOf(c,u+1);return a[l]=f,f}function kS(e){return e.toLowerCase().replace(fD," ")}function nne(e,t){return Jv(e,t,kS(e),kS(t),0,0,{})}function Wo(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function sne(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function hD(...e){return t=>e.forEach(r=>sne(r,t))}function Jc(...e){return p.useCallback(hD(...e),e)}function ine(e,t=[]){let r=[];function n(i,a){const l=p.createContext(a),c=r.length;r=[...r,a];function u(d){const{scope:h,children:m,...g}=d,v=(h==null?void 0:h[e][c])||l,y=p.useMemo(()=>g,Object.values(g));return p.createElement(v.Provider,{value:y},m)}function f(d,h){const m=(h==null?void 0:h[e][c])||l,g=p.useContext(m);if(g)return g;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,f]}const s=()=>{const i=r.map(a=>p.createContext(a));return function(l){const c=(l==null?void 0:l[e])||i;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,one(s,...t)]}function one(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:c,scopeName:u})=>{const d=c(i)[`__scope${u}`];return{...l,...d}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}const Xv=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},ane=wc["useId".toString()]||(()=>{});let lne=0;function Bm(e){const[t,r]=p.useState(ane());return Xv(()=>{e||r(n=>n??String(lne++))},[e]),e||(t?`radix-${t}`:"")}function Ii(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...r)=>{var n;return(n=t.current)===null||n===void 0?void 0:n.call(t,...r)},[])}function cne({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,s]=une({defaultProp:t,onChange:r}),i=e!==void 0,a=i?e:n,l=Ii(r),c=p.useCallback(u=>{if(i){const d=typeof u=="function"?u(e):u;d!==e&&l(d)}else s(u)},[i,e,s,l]);return[a,c]}function une({defaultProp:e,onChange:t}){const r=p.useState(e),[n]=r,s=p.useRef(n),i=Ii(t);return p.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),r}const pb=p.forwardRef((e,t)=>{const{children:r,...n}=e,s=p.Children.toArray(r),i=s.find(fne);if(i){const a=i.props.children,l=s.map(c=>c===i?p.Children.count(a)>1?p.Children.only(null):p.isValidElement(a)?a.props.children:null:c);return p.createElement(Qv,je({},n,{ref:t}),p.isValidElement(a)?p.cloneElement(a,void 0,l):null)}return p.createElement(Qv,je({},n,{ref:t}),r)});pb.displayName="Slot";const Qv=p.forwardRef((e,t)=>{const{children:r,...n}=e;return p.isValidElement(r)?p.cloneElement(r,{...hne(n,r.props),ref:hD(t,r.ref)}):p.Children.count(r)>1?p.Children.only(null):null});Qv.displayName="SlotClone";const dne=({children:e})=>p.createElement(p.Fragment,null,e);function fne(e){return p.isValidElement(e)&&e.type===dne}function hne(e,t){const r={...t};for(const n in t){const s=e[n],i=t[n];/^on[A-Z]/.test(n)?r[n]=(...l)=>{i==null||i(...l),s==null||s(...l)}:n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...e,...r}}const pne=["a","button","div","h2","h3","img","li","nav","ol","p","span","svg","ul"],sp=pne.reduce((e,t)=>{const r=p.forwardRef((n,s)=>{const{asChild:i,...a}=n,l=i?pb:t;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,je({},a,{ref:s}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function mne(e,t){e&&jr.flushSync(()=>e.dispatchEvent(t))}function gne(e){const t=Ii(e);p.useEffect(()=>{const r=n=>{n.key==="Escape"&&t(n)};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[t])}const Zv="dismissableLayer.update",vne="dismissableLayer.pointerDownOutside",xne="dismissableLayer.focusOutside";let AS;const yne=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),bne=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:l,...c}=e,u=p.useContext(yne),[f,d]=p.useState(null),[,h]=p.useState({}),m=Jc(t,S=>d(S)),g=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(v),x=f?g.indexOf(f):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,w=x>=y,j=wne(S=>{const N=S.target,E=[...u.branches].some(C=>C.contains(N));!w||E||(s==null||s(S),a==null||a(S),S.defaultPrevented||l==null||l())}),_=jne(S=>{const N=S.target;[...u.branches].some(C=>C.contains(N))||(i==null||i(S),a==null||a(S),S.defaultPrevented||l==null||l())});return gne(S=>{x===u.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&l&&(S.preventDefault(),l()))}),p.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(AS=document.body.style.pointerEvents,document.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),RS(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(document.body.style.pointerEvents=AS)}},[f,r,u]),p.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),RS())},[f,u]),p.useEffect(()=>{const S=()=>h({});return document.addEventListener(Zv,S),()=>document.removeEventListener(Zv,S)},[]),p.createElement(sp.div,je({},c,{ref:m,style:{pointerEvents:b?w?"auto":"none":void 0,...e.style},onFocusCapture:Wo(e.onFocusCapture,_.onFocusCapture),onBlurCapture:Wo(e.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Wo(e.onPointerDownCapture,j.onPointerDownCapture)}))});function wne(e){const t=Ii(e),r=p.useRef(!1),n=p.useRef(()=>{});return p.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let c=function(){pD(vne,t,l,{discrete:!0})};const l={originalEvent:a};a.pointerType==="touch"?(document.removeEventListener("click",n.current),n.current=c,document.addEventListener("click",n.current,{once:!0})):c()}r.current=!1},i=window.setTimeout(()=>{document.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),document.removeEventListener("pointerdown",s),document.removeEventListener("click",n.current)}},[t]),{onPointerDownCapture:()=>r.current=!0}}function jne(e){const t=Ii(e),r=p.useRef(!1);return p.useEffect(()=>{const n=s=>{s.target&&!r.current&&pD(xne,t,{originalEvent:s},{discrete:!1})};return document.addEventListener("focusin",n),()=>document.removeEventListener("focusin",n)},[t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function RS(){const e=new CustomEvent(Zv);document.dispatchEvent(e)}function pD(e,t,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?mne(s,i):s.dispatchEvent(i)}const zm="focusScope.autoFocusOnMount",Um="focusScope.autoFocusOnUnmount",IS={bubbles:!1,cancelable:!0},_ne=p.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[l,c]=p.useState(null),u=Ii(s),f=Ii(i),d=p.useRef(null),h=Jc(t,v=>c(v)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(n){let v=function(x){if(m.paused||!l)return;const b=x.target;l.contains(b)?d.current=b:ii(d.current,{select:!0})},y=function(x){m.paused||!l||l.contains(x.relatedTarget)||ii(d.current,{select:!0})};return document.addEventListener("focusin",v),document.addEventListener("focusout",y),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",y)}}},[n,l,m.paused]),p.useEffect(()=>{if(l){DS.add(m);const v=document.activeElement;if(!l.contains(v)){const x=new CustomEvent(zm,IS);l.addEventListener(zm,u),l.dispatchEvent(x),x.defaultPrevented||(Sne(Tne(mD(l)),{select:!0}),document.activeElement===v&&ii(l))}return()=>{l.removeEventListener(zm,u),setTimeout(()=>{const x=new CustomEvent(Um,IS);l.addEventListener(Um,f),l.dispatchEvent(x),x.defaultPrevented||ii(v??document.body,{select:!0}),l.removeEventListener(Um,f),DS.remove(m)},0)}}},[l,u,f,m]);const g=p.useCallback(v=>{if(!r&&!n||m.paused)return;const y=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,x=document.activeElement;if(y&&x){const b=v.currentTarget,[w,j]=Nne(b);w&&j?!v.shiftKey&&x===j?(v.preventDefault(),r&&ii(w,{select:!0})):v.shiftKey&&x===w&&(v.preventDefault(),r&&ii(j,{select:!0})):x===b&&v.preventDefault()}},[r,n,m.paused]);return p.createElement(sp.div,je({tabIndex:-1},a,{ref:h,onKeyDown:g}))});function Sne(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(ii(n,{select:t}),document.activeElement!==r)return}function Nne(e){const t=mD(e),r=OS(t,e),n=OS(t.reverse(),e);return[r,n]}function mD(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function OS(e,t){for(const r of e)if(!Ene(r,{upTo:t}))return r}function Ene(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Cne(e){return e instanceof HTMLInputElement&&"select"in e}function ii(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Cne(e)&&t&&e.select()}}const DS=Pne();function Pne(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=$S(e,t),e.unshift(t)},remove(t){var r;e=$S(e,t),(r=e[0])===null||r===void 0||r.resume()}}}function $S(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Tne(e){return e.filter(t=>t.tagName!=="A")}const kne=p.forwardRef((e,t)=>{var r;const{container:n=globalThis==null||(r=globalThis.document)===null||r===void 0?void 0:r.body,...s}=e;return n?Mf.createPortal(p.createElement(sp.div,je({},s,{ref:t})),n):null});function Ane(e,t){return p.useReducer((r,n)=>{const s=t[r][n];return s??r},e)}const ip=e=>{const{present:t,children:r}=e,n=Rne(t),s=typeof r=="function"?r({present:n.isPresent}):p.Children.only(r),i=Jc(n.ref,s.ref);return typeof r=="function"||n.isPresent?p.cloneElement(s,{ref:i}):null};ip.displayName="Presence";function Rne(e){const[t,r]=p.useState(),n=p.useRef({}),s=p.useRef(e),i=p.useRef("none"),a=e?"mounted":"unmounted",[l,c]=Ane(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=Wu(n.current);i.current=l==="mounted"?u:"none"},[l]),Xv(()=>{const u=n.current,f=s.current;if(f!==e){const h=i.current,m=Wu(u);e?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(f&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),Xv(()=>{if(t){const u=d=>{const m=Wu(n.current).includes(d.animationName);d.target===t&&m&&jr.flushSync(()=>c("ANIMATION_END"))},f=d=>{d.target===t&&(i.current=Wu(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{u&&(n.current=getComputedStyle(u)),r(u)},[])}}function Wu(e){return(e==null?void 0:e.animationName)||"none"}let Vm=0;function Ine(){p.useEffect(()=>{var e,t;const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=r[0])!==null&&e!==void 0?e:MS()),document.body.insertAdjacentElement("beforeend",(t=r[1])!==null&&t!==void 0?t:MS()),Vm++,()=>{Vm===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),Vm--}},[])}function MS(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var gD=ey(),qm=function(){},op=p.forwardRef(function(e,t){var r=p.useRef(null),n=p.useState({onScrollCapture:qm,onWheelCapture:qm,onTouchMoveCapture:qm}),s=n[0],i=n[1],a=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,f=e.enabled,d=e.shards,h=e.sideCar,m=e.noIsolation,g=e.inert,v=e.allowPinchZoom,y=e.as,x=y===void 0?"div":y,b=Sn(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),w=h,j=Z0([r,t]),_=Qe(Qe({},b),s);return p.createElement(p.Fragment,null,f&&p.createElement(w,{sideCar:gD,removeScrollBar:u,shards:d,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!v,lockRef:r}),a?p.cloneElement(p.Children.only(l),Qe(Qe({},_),{ref:j})):p.createElement(x,Qe({},_,{className:c,ref:j}),l))});op.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};op.classNames={fullWidth:Bo,zeroRight:Fo};var ex=!1;if(typeof window<"u")try{var Hu=Object.defineProperty({},"passive",{get:function(){return ex=!0,!0}});window.addEventListener("test",Hu,Hu),window.removeEventListener("test",Hu,Hu)}catch{ex=!1}var ao=ex?{passive:!1}:!1,One=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},Dne=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},LS=function(e,t){var r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var n=vD(e,r);if(n){var s=xD(e,r),i=s[1],a=s[2];if(i>a)return!0}r=r.parentNode}while(r&&r!==document.body);return!1},$ne=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Mne=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},vD=function(e,t){return e==="v"?One(t):Dne(t)},xD=function(e,t){return e==="v"?$ne(t):Mne(t)},Lne=function(e,t){return e==="h"&&t==="rtl"?-1:1},Fne=function(e,t,r,n,s){var i=Lne(e,window.getComputedStyle(t).direction),a=i*n,l=r.target,c=t.contains(l),u=!1,f=a>0,d=0,h=0;do{var m=xD(e,l),g=m[0],v=m[1],y=m[2],x=v-y-i*g;(g||x)&&vD(e,l)&&(d+=x,h+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(f&&(s&&d===0||!s&&a>d)||!f&&(s&&h===0||!s&&-a>h))&&(u=!0),u},Gu=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},FS=function(e){return[e.deltaX,e.deltaY]},BS=function(e){return e&&"current"in e?e.current:e},Bne=function(e,t){return e[0]===t[0]&&e[1]===t[1]},zne=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Une=0,lo=[];function Vne(e){var t=p.useRef([]),r=p.useRef([0,0]),n=p.useRef(),s=p.useState(Une++)[0],i=p.useState(function(){return dh()})[0],a=p.useRef(e);p.useEffect(function(){a.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var v=Fc([e.lockRef.current],(e.shards||[]).map(BS),!0).filter(Boolean);return v.forEach(function(y){return y.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),v.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(v,y){if("touches"in v&&v.touches.length===2)return!a.current.allowPinchZoom;var x=Gu(v),b=r.current,w="deltaX"in v?v.deltaX:b[0]-x[0],j="deltaY"in v?v.deltaY:b[1]-x[1],_,S=v.target,N=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in v&&N==="h"&&S.type==="range")return!1;var E=LS(N,S);if(!E)return!0;if(E?_=N:(_=N==="v"?"h":"v",E=LS(N,S)),!E)return!1;if(!n.current&&"changedTouches"in v&&(w||j)&&(n.current=_),!_)return!0;var C=n.current||_;return Fne(C,y,v,C==="h"?w:j,!0)},[]),c=p.useCallback(function(v){var y=v;if(!(!lo.length||lo[lo.length-1]!==i)){var x="deltaY"in y?FS(y):Gu(y),b=t.current.filter(function(_){return _.name===y.type&&_.target===y.target&&Bne(_.delta,x)})[0];if(b&&b.should){y.preventDefault();return}if(!b){var w=(a.current.shards||[]).map(BS).filter(Boolean).filter(function(_){return _.contains(y.target)}),j=w.length>0?l(y,w[0]):!a.current.noIsolation;j&&y.preventDefault()}}},[]),u=p.useCallback(function(v,y,x,b){var w={name:v,delta:y,target:x,should:b};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(j){return j!==w})},1)},[]),f=p.useCallback(function(v){r.current=Gu(v),n.current=void 0},[]),d=p.useCallback(function(v){u(v.type,FS(v),v.target,l(v,e.lockRef.current))},[]),h=p.useCallback(function(v){u(v.type,Gu(v),v.target,l(v,e.lockRef.current))},[]);p.useEffect(function(){return lo.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",c,ao),document.addEventListener("touchmove",c,ao),document.addEventListener("touchstart",f,ao),function(){lo=lo.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,ao),document.removeEventListener("touchmove",c,ao),document.removeEventListener("touchstart",f,ao)}},[]);var m=e.removeScrollBar,g=e.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:zne(s)}):null,m?p.createElement(ry,{gapMode:"margin"}):null)}const qne=ty(gD,Vne);var yD=p.forwardRef(function(e,t){return p.createElement(op,Qe({},e,{ref:t,sideCar:qne}))});yD.classNames=op.classNames;const Wne=yD,bD="Dialog",[wD,boe]=ine(bD),[Hne,Gi]=wD(bD),Gne=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,l=p.useRef(null),c=p.useRef(null),[u=!1,f]=cne({prop:n,defaultProp:s,onChange:i});return p.createElement(Hne,{scope:t,triggerRef:l,contentRef:c,contentId:Bm(),titleId:Bm(),descriptionId:Bm(),open:u,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(d=>!d),[f]),modal:a},r)},jD="DialogPortal",[Kne,_D]=wD(jD,{forceMount:void 0}),Yne=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,i=Gi(jD,t);return p.createElement(Kne,{scope:t,forceMount:r},p.Children.map(n,a=>p.createElement(ip,{present:r||i.open},p.createElement(kne,{asChild:!0,container:s},a))))},tx="DialogOverlay",Jne=p.forwardRef((e,t)=>{const r=_D(tx,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,i=Gi(tx,e.__scopeDialog);return i.modal?p.createElement(ip,{present:n||i.open},p.createElement(Xne,je({},s,{ref:t}))):null}),Xne=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Gi(tx,r);return p.createElement(Wne,{as:pb,allowPinchZoom:!0,shards:[s.contentRef]},p.createElement(sp.div,je({"data-state":ND(s.open)},n,{ref:t,style:{pointerEvents:"auto",...n.style}})))}),yc="DialogContent",Qne=p.forwardRef((e,t)=>{const r=_D(yc,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,i=Gi(yc,e.__scopeDialog);return p.createElement(ip,{present:n||i.open},i.modal?p.createElement(Zne,je({},s,{ref:t})):p.createElement(ese,je({},s,{ref:t})))}),Zne=p.forwardRef((e,t)=>{const r=Gi(yc,e.__scopeDialog),n=p.useRef(null),s=Jc(t,r.contentRef,n);return p.useEffect(()=>{const i=n.current;if(i)return Lc(i)},[]),p.createElement(SD,je({},e,{ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wo(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=r.triggerRef.current)===null||a===void 0||a.focus()}),onPointerDownOutside:Wo(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0;(a.button===2||l)&&i.preventDefault()}),onFocusOutside:Wo(e.onFocusOutside,i=>i.preventDefault())}))}),ese=p.forwardRef((e,t)=>{const r=Gi(yc,e.__scopeDialog),n=p.useRef(!1);return p.createElement(SD,je({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i;if((i=e.onCloseAutoFocus)===null||i===void 0||i.call(e,s),!s.defaultPrevented){var a;n.current||(a=r.triggerRef.current)===null||a===void 0||a.focus(),s.preventDefault()}n.current=!1},onInteractOutside:s=>{var i,a;(i=e.onInteractOutside)===null||i===void 0||i.call(e,s),s.defaultPrevented||(n.current=!0);const l=s.target;((a=r.triggerRef.current)===null||a===void 0?void 0:a.contains(l))&&s.preventDefault()}}))}),SD=p.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,l=Gi(yc,r),c=p.useRef(null),u=Jc(t,c);return Ine(),p.createElement(p.Fragment,null,p.createElement(_ne,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i},p.createElement(bne,je({role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":ND(l.open)},a,{ref:u,onDismiss:()=>l.onOpenChange(!1)}))),!1)});function ND(e){return e?"open":"closed"}const tse=Gne,rse=Yne,nse=Jne,sse=Qne;var ise='[cmdk-list-sizer=""]',Za='[cmdk-group=""]',Wm='[cmdk-group-items=""]',ose='[cmdk-group-heading=""]',mb='[cmdk-item=""]',zS=`${mb}:not([aria-disabled="true"])`,rx="cmdk-item-select",An="data-value",ase=(e,t)=>nne(e,t),ED=p.createContext(void 0),Xc=()=>p.useContext(ED),CD=p.createContext(void 0),gb=()=>p.useContext(CD),PD=p.createContext(void 0),TD=p.forwardRef((e,t)=>{let r=p.useRef(null),n=fo(()=>{var $,M,W;return{search:"",value:(W=(M=e.value)!=null?M:($=e.defaultValue)==null?void 0:$.toLowerCase())!=null?W:"",filtered:{count:0,items:new Map,groups:new Set}}}),s=fo(()=>new Set),i=fo(()=>new Map),a=fo(()=>new Map),l=fo(()=>new Set),c=kD(e),{label:u,children:f,value:d,onValueChange:h,filter:m,shouldFilter:g,vimBindings:v=!0,...y}=e,x=p.useId(),b=p.useId(),w=p.useId(),j=xse();Aa(()=>{if(d!==void 0){let $=d.trim().toLowerCase();n.current.value=$,j(6,L),_.emit()}},[d]);let _=p.useMemo(()=>({subscribe:$=>(l.current.add($),()=>l.current.delete($)),snapshot:()=>n.current,setState:($,M,W)=>{var U,X,me;if(!Object.is(n.current[$],M)){if(n.current[$]=M,$==="search")k(),E(),j(1,C);else if($==="value")if(((U=c.current)==null?void 0:U.value)!==void 0){let se=M??"";(me=(X=c.current).onValueChange)==null||me.call(X,se);return}else W||j(5,L);_.emit()}},emit:()=>{l.current.forEach($=>$())}}),[]),S=p.useMemo(()=>({value:($,M)=>{M!==a.current.get($)&&(a.current.set($,M),n.current.filtered.items.set($,N(M)),j(2,()=>{E(),_.emit()}))},item:($,M)=>(s.current.add($),M&&(i.current.has(M)?i.current.get(M).add($):i.current.set(M,new Set([$]))),j(3,()=>{k(),E(),n.current.value||C(),_.emit()}),()=>{a.current.delete($),s.current.delete($),n.current.filtered.items.delete($);let W=A();j(4,()=>{k(),(W==null?void 0:W.getAttribute("id"))===$&&C(),_.emit()})}),group:$=>(i.current.has($)||i.current.set($,new Set),()=>{a.current.delete($),i.current.delete($)}),filter:()=>c.current.shouldFilter,label:u||e["aria-label"],commandRef:r,listId:x,inputId:w,labelId:b}),[]);function N($){var M,W;let U=(W=(M=c.current)==null?void 0:M.filter)!=null?W:ase;return $?U($,n.current.search):0}function E(){if(!r.current||!n.current.search||c.current.shouldFilter===!1)return;let $=n.current.filtered.items,M=[];n.current.filtered.groups.forEach(U=>{let X=i.current.get(U),me=0;X.forEach(se=>{let Z=$.get(se);me=Math.max(Z,me)}),M.push([U,me])});let W=r.current.querySelector(ise);R().sort((U,X)=>{var me,se;let Z=U.getAttribute(An),oe=X.getAttribute(An);return((me=$.get(oe))!=null?me:0)-((se=$.get(Z))!=null?se:0)}).forEach(U=>{let X=U.closest(Wm);X?X.appendChild(U.parentElement===X?U:U.closest(`${Wm} > *`)):W.appendChild(U.parentElement===W?U:U.closest(`${Wm} > *`))}),M.sort((U,X)=>X[1]-U[1]).forEach(U=>{let X=r.current.querySelector(`${Za}[${An}="${U[0]}"]`);X==null||X.parentElement.appendChild(X)})}function C(){let $=R().find(W=>!W.ariaDisabled),M=$==null?void 0:$.getAttribute(An);_.setState("value",M||void 0)}function k(){if(!n.current.search||c.current.shouldFilter===!1){n.current.filtered.count=s.current.size;return}n.current.filtered.groups=new Set;let $=0;for(let M of s.current){let W=a.current.get(M),U=N(W);n.current.filtered.items.set(M,U),U>0&&$++}for(let[M,W]of i.current)for(let U of W)if(n.current.filtered.items.get(U)>0){n.current.filtered.groups.add(M);break}n.current.filtered.count=$}function L(){var $,M,W;let U=A();U&&((($=U.parentElement)==null?void 0:$.firstChild)===U&&((W=(M=U.closest(Za))==null?void 0:M.querySelector(ose))==null||W.scrollIntoView({block:"nearest"})),U.scrollIntoView({block:"nearest"}))}function A(){var $;return($=r.current)==null?void 0:$.querySelector(`${mb}[aria-selected="true"]`)}function R(){return Array.from(r.current.querySelectorAll(zS))}function O($){let M=R()[$];M&&_.setState("value",M.getAttribute(An))}function z($){var M;let W=A(),U=R(),X=U.findIndex(se=>se===W),me=U[X+$];(M=c.current)!=null&&M.loop&&(me=X+$<0?U[U.length-1]:X+$===U.length?U[0]:U[X+$]),me&&_.setState("value",me.getAttribute(An))}function F($){let M=A(),W=M==null?void 0:M.closest(Za),U;for(;W&&!U;)W=$>0?gse(W,Za):vse(W,Za),U=W==null?void 0:W.querySelector(zS);U?_.setState("value",U.getAttribute(An)):z($)}let V=()=>O(R().length-1),I=$=>{$.preventDefault(),$.metaKey?V():$.altKey?F(1):z(1)},D=$=>{$.preventDefault(),$.metaKey?O(0):$.altKey?F(-1):z(-1)};return p.createElement("div",{ref:Qc([r,t]),...y,"cmdk-root":"",onKeyDown:$=>{var M;if((M=y.onKeyDown)==null||M.call(y,$),!$.defaultPrevented)switch($.key){case"n":case"j":{v&&$.ctrlKey&&I($);break}case"ArrowDown":{I($);break}case"p":case"k":{v&&$.ctrlKey&&D($);break}case"ArrowUp":{D($);break}case"Home":{$.preventDefault(),O(0);break}case"End":{$.preventDefault(),V();break}case"Enter":if(!$.nativeEvent.isComposing){$.preventDefault();let W=A();if(W){let U=new Event(rx);W.dispatchEvent(U)}}}}},p.createElement("label",{"cmdk-label":"",htmlFor:S.inputId,id:S.labelId,style:yse},u),p.createElement(CD.Provider,{value:_},p.createElement(ED.Provider,{value:S},f)))}),lse=p.forwardRef((e,t)=>{var r,n;let s=p.useId(),i=p.useRef(null),a=p.useContext(PD),l=Xc(),c=kD(e),u=(n=(r=c.current)==null?void 0:r.forceMount)!=null?n:a==null?void 0:a.forceMount;Aa(()=>l.item(s,a==null?void 0:a.id),[]);let f=AD(s,i,[e.value,e.children,i]),d=gb(),h=Oi(_=>_.value&&_.value===f.current),m=Oi(_=>u||l.filter()===!1?!0:_.search?_.filtered.items.get(s)>0:!0);p.useEffect(()=>{let _=i.current;if(!(!_||e.disabled))return _.addEventListener(rx,g),()=>_.removeEventListener(rx,g)},[m,e.onSelect,e.disabled]);function g(){var _,S;v(),(S=(_=c.current).onSelect)==null||S.call(_,f.current)}function v(){d.setState("value",f.current,!0)}if(!m)return null;let{disabled:y,value:x,onSelect:b,forceMount:w,...j}=e;return p.createElement("div",{ref:Qc([i,t]),...j,id:s,"cmdk-item":"",role:"option","aria-disabled":y||void 0,"aria-selected":h||void 0,"data-disabled":y||void 0,"data-selected":h||void 0,onPointerMove:y?void 0:v,onClick:y?void 0:g},e.children)}),cse=p.forwardRef((e,t)=>{let{heading:r,children:n,forceMount:s,...i}=e,a=p.useId(),l=p.useRef(null),c=p.useRef(null),u=p.useId(),f=Xc(),d=Oi(g=>s||f.filter()===!1?!0:g.search?g.filtered.groups.has(a):!0);Aa(()=>f.group(a),[]),AD(a,l,[e.value,e.heading,c]);let h=p.useMemo(()=>({id:a,forceMount:s}),[s]),m=p.createElement(PD.Provider,{value:h},n);return p.createElement("div",{ref:Qc([l,t]),...i,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},r&&p.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),p.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},m))}),use=p.forwardRef((e,t)=>{let{alwaysRender:r,...n}=e,s=p.useRef(null),i=Oi(a=>!a.search);return!r&&!i?null:p.createElement("div",{ref:Qc([s,t]),...n,"cmdk-separator":"",role:"separator"})}),dse=p.forwardRef((e,t)=>{let{onValueChange:r,...n}=e,s=e.value!=null,i=gb(),a=Oi(f=>f.search),l=Oi(f=>f.value),c=Xc(),u=p.useMemo(()=>{var f;let d=(f=c.commandRef.current)==null?void 0:f.querySelector(`${mb}[${An}="${l}"]`);return d==null?void 0:d.getAttribute("id")},[l,c.commandRef]);return p.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),p.createElement("input",{ref:t,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":u,id:c.inputId,type:"text",value:s?e.value:a,onChange:f=>{s||i.setState("search",f.target.value),r==null||r(f.target.value)}})}),fse=p.forwardRef((e,t)=>{let{children:r,...n}=e,s=p.useRef(null),i=p.useRef(null),a=Xc();return p.useEffect(()=>{if(i.current&&s.current){let l=i.current,c=s.current,u,f=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let d=l.offsetHeight;c.style.setProperty("--cmdk-list-height",d.toFixed(1)+"px")})});return f.observe(l),()=>{cancelAnimationFrame(u),f.unobserve(l)}}},[]),p.createElement("div",{ref:Qc([s,t]),...n,"cmdk-list":"",role:"listbox","aria-label":"Suggestions",id:a.listId,"aria-labelledby":a.inputId},p.createElement("div",{ref:i,"cmdk-list-sizer":""},r))}),hse=p.forwardRef((e,t)=>{let{open:r,onOpenChange:n,overlayClassName:s,contentClassName:i,container:a,...l}=e;return p.createElement(tse,{open:r,onOpenChange:n},p.createElement(rse,{container:a},p.createElement(nse,{"cmdk-overlay":"",className:s}),p.createElement(sse,{"aria-label":e.label,"cmdk-dialog":"",className:i},p.createElement(TD,{ref:t,...l}))))}),pse=p.forwardRef((e,t)=>{let r=p.useRef(!0),n=Oi(s=>s.filtered.count===0);return p.useEffect(()=>{r.current=!1},[]),r.current||!n?null:p.createElement("div",{ref:t,...e,"cmdk-empty":"",role:"presentation"})}),mse=p.forwardRef((e,t)=>{let{progress:r,children:n,...s}=e;return p.createElement("div",{ref:t,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Loading..."},p.createElement("div",{"aria-hidden":!0},n))}),ir=Object.assign(TD,{List:fse,Item:lse,Input:dse,Group:cse,Separator:use,Dialog:hse,Empty:pse,Loading:mse});function gse(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function vse(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function kD(e){let t=p.useRef(e);return Aa(()=>{t.current=e}),t}var Aa=typeof window>"u"?p.useEffect:p.useLayoutEffect;function fo(e){let t=p.useRef();return t.current===void 0&&(t.current=e()),t}function Qc(e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}function Oi(e){let t=gb(),r=()=>e(t.snapshot());return p.useSyncExternalStore(t.subscribe,r,r)}function AD(e,t,r){let n=p.useRef(),s=Xc();return Aa(()=>{var i;let a=(()=>{var l;for(let c of r){if(typeof c=="string")return c.trim().toLowerCase();if(typeof c=="object"&&"current"in c)return c.current?(l=c.current.textContent)==null?void 0:l.trim().toLowerCase():n.current}})();s.value(e,a),(i=t.current)==null||i.setAttribute(An,a),n.current=a}),n}var xse=()=>{let[e,t]=p.useState(),r=fo(()=>new Map);return Aa(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,s)=>{r.current.set(n,s),t({})}},yse={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const RD=J.forwardRef(({className:e,...t},r)=>o.jsx(ir,{ref:r,className:he("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));RD.displayName=ir.displayName;const ID=J.forwardRef(({className:e,...t},r)=>o.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[o.jsx(Zo,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),o.jsx(ir.Input,{ref:r,className:he("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));ID.displayName=ir.Input.displayName;const OD=J.forwardRef(({className:e,...t},r)=>o.jsx(ir.List,{ref:r,className:he("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));OD.displayName=ir.List.displayName;const DD=J.forwardRef((e,t)=>o.jsx(ir.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));DD.displayName=ir.Empty.displayName;const $D=J.forwardRef(({className:e,...t},r)=>o.jsx(ir.Group,{ref:r,className:he("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));$D.displayName=ir.Group.displayName;const MD=J.forwardRef(({className:e,...t},r)=>o.jsx(ir.Separator,{ref:r,className:he("-mx-1 h-px bg-border",e),...t}));MD.displayName=ir.Separator.displayName;const nx=J.forwardRef(({className:e,...t},r)=>o.jsx(ir.Item,{ref:r,className:he("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t}));nx.displayName=ir.Item.displayName;const bse=Vf("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function wi({className:e,variant:t,...r}){return o.jsx("div",{className:he(bse({variant:t}),e),...r})}const wse=({options:e,selected:t,onChange:r,placeholder:n,searchPlaceholder:s,emptyText:i,className:a,showSelectAll:l=!1,selectAllText:c="Tout slectionner"})=>{const[u,f]=p.useState(!1),d=m=>{r(t.filter(g=>g.value!==m.value))},h=()=>{t.length===e.length?r([]):r(e)};return o.jsxs(UI,{open:u,onOpenChange:f,children:[o.jsx(VI,{asChild:!0,children:o.jsxs(G,{variant:"outline",role:"combobox","aria-expanded":u,className:he("w-full justify-between",a),onClick:()=>f(!u),children:[o.jsx("div",{className:"flex gap-1 flex-wrap",children:t.length>0?t.map(m=>o.jsxs(wi,{variant:"secondary",className:"mr-1",onClick:g=>{g.stopPropagation(),d(m)},children:[m.label,o.jsx("span",{className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:o.jsx(es,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},m.value)):o.jsx("span",{children:n})}),o.jsx(w3,{className:"h-4 w-4 shrink-0 opacity-50"})]})}),o.jsx(Fy,{className:"w-[--radix-popover-trigger-width] p-0",children:o.jsxs(RD,{children:[o.jsx(ID,{placeholder:s}),o.jsxs(OD,{children:[o.jsx(DD,{children:i}),o.jsxs($D,{children:[l&&o.jsxs(o.Fragment,{children:[o.jsxs(nx,{onSelect:h,children:[o.jsx(Mn,{className:he("mr-2 h-4 w-4",t.length===e.length?"opacity-100":"opacity-0")}),c]}),o.jsx(MD,{})]}),e.map(m=>o.jsxs(nx,{onSelect:()=>{const g=t.some(v=>v.value===m.value);r(g?t.filter(v=>v.value!==m.value):[...t,m])},children:[o.jsx(Mn,{className:he("mr-2 h-4 w-4",t.some(g=>g.value===m.value)?"opacity-100":"opacity-0")}),m.label]},m.value))]})]})]})})]})},jse=({form:e,onSave:t,onCancel:r,isSaving:n=!1})=>{const{projectsData:s}=Ve(),[i,a]=p.useState(e?JSON.parse(JSON.stringify(e)):{name:"",fields:[],projectIds:[]}),[l,c]=p.useState(""),[u,f]=p.useState("text"),d=p.useMemo(()=>Object.values(s).map(x=>({value:x.type,label:x.title})),[s]),h=p.useMemo(()=>(i.projectIds||[]).map(x=>d.find(b=>b.value===x)).filter(Boolean),[i.projectIds,d]);p.useEffect(()=>{e&&a(JSON.parse(JSON.stringify(e)))},[e]);const m=(x,b,w)=>{const j=[...i.fields];j[x]={...j[x],[b]:w},a(_=>({..._,fields:j}))},g=()=>{if(!l.trim())return;const x={id:`field-${Date.now()}`,label:l,type:u,placeholder:""};a(b=>({...b,fields:[...b.fields||[],x]})),c(""),f("text")},v=x=>{const b=(i.fields||[]).filter((w,j)=>j!==x);a(w=>({...w,fields:b}))},y=()=>{if(!i.name.trim()){B({title:"Nom manquant",description:"Veuillez nommer votre formulaire.",variant:"destructive"});return}const x={...i,id:i.id||`form-${Date.now()}`};t(x)};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"form-name",children:"Nom du formulaire (Interne)"}),o.jsx(pe,{id:"form-name",value:i.name,onChange:x=>a(b=>({...b,name:x.target.value}))})]}),o.jsxs("div",{children:[o.jsx(ee,{children:" qui est destin ce formulaire ?"}),o.jsxs("div",{className:"flex gap-4 mt-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"radio",id:"audience-client",name:"audience",value:"client",checked:(i.audience||"client")==="client",onChange:x=>a(b=>({...b,audience:x.target.value})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),o.jsx(ee,{htmlFor:"audience-client",className:"font-normal cursor-pointer",children:"Client"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"radio",id:"audience-internal",name:"audience",value:"internal",checked:i.audience==="internal",onChange:x=>a(b=>({...b,audience:x.target.value})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),o.jsx(ee,{htmlFor:"audience-internal",className:"font-normal cursor-pointer",children:"Interne (quipe)"})]})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(i.audience||"client")==="client"?"Ce formulaire sera envoyable au client via le chat":"Ce formulaire sera visible uniquement dans la fiche prospect (quipe)"})]}),o.jsxs("div",{children:[o.jsx(ee,{children:"Projets associs"}),o.jsx(wse,{options:d,selected:h,onChange:x=>a(b=>({...b,projectIds:x.map(w=>w.value)})),placeholder:"Slectionner des projets...",searchPlaceholder:"Rechercher un projet...",emptyText:"Aucun projet trouv.",className:"mt-1"})]}),o.jsx("h3",{className:"text-md font-semibold text-gray-700 pt-4 border-t",children:"Champs du formulaire"}),o.jsx("div",{className:"space-y-3",children:(i.fields||[]).map((x,b)=>o.jsxs("div",{className:"flex flex-col gap-2 bg-gray-50 p-3 rounded-md",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(pe,{value:x.label,onChange:w=>m(b,"label",w.target.value),placeholder:"Nom du champ"}),o.jsxs(Xt,{value:x.type,onValueChange:w=>m(b,"type",w),children:[o.jsx(zt,{className:"w-[180px]",children:o.jsx(Qt,{})}),o.jsxs(Ut,{children:[o.jsx(Pe,{value:"text",children:"Texte"}),o.jsx(Pe,{value:"email",children:"Email"}),o.jsx(Pe,{value:"phone",children:"Tlphone"}),o.jsx(Pe,{value:"number",children:"Nombre"}),o.jsx(Pe,{value:"select",children:"Liste droulante"}),o.jsx(Pe,{value:"file",children:"Fichier"})]})]}),o.jsx(G,{variant:"ghost",size:"icon",onClick:()=>v(b),children:o.jsx(Fn,{className:"h-4 w-4 text-red-500"})})]}),x.type==="select"&&o.jsxs("div",{className:"pl-2 space-y-2 border-l-2 border-blue-300",children:[o.jsx(ee,{className:"text-xs font-semibold text-blue-700",children:"Options du menu droulant :"}),o.jsx("div",{className:"space-y-1",children:(x.options||[]).map((w,j)=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(pe,{value:w,onChange:_=>{const S=[...x.options||[]];S[j]=_.target.value,m(b,"options",S)},placeholder:`Option ${j+1}`,className:"flex-1"}),o.jsx(G,{variant:"ghost",size:"icon",onClick:()=>{const _=(x.options||[]).filter((S,N)=>N!==j);m(b,"options",_)},children:o.jsx(Fn,{className:"h-3 w-3 text-red-500"})})]},j))}),o.jsxs(G,{variant:"outline",size:"sm",onClick:()=>{const w=[...x.options||[],""];m(b,"options",w)},className:"text-xs",children:[o.jsx(hr,{className:"h-3 w-3 mr-1"})," Ajouter une option"]})]}),o.jsxs("div",{className:"pl-2 space-y-2 border-l-2 border-purple-300",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(ee,{className:"text-xs font-semibold text-purple-700",children:"Conditions d'affichage :"}),x.show_if_conditions&&x.show_if_conditions.length>1&&o.jsxs(Xt,{value:x.condition_operator||"AND",onValueChange:w=>m(b,"condition_operator",w),children:[o.jsx(zt,{className:"w-[100px] h-7 text-xs",children:o.jsx(Qt,{})}),o.jsxs(Ut,{children:[o.jsx(Pe,{value:"AND",children:"ET (toutes)"}),o.jsx(Pe,{value:"OR",children:"OU (au moins une)"})]})]})]}),(x.show_if_conditions||[]).map((w,j)=>o.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 p-2 rounded",children:[o.jsxs(Xt,{value:`${w.field}::${w.equals}`,onValueChange:_=>{const[S,N]=_.split("::"),E=[...x.show_if_conditions||[]];E[j]={field:S,equals:N},m(b,"show_if_conditions",E)},children:[o.jsx(zt,{className:"flex-1 h-8 text-xs",children:o.jsx(Qt,{})}),o.jsx(Ut,{children:(i.fields||[]).slice(0,b).filter(_=>_.type==="text"||_.type==="email"||_.type==="phone"||_.type==="select").map(_=>_.type==="select"&&_.options&&_.options.length>0?_.options.map(S=>o.jsxs(Pe,{value:`${_.id}::${S}`,children:['"',_.label,'" = "',S,'"']},`${_.id}::${S}`)):o.jsxs(Pe,{value:`${_.id}::has_value`,children:['"',_.label,'" rempli']},_.id)).flat()})]}),o.jsx(G,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{const _=(x.show_if_conditions||[]).filter((S,N)=>N!==j);m(b,"show_if_conditions",_.length>0?_:void 0)},children:o.jsx(Fn,{className:"h-3 w-3 text-red-500"})})]},j)),o.jsxs(G,{variant:"outline",size:"sm",onClick:()=>{const w=[...x.show_if_conditions||[],{field:"",equals:""}];m(b,"show_if_conditions",w)},className:"text-xs w-full",children:[o.jsx(hr,{className:"h-3 w-3 mr-1"})," Ajouter une condition"]}),(!x.show_if_conditions||x.show_if_conditions.length===0)&&o.jsx("p",{className:"text-xs text-gray-500 italic",children:"Toujours visible (aucune condition)"})]}),x.type==="select"&&o.jsxs("div",{className:"pl-2 space-y-2 border-l-2 border-green-300 mt-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(ee,{className:"text-xs font-semibold text-green-700",children:"Rptition de champs :"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"checkbox",id:`repeater-${x.id}`,checked:x.is_repeater||!1,onChange:w=>m(b,"is_repeater",w.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500"}),o.jsx(ee,{htmlFor:`repeater-${x.id}`,className:"text-xs font-normal cursor-pointer",children:"Utiliser comme compteur de rptition"})]})]}),x.is_repeater&&o.jsxs("div",{className:"space-y-2 bg-green-50 p-3 rounded",children:[o.jsx(ee,{className:"text-xs",children:"Champs  rpter :"}),o.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Slectionnez les champs qui doivent tre rpts N fois (o N = valeur choisie dans le menu droulant)"}),o.jsx("div",{className:"space-y-1",children:(i.fields||[]).slice(b+1).map((w,j)=>{const _=(x.repeats_fields||[]).includes(w.id);return o.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded border",children:[o.jsx("input",{type:"checkbox",id:`repeat-${x.id}-${w.id}`,checked:_,onChange:S=>{const N=x.repeats_fields||[],E=S.target.checked?[...N,w.id]:N.filter(C=>C!==w.id);m(b,"repeats_fields",E)},className:"h-4 w-4 text-green-600 focus:ring-green-500"}),o.jsxs(ee,{htmlFor:`repeat-${x.id}-${w.id}`,className:"text-xs font-normal cursor-pointer flex-1",children:[w.label," (",w.type,")"]})]},w.id)})}),(i.fields||[]).slice(b+1).length===0&&o.jsx("p",{className:"text-xs text-orange-600 italic",children:"Ajoutez des champs aprs celui-ci pour pouvoir les rpter"})]}),!x.is_repeater&&o.jsx("p",{className:"text-xs text-gray-500 italic",children:"Activez cette option pour gnrer automatiquement N copies des champs suivants"})]})]},x.id))}),o.jsxs("div",{className:"flex items-end gap-2 pt-4 border-t",children:[o.jsxs("div",{className:"flex-grow",children:[o.jsx(ee,{children:"Ajouter un champ"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(pe,{value:l,onChange:x=>c(x.target.value),placeholder:"Nom du nouveau champ"}),o.jsxs(Xt,{value:u,onValueChange:f,children:[o.jsx(zt,{className:"w-[180px]",children:o.jsx(Qt,{})}),o.jsxs(Ut,{children:[o.jsx(Pe,{value:"text",children:"Texte"}),o.jsx(Pe,{value:"email",children:"Email"}),o.jsx(Pe,{value:"phone",children:"Tlphone"}),o.jsx(Pe,{value:"number",children:"Nombre"}),o.jsx(Pe,{value:"select",children:"Liste droulante"}),o.jsx(Pe,{value:"file",children:"Fichier"})]})]})]})]}),o.jsx(G,{onClick:g,children:o.jsx(hr,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[o.jsx(G,{variant:"outline",onClick:r,disabled:n,children:"Annuler"}),o.jsx(G,{onClick:y,className:"bg-green-600 hover:bg-green-700",disabled:n,children:n?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrement..."]}):"Enregistrer le formulaire"})]})]})},_se=()=>{const e=Ht();Ve();const{organizationId:t}=an(),{forms:r,loading:n,saveForm:s,deleteForm:i}=$y(t),a=p.useMemo(()=>r,[r]),[l,c]=p.useState(null),[u,f]=p.useState(!1);p.useEffect(()=>{var v;const g=(v=e.state)==null?void 0:v.prefilledForm;g&&(c(g),B({title:" Formulaire pr-rempli",description:`${g.fields.length} champs dtects depuis le template. Vous pouvez les ajuster avant de sauvegarder.`,className:"bg-blue-500 text-white",duration:5e3}),window.history.replaceState({},document.title))},[e.state]);const d=async g=>{f(!0);const v=g.id||`form-${Date.now()}-${Math.random().toString(36).slice(2,7)}`;try{const y=await s(v,{name:g.name,fields:g.fields||[],projectIds:g.projectIds||[],audience:g.audience||"client"});y.success?(B({title:" Formulaire enregistr !",description:`Le formulaire "${g.name}" a t sauvegard dans Supabase.`,className:"bg-green-500 text-white"}),c(null)):B({title:" Erreur",description:`Impossible d'enregistrer le formulaire : ${y.error}`,variant:"destructive"})}finally{f(!1)}},h=async g=>{const v=await i(g);v.success?B({title:" Formulaire supprim !",description:"Le formulaire a t supprim de Supabase.",className:"bg-green-500 text-white"}):B({title:" Erreur",description:`Impossible de supprimer le formulaire : ${v.error}`,variant:"destructive"})},m=g=>{c(g)};return o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"formulaires"}),o.jsxs("div",{className:"flex flex-1 gap-6 p-6",children:[o.jsx("div",{className:"w-[25%] flex-shrink-0",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-card h-full flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Gestion des Formulaires"}),o.jsxs(G,{onClick:()=>c({name:"",fields:[],projectIds:[]}),className:"bg-teal-600 hover:bg-teal-700 w-full",children:[o.jsx(hr,{className:"mr-2 h-4 w-4"})," Crer un formulaire"]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-3",children:n?o.jsx("div",{className:"text-center text-gray-500 py-8",children:"Chargement..."}):Object.values(a).length>0?Object.values(a).map(g=>o.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors ${(l==null?void 0:l.id)===g.id?"bg-teal-50 border-2 border-teal-500":"bg-gray-50 hover:bg-gray-100"}`,onClick:()=>m(g),children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Ln,{className:"h-5 w-5 text-gray-500"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:g.name}),o.jsxs("p",{className:"text-xs text-gray-500",children:[g.audience==="internal"?" Interne":" Client","  ",(g.fields||[]).length," champs"]})]})]}),o.jsxs(Hc,{children:[o.jsx(jh,{asChild:!0,children:o.jsx(G,{variant:"destructive",size:"icon",className:"h-8 w-8",onClick:v=>v.stopPropagation(),children:o.jsx(Fn,{className:"h-4 w-4"})})}),o.jsxs(ba,{children:[o.jsxs(wa,{children:[o.jsxs(_a,{children:['Supprimer "',g.name,'" ?']}),o.jsx(Sa,{children:"Cette action est irrversible."})]}),o.jsxs(ja,{children:[o.jsx(Ea,{children:"Annuler"}),o.jsx(Na,{onClick:()=>h(g.id),className:"bg-red-600 hover:bg-red-700",children:"Supprimer"})]})]})]})]},`${g.id}-${g.name}-${g.updatedAt||g.createdAt}`)):o.jsxs("div",{className:"text-center text-gray-500 py-8",children:[o.jsx(Ln,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("p",{className:"mt-2",children:"Aucun formulaire cr. Cliquez sur le bouton pour en ajouter un."})]})})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-card p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:l?l.id?`Modifier "${l.name}"`:"Crer un nouveau formulaire":"Slectionnez un formulaire"}),o.jsx("p",{className:"text-sm text-gray-500",children:l?"Configurez les champs, les conditions d'affichage et les projets associs.":"Cliquez sur un formulaire dans la liste pour le modifier."})]}),l?o.jsx(jse,{form:l,onSave:d,onCancel:()=>c(null),isSaving:u}):o.jsxs("div",{className:"text-center py-20 text-gray-400",children:[o.jsx(Ln,{className:"mx-auto h-20 w-20 mb-4"}),o.jsx("p",{className:"text-lg",children:"Slectionnez un formulaire  modifier"}),o.jsx("p",{className:"text-sm mt-2",children:"ou crez-en un nouveau"})]})]})})]})]})},Sse=()=>{const{projectsData:e={},setProjectsData:t}=Ve(),[r,n]=p.useState(""),[s,i]=p.useState({coverImage:"",clientDescription:"",ctaText:""}),a=p.useRef(null),l=p.useMemo(()=>Object.values(e).map(h=>({value:h.type,label:h.title,icon:h.icon})),[e]);p.useEffect(()=>{l.length>0&&!r&&n(l[0].value)},[l,r]),p.useEffect(()=>{if(r&&e[r]){const h=e[r];i({coverImage:h.coverImage||"",clientDescription:h.clientDescription||"",ctaText:h.ctaText||""})}},[r,e]);const c=(h,m)=>{i(g=>({...g,[h]:m}))},u=async()=>{if(!r)return;const h={...e[r],...s},m={...e,[r]:h};try{await t(m),B({title:" Modifications enregistres !",description:`L'affichage du projet "${e[r].title}" a t mis  jour.`,className:"bg-green-500 text-white"})}catch{B({title:" Erreur !",description:"Impossible de sauvegarder les modifications.",variant:"destructive"})}},f=h=>{const m=h.target.files[0];if(m){const g=new FileReader;g.onloadend=()=>{c("coverImage",g.result)},g.readAsDataURL(m)}},d=r&&e[r];return o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"catalogue"}),o.jsxs("div",{className:"flex flex-1 gap-6 p-6",children:[o.jsx("div",{className:"w-[25%] flex-shrink-0",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-card h-full flex flex-col",children:[o.jsxs("div",{className:"p-6 border-b",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:" Catalogue Client"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Configurez l'affichage des projets pour vos clients"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-3",children:l.length>0?l.map(h=>o.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors ${r===h.value?"bg-indigo-50 border-2 border-indigo-500":"bg-gray-50 hover:bg-gray-100"}`,onClick:()=>n(h.value),children:[o.jsx("span",{className:"text-2xl",children:h.icon}),o.jsx("span",{className:"font-medium",children:h.label})]},h.value)):o.jsxs("div",{className:"text-center text-gray-500 py-8",children:[o.jsx(ad,{className:"mx-auto h-12 w-12 text-gray-400"}),o.jsx("p",{className:"mt-2",children:"Aucun projet disponible"}),o.jsx("p",{className:"text-xs mt-1",children:`Crez d'abord des projets dans "Gestion des Projets"`})]})})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-card p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:d?`Configuration de "${d.title}"`:"Slectionnez un projet"}),o.jsx("p",{className:"text-sm text-gray-500",children:d?"Personnalisez l'image, la description et le bouton d'action affichs aux clients.":"Cliquez sur un projet dans la liste pour configurer son affichage."})]}),d?o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 p-4 rounded-lg border border-indigo-200",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-3xl",children:d.icon}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-gray-800",children:d.title}),o.jsxs("p",{className:"text-sm text-gray-600",children:["Type: ",d.type]})]})]})}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"project-cover-image",children:"Image de couverture (URL)"}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx(pe,{id:"project-cover-image",placeholder:"https://exemple.com/image.jpg",value:s.coverImage,onChange:h=>c("coverImage",h.target.value)}),o.jsx("input",{type:"file",ref:a,onChange:f,accept:"image/*",className:"hidden"}),o.jsx(G,{variant:"outline",onClick:()=>{var h;return(h=a.current)==null?void 0:h.click()},title:"Uploader une image",children:o.jsx(mP,{className:"h-4 w-4"})})]}),s.coverImage?o.jsx("div",{className:"mt-3 relative w-full aspect-video rounded-lg overflow-hidden bg-gray-100 border",children:o.jsx("img",{src:s.coverImage,alt:"Aperu de la couverture",className:"w-full h-full object-cover",onError:h=>{h.target.src="",h.target.style.display="none",B({title:"Erreur d'image",description:"L'URL de l'image n'est pas valide.",variant:"destructive"})}})}):o.jsx("div",{className:"mt-3 flex items-center justify-center w-full aspect-video rounded-lg bg-gray-100 border-2 border-dashed border-gray-300",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ad,{className:"h-12 w-12 text-gray-400 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Aucune image de couverture"})]})}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Image affiche aux clients sur la page de prsentation du projet"})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"project-client-description",children:"Description du projet"}),o.jsx(mi,{id:"project-client-description",placeholder:"Courte description visible par le client...",value:s.clientDescription,onChange:h=>c("clientDescription",h.target.value),rows:5,className:"mt-1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Texte prsent au client pour expliquer le projet"})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"project-cta-text",children:"Texte du bouton (CTA)"}),o.jsx(pe,{id:"project-cta-text",placeholder:"Ex: Ajouter ce projet",value:s.ctaText,onChange:h=>c("ctaText",h.target.value),className:"mt-1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Texte affich sur le bouton d'action principal"})]}),o.jsx("div",{className:"flex justify-end pt-4 border-t",children:o.jsx(G,{onClick:u,className:"bg-green-600 hover:bg-green-700",children:"Enregistrer les modifications"})})]}):o.jsxs("div",{className:"text-center py-20 text-gray-400",children:[o.jsx(ad,{className:"mx-auto h-20 w-20 mb-4"}),o.jsx("p",{className:"text-lg",children:"Slectionnez un projet  configurer"}),o.jsx("p",{className:"text-sm mt-2",children:'ou crez-en un dans "Gestion des Projets"'})]})]})})]})]})},Nse=()=>{const e=Te(),{activeAdminUser:t}=Ve(),{organizationId:r}=an(),{partners:n,loading:s,error:i,refetch:a}=My(r),[l,c]=p.useState(""),[u,f]=p.useState(!1),[d,h]=p.useState(!1),[m,g]=p.useState({companyName:"",email:"",contactLastName:"",contactFirstName:"",phone:""}),v=p.useMemo(()=>(t==null?void 0:t.role)==="Global Admin"||(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="platform_admin",[t]),y=p.useMemo(()=>{if(!l.trim())return n;const j=l.toLowerCase();return n.filter(_=>{var S,N,E;return((S=_.name)==null?void 0:S.toLowerCase().includes(j))||((N=_.email)==null?void 0:N.toLowerCase().includes(j))||((E=_.specialty)==null?void 0:E.toLowerCase().includes(j))})},[n,l]),x=p.useMemo(()=>({total:n.length,active:n.filter(j=>j.active).length,inactive:n.filter(j=>!j.active).length,totalMissions:n.reduce((j,_)=>j+_.missionsCount,0)}),[n]),b=async()=>{var j,_,S,N,E;if(!m.companyName.trim()||!m.email.trim()){B({title:"Champs requis",description:"Le nom de l'entreprise et l'email sont obligatoires.",variant:"destructive"});return}if(!m.email.includes("@")){B({title:"Email invalide",description:"Veuillez entrer une adresse email valide.",variant:"destructive"});return}h(!0);try{const{data:C,error:k}=await T.functions.invoke("invite-partner",{body:{companyName:m.companyName.trim(),email:m.email.trim().toLowerCase(),contactLastName:((j=m.contactLastName)==null?void 0:j.trim())||null,contactFirstName:((_=m.contactFirstName)==null?void 0:_.trim())||null,phone:((S=m.phone)==null?void 0:S.trim())||null,organizationId:r}});if(k)throw k;if(C!=null&&C.error){B({title:"Erreur",description:C.error,variant:"destructive"});return}P.info("Invitation partenaire envoye",{email:m.email,partnerId:C==null?void 0:C.partnerId}),B({title:" Invitation envoye",description:`${m.companyName} recevra un email avec ses identifiants.`,className:"bg-green-500 text-white"}),g({companyName:"",email:"",contactLastName:"",contactFirstName:"",phone:""}),f(!1),a()}catch(C){P.error("Erreur invitation partenaire",{error:C.message});let k="Une erreur est survenue lors de l'invitation.";(N=C.message)!=null&&N.includes("already registered")?k="Cet email est dj utilis.":(E=C.message)!=null&&E.includes("rate limit")&&(k="Trop de tentatives, ressayez plus tard."),B({title:"Erreur",description:k,variant:"destructive"})}finally{h(!1)}},w=()=>{f(!1),g({companyName:"",email:"",contactLastName:"",contactFirstName:"",phone:""})};return v?o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"partenaires"}),o.jsxs("div",{className:"flex-1 p-6 overflow-auto",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[o.jsx(Pi,{className:"h-7 w-7 text-orange-600"}),"Partenaires"]}),o.jsx("p",{className:"text-gray-500 mt-1",children:"Grez les partenaires terrain de votre organisation"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(G,{variant:"outline",size:"sm",onClick:a,disabled:s,children:[o.jsx(Kf,{className:`h-4 w-4 mr-2 ${s?"animate-spin":""}`}),"Actualiser"]}),o.jsxs(G,{size:"sm",onClick:()=>f(!0),className:"bg-orange-600 hover:bg-orange-700",children:[o.jsx(jl,{className:"h-4 w-4 mr-2"}),"Inviter un partenaire"]})]})]}),o.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[o.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:[o.jsx("div",{className:"text-2xl font-bold text-gray-900",children:x.total}),o.jsx("div",{className:"text-sm text-gray-500",children:"Partenaires"})]}),o.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:[o.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.active}),o.jsx("div",{className:"text-sm text-gray-500",children:"Actifs"})]}),o.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:[o.jsx("div",{className:"text-2xl font-bold text-red-600",children:x.inactive}),o.jsx("div",{className:"text-sm text-gray-500",children:"Inactifs"})]}),o.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:[o.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.totalMissions}),o.jsx("div",{className:"text-sm text-gray-500",children:"Missions totales"})]})]}),o.jsxs("div",{className:"relative max-w-md",children:[o.jsx(Zo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx(pe,{type:"text",placeholder:"Rechercher un partenaire...",value:l,onChange:j=>c(j.target.value),className:"pl-10"})]})]}),s?o.jsxs("div",{className:"flex items-center justify-center py-20",children:[o.jsx(De,{className:"h-8 w-8 animate-spin text-blue-600"}),o.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement des partenaires..."})]}):i?o.jsx("div",{className:"flex items-center justify-center py-20",children:o.jsxs("div",{className:"text-center",children:[o.jsx(d0,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),o.jsxs("p",{className:"text-red-600 font-medium",children:["Erreur: ",i]}),o.jsx(G,{variant:"outline",className:"mt-4",onClick:a,children:"Ressayer"})]})}):y.length===0?o.jsx("div",{className:"flex items-center justify-center py-20",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Pi,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:l?"Aucun partenaire trouv":"Aucun partenaire"}),o.jsx("p",{className:"text-gray-500 max-w-sm",children:l?"Modifiez votre recherche pour trouver des partenaires.":"Les partenaires apparatront ici une fois crs via l'invitation."})]})}):o.jsx("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-700",children:"Partenaire"}),o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-700",children:"Email"}),o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-gray-700",children:"Spcialit"}),o.jsx("th",{className:"text-center px-6 py-4 text-sm font-semibold text-gray-700",children:"Statut"}),o.jsx("th",{className:"text-center px-6 py-4 text-sm font-semibold text-gray-700",children:"Missions"}),o.jsx("th",{className:"text-right px-6 py-4 text-sm font-semibold text-gray-700"})]})}),o.jsx("tbody",{className:"divide-y",children:y.map(j=>{var _,S;return o.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>e(`/admin/partners/${j.id}`),children:[o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center",children:o.jsx("span",{className:"text-orange-600 font-semibold text-sm",children:((S=(_=j.name)==null?void 0:_.charAt(0))==null?void 0:S.toUpperCase())||"?"})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:j.name}),j.phone&&o.jsx("div",{className:"text-sm text-gray-500",children:j.phone})]})]})}),o.jsx("td",{className:"px-6 py-4 text-gray-600",children:j.email}),o.jsx("td",{className:"px-6 py-4",children:j.specialty?o.jsx(wi,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:j.specialty}):o.jsx("span",{className:"text-gray-400 text-sm",children:"Non dfinie"})}),o.jsx("td",{className:"px-6 py-4 text-center",children:j.active?o.jsxs(wi,{className:"bg-green-100 text-green-700 border-green-200",children:[o.jsx(F3,{className:"h-3 w-3 mr-1"}),"Actif"]}):o.jsxs(wi,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[o.jsx(B3,{className:"h-3 w-3 mr-1"}),"Inactif"]})}),o.jsx("td",{className:"px-6 py-4 text-center",children:o.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-gray-100 text-gray-700 font-medium text-sm",children:j.missionsCount})}),o.jsx("td",{className:"px-6 py-4 text-right",children:o.jsx(Gn,{className:"h-5 w-5 text-gray-400"})})]},j.id)})})]})})]}),o.jsx(bh,{open:u,onOpenChange:w,children:o.jsxs(Vc,{className:"sm:max-w-md",children:[o.jsxs(qc,{children:[o.jsxs(Wc,{className:"flex items-center gap-2",children:[o.jsx(jl,{className:"h-5 w-5 text-orange-600"}),"Inviter un partenaire"]}),o.jsx(wh,{children:"Le partenaire recevra un email avec ses identifiants de connexion."})]}),o.jsxs("div",{className:"px-6 py-5 space-y-5",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs(ee,{htmlFor:"invite-company",children:["Nom de l'entreprise ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(pe,{id:"invite-company",type:"text",placeholder:"Ex: Solaire Sud Ouest",value:m.companyName,onChange:j=>g(_=>({..._,companyName:j.target.value})),disabled:d,className:"w-full rounded-lg"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(ee,{htmlFor:"invite-email",children:["Email ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(pe,{id:"invite-email",type:"email",placeholder:"partenaire@entreprise.com",value:m.email,onChange:j=>g(_=>({..._,email:j.target.value})),disabled:d,className:"w-full rounded-lg"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(ee,{htmlFor:"invite-contact-name",children:["Nom du contact ",o.jsx("span",{className:"text-gray-400",children:"(optionnel)"})]}),o.jsx(pe,{id:"invite-contact-name",type:"text",placeholder:"Dupont",value:m.contactLastName,onChange:j=>g(_=>({..._,contactLastName:j.target.value})),disabled:d,className:"w-full rounded-lg"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(ee,{htmlFor:"invite-contact-firstname",children:["Prnom du contact ",o.jsx("span",{className:"text-gray-400",children:"(optionnel)"})]}),o.jsx(pe,{id:"invite-contact-firstname",type:"text",placeholder:"Jean",value:m.contactFirstName,onChange:j=>g(_=>({..._,contactFirstName:j.target.value})),disabled:d,className:"w-full rounded-lg"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(ee,{htmlFor:"invite-phone",children:["Tlphone ",o.jsx("span",{className:"text-gray-400",children:"(optionnel)"})]}),o.jsx(pe,{id:"invite-phone",type:"tel",placeholder:"06 12 34 56 78",value:m.phone,onChange:j=>g(_=>({..._,phone:j.target.value})),disabled:d,className:"w-full rounded-lg"})]})]}),o.jsxs(TR,{className:"flex gap-2 mt-6",children:[o.jsx(G,{variant:"outline",onClick:w,disabled:d,children:"Annuler"}),o.jsx(G,{onClick:b,disabled:d,className:"bg-orange-600 hover:bg-orange-700",children:d?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Envoi..."]}):o.jsxs(o.Fragment,{children:[o.jsx(jl,{className:"h-4 w-4 mr-2"}),"Inviter le partenaire"]})})]})]})})]}):o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"partenaires"}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center max-w-md",children:[o.jsx("div",{className:"text-6xl mb-4",children:""}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Accs restreint"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Cette page est rserve aux Global Admin et Admin."}),o.jsx(G,{onClick:()=>e("/admin/pipeline"),children:"Retour au Pipeline"})]})})]})},Ese=()=>{var w,j;const{partnerId:e}=ma(),t=Te(),{activeAdminUser:r}=Ve(),{organizationId:n}=an(),{togglePartnerActive:s,getPartnerWithMissions:i}=My(n),[a,l]=p.useState(null),[c,u]=p.useState([]),[f,d]=p.useState(!0),[h,m]=p.useState(null),[g,v]=p.useState(!1),y=p.useMemo(()=>(r==null?void 0:r.role)==="Global Admin"||(r==null?void 0:r.role)==="Admin"||(r==null?void 0:r.role)==="platform_admin",[r]);p.useEffect(()=>{(async()=>{if(!e)return;d(!0),m(null);const S=await i(e);S.error?m(S.error):(l(S.partner),u(S.missions)),d(!1)})()},[e,i]);const x=async()=>{if(!a)return;v(!0);const _=!a.active,S=await s(a.id,_);S.success?(l(N=>({...N,active:_})),B({title:_?" Partenaire activ":" Partenaire dsactiv",description:_?`${a.name} peut maintenant recevoir des missions.`:`${a.name} ne recevra plus de nouvelles missions.`,className:_?"bg-green-500 text-white":"bg-orange-500 text-white"})):B({title:" Erreur",description:S.error||"Impossible de modifier le statut.",variant:"destructive"}),v(!1)},b=_=>{const S={pending:{label:"En attente",icon:Hd,className:"bg-gray-100 text-gray-700"},in_progress:{label:"En cours",icon:De,className:"bg-blue-100 text-blue-700"},completed:{label:"Termine",icon:Hf,className:"bg-green-100 text-green-700"},blocked:{label:"Bloque",icon:qf,className:"bg-red-100 text-red-700"},cancelled:{label:"Annule",icon:v0,className:"bg-gray-100 text-gray-500"}},N=S[_]||S.pending,E=N.icon;return o.jsxs(wi,{className:N.className,children:[o.jsx(E,{className:"h-3 w-3 mr-1"}),N.label]})};return y?f?o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"partenaires"}),o.jsxs("div",{className:"flex-1 flex items-center justify-center",children:[o.jsx(De,{className:"h-8 w-8 animate-spin text-blue-600"}),o.jsx("span",{className:"ml-3 text-gray-600",children:"Chargement du partenaire..."})]})]}):h||!a?o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"partenaires"}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(d0,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),o.jsx("p",{className:"text-red-600 font-medium mb-4",children:h||"Partenaire non trouv"}),o.jsx(G,{variant:"outline",onClick:()=>t("/admin/partners"),children:"Retour  la liste"})]})})]}):o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"partenaires"}),o.jsxs("div",{className:"flex-1 p-6 overflow-auto",children:[o.jsxs(G,{variant:"ghost",className:"mb-4",onClick:()=>t("/admin/partners"),children:[o.jsx(f0,{className:"h-4 w-4 mr-2"}),"Retour  la liste"]}),o.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[o.jsx("div",{className:"col-span-1",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"w-20 h-20 rounded-full bg-orange-100 flex items-center justify-center mx-auto mb-4",children:o.jsx("span",{className:"text-orange-600 font-bold text-2xl",children:((j=(w=a.name)==null?void 0:w.charAt(0))==null?void 0:j.toUpperCase())||"?"})}),o.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.name}),a.specialty&&o.jsx(wi,{variant:"outline",className:"mt-2 bg-blue-50 text-blue-700",children:a.specialty})]}),o.jsxs("div",{className:"space-y-4 border-t pt-4",children:[o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(tn,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm",children:a.email})]}),a.phone&&o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(kc,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm",children:a.phone})]}),o.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[o.jsx(h0,{className:"h-4 w-4 text-gray-400"}),o.jsxs("span",{className:"text-sm",children:["Cr le ",new Date(a.createdAt).toLocaleDateString("fr-FR")]})]})]}),o.jsx("div",{className:"border-t pt-4 mt-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-gray-900",children:"Statut"}),o.jsx("div",{className:"text-sm text-gray-500",children:a.active?"Peut recevoir des missions":"Ne reoit plus de missions"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ph,{checked:a.active,onCheckedChange:x,disabled:g}),g&&o.jsx(De,{className:"h-4 w-4 animate-spin"})]})]})})]})}),o.jsx("div",{className:"col-span-2",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[o.jsxs("div",{className:"px-6 py-4 border-b",children:[o.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[o.jsx(tv,{className:"h-5 w-5 text-blue-600"}),"Missions (",c.length,")"]}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Historique des missions assignes  ce partenaire (lecture seule)"})]}),c.length===0?o.jsxs("div",{className:"p-12 text-center",children:[o.jsx(tv,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:"Aucune mission assigne"})]}):o.jsx("div",{className:"divide-y max-h-[500px] overflow-y-auto",children:c.map(_=>o.jsx("div",{className:"px-6 py-4 hover:bg-gray-50",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-medium text-gray-900",children:_.title}),o.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-gray-500",children:[o.jsx(wi,{variant:"outline",className:"text-xs",children:_.projectType}),_.stepName&&o.jsxs("span",{children:[" ",_.stepName]}),o.jsxs("span",{children:[" ",_.source]})]}),o.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Cre le ",new Date(_.createdAt).toLocaleDateString("fr-FR"),_.dueDate&&o.jsxs(o.Fragment,{children:["  chance: ",new Date(_.dueDate).toLocaleDateString("fr-FR")]})]})]}),o.jsx("div",{children:b(_.status)})]})},_.id))})]})})]})]})]}):o.jsxs("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:[o.jsx(vn,{activeModule:"partenaires"}),o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center max-w-md",children:[o.jsx("div",{className:"text-6xl mb-4",children:""}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Accs restreint"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Cette page est rserve aux Global Admin et Admin."}),o.jsx(G,{onClick:()=>t("/admin/pipeline"),children:"Retour au Pipeline"})]})})]})},Cse=()=>{const e=Te(),[t,r]=p.useState(""),[n,s]=p.useState(""),[i,a]=p.useState(!1),[l,c]=p.useState(""),[u,f]=p.useState(""),[d,h]=p.useState(!1),[m,g]=p.useState(!1),[v,y]=p.useState(!0),[x,b]=p.useState(!1),[w,j]=p.useState("");p.useEffect(()=>{const N=window.location.hash,E=N.includes("access_token")||N.includes("type=invite")||N.includes("type=recovery");P.info(" PartnerLoginPage - Vrification du flow invitation",{hash:N?N.substring(0,50)+"...":"(vide)",hasInviteToken:E});const C=async()=>{var R;const{data:{session:A}}=await T.auth.getSession();if(A){P.info(" Session active trouve",{userId:A.user.id,email:A.user.email,isRecovery:(R=A.user)==null?void 0:R.recovery});const{data:O,error:z}=await T.from("partners").select("email, company_name").eq("user_id",A.user.id).single();if(O&&!z){const F=new Date(A.user.created_at),I=(new Date-F)/(1e3*60*60),D=I<24;if(P.info(" Partenaire trouv",{email:O.email,isRecentInvite:D,hoursSinceCreation:I.toFixed(1)}),E||D){g(!0),j(O.email),b(!0),y(!1);return}}}E?(P.warn(" Hash prsent mais pas de session valide"),g(!0),b(!1),y(!1)):(g(!1),y(!1))},k=setTimeout(C,500),{data:{subscription:L}}=T.auth.onAuthStateChange(async(A,R)=>{(A==="SIGNED_IN"||A==="TOKEN_REFRESHED"||A==="INITIAL_SESSION")&&R&&C()});return()=>{clearTimeout(k),L.unsubscribe()}},[]);const _=async N=>{if(N.preventDefault(),l.length<6){B({title:"Mot de passe trop court",description:"Le mot de passe doit contenir au moins 6 caractres.",variant:"destructive"});return}if(l!==u){B({title:"Erreur",description:"Les mots de passe ne correspondent pas.",variant:"destructive"});return}h(!0);try{const{error:E}=await T.auth.updateUser({password:l});if(E){P.error("Erreur updateUser password",{error:E.message}),B({title:"Erreur",description:E.message||"Impossible de dfinir le mot de passe.",variant:"destructive"});return}P.info("Mot de passe partenaire dfini avec succs"),B({title:" Mot de passe cr !",description:"Bienvenue sur EVATIME.",className:"bg-green-500 text-white"}),e("/partner/missions")}catch(E){P.error("Erreur inattendue cration mot de passe",{error:E.message}),B({title:"Erreur",description:"Une erreur inattendue s'est produite.",variant:"destructive"})}finally{h(!1)}},S=async N=>{N.preventDefault(),a(!0);try{const{data:E,error:C}=await T.auth.signInWithPassword({email:t,password:n});if(C){B({title:"Erreur de connexion",description:"Email ou mot de passe incorrect.",variant:"destructive"}),a(!1);return}const{data:k,error:L}=await T.from("partners").select("id, company_name, active").eq("user_id",E.user.id).single();if(L||!k){P.warn("Tentative de connexion partenaire par un non-partenaire",{userId:E.user.id,email:t,error:L==null?void 0:L.message}),await T.auth.signOut(),B({title:"Accs refus",description:"Ce compte n'est pas un compte partenaire.",variant:"destructive"}),a(!1);return}if(!k.active){await T.auth.signOut(),B({title:"Compte dsactiv",description:"Votre compte partenaire a t dsactiv. Contactez l'administrateur.",variant:"destructive"}),a(!1);return}P.info("Connexion partenaire russie",{partnerId:k.id,companyName:k.company_name}),B({title:"Connexion russie !",description:`Bienvenue ${k.company_name}`,className:"bg-green-500 text-white"}),e("/partner")}catch(E){P.error("Erreur inattendue lors de la connexion partenaire",{error:E.message}),B({title:"Erreur",description:"Une erreur inattendue s'est produite.",variant:"destructive"})}finally{a(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-amber-100 flex items-center justify-center p-4",children:o.jsx(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[m&&v&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx(De,{className:"w-12 h-12 text-orange-600 animate-spin mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Validation de votre invitation..."})]}),m&&!v&&!x&&o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(gj,{className:"w-8 h-8 text-red-600"})}),o.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Lien expir"}),o.jsx("p",{className:"text-gray-500 mb-6",children:"Ce lien d'invitation n'est plus valide ou a dj t utilis."}),o.jsx(G,{onClick:()=>e("/partner/login"),className:"bg-orange-600 hover:bg-orange-700 text-white",children:"Retour  la connexion"})]}),m&&!v&&x&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(gj,{className:"w-8 h-8 text-orange-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Crer votre mot de passe"}),o.jsx("p",{className:"text-gray-500 mt-2",children:"Dfinissez un mot de passe pour accder  votre espace"}),w&&o.jsx("p",{className:"text-sm text-orange-600 mt-1",children:w})]}),o.jsxs("form",{onSubmit:_,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"new-password",children:"Nouveau mot de passe"}),o.jsx(pe,{id:"new-password",type:"password",placeholder:"",value:l,onChange:N=>c(N.target.value),required:!0,disabled:d,className:"h-12",minLength:6})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"confirm-password",children:"Confirmer le mot de passe"}),o.jsx(pe,{id:"confirm-password",type:"password",placeholder:"",value:u,onChange:N=>f(N.target.value),required:!0,disabled:d,className:"h-12",minLength:6})]}),o.jsx(G,{type:"submit",disabled:d,className:"w-full h-12 bg-orange-600 hover:bg-orange-700 text-white font-medium",children:d?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"w-4 h-4 mr-2 animate-spin"}),"Cration..."]}):"Crer mon mot de passe"})]}),o.jsx("p",{className:"text-center text-sm text-gray-400 mt-8",children:"Accs rserv aux partenaires agrs"})]}),!m&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(tv,{className:"w-8 h-8 text-orange-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Espace Partenaire"}),o.jsx("p",{className:"text-gray-500 mt-2",children:"Connectez-vous  votre compte"})]}),o.jsxs("form",{onSubmit:S,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"email",children:"Email"}),o.jsx(pe,{id:"email",type:"email",placeholder:"partenaire@entreprise.com",value:t,onChange:N=>r(N.target.value),required:!0,disabled:i,className:"h-12"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"password",children:"Mot de passe"}),o.jsx(pe,{id:"password",type:"password",placeholder:"",value:n,onChange:N=>s(N.target.value),required:!0,disabled:i,className:"h-12"})]}),o.jsx(G,{type:"submit",disabled:i,className:"w-full h-12 bg-orange-600 hover:bg-orange-700 text-white font-medium",children:i?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"w-4 h-4 mr-2 animate-spin"}),"Connexion..."]}):"Se connecter"})]}),o.jsx("p",{className:"text-center text-sm text-gray-400 mt-8",children:"Accs rserv aux partenaires agrs"})]})]})})})},US=()=>{const e=Te(),[t,r]=p.useState(!0),[n,s]=p.useState([]),[i,a]=p.useState(null);p.useEffect(()=>{let m=!0;return(async()=>{try{r(!0);const{data:{user:v},error:y}=await T.auth.getUser();if(y||!v){e("/partner/login");return}const{data:x,error:b}=await T.from("partners").select("id, company_name, email, phone, active").eq("user_id",v.id).single();if(b||!x){P.warn("PartnerMissionsPage: utilisateur non-partenaire",{userId:v.id}),await T.auth.signOut(),e("/partner/login");return}if(!x.active){await T.auth.signOut(),B({title:"Compte dsactiv",description:"Votre compte partenaire est dsactiv.",variant:"destructive"}),e("/partner/login");return}if(!m)return;a(x);const{data:w,error:j}=await T.from("missions").select("*").eq("partner_id",x.id).eq("status","pending").order("created_at",{ascending:!1});if(j)throw j;if(!m)return;s(w||[])}catch(v){P.error("PartnerMissionsPage load error",{err:v.message}),B({title:"Erreur",description:"Impossible de charger les missions.",variant:"destructive"})}finally{m&&r(!1)}})(),()=>{m=!1}},[e]);const l=new Date;l.setHours(0,0,0,0);const c=n.filter(m=>m.is_blocking),u=n.filter(m=>{if(m.is_blocking)return!1;const g=new Date(m.created_at);return g.setHours(0,0,0,0),g.getTime()>=l.getTime()}),f=n.filter(m=>{if(m.is_blocking)return!1;const g=new Date(m.created_at);return g.setHours(0,0,0,0),g.getTime()<l.getTime()}),d=n.length;if(t)return o.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:o.jsx(De,{className:"w-8 h-8 text-blue-600 animate-spin"})});const h=(m,g,v,y)=>g.length===0?null:o.jsxs("div",{className:"mb-5",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx("span",{className:`w-2.5 h-2.5 rounded-full ${v}`}),o.jsx("span",{className:"text-xs font-bold text-gray-400 tracking-widest",children:m})]}),o.jsx("div",{className:"space-y-3",children:g.map(x=>{var j;const b=x.client_name||((j=x.title)==null?void 0:j.replace("Mission pour ",""))||"Client",w=x.description||x.step_name||"";return o.jsxs("div",{className:"flex items-center bg-gray-100/60 rounded-2xl overflow-hidden cursor-pointer active:bg-gray-200/60 transition-colors",onClick:()=>e(`/partner/missions/${x.id}`),children:[o.jsx("div",{className:`w-1.5 self-stretch ${y} rounded-l-2xl shrink-0`}),o.jsxs("div",{className:"flex-1 flex items-center gap-3 p-4 pl-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 truncate",children:b}),o.jsx("div",{className:"text-sm text-gray-500 truncate mt-0.5",children:w})]}),o.jsx(Gn,{className:"w-4 h-4 text-gray-300 shrink-0"})]})]},x.id)})})]});return o.jsxs("div",{className:"px-4 pt-6 pb-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-black text-gray-900",children:"Missions"}),o.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Command par Charly"})]}),d>0&&o.jsxs("div",{className:"relative mt-1",children:[o.jsx(Wd,{className:"w-6 h-6 text-gray-400"}),o.jsx("span",{className:"absolute -top-1.5 -right-1.5 w-5 h-5 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center",children:d})]})]}),n.length===0?o.jsxs("div",{className:"text-center py-16",children:[o.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(Wd,{className:"w-8 h-8 text-gray-300"})}),o.jsx("p",{className:"text-gray-400 font-medium",children:"Aucune mission en cours"}),o.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Vos nouvelles missions apparatront ici."})]}):o.jsxs(o.Fragment,{children:[h("CRITIQUE",c,"bg-red-500","bg-red-500"),h("AUJOURD'HUI",u,"bg-orange-400","bg-orange-400"),h("AUTRES",f,"bg-gray-300","bg-gray-300")]})]})},jt=[];for(let e=0;e<256;++e)jt.push((e+256).toString(16).slice(1));function Pse(e,t=0){return(jt[e[t+0]]+jt[e[t+1]]+jt[e[t+2]]+jt[e[t+3]]+"-"+jt[e[t+4]]+jt[e[t+5]]+"-"+jt[e[t+6]]+jt[e[t+7]]+"-"+jt[e[t+8]]+jt[e[t+9]]+"-"+jt[e[t+10]]+jt[e[t+11]]+jt[e[t+12]]+jt[e[t+13]]+jt[e[t+14]]+jt[e[t+15]]).toLowerCase()}let Hm;const Tse=new Uint8Array(16);function kse(){if(!Hm){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Hm=crypto.getRandomValues.bind(crypto)}return Hm(Tse)}const Ase=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),VS={randomUUID:Ase};function Rse(e,t,r){var s;e=e||{};const n=e.random??((s=e.rng)==null?void 0:s.call(e))??kse();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(r=r||0,r<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let i=0;i<16;++i)t[r+i]=n[i];return t}return Pse(n)}function Ise(e,t,r){return VS.randomUUID&&!t&&!e?VS.randomUUID():Rse(e,t,r)}function LD({projectType:e,prospectId:t,organizationId:r=null,enabled:n=!0}){const[s,i]=p.useState([]),[a,l]=p.useState(!1),[c,u]=p.useState(!1),[f,d]=p.useState(!1),[h,m]=p.useState(null),g=p.useCallback(async()=>{if(!(!e||!n))try{l(!0),m(null);let x=T.from("project_files").select("*").eq("project_type",e).order("created_at",{ascending:!1});t&&(x=x.eq("prospect_id",t));const{data:b,error:w}=await x;if(w)throw w;i(b||[])}catch(x){P.error("Error fetching project files:",x),m(x.message)}finally{l(!1)}},[e,t,n]);p.useEffect(()=>{if(!e||!n)return;g();const x=T.channel(`project-files-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"project_files",filter:`project_type=eq.${e}`},b=>{P.debug("Realtime event",{eventType:b.eventType}),i(w=>{var N;const{eventType:j,new:_,old:S}=b;if(j==="INSERT")return[_,...w];if(j==="DELETE"){const E=(S==null?void 0:S.id)||((N=b.old)==null?void 0:N.id);return w.filter(C=>C.id!==E)}return j==="UPDATE"?w.map(E=>E.id===_.id?_:E):w})}).subscribe();return()=>{T.removeChannel(x)}},[e,n,g]);const v=p.useCallback(async({file:x,uploadedBy:b,fieldLabel:w=null})=>{if(!(!x||!e))try{u(!0),m(null);const j=x.name.split(".").pop(),_=`${Ise()}.${j}`,S=`${e}/${_}`,{error:N}=await T.storage.from("project-files").upload(S,x);if(N)throw N;const{data:E,error:C}=await T.from("project_files").insert([{project_type:e,prospect_id:t||null,organization_id:r||null,file_name:x.name,file_type:x.type,file_size:x.size,storage_path:S,uploaded_by:b||null,field_label:w}]).select().single();if(C)throw C;return E}catch(j){throw P.error("Error uploading file:",j),m(j.message),j}finally{u(!1)}},[e,t]),y=p.useCallback(async(x,b)=>{if(!(!x||!b))try{d(!0),m(null);const{error:w}=await T.storage.from("project-files").remove([b]);if(w)throw w;const{error:j}=await T.from("project_files").delete().eq("id",x);if(j)throw j}catch(w){throw P.error("Error deleting file:",w),m(w.message),w}finally{d(!1)}},[]);return{files:s,loading:a,uploading:c,deleting:f,error:h,uploadFile:v,deleteFile:y,refetch:g}}const Ose=()=>{const{missionId:e}=ma(),t=Te(),[r,n]=p.useState(!0),[s,i]=p.useState(null),[a,l]=p.useState(null),[c,u]=p.useState({}),[f,d]=p.useState(""),[h,m]=p.useState(!1),[g,v]=p.useState({}),[y,x]=p.useState({}),[b,w]=p.useState([]),{uploadFile:j,uploading:_}=LD({projectType:(s==null?void 0:s.project_type)||"",prospectId:(s==null?void 0:s.prospect_id)||null,enabled:!!s});p.useEffect(()=>{let R=!0;return(async()=>{var z;try{n(!0);const{data:{user:F},error:V}=await T.auth.getUser();if(V||!F){t("/partner/login");return}const{data:I,error:D}=await T.from("partners").select("id, active").eq("user_id",F.id).single();if(D||!I){await T.auth.signOut(),t("/partner/login");return}if(!I.active){await T.auth.signOut(),t("/partner/login");return}const{data:$,error:M}=await T.from("missions").select("*").eq("id",e).single();if(M||!$){B({title:"Erreur",description:"Mission introuvable.",variant:"destructive"}),t("/partner/missions");return}if($.partner_id!==I.id){P.warn("Accs mission non autoris",{missionId:e,userId:F.id}),await T.auth.signOut(),t("/partner/login");return}if(!R)return;i($);const{data:W}=await T.from("prospects").select("id, name, email, phone, address").eq("id",$.prospect_id).maybeSingle();if(R&&l(W||null),((z=$.form_ids)==null?void 0:z.length)>0){const{data:X}=await T.from("forms").select("*").in("form_id",$.form_ids);if(X&&R){const Z={};X.forEach(oe=>{Z[oe.form_id]=oe}),v(Z)}const{data:me,error:se}=await T.from("client_form_panels").select("*").eq("prospect_id",$.prospect_id).eq("project_type",$.project_type).eq("filled_by_role","partner").in("form_id",$.form_ids);if(se)P.error("Erreur chargement panels partenaire",{error:se.message});else if(me&&R){const Z=me.map(H=>({id:H.id,panelId:H.panel_id,prospectId:H.prospect_id,projectType:H.project_type,formId:H.form_id,status:H.status,filledByRole:H.filled_by_role,formData:H.form_data||{},rejectionReason:H.rejection_reason||null,lastSubmittedAt:H.last_submitted_at}));w(Z);const oe={};Z.forEach(H=>{H.formData&&Object.keys(H.formData).length>0&&(oe[H.panelId]={...H.formData})}),Object.keys(oe).length>0&&(x(oe),P.debug("Drafts pr-remplis depuis panels existants",{count:Object.keys(oe).length})),P.debug("Panels partenaire chargs",{count:Z.length})}}const U=$.questions||$.payload||null;if(U&&typeof U=="object"){const X={};U.forEach((me,se)=>{X[me.id||se]=me.type==="boolean"?null:me.default||""}),u(X)}}catch(F){P.error("PartnerMissionDetail load error",{err:F.message}),B({title:"Erreur",description:"Impossible de charger la mission.",variant:"destructive"}),t("/partner/missions")}finally{R&&n(!1)}})(),()=>{R=!1}},[e,t]);const S=()=>t("/partner/missions"),N=(R,O)=>{u(z=>({...z,[R]:O}))},E=(R,O,z)=>{x(F=>({...F,[R]:{...F[R]||{},[O]:z}}))},C=async R=>{var $,M;const{panelId:O,formId:z}=R,F=g[z],V={...y[O]||{}},I=($=F==null?void 0:F.fields)==null?void 0:$.filter(W=>W.required&&!V[W.id]);if((I==null?void 0:I.length)>0)return{success:!1,error:`Champs manquants dans "${(F==null?void 0:F.title)||"Formulaire"}"`,missingFields:I};try{const W=((M=F==null?void 0:F.fields)==null?void 0:M.filter(U=>U.type==="file"))||[];for(const U of W){const X=V[U.id];if(X&&X instanceof File){if(X.size>10485760)return{success:!1,error:`${U.label}: Fichier trop volumineux (max 10 MB)`};const{data:{user:se}}=await T.auth.getUser(),Z=await j({file:X,uploadedBy:se==null?void 0:se.id,fieldLabel:U.label});Z&&(V[U.id]={id:Z.id,name:Z.file_name,size:Z.file_size,type:Z.file_type,storagePath:Z.storage_path,fieldLabel:U.label},P.debug(" Fichier partenaire upload",{fieldId:U.id,fileName:Z.file_name}))}}}catch(W){return P.error(" Erreur upload fichier partenaire",W),{success:!1,error:`Erreur upload: ${W.message}`}}const{error:D}=await T.from("client_form_panels").update({form_data:V,status:"submitted",last_submitted_at:new Date().toISOString()}).eq("panel_id",O);return D?(console.error("UPDATE PANEL ERROR:",D),{success:!1,error:D.message}):(x(W=>({...W,[O]:V})),{success:!0})},k=async()=>{try{m(!0);const R=b.filter(F=>F.status==="pending"||F.status==="rejected");if(R.length>0){for(const F of R){const V=await C(F);if(!V.success){B({title:"Formulaire incomplet",description:V.error,variant:"destructive"}),m(!1);return}}w(F=>F.map(V=>({...V,status:R.some(I=>I.panelId===V.panelId)?"submitted":V.status,formData:y[V.panelId]||V.formData})))}const O={responses:c,comment:f||null,updated_at:new Date().toISOString(),forms_submitted:b.length},{error:z}=await T.from("missions").update({status:"submitted",partner_notes:JSON.stringify(O),updated_at:new Date().toISOString()}).eq("id",s.id);if(z)throw z;B({title:" Mission soumise",description:"Formulaires envoys. En attente de validation admin.",className:"bg-green-500 text-white"}),t("/partner/preuves")}catch(R){P.error("PartnerMissionDetail handleValidateMission error",{err:R.message}),B({title:"Erreur",description:"Impossible de valider la mission.",variant:"destructive"})}finally{m(!1)}},L=async R=>{try{if(m(!0),R==="blocked"&&(!f||f.trim()==="")){B({title:"Commentaire requis",description:"Veuillez fournir un commentaire.",variant:"destructive"}),m(!1);return}const O={responses:c,comment:f||null,updated_at:new Date().toISOString()},z={status:R,partner_notes:JSON.stringify(O),updated_at:new Date().toISOString()};R==="completed"&&(z.completed_at=new Date().toISOString());const{error:F}=await T.from("missions").update(z).eq("id",s.id);if(F)throw F;if(R==="blocked"&&b.length>0){const V=b.map(D=>D.panelId),{error:I}=await T.from("client_form_panels").update({status:"rejected",rejection_reason:`Mission impossible  ${f}`}).in("panel_id",V);I&&P.error("Erreur mise  jour panels aprs mission impossible",{error:I.message})}B({title:" Enregistr",description:"Votre rponse a t sauvegarde.",className:"bg-green-500 text-white"}),t("/partner/preuves")}catch(O){P.error("PartnerMissionDetail save error",{err:O.message}),B({title:"Erreur",description:"Impossible d'enregistrer la mission.",variant:"destructive"})}finally{m(!1)}},A=R=>{var z;const O={name:(s==null?void 0:s.client_name)||((z=s==null?void 0:s.title)==null?void 0:z.replace("Mission pour ",""))||(a==null?void 0:a.name)||"",phone:(s==null?void 0:s.phone)||(a==null?void 0:a.phone),email:(s==null?void 0:s.email)||(a==null?void 0:a.email),address:(s==null?void 0:s.address)||(a==null?void 0:a.address)};switch(R){case"Appel":O.phone&&(window.location.href=`tel:${O.phone}`);break;case"Mail":O.email&&(window.location.href=`mailto:${O.email}`);break;case"WhatsApp":if(O.phone){const F=O.phone.replace(/[^0-9]/g,"");window.open(`https://wa.me/${F}`,"_blank")}else B({title:"Numro manquant",description:"Ce client n'a pas de numro de tlphone.",variant:"destructive"});break;case"GPS":if(O.address){const F=encodeURIComponent(O.address);/Mac|iPod|iPhone|iPad/.test(navigator.platform)?window.location.href=`maps://?q=${F}`:window.open(`https://www.google.com/maps/search/?api=1&query=${F}`,"_blank")}break}};return r?o.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:o.jsx(De,{className:"w-8 h-8 text-blue-600 animate-spin"})}):s?o.jsx("div",{className:"px-4 pt-4 pb-4",children:o.jsxs("div",{className:"max-w-2xl mx-auto",children:[o.jsxs("header",{className:"mb-6 flex items-center gap-4",children:[o.jsx(G,{variant:"ghost",onClick:S,className:"p-2",children:o.jsx(f0,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s.title}),o.jsx("p",{className:"text-sm text-gray-500",children:s.step_name||s.project_type})]})]}),o.jsxs("section",{className:"bg-white rounded-xl p-4 shadow-sm border mb-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actions rapides"}),o.jsx("div",{className:"flex flex-wrap justify-between gap-2 text-center",children:[{icon:kc,label:"Appel"},{icon:tn,label:"Mail"},{icon:g0,label:"WhatsApp"},{icon:m0,label:"GPS"}].map(({icon:R,label:O})=>o.jsxs("button",{onClick:()=>A(O),className:"flex flex-col items-center space-x-1 transition-colors group text-gray-600 hover:text-blue-600",children:[o.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center bg-gray-100 group-hover:bg-blue-100",children:o.jsx(R,{className:"h-6 w-6"})}),o.jsx("span",{className:"text-xs font-medium",children:O})]},O))})]}),o.jsxs("section",{className:"bg-white rounded-xl p-4 shadow-sm border mb-4",children:[o.jsx(ee,{className:"text-xs text-gray-500",children:"ORDRE EVATIME"}),o.jsx("div",{className:"mt-2 font-medium text-gray-900",children:"Instruction"}),o.jsx("p",{className:"text-sm text-gray-600 mt-2",children:s.description||""})]}),b.length>0&&o.jsxs("section",{className:"bg-white rounded-xl p-4 shadow-sm border mb-4",children:[o.jsx(ee,{className:"text-xs text-gray-500",children:"FORMULAIRES  REMPLIR"}),o.jsx("div",{className:"mt-4 space-y-6",children:b.map(R=>{var D,$;const O=g[R.formId],z=y[R.panelId]||{},F=R.status==="submitted",V=R.status==="approved",I=R.status==="rejected";return o.jsxs("div",{className:"border-t pt-4 first:border-t-0 first:pt-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:(O==null?void 0:O.title)||"Formulaire"}),V&&o.jsx("span",{className:"text-xs px-2 py-1 rounded bg-green-100 text-green-700",children:" Valid"}),F&&!V&&o.jsx("span",{className:"text-xs px-2 py-1 rounded bg-blue-100 text-blue-700",children:" Envoy"}),I&&o.jsx("span",{className:"text-xs px-2 py-1 rounded bg-red-100 text-red-700",children:" Refus"}),R.status==="pending"&&o.jsx("span",{className:"text-xs px-2 py-1 rounded bg-orange-100 text-orange-700",children:"  remplir"})]}),(O==null?void 0:O.description)&&o.jsx("p",{className:"text-sm text-gray-600 mb-4",children:O.description}),I&&R.rejectionReason&&o.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-300 rounded-lg",children:[o.jsx("p",{className:"text-sm font-semibold text-red-800 mb-1",children:" Formulaire refus"}),o.jsxs("p",{className:"text-sm text-red-700",children:[o.jsx("strong",{children:"Raison :"})," ",R.rejectionReason]}),o.jsx("p",{className:"text-xs text-red-600 mt-2",children:"Veuillez corriger et soumettre  nouveau."})]}),(F||V)&&!I&&o.jsxs("div",{className:"space-y-3",children:[(D=O==null?void 0:O.fields)==null?void 0:D.map(M=>{var X;const W=((X=R.formData)==null?void 0:X[M.id])||z[M.id]||"",U=M.type==="file"&&typeof W=="object"&&W.storagePath;return o.jsxs("div",{children:[o.jsx(ee,{className:"text-xs text-gray-500 uppercase",children:M.label}),U?o.jsxs("div",{className:"flex items-center gap-2 mt-1 px-3 py-2 bg-blue-50 rounded border border-blue-200",children:[o.jsx(Ln,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),o.jsx("span",{className:"text-sm text-blue-900 truncate",children:W.name})]}):o.jsx("p",{className:"text-sm text-gray-900 mt-1 px-3 py-2 bg-gray-50 rounded border",children:M.type==="checkbox"?W?" Oui":" Non":W||""})]},M.id)}),F&&o.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded text-center",children:o.jsx("p",{className:"text-sm text-blue-700",children:" Formulaire envoy  En attente de validation admin"})}),V&&o.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded text-center",children:o.jsx("p",{className:"text-sm text-green-700",children:" Formulaire valid par l'admin"})})]}),(R.status==="pending"||I)&&o.jsx("div",{className:"space-y-4",children:($=O==null?void 0:O.fields)==null?void 0:$.map(M=>{var W;return o.jsxs("div",{children:[o.jsxs(ee,{className:"mb-2 block",children:[M.label,M.required&&o.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),M.type==="text"&&o.jsx(pe,{type:"text",value:z[M.id]||"",onChange:U=>E(R.panelId,M.id,U.target.value),placeholder:M.placeholder||""}),M.type==="textarea"&&o.jsx("textarea",{value:z[M.id]||"",onChange:U=>E(R.panelId,M.id,U.target.value),placeholder:M.placeholder||"",className:"w-full px-3 py-2 border rounded min-h-[80px]"}),M.type==="select"&&o.jsxs("select",{value:z[M.id]||"",onChange:U=>E(R.panelId,M.id,U.target.value),className:"w-full px-3 py-2 border rounded",children:[o.jsx("option",{value:"",children:"-- Slectionner --"}),(W=M.options)==null?void 0:W.map(U=>o.jsx("option",{value:U,children:U},U))]}),M.type==="number"&&o.jsx(pe,{type:"number",value:z[M.id]||"",onChange:U=>E(R.panelId,M.id,U.target.value),placeholder:M.placeholder||""}),M.type==="date"&&o.jsx(pe,{type:"date",value:z[M.id]||"",onChange:U=>E(R.panelId,M.id,U.target.value)}),M.type==="checkbox"&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"checkbox",checked:z[M.id]||!1,onChange:U=>E(R.panelId,M.id,U.target.checked),className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:M.placeholder})]}),M.type==="file"&&(()=>{const U=z[M.id],X=U instanceof File||U&&typeof U=="object"&&U.storagePath;return o.jsxs("div",{className:"space-y-2",children:[X&&o.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[o.jsx(Ln,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-medium text-blue-900 truncate",children:(U instanceof File,U.name)}),o.jsx("p",{className:"text-xs text-blue-600",children:U instanceof File?`${(U.size/1024).toFixed(1)} KB`:U.size?`${(U.size/1024).toFixed(1)} KB`:""})]}),o.jsx("button",{type:"button",onClick:()=>E(R.panelId,M.id,null),className:"p-1 hover:bg-red-100 rounded-full transition-colors",children:o.jsx(es,{className:"h-4 w-4 text-red-600"})})]}),o.jsxs("label",{htmlFor:`file-${R.panelId}-${M.id}`,className:`flex items-center justify-center gap-2 p-3 border-2 border-dashed rounded-lg cursor-pointer transition-colors ${X?"border-gray-300 bg-gray-50 hover:border-gray-400":"border-blue-300 bg-blue-50 hover:border-blue-400 hover:bg-blue-100"}`,children:[o.jsx(mP,{className:"h-5 w-5 text-blue-600"}),o.jsx("span",{className:"text-sm font-medium text-blue-900",children:X?"Changer le fichier":"Choisir un fichier"})]}),o.jsx("input",{id:`file-${R.panelId}-${M.id}`,type:"file",onChange:me=>{var Z;const se=(Z=me.target.files)==null?void 0:Z[0];se&&E(R.panelId,M.id,se)},className:"hidden",accept:".pdf,.png,.jpg,.jpeg,.doc,.docx"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Formats: PDF, PNG, JPG, DOCX (max 10 MB)"})]})})()]},M.id)})})]},R.panelId)})})]}),s.questions||s.payload?o.jsxs("section",{className:"bg-white rounded-xl p-4 shadow-sm border mb-4",children:[o.jsx(ee,{className:"text-xs text-gray-500",children:"Merci de confirmer les lments suivants"}),o.jsx("div",{className:"mt-3 space-y-3",children:(s.questions||s.payload).map((R,O)=>o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"font-medium text-gray-900",children:R.label}),R.type==="boolean"?o.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[o.jsx("button",{onClick:()=>N(R.id||O,!0),className:`px-3 py-2 rounded ${c[R.id||O]===!0?"bg-green-50 border":"bg-gray-50"}`,children:"Oui"}),o.jsx("button",{onClick:()=>N(R.id||O,!1),className:`px-3 py-2 rounded ${c[R.id||O]===!1?"bg-red-50 border":"bg-gray-50"}`,children:"Non"})]}):o.jsx("input",{type:"text",value:c[R.id||O]||"",onChange:z=>N(R.id||O,z.target.value),className:"w-full px-3 py-2 border rounded"})]},R.id||O))})]}):null,o.jsxs("section",{className:"bg-white rounded-xl p-4 shadow-sm border mb-4",children:[o.jsx(ee,{className:"text-xs text-gray-500",children:"Commentaire (optionnel)"}),o.jsx("textarea",{value:f,onChange:R=>d(R.target.value),className:"w-full mt-2 px-3 py-2 border rounded min-h-[80px]"}),o.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Le commentaire devient requis si vous marquez la mission comme impossible."})]}),o.jsxs("button",{onClick:()=>t("/partner/charly",{state:{openChat:{prospectId:s.prospect_id,projectType:s.project_type,prospectName:(a==null?void 0:a.name)||s.client_name||"Client"}}}),className:"w-full flex items-center justify-center gap-2 py-3 mb-4 text-orange-600 bg-orange-50 border border-orange-200 rounded-xl hover:bg-orange-100 transition-colors",children:[o.jsx(qf,{className:"w-4 h-4"}),o.jsx("span",{className:"text-sm font-medium",children:"Signaler un problme"})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(G,{variant:"ghost",onClick:()=>L("blocked"),disabled:h,className:"flex-1 border",children:"IMPOSSIBLE  RALISER"}),o.jsx(G,{onClick:k,disabled:h,className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white",children:h?"Envoi en cours...":"VALIDER LA MISSION"})]})]})}):null},Dse=()=>{const e=Te(),[t,r]=p.useState(!0),[n,s]=p.useState([]),[i,a]=p.useState([]),[l,c]=p.useState(""),[u,f]=p.useState(null);p.useEffect(()=>{(async()=>{try{const{data:{user:y}}=await T.auth.getUser();if(!y)return;const{data:x}=await T.from("partners").select("id").eq("user_id",y.id).single();if(!x)return;const{data:b}=await T.from("missions").select("*").eq("partner_id",x.id).order("created_at",{ascending:!1});if(a(b||[]),!(b!=null&&b.length)){s([]),r(!1);return}const w=[...new Set(b.map(_=>_.prospect_id).filter(Boolean))],{data:j}=await T.from("prospects").select("id, name, email, phone, address").in("id",w);s(j||[])}catch(y){P.error("PartnerContactsPage load error",{err:y.message})}finally{r(!1)}})()},[]);const d=n.filter(v=>{if(!l)return!0;const y=l.toLowerCase();return(v.name||"").toLowerCase().includes(y)||(v.email||"").toLowerCase().includes(y)}),h=v=>i.filter(y=>y.prospect_id===v),m=v=>{const y=h(v.id);y.length===1?e(`/partner/missions/${y[0].id}`):f(x=>x===v.id?null:v.id)},g=v=>{switch(v){case"pending":return{text:" faire",cls:"bg-orange-100 text-orange-700"};case"completed":return{text:"Valide",cls:"bg-green-100 text-green-700"};case"submitted":return{text:"En attente",cls:"bg-blue-100 text-blue-700"};case"blocked":return{text:"Refuse",cls:"bg-red-100 text-red-700"};default:return{text:v,cls:"bg-gray-100 text-gray-600"}}};return t?o.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:o.jsx(De,{className:"w-8 h-8 text-blue-600 animate-spin"})}):o.jsxs("div",{className:"px-4 pt-6 pb-4",children:[o.jsx("h1",{className:"text-2xl font-black text-gray-900",children:"Annuaire"}),o.jsx("p",{className:"text-sm text-gray-400 italic mt-1",children:"Consultation seule"}),o.jsxs("div",{className:"mt-4 relative",children:[o.jsx(Zo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:l,onChange:v=>c(v.target.value),placeholder:"Rechercher un client ou contact...",className:"w-full pl-10 pr-4 py-3 bg-gray-100 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-200"})]}),o.jsx("div",{className:"mt-5 space-y-3",children:d.length===0?o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-400",children:"Aucun contact trouv."})}):d.map(v=>{const y=(v.name||"?")[0].toUpperCase(),x=v.email||v.phone||"",b=h(v.id),w=b.length>1,j=u===v.id;return o.jsxs("div",{className:"bg-gray-100/60 rounded-2xl overflow-hidden",children:[o.jsxs("div",{onClick:()=>m(v),className:"flex items-center gap-3 p-4 cursor-pointer active:bg-gray-200/60 transition-colors",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-bold text-gray-600 shrink-0",children:y}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-semibold text-gray-900 truncate",children:v.name||""}),o.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wide truncate",children:x}),!w&&b.length===1&&o.jsxs("div",{className:"text-xs text-gray-500 mt-0.5 truncate",children:[o.jsx("span",{className:"text-blue-600 font-semibold",children:b[0].project_type}),b[0].step_name&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-gray-400 mx-1",children:""}),b[0].step_name]})]})]}),w&&o.jsx("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 shrink-0",children:b.length}),w?o.jsx(Ds,{className:`w-4 h-4 text-gray-300 shrink-0 transition-transform duration-200 ${j?"rotate-180":""}`}):o.jsx(Gn,{className:"w-4 h-4 text-gray-300 shrink-0"})]}),w&&j&&o.jsx("div",{className:"px-3 pb-3 space-y-2",children:b.map(_=>{const S=g(_.status),N=_.step_name||_.description||"";return o.jsxs("div",{className:"flex items-center gap-3 bg-white rounded-xl p-3 cursor-pointer active:bg-gray-50 transition-colors",onClick:()=>e(`/partner/missions/${_.id}`),children:[o.jsx("div",{className:"flex-1 min-w-0",children:o.jsxs("div",{className:"text-sm font-medium text-gray-900 truncate",children:[o.jsx("span",{className:"text-blue-600 font-semibold",children:_.project_type}),o.jsx("span",{className:"text-gray-400 mx-1",children:""}),N]})}),o.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full ${S.cls} shrink-0`,children:S.text}),o.jsx(Gn,{className:"w-4 h-4 text-gray-300 shrink-0"})]},_.id)})})]},v.id)})})]})};function $se(e=null,t=null,r=null,n=null){const[s,i]=p.useState([]),[a,l]=p.useState(!0),[c,u]=p.useState(null),f=m=>({id:m.id,sender:m.sender,channel:m.channel,partnerId:m.partner_id||null,text:m.text,file:m.file,formId:m.form_id,completedFormId:m.completed_form_id,promptId:m.prompt_id,stepIndex:m.step_index,relatedMessageTimestamp:m.related_message_timestamp,metadata:m.metadata||null,read:m.read,timestamp:m.created_at,createdAt:m.created_at});return p.useEffect(()=>{if(!e||!t){l(!1);return}(async()=>{try{l(!0);let x=T.from("chat_messages").select("*").eq("prospect_id",e).eq("project_type",t);r&&(x=x.eq("channel",r)),n&&r==="partner"&&(x=x.eq("partner_id",n));const{data:b,error:w}=await x.order("created_at",{ascending:!0});if(w)throw w;const j=(b||[]).map(f);i(j),u(null)}catch(x){P.error(" Error loading chat messages:",x),u(x.message)}finally{l(!1)}})();const g=r?`-${r}`:"-all",v=n?`-p${n.slice(0,8)}`:"",y=T.channel(`chat-${e}-${t}${g}${v}-${Math.random().toString(36).slice(2)}`).on("postgres_changes",{event:"*",schema:"public",table:"chat_messages",filter:`prospect_id=eq.${e}`},x=>{if(!(x.new&&x.new.project_type!==t)&&!(r&&x.new&&x.new.channel!==r)&&!(n&&r==="partner"&&x.new&&x.new.partner_id!==n))if(x.eventType==="INSERT"){const b=f(x.new);i(w=>w.some(j=>j.id===b.id)?w:[...w,b])}else if(x.eventType==="UPDATE"){const b=f(x.new);i(w=>w.map(j=>j.id===b.id?b:j))}else x.eventType==="DELETE"&&i(b=>b.filter(w=>w.id!==x.old.id))}).subscribe();return()=>{T.removeChannel(y)}},[e,t,r,n]),{messages:s,loading:a,error:c,sendMessage:async m=>{try{if(s.some(b=>m.promptId?b.promptId===m.promptId&&b.stepIndex===m.stepIndex&&b.text===m.text&&b.sender===m.sender:m.completedFormId?b.completedFormId===m.completedFormId&&b.sender===m.sender&&b.relatedMessageTimestamp===m.relatedMessageTimestamp:!1))return{success:!0,duplicate:!0};const v={prospect_id:e,project_type:t,sender:m.sender,text:m.text||null,file:m.file||null,form_id:m.formId||null,completed_form_id:m.completedFormId||null,prompt_id:m.promptId||null,step_index:m.stepIndex!==void 0?m.stepIndex:null,related_message_timestamp:m.relatedMessageTimestamp||null,channel:m.channel||r||"client",metadata:m.metadata||null,partner_id:m.partnerId||n||null,read:!1},{data:y,error:x}=await T.from("chat_messages").insert([v]).select().single();if(x)throw x;return{success:!0,data:f(y)}}catch(g){return P.error(" Error sending message:",g),{success:!1,error:g.message}}},markAsRead:async m=>{try{const{error:g}=await T.from("chat_messages").update({read:!0}).in("id",m);if(g)throw g;return{success:!0}}catch(g){return P.error(" Error marking messages as read:",g),{success:!1,error:g.message}}}}}const Mse=({prospectId:e,projectType:t,prospectName:r,partnerId:n,onBack:s})=>{const{messages:i,loading:a,sendMessage:l,markAsRead:c}=$se(e,t,"partner",n),{uploadFile:u,uploading:f}=LD({projectType:t,prospectId:e,enabled:!0}),[d,h]=p.useState(""),[m,g]=p.useState(!1),[v,y]=p.useState(!1),x=p.useRef(null),b=p.useRef(null),w=p.useRef(null),j=p.useRef(null),_=p.useRef(null);p.useEffect(()=>{requestAnimationFrame(()=>{var A;(A=x.current)==null||A.scrollIntoView({behavior:"smooth",block:"end"})})},[i]);const S=p.useCallback(()=>{setTimeout(()=>{var A,R;(A=x.current)==null||A.scrollIntoView({behavior:"smooth",block:"end"}),(R=b.current)==null||R.scrollIntoView({behavior:"smooth",block:"nearest"})},300)},[]);p.useEffect(()=>{if(!i.length)return;const A=i.filter(R=>R.sender!=="partner"&&!R.read).map(R=>R.id);A.length>0&&c(A)},[i]),p.useEffect(()=>{if(!v)return;const A=()=>y(!1);return document.addEventListener("click",A),()=>document.removeEventListener("click",A)},[v]);const N=async A=>{if(!A)return;const R=10*1024*1024;if(A.size>R){B({title:" Fichier trop volumineux",description:"Maximum 10 MB.",variant:"destructive"});return}g(!0);try{const{data:{user:O}}=await T.auth.getUser(),z=await u({file:A,uploadedBy:O==null?void 0:O.id,fieldLabel:"chat-partner"});if(z){const F={id:z.id,name:z.file_name,size:z.file_size,type:z.file_type,storagePath:z.storage_path},V=A.type.startsWith("image/");(await l({sender:"partner",channel:"partner",text:V?" Photo":` ${A.name}`,file:F,partnerId:n})).success&&B({title:" Envoy",description:A.name,className:"bg-green-500 text-white"})}}catch(O){P.error("PartnerChat: erreur upload fichier",{err:O.message}),B({title:"Erreur",description:"Impossible d'envoyer le fichier.",variant:"destructive"})}finally{g(!1),y(!1)}},E=async()=>{if(!(!d.trim()||m)){g(!0);try{(await l({sender:"partner",channel:"partner",text:d.trim(),partnerId:n})).success?h(""):B({title:"Erreur",description:"Message non envoy.",variant:"destructive"})}catch(A){P.error("PartnerCharlyPage: erreur envoi message",{err:A.message}),B({title:"Erreur",description:A.message,variant:"destructive"})}finally{g(!1)}}},C=async A=>{if(A!=null&&A.storagePath)try{const{data:R,error:O}=await T.storage.from("project-files").createSignedUrl(A.storagePath,3600);if(O)throw O;window.open(R.signedUrl,"_blank")}catch{B({title:"Erreur",description:"Impossible d'ouvrir le fichier.",variant:"destructive"})}},[k,L]=p.useState({});return p.useEffect(()=>{const A=async()=>{const R=i.filter(z=>{var F,V,I;return((F=z.file)==null?void 0:F.storagePath)&&((I=(V=z.file)==null?void 0:V.type)==null?void 0:I.startsWith("image/"))}),O={};for(const z of R)if(!k[z.file.storagePath])try{const{data:F}=await T.storage.from("project-files").createSignedUrl(z.file.storagePath,3600);F!=null&&F.signedUrl&&(O[z.file.storagePath]=F.signedUrl)}catch{}Object.keys(O).length>0&&L(z=>({...z,...O}))};i.length>0&&A()},[i]),o.jsxs("div",{className:"fixed inset-0 bottom-16 flex flex-col bg-white z-40",style:{height:"calc(100dvh - 4rem)",top:0},children:[o.jsxs("div",{className:"px-4 pt-4 pb-3 flex items-center gap-3 border-b border-gray-200 shrink-0",children:[o.jsx("button",{onClick:s,className:"p-1.5 rounded-full hover:bg-gray-100 transition-colors",children:o.jsx(f0,{className:"w-5 h-5 text-gray-600"})}),o.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-900 flex items-center justify-center text-white font-bold text-sm",children:"C"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h2",{className:"text-sm font-bold text-gray-900 truncate",children:r}),o.jsx("p",{className:"text-xs text-blue-600 font-semibold uppercase tracking-wide",children:t})]})]}),o.jsxs("div",{className:"flex-1 px-4 py-4 overflow-y-auto overscroll-contain",children:[a?o.jsx("div",{className:"flex items-center justify-center h-32",children:o.jsx(De,{className:"w-6 h-6 animate-spin text-gray-400"})}):i.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-gray-400",children:[o.jsx(g0,{className:"w-10 h-10 mb-2"}),o.jsx("p",{className:"text-sm",children:"Aucun message. Commencez la conversation !"})]}):i.map(A=>{var V,I,D;const R=A.sender==="partner",O=(V=A.file)==null?void 0:V.storagePath,z=O&&((D=(I=A.file)==null?void 0:I.type)==null?void 0:D.startsWith("image/")),F=z?k[A.file.storagePath]:null;return o.jsxs("div",{className:`flex items-end gap-2 mb-3 ${R?"justify-end":"justify-start"}`,children:[!R&&o.jsx("div",{className:"w-7 h-7 rounded-full bg-gray-900 flex items-center justify-center text-white text-xs font-bold shrink-0",children:"C"}),o.jsxs("div",{className:`max-w-[75%] rounded-2xl overflow-hidden ${R?"bg-blue-600 text-white rounded-br-none":"bg-gray-100 text-gray-900 rounded-bl-none"}`,children:[z&&F&&o.jsx("button",{onClick:()=>C(A.file),className:"block w-full",children:o.jsx("img",{src:F,alt:A.file.name,className:"w-full max-h-52 object-cover",loading:"lazy"})}),O&&!z&&o.jsxs("button",{onClick:()=>C(A.file),className:`flex items-center gap-2 px-4 pt-3 pb-1 w-full text-left ${R?"hover:bg-blue-700":"hover:bg-gray-200"} transition-colors`,children:[o.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center shrink-0 ${R?"bg-blue-500":"bg-gray-300"}`,children:o.jsx(Ln,{className:"w-5 h-5"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-medium truncate",children:A.file.name}),o.jsxs("p",{className:`text-xs ${R?"text-blue-200":"text-gray-400"}`,children:[(A.file.size/1024).toFixed(0)," KB"]})]}),o.jsx(E3,{className:`w-4 h-4 shrink-0 ${R?"text-blue-200":"text-gray-400"}`})]}),o.jsxs("div",{className:"px-4 py-2.5",children:[(!O||!z)&&o.jsx("p",{className:"text-sm leading-relaxed",children:A.text}),o.jsx("p",{className:`text-xs mt-1 ${R?"text-blue-200":"text-gray-400"}`,children:UA(new Date(A.timestamp),{addSuffix:!0,locale:VA})})]})]}),R&&o.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs font-bold shrink-0",children:"P"})]},A.id)}),o.jsx("div",{ref:x})]}),o.jsxs("div",{className:"px-3 pb-3 pt-2 border-t border-gray-100 bg-white shrink-0",ref:b,children:[v&&o.jsxs("div",{className:"flex gap-4 justify-center py-3 mb-2 bg-gray-50 rounded-2xl",onClick:A=>A.stopPropagation(),children:[o.jsxs("button",{onClick:()=>{var A;return(A=_.current)==null?void 0:A.click()},className:"flex flex-col items-center gap-1.5",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-green-500 flex items-center justify-center text-white shadow-md",children:o.jsx(y3,{className:"w-6 h-6"})}),o.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Photo"})]}),o.jsxs("button",{onClick:()=>{var A;return(A=j.current)==null?void 0:A.click()},className:"flex flex-col items-center gap-1.5",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-500 flex items-center justify-center text-white shadow-md",children:o.jsx(ad,{className:"w-6 h-6"})}),o.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Galerie"})]}),o.jsxs("button",{onClick:()=>{var A;return(A=w.current)==null?void 0:A.click()},className:"flex flex-col items-center gap-1.5",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center text-white shadow-md",children:o.jsx(Ln,{className:"w-6 h-6"})}),o.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Fichier"})]})]}),o.jsx("input",{ref:_,type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:A=>{var R;return((R=A.target.files)==null?void 0:R[0])&&N(A.target.files[0])}}),o.jsx("input",{ref:j,type:"file",accept:"image/*",className:"hidden",onChange:A=>{var R;return((R=A.target.files)==null?void 0:R[0])&&N(A.target.files[0])}}),o.jsx("input",{ref:w,type:"file",accept:"*/*",className:"hidden",onChange:A=>{var R;return((R=A.target.files)==null?void 0:R[0])&&N(A.target.files[0])}}),o.jsxs("form",{onSubmit:A=>{A.preventDefault(),E()},autoComplete:"off",className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:A=>{A.stopPropagation(),y(!v)},disabled:m||f,className:`w-10 h-10 rounded-full flex items-center justify-center shrink-0 transition-all ${v?"bg-gray-900 text-white rotate-45":"bg-gray-200 text-gray-600 hover:bg-gray-300"}`,children:o.jsx(hr,{className:"w-5 h-5"})}),o.jsx("div",{className:"flex-1 flex items-center gap-2 bg-gray-100 rounded-full px-4 py-2.5",children:o.jsx("input",{type:"text",name:"chat-message-input",id:"chat-message-input",value:d,onChange:A=>h(A.target.value),onFocus:S,enterKeyHint:"send",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false","data-form-type":"other","data-lpignore":"true","aria-autocomplete":"none",placeholder:"crire au bureau...",className:"flex-1 bg-transparent text-base focus:outline-none",style:{fontSize:"16px"},disabled:m||f})}),o.jsx("button",{type:"submit",disabled:m||f||!d.trim(),className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center text-white shrink-0 disabled:opacity-40 transition-opacity",children:m||f?o.jsx(De,{className:"w-5 h-5 animate-spin"}):o.jsx(fP,{className:"w-5 h-5"})})]})]})]})},Lse=()=>{const e=Te(),t=Ht(),[r,n]=p.useState(!0),[s,i]=p.useState([]),[a,l]=p.useState(null),[c,u]=p.useState(null),[f,d]=p.useState(""),[h,m]=p.useState(!1);p.useEffect(()=>{var x;if((x=t.state)!=null&&x.openChat&&!a){const{prospectId:b,projectType:w,prospectName:j}=t.state.openChat;l({prospectId:b,projectType:w,prospectName:j}),window.history.replaceState({},"")}},[t.state]),p.useEffect(()=>{let x=!0;return(async()=>{try{n(!0);const{data:{user:w},error:j}=await T.auth.getUser();if(j||!w){e("/partner/login");return}const{data:_,error:S}=await T.from("partners").select("id, active").eq("user_id",w.id).single();if(S||!_||!_.active){e("/partner/login");return}u(_.id);const{data:N,error:E}=await T.from("missions").select("id, prospect_id, project_type, title, status, client_name, step_name, created_at").eq("partner_id",_.id).order("created_at",{ascending:!1});if(E)throw E;if(!x)return;const C=new Set,k=[];for(const A of N||[]){const R=`${A.prospect_id}__${A.project_type}`;C.has(R)||(C.add(R),k.push({prospectId:A.prospect_id,projectType:A.project_type,prospectName:A.client_name||"Client",stepName:A.step_name,missionTitle:A.title,missionId:A.id,status:A.status,createdAt:A.created_at}))}const L=await Promise.all(k.map(async A=>{const{count:R,error:O}=await T.from("chat_messages").select("id",{count:"exact",head:!0}).eq("prospect_id",A.prospectId).eq("project_type",A.projectType).eq("channel","partner").eq("partner_id",_.id).neq("sender","partner").eq("read",!1),{data:z}=await T.from("chat_messages").select("created_at, text").eq("prospect_id",A.prospectId).eq("project_type",A.projectType).eq("channel","partner").eq("partner_id",_.id).order("created_at",{ascending:!1}).limit(1).single();return{...A,unreadCount:O?0:R||0,lastMessageAt:(z==null?void 0:z.created_at)||A.createdAt||null,lastMessagePreview:(z==null?void 0:z.text)||null}}));L.sort((A,R)=>new Date(R.lastMessageAt||0)-new Date(A.lastMessageAt||0)),i(L)}catch(w){P.error("PartnerCharlyPage load error",{err:w.message}),B({title:"Erreur",description:"Impossible de charger les conversations.",variant:"destructive"})}finally{x&&n(!1)}})(),()=>{x=!1}},[e,a]);const g=7*24*60*60*1e3,v=s.filter(x=>{if(f.trim()){const b=f.toLowerCase(),w=x.prospectName.toLowerCase().includes(b),j=x.projectType.toLowerCase().includes(b),_=(x.stepName||"").toLowerCase().includes(b);if(!w&&!j&&!_)return!1}if(!h){const b=x.unreadCount>0,w=x.lastMessageAt?new Date(x.lastMessageAt):null,j=w&&Date.now()-w.getTime()<g;if(!b&&!j)return!1}return!0}),y=s.length-v.length;return a?o.jsx(Mse,{prospectId:a.prospectId,projectType:a.projectType,prospectName:a.prospectName,partnerId:c,onBack:()=>l(null)}):o.jsxs("div",{className:"flex flex-col h-full min-h-[calc(100vh-5rem)]",children:[o.jsxs("div",{className:"px-4 pt-6 pb-3 flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-900 flex items-center justify-center text-white font-bold text-sm",children:"C"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Charly"}),o.jsx("p",{className:"text-xs text-blue-600 font-bold tracking-wide uppercase",children:"Assistant Direction"})]})]}),o.jsx("div",{className:"px-4 pb-2",children:o.jsxs("div",{className:"relative",children:[o.jsx(Zo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),o.jsx("input",{type:"text",value:f,onChange:x=>d(x.target.value),placeholder:"Rechercher un client, un projet...",className:"w-full pl-9 pr-3 py-2.5 text-sm border border-gray-200 rounded-xl bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),f&&o.jsx("button",{onClick:()=>d(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:o.jsx(es,{className:"w-4 h-4 text-gray-400"})})]})}),o.jsx("div",{className:"flex-1 px-4 py-2 overflow-y-auto",children:r?o.jsx("div",{className:"flex items-center justify-center h-40",children:o.jsx(De,{className:"w-6 h-6 animate-spin text-gray-400"})}):s.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-400",children:[o.jsx(g0,{className:"w-12 h-12 mb-3"}),o.jsx("p",{className:"text-sm font-medium",children:"Aucune conversation"}),o.jsx("p",{className:"text-xs mt-1",children:"Les conversations apparatront ici quand vous aurez des missions."})]}):v.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-400",children:[o.jsx(Zo,{className:"w-10 h-10 mb-3"}),o.jsx("p",{className:"text-sm font-medium",children:f?"Aucun rsultat":"Aucune conversation rcente"}),o.jsx("p",{className:"text-xs mt-1",children:f?`Rien trouv pour "${f}"`:`${y} conversation${y>1?"s":""} plus ancienne${y>1?"s":""}`}),!h&&!f&&o.jsx("button",{onClick:()=>m(!0),className:"mt-3 text-xs font-semibold text-blue-600 hover:text-blue-800 transition-colors",children:"Voir toutes les conversations"})]}):o.jsxs("div",{className:"space-y-2",children:[v.map(x=>o.jsxs("button",{onClick:()=>l(x),className:`w-full flex items-center gap-3 p-3 rounded-xl border transition-all text-left ${x.unreadCount>0?"bg-blue-50 border-blue-200 hover:border-blue-300":"bg-white border-gray-200 hover:border-gray-300 hover:shadow-sm"}`,children:[o.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm shrink-0 ${x.unreadCount>0?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:x.prospectName.charAt(0).toUpperCase()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("p",{className:`text-sm truncate ${x.unreadCount>0?"font-bold text-gray-900":"font-semibold text-gray-900"}`,children:x.prospectName}),x.unreadCount>0&&o.jsx("span",{className:"bg-blue-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center shrink-0",children:x.unreadCount})]}),x.lastMessagePreview?o.jsxs("p",{className:`text-xs truncate mt-0.5 ${x.unreadCount>0?"text-gray-700 font-medium":"text-gray-500"}`,children:[x.lastMessagePreview.substring(0,60),x.lastMessagePreview.length>60?"":""]}):o.jsxs("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:[x.projectType," ",x.stepName?` ${x.stepName}`:""]})]}),o.jsxs("div",{className:"flex flex-col items-end shrink-0",children:[x.lastMessageAt&&o.jsx("span",{className:"text-[10px] text-gray-400",children:UA(new Date(x.lastMessageAt),{addSuffix:!0,locale:VA})}),o.jsx(Gn,{className:"w-4 h-4 text-gray-400 mt-1"})]})]},`${x.prospectId}-${x.projectType}`)),!f&&y>0&&!h&&o.jsxs("button",{onClick:()=>m(!0),className:"w-full py-2.5 text-xs font-semibold text-blue-600 hover:text-blue-800 transition-colors text-center",children:["+ ",y," conversation",y>1?"s":""," plus ancienne",y>1?"s":""]}),h&&!f&&o.jsx("button",{onClick:()=>m(!1),className:"w-full py-2.5 text-xs font-semibold text-gray-500 hover:text-gray-700 transition-colors text-center",children:"Afficher uniquement les rcentes"})]})})]})},Fse=()=>{const e=Te(),[t,r]=p.useState(!0),[n,s]=p.useState([]),[i,a]=p.useState({submitted:!0,completed:!1,blocked:!1});p.useEffect(()=>{(async()=>{try{const{data:{user:v}}=await T.auth.getUser();if(!v)return;const{data:y}=await T.from("partners").select("id").eq("user_id",v.id).single();if(!y)return;const{data:x}=await T.from("missions").select("*").eq("partner_id",y.id).in("status",["completed","blocked","submitted"]).order("updated_at",{ascending:!1});s(x||[])}catch(v){P.error("PartnerProofsPage load error",{err:v.message})}finally{r(!1)}})()},[]);const l=g=>{a(v=>({...v,[g]:!v[g]}))};if(t)return o.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:o.jsx(De,{className:"w-8 h-8 text-blue-600 animate-spin"})});const c=n.filter(g=>g.status==="submitted"),u=n.filter(g=>g.status==="completed"),f=n.filter(g=>g.status==="blocked"),d=n.length===0,h=[{key:"submitted",label:"En attente de validation",count:c.length,items:c,dotColor:"bg-orange-500",badgeBg:"bg-orange-100",badgeText:"text-orange-700",icon:Hd,iconColor:"text-orange-500"},{key:"completed",label:"Valides",count:u.length,items:u,dotColor:"bg-green-500",badgeBg:"bg-green-100",badgeText:"text-green-700",icon:Hf,iconColor:"text-green-500"},{key:"blocked",label:"Refuses",count:f.length,items:f,dotColor:"bg-red-500",badgeBg:"bg-red-100",badgeText:"text-red-700",icon:v0,iconColor:"text-red-500"}],m=(g,v)=>{var b;const y=g.client_name||((b=g.title)==null?void 0:b.replace("Mission pour ",""))||"Client",x=g.step_name||g.project_type||"";return o.jsxs("div",{className:"flex items-center gap-3 bg-white rounded-xl p-3 cursor-pointer active:bg-gray-50 transition-colors",onClick:()=>e(`/partner/missions/${g.id}`),children:[o.jsx("div",{className:`w-9 h-9 rounded-full ${v.badgeBg} flex items-center justify-center shrink-0`,children:o.jsx(v.icon,{className:`w-4 h-4 ${v.iconColor}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium text-gray-900 text-sm truncate",children:y}),x&&o.jsx("div",{className:"text-xs text-gray-400 truncate mt-0.5",children:x})]}),o.jsx(Gn,{className:"w-4 h-4 text-gray-300 shrink-0"})]},g.id)};return o.jsxs("div",{className:"px-4 pt-6 pb-4",children:[o.jsx("h1",{className:"text-2xl font-black text-gray-900",children:"Registre"}),d?o.jsxs("div",{className:"text-center py-16",children:[o.jsx(Hd,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),o.jsx("p",{className:"text-gray-400",children:"Aucune preuve pour le moment."}),o.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Vos missions soumises apparatront ici."})]}):o.jsx("div",{className:"mt-5 space-y-3",children:h.map(g=>{const v=i[g.key];return o.jsxs("div",{className:"bg-gray-100/60 rounded-2xl overflow-hidden",children:[o.jsxs("button",{onClick:()=>l(g.key),className:"w-full flex items-center justify-between px-5 py-5 active:bg-gray-200/60 transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:`w-3 h-3 rounded-full ${g.dotColor}`}),o.jsx("span",{className:"text-base font-semibold text-gray-900",children:g.label})]}),o.jsxs("div",{className:"flex items-center gap-2.5",children:[o.jsx("span",{className:`text-sm font-bold px-2.5 py-1 rounded-full ${g.badgeBg} ${g.badgeText}`,children:g.count}),o.jsx(Ds,{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${v?"rotate-180":""}`})]})]}),v&&g.items.length>0&&o.jsx("div",{className:"px-3 pb-3 space-y-2",children:g.items.map(y=>m(y,g))}),v&&g.items.length===0&&o.jsx("div",{className:"px-4 pb-4 text-center",children:o.jsx("p",{className:"text-xs text-gray-400",children:"Aucune mission dans cette catgorie."})})]},g.key)})})]})},qS=()=>{var c;const{currentUser:e}=Ve(),[t,r]=p.useState(!1),n={filleuls:4,confirmes:3,gainsCumules:300},s=`https://evatime.fr/inscription/${((c=e==null?void 0:e.name)==null?void 0:c.replace(/\s+/g,"-"))||"Jack-Luc"}`,i=[{id:1,filleul:"Sophie Martin",statut:"En attente",gain:null,date:"06/11/2025",badgeColor:"bg-yellow-100 text-yellow-700"},{id:2,filleul:"Julien Dubois",statut:"Confirm",gain:100,date:"02/11/2025",badgeColor:"bg-green-100 text-green-700"},{id:3,filleul:"Alexandre Petit",statut:"Confirm",gain:100,date:"28/10/2025",badgeColor:"bg-green-100 text-green-700"}],a=()=>{navigator.clipboard.writeText(s),r(!0),B({title:"Lien copi !",description:"Le lien de parrainage a t copi dans le presse-papier.",className:"bg-green-500 text-white"}),setTimeout(()=>r(!1),2e3)},l=()=>{B({title:"Invitation",description:"Fonctionnalit d'invitation  venir..."})};return o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[o.jsxs("div",{className:"relative bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 rounded-2xl shadow-xl overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.05] bg-[size:20px_20px]"}),o.jsxs("div",{className:"relative grid grid-cols-1 lg:grid-cols-[1fr_auto] gap-8 p-8 lg:p-12 items-center",children:[o.jsxs("div",{className:"text-white space-y-6",children:[o.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full text-sm font-medium",children:[o.jsx(nv,{className:"h-5 w-5"}),"Programme de parrainage"]}),o.jsx("h1",{className:"text-4xl lg:text-5xl font-bold leading-tight",children:"Gagnez de l'argent en recommandant nos services ! "}),o.jsxs("p",{className:"text-xl text-blue-100 leading-relaxed",children:["Chaque ami que vous parrainez vous rapporte"," ",o.jsx("span",{className:"font-bold text-yellow-300 text-2xl",children:"100 "})," ","et lui offre galement"," ",o.jsx("span",{className:"font-bold text-yellow-300 text-2xl",children:"100 "})," de rduction.",o.jsx("br",{}),o.jsx("span",{className:"text-white font-semibold mt-2 block",children:"C'est gagnant-gagnant ! "})]}),o.jsxs("div",{className:"flex flex-wrap gap-4 pt-4",children:[o.jsxs(G,{onClick:l,size:"lg",className:"bg-yellow-400 hover:bg-yellow-500 text-gray-900 font-bold shadow-lg hover:shadow-xl transition-all",children:[o.jsx(jl,{className:"h-5 w-5 mr-2"}),"Inviter un ami maintenant"]}),o.jsx(G,{onClick:a,size:"lg",variant:"outline",className:"bg-white/10 backdrop-blur-sm border-white/30 text-white hover:bg-white/20 font-semibold",children:t?o.jsxs(o.Fragment,{children:[o.jsx(Mn,{className:"h-5 w-5 mr-2"}),"Lien copi !"]}):o.jsxs(o.Fragment,{children:[o.jsx(hj,{className:"h-5 w-5 mr-2"}),"Copier mon lien"]})})]})]}),o.jsx("div",{className:"hidden lg:block flex-shrink-0",children:o.jsx("img",{src:"https://ik.imagekit.io/bqla7nrgyf/ChatGPT%20Image%206%20nov.%202025%20a%CC%80%2017_33_52.png.webp?updatedAt=1762764615950",alt:"Programme de parrainage",className:"w-80 h-auto object-contain drop-shadow-2xl"})})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-card p-8",children:[o.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[o.jsx(L3,{className:"h-6 w-6 text-green-600"}),"Vos performances de parrainage"]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs(le.div,{whileHover:{scale:1.05},className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 text-center border-2 border-blue-200 cursor-pointer",children:[o.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:o.jsx(Pi,{className:"h-8 w-8 text-white"})}),o.jsx("p",{className:"text-sm font-medium text-blue-700 mb-2 uppercase tracking-wide",children:"Filleuls inscrits"}),o.jsx("p",{className:"text-5xl font-extrabold text-blue-900 mb-1",children:n.filleuls}),o.jsx("p",{className:"text-xs text-blue-600",children:"personnes invites"})]}),o.jsxs(le.div,{whileHover:{scale:1.05},className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 text-center border-2 border-green-200 cursor-pointer",children:[o.jsx("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:o.jsx(Mn,{className:"h-8 w-8 text-white"})}),o.jsx("p",{className:"text-sm font-medium text-green-700 mb-2 uppercase tracking-wide",children:"Parrainages confirms"}),o.jsx("p",{className:"text-5xl font-extrabold text-green-900 mb-1",children:n.confirmes}),o.jsx("p",{className:"text-xs text-green-600",children:"souscriptions valides"})]}),o.jsxs(le.div,{whileHover:{scale:1.05},className:"bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-xl p-6 text-center border-2 border-yellow-200 cursor-pointer",children:[o.jsx("div",{className:"w-16 h-16 bg-yellow-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:o.jsx(nv,{className:"h-8 w-8 text-white"})}),o.jsx("p",{className:"text-sm font-medium text-yellow-700 mb-2 uppercase tracking-wide",children:"Revenus gnrs"}),o.jsxs("p",{className:"text-5xl font-extrabold text-yellow-900 mb-1",children:[n.gainsCumules," "]}),o.jsx("p",{className:"text-xs text-yellow-600",children:"total des gains"})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-card p-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Votre lien de parrainage unique"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(pe,{value:s,readOnly:!0,className:"flex-1 bg-gray-50 border-gray-200"}),o.jsx(G,{onClick:a,className:"bg-blue-600 hover:bg-blue-700 text-white",children:t?o.jsxs(o.Fragment,{children:[o.jsx(Mn,{className:"h-4 w-4 mr-2"}),"Copi"]}):o.jsxs(o.Fragment,{children:[o.jsx(hj,{className:"h-4 w-4 mr-2"}),"Copier le lien"]})})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl shadow-card p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Suivi de vos parrainages"}),o.jsxs(G,{onClick:l,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[o.jsx(jl,{className:"h-4 w-4 mr-2"}),"Inviter un ami"]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200",children:[o.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600 uppercase tracking-wider",children:"Filleul"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600 uppercase tracking-wider",children:"Statut"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600 uppercase tracking-wider",children:"Gain"}),o.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-600 uppercase tracking-wider",children:"Date"})]})}),o.jsx("tbody",{children:i.map(u=>o.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"py-4 px-4 text-gray-900 font-medium",children:u.filleul}),o.jsx("td",{className:"py-4 px-4",children:o.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${u.badgeColor}`,children:u.statut})}),o.jsx("td",{className:"py-4 px-4 text-gray-900 font-medium",children:u.gain?`+${u.gain} `:""}),o.jsx("td",{className:"py-4 px-4 text-gray-600",children:u.date})]},u.id))})]})})]})]})},WS=({title:e,children:t})=>o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-6 rounded-2xl shadow-card",children:[o.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:e}),o.jsx("div",{className:"space-y-6",children:t})]}),Gm=()=>{const e=Ht();Te();const{currentUser:t,setCurrentUser:r,updateProspect:n}=Ve(),s=e.pathname.includes("/profil"),[i,a]=p.useState({name:"",companyName:"",email:"",phone:"",address:""});p.useEffect(()=>{t&&a({name:t.name||"",companyName:t.companyName||"",email:t.email||"",phone:t.phone||"",address:t.address||""})},[t]);const l=m=>{const{id:g,value:v}=m.target;a(y=>({...y,[g]:v}))},c=async()=>{if(t)try{const m=await n({id:t.id,name:i.name,email:i.email,phone:i.phone,company:i.companyName,address:i.address});if(m&&m.length>0){const g=m[0],v={id:g.id,name:g.name,email:g.email,phone:g.phone,companyName:g.company_name,address:g.address,tags:g.tags||[],userId:g.user_id,ownerId:g.owner_id,status:g.status,hasAppointment:g.has_appointment,affiliateName:g.affiliate_name,formData:g.form_data||{},createdAt:g.created_at,updatedAt:g.updated_at};r(v)}B({title:"Profil mis a jour !",description:"Vos informations ont ete enregistrees avec succes.",className:"bg-green-100 border-green-300 text-green-800"})}catch(m){P.error("Erreur sauvegarde profil:",m),B({title:"Erreur",description:"Impossible de sauvegarder les modifications.",variant:"destructive"})}},u=()=>{B({title:'Sauvegarde des "Prfrences de notifications"...',description:" This feature isn't implemented yetbut don't worry! You can request it in your next prompt! "})},f=()=>{T.auth.signOut(),window.location.href="/"},d=s?"Mon Profil":"Paramtres",h=s?"Grez vos informations personnelles et vos prfrences.":"Grez les paramtres de l'application.";return o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:d}),o.jsx("p",{className:"text-gray-600 mt-1",children:h})]}),o.jsxs(WS,{title:"Informations Personnelles",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"name",children:"Nom complet"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(Ac,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"name",type:"text",placeholder:"Jack Dupont",className:"pl-10",value:i.name,onChange:l})]})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"companyName",children:"Socit"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(rv,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"companyName",type:"text",placeholder:"Nom de votre socit",className:"pl-10",value:i.companyName,onChange:l})]})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"email",children:"Adresse e-mail"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(tn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"email",type:"email",placeholder:"jack.dupont@email.com",className:"pl-10",value:i.email,onChange:l})]})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"phone",children:"Tlphone"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(kc,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"phone",type:"tel",placeholder:"06 12 34 56 78",className:"pl-10",value:i.phone,onChange:l})]})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"address",children:"Adresse"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(m0,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"address",type:"text",placeholder:"123 Rue de Paris, 75001 Paris",className:"pl-10",value:i.address,onChange:l})]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-end gap-2 sm:gap-4 mt-6 pt-6 border-t",children:[o.jsxs(Hc,{children:[o.jsx(jh,{asChild:!0,children:o.jsxs(G,{variant:"destructive",children:[o.jsx(I3,{className:"mr-2 h-4 w-4"}),"Se dconnecter"]})}),o.jsxs(ba,{children:[o.jsxs(wa,{children:[o.jsx(_a,{children:"Confirmer la dconnexion"}),o.jsx(Sa,{children:"tes-vous sr de vouloir vous dconnecter ? Vous recevrez un nouveau lien scuris pour vous reconnecter."})]}),o.jsxs(ja,{children:[o.jsx(Ea,{children:"Annuler"}),o.jsx(Na,{onClick:f,className:"bg-red-600 hover:bg-red-700",children:"Se dconnecter"})]})]})]}),o.jsx(G,{onClick:c,className:"bg-green-600 hover:bg-green-700",children:"Enregistrer les modifications"})]})]}),o.jsxs(WS,{title:"Prfrences de notifications",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Choisissez comment nous pouvons vous contacter pour les mises  jour importantes de vos projets."}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50",children:[o.jsx(sr,{id:"notif-email",defaultChecked:!0}),o.jsxs("div",{className:"grid gap-1.5 leading-none",children:[o.jsx("label",{htmlFor:"notif-email",className:"font-medium cursor-pointer",children:"Par e-mail"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Recevez les notifications directement dans votre bote de rception."})]})]}),o.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50",children:[o.jsx(sr,{id:"notif-sms"}),o.jsxs("div",{className:"grid gap-1.5 leading-none",children:[o.jsx("label",{htmlFor:"notif-sms",className:"font-medium cursor-pointer",children:"Par SMS"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Recevez des alertes rapides sur votre tlphone."})]})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx(G,{onClick:u,className:"w-full sm:w-auto",children:"Enregistrer les prfrences"})})]})]})},Bse=({project:e,projectStatus:t})=>{var f;const{currentUser:r,setCurrentUser:n,updateProspect:s}=Ve(),i=Te(),a=((f=r==null?void 0:r.tags)==null?void 0:f.includes(e.type))||!1,l=a&&(t==="abandon"||t==="archive"),c=async()=>{if(r!=null&&r.id)try{const{error:d}=await T.from("project_infos").upsert({prospect_id:r.id,project_type:e.type,status:"actif",data:{}},{onConflict:"prospect_id,project_type"});if(d)throw d;await T.from("project_history").insert({prospect_id:r.id,project_type:e.type,event_type:"status",description:"Projet ractiv par le client"}),B({title:"Projet ractiv ! ",description:`Le projet "${e.clientTitle}" est de nouveau actif dans votre tableau de bord.`,className:"bg-green-500 text-white"}),setTimeout(()=>window.location.reload(),1e3)}catch(d){P.error("Erreur ractivation:",d),B({title:"Erreur",description:"Impossible de ractiver le projet.",variant:"destructive"})}},u=async()=>{if(a&&!l){i("/dashboard",{state:{openProjectType:e.type}});return}if(!(r!=null&&r.id)){B({title:"Erreur",description:"Vous devez tre connect pour ajouter un projet.",variant:"destructive"});return}try{const d=[...r.tags||[],e.type];if(await s({id:r.id,tags:d}),e.steps&&e.steps.length>0){const h=JSON.parse(JSON.stringify(e.steps));h[0].status="in_progress";const{data:m,error:g}=await T.from("prospects").select("organization_id").eq("id",r.id).single();if(g||!(m!=null&&m.organization_id)){P.error("Organization introuvable pour le prospect:",{prospectId:r.id,error:g==null?void 0:g.message});return}const{error:v}=await T.from("project_steps_status").upsert({prospect_id:r.id,project_type:e.type,organization_id:m.organization_id,steps:h,updated_at:new Date().toISOString()},{onConflict:"prospect_id,project_type"});v&&P.error(" Erreur initialisation steps:",v),await new Promise(y=>setTimeout(y,500))}n({...r,tags:d}),B({title:"Projet ajout avec succs ! ",description:`Le projet "${e.clientTitle}" est maintenant dans votre tableau de bord.`}),i("/dashboard",{state:{openProjectType:e.type}})}catch(d){P.error("Erreur ajout projet:",d),B({title:"Erreur",description:"Impossible d'ajouter le projet. Veuillez ressayer.",variant:"destructive"})}};return o.jsxs(le.div,{className:"bg-white rounded-3xl shadow-soft overflow-hidden flex flex-col",whileHover:{y:-5},children:[o.jsx("div",{className:"h-48 w-full bg-gray-100 flex items-center justify-center",children:e.coverImage?o.jsx("img",{src:e.coverImage,alt:e.clientTitle,className:"w-full h-full object-cover"}):o.jsx(pP,{className:"h-16 w-16 text-gray-300"})}),o.jsxs("div",{className:"p-6 flex-grow flex flex-col",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:e.clientTitle}),o.jsx("p",{className:"text-gray-600 text-sm flex-grow mb-6",children:e.clientDescription||"Ce nouveau projet est disponible. Ajoutez-le  votre tableau de bord pour en savoir plus."}),l?o.jsxs(G,{onClick:c,className:"w-full mt-auto rounded-xl bg-orange-500 hover:bg-orange-600 text-white",size:"lg",children:[o.jsx(Kf,{className:"mr-2 h-4 w-4"})," Ractiver ce projet"]}):o.jsx(G,{onClick:u,className:`w-full mt-auto rounded-xl ${a?"bg-blue-500 hover:bg-blue-600 text-white":"gradient-green hover:opacity-90"}`,size:"lg",children:a?" Voir le projet":e.ctaText||" Ajouter ce projet"})]})]})},HS=()=>{const{projectsData:e,currentUser:t}=Ve(),[r,n]=p.useState({});p.useEffect(()=>{(async()=>{if(!(t!=null&&t.id)||!(t!=null&&t.tags)||t.tags.length===0)return;const{data:a}=await T.from("project_infos").select("project_type, status").eq("prospect_id",t.id).in("project_type",t.tags);if(a){const l={};a.forEach(c=>{l[c.project_type]=c.status||"actif"}),n(l)}})()},[t]);const s=Object.values(e).filter(i=>i.isPublic);return o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:"Dcouvrez nos offres exclusives "}),o.jsx("p",{className:"text-gray-600 mt-2 max-w-2xl mx-auto",children:"Choisissez lopportunit qui vous correspond et suivez-la directement dans votre Tableau de bord."})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:s.map(i=>o.jsx(Bse,{project:i,projectStatus:r[i.type]||"actif"},i.type))})]})},zse=()=>{const e=Te(),{setCurrentUser:t}=Ve(),[r,n]=p.useState("loading"),[s,i]=p.useState("Activation de votre compte...");return p.useEffect(()=>{(async()=>{try{const l=window.location.hash;if(!l||l.length===0){console.warn(" Aucun fragment trouv dans l'URL"),n("error"),i("Lien invalide. Veuillez demander un nouveau lien d'invitation.");return}const c=l.startsWith("#")?l.slice(1):l,u=new URLSearchParams(c),f=u.get("access_token"),d=u.get("refresh_token");if(!f){logger.error(" Pas d'access_token dans le fragment"),n("error"),i("Lien invalide ou expir. Veuillez demander un nouveau lien.");return}const{data:h,error:m}=await T.auth.setSession({access_token:f,refresh_token:d||""});if(m){logger.error(" Erreur setSession:",m),n("error"),i("Erreur lors de la connexion. Le lien a peut-tre expir.");return}window.history.replaceState({},document.title,window.location.pathname+window.location.search);const g=h.user;if(!g){n("error"),i("Erreur: utilisateur non trouv aprs authentification.");return}const{data:v,error:y}=await T.from("prospects").select("*").eq("email",g.email).is("user_id",null);if(y)throw logger.error("Erreur recherche prospect:",y),y;if(!v||v.length===0){const{data:_,error:S}=await T.from("prospects").select("*").eq("user_id",g.id).single();if(_){const N={id:_.id,userId:_.user_id,name:_.name,email:_.email,phone:_.phone,company:_.company_name,address:_.address,tags:_.tags||[],status:_.status,ownerId:_.owner_id,hasAppointment:_.has_appointment};t(N),n("success"),i("Connexion reussie !"),setTimeout(()=>{e("/dashboard")},1500);return}n("error"),i("Aucun compte trouve avec cet email. Contactez votre conseiller.");return}const x=v[0],{data:b,error:w}=await T.from("prospects").update({user_id:g.id}).eq("id",x.id).select().single();if(w)throw logger.error("Erreur mise a jour prospect:",w),w;const j={id:b.id,userId:b.user_id,name:b.name,email:b.email,phone:b.phone,company:b.company_name,address:b.address,tags:b.tags||[],status:b.status,ownerId:b.owner_id,hasAppointment:b.has_appointment};t(j),n("success"),i("Compte active avec succes ! Redirection..."),B({title:"Bienvenue !",description:"Votre compte a ete active avec succes.",className:"bg-green-500 text-white"}),setTimeout(()=>{e("/dashboard")},2e3)}catch(l){logger.error("Erreur activation:",l),n("error"),i("Une erreur est survenue. Veuillez reessayer.")}})()},[e,t]),o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:o.jsxs(le.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white p-8 rounded-2xl shadow-xl max-w-md w-full text-center",children:[r==="loading"&&o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"h-16 w-16 text-blue-500 animate-spin mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Activation en cours..."}),o.jsx("p",{className:"text-gray-600",children:s})]}),r==="success"&&o.jsxs(o.Fragment,{children:[o.jsx(Hf,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Activation reussie !"}),o.jsx("p",{className:"text-gray-600",children:s})]}),r==="error"&&o.jsxs(o.Fragment,{children:[o.jsx(v0,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Erreur d'activation"}),o.jsx("p",{className:"text-gray-600 mb-4",children:s}),o.jsx("button",{onClick:()=>e("/"),className:"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition",children:"Retour a l'accueil"})]})]})})},Use=()=>{const e=Te(),{setActiveAdminUser:t}=Ve(),[r,n]=p.useState(""),[s,i]=p.useState(""),[a,l]=p.useState(!1),[c,u]=p.useState(!1),[f,d]=p.useState(!1),[h,m]=p.useState(!0),[g,v]=p.useState(!1),[y,x]=p.useState("");p.useEffect(()=>{const _=window.location.hash,S=_.includes("access_token")||_.includes("type=invite");if(P.info(" ActivateAccountPage - Vrification du flow invitation",{hash:_.substring(0,50)+"...",isInviteFlow:S}),S){const{data:{subscription:N}}=T.auth.onAuthStateChange(async(C,k)=>{C==="SIGNED_IN"&&k?await b(k):C==="TOKEN_REFRESHED"&&k&&await b(k)}),E=setTimeout(async()=>{P.warn(" Timeout - vrification manuelle de la session");const{data:{session:C}}=await T.auth.getSession();C?await b(C):(P.error(" Pas de session aprs timeout"),v(!1),m(!1))},5e3);return()=>{N.unsubscribe(),clearTimeout(E)}}else w()},[]);const b=async _=>{try{const S=_.user;if(!S||!S.email){P.error(" Pas d'utilisateur dans la session"),v(!1),m(!1);return}const{data:N,error:E}=await T.from("users").select("email, name").eq("user_id",S.id).single();if(E||!N){P.error(" Utilisateur non trouv dans table users:",E),v(!1),m(!1);return}P.info(" Session valide pour:",N.email),x(N.email),v(!0),m(!1)}catch(S){P.error(" Erreur validation session:",S),v(!1),m(!1)}},w=async()=>{try{P.info(" Vrification de la session existante...");const{data:{session:_},error:S}=await T.auth.getSession();if(S||!_){P.error(" Pas de session active:",S),v(!1),m(!1);return}await b(_)}catch(_){P.error(" Erreur vrification session:",_),v(!1),m(!1)}},j=async _=>{if(_.preventDefault(),!r||!s){B({title:"Champs manquants",description:"Veuillez remplir tous les champs.",variant:"destructive"});return}if(r.length<6){B({title:"Mot de passe trop court",description:"Le mot de passe doit contenir au moins 6 caractres.",variant:"destructive"});return}if(r!==s){B({title:"Mots de passe diffrents",description:"Les mots de passe ne correspondent pas.",variant:"destructive"});return}d(!0);try{P.info(" Mise  jour du mot de passe...");const{data:S,error:N}=await T.auth.updateUser({password:r});if(N){P.error(" Erreur updateUser:",N),B({title:"Erreur",description:"Impossible de dfinir le mot de passe. Veuillez ressayer.",variant:"destructive"}),d(!1);return}const E=S.user;if(!E){B({title:"Erreur",description:"Erreur lors de la mise  jour du compte.",variant:"destructive"}),d(!1);return}const{data:C,error:k}=await T.from("users").select("*").eq("user_id",E.id).single();if(k||!C){P.error(" Erreur rcupration donnes user:",k),B({title:"Erreur",description:"Impossible de rcuprer les informations du compte.",variant:"destructive"}),d(!1);return}B({title:"Compte activ !",description:"Votre mot de passe a t dfini. Connexion en cours...",className:"bg-green-500 text-white"});const L={id:C.id,userId:C.user_id,name:C.name,email:C.email,role:C.role,phone:C.phone,avatarUrl:C.avatar_url,managerId:C.manager_id,organizationId:C.organization_id,accessRights:C.access_rights,createdAt:C.created_at,updatedAt:C.updated_at};t(L),setTimeout(()=>{e("/admin/pipeline")},1200)}catch(S){P.error("Erreur activation compte:",S),B({title:"Erreur",description:"Une erreur est survenue. Veuillez ressayer.",variant:"destructive"}),d(!1)}};return h?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center px-4",children:o.jsxs(le.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white p-8 rounded-2xl shadow-xl max-w-md w-full text-center",children:[o.jsx(De,{className:"h-16 w-16 text-blue-500 animate-spin mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Vrification..."}),o.jsx("p",{className:"text-gray-600",children:"Veuillez patienter"})]})}):g?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex items-center justify-center px-4",children:o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:o.jsx(Hf,{className:"h-8 w-8 text-green-600"})}),o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Activation de votre compte"}),o.jsx("p",{className:"text-gray-600",children:"Bienvenue ! Dfinissez votre mot de passe pour activer votre compte professionnel."}),y&&o.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Compte : ",o.jsx("strong",{children:y})]})]}),o.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:o.jsxs("form",{onSubmit:j,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"password",children:"Nouveau mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(pe,{id:"password",type:a?"text":"password",placeholder:"Minimum 6 caractres",required:!0,value:r,onChange:_=>n(_.target.value),className:"h-12 pr-10"}),o.jsx("button",{type:"button",onClick:()=>l(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:a?o.jsx(Ql,{className:"h-5 w-5"}):o.jsx(Zl,{className:"h-5 w-5"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"confirmPassword",children:"Confirmer le mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(pe,{id:"confirmPassword",type:c?"text":"password",placeholder:"Retapez votre mot de passe",required:!0,value:s,onChange:_=>i(_.target.value),className:"h-12 pr-10"}),o.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:c?o.jsx(Ql,{className:"h-5 w-5"}):o.jsx(Zl,{className:"h-5 w-5"})})]})]}),r&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-xs text-gray-600",children:"Force du mot de passe :"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("div",{className:`h-1 flex-1 rounded ${r.length>=6?"bg-green-500":"bg-gray-200"}`}),o.jsx("div",{className:`h-1 flex-1 rounded ${r.length>=8?"bg-green-500":"bg-gray-200"}`}),o.jsx("div",{className:`h-1 flex-1 rounded ${r.length>=10&&/[A-Z]/.test(r)?"bg-green-500":"bg-gray-200"}`})]}),o.jsxs("p",{className:"text-xs text-gray-500",children:[r.length<6&&"Minimum 6 caractres requis",r.length>=6&&r.length<8&&"Acceptable",r.length>=8&&r.length<10&&"Bon",r.length>=10&&/[A-Z]/.test(r)&&"Excellent"]})]}),o.jsx(G,{type:"submit",disabled:f,className:"w-full h-12 bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white text-lg font-semibold",children:f?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"mr-2 h-5 w-5 animate-spin"}),"Activation en cours..."]}):"Activer mon compte"})]})}),o.jsx("div",{className:"mt-6 text-center",children:o.jsxs("p",{className:"text-sm text-gray-600",children:["Un problme ?"," ",o.jsx("button",{onClick:()=>e("/login"),className:"text-blue-600 hover:underline font-medium",children:"Retour  la connexion"})]})})]})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-100 flex items-center justify-center px-4",children:o.jsxs(le.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white p-8 rounded-2xl shadow-xl max-w-md w-full text-center",children:[o.jsx("div",{className:"h-16 w-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx("span",{className:"text-3xl",children:""})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Lien invalide ou expir"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Ce lien d'activation n'est plus valide. Veuillez contacter votre administrateur pour recevoir une nouvelle invitation."}),o.jsx(G,{onClick:()=>e("/login"),className:"w-full bg-blue-600 hover:bg-blue-700",children:"Retour  la connexion"})]})})},Vse=()=>{const e=Te(),[t,r]=p.useState([]),[n,s]=p.useState(!0),[i,a]=p.useState(null),[l,c]=p.useState(!1),[u,f]=p.useState(!1),[d,h]=p.useState({companyName:"",adminEmail:"",adminName:"",adminPhone:""});p.useEffect(()=>{(async()=>{try{const{data:w,error:j}=await T.rpc("platform_list_organizations");if(j){console.error("[OrganizationsListPage] Error fetching organizations:",j),a(j.message);return}r(w||[])}catch(w){console.error("[OrganizationsListPage] Exception:",w),a(w.message)}finally{s(!1)}})()},[]);const m=b=>{e(`/platform/organizations/${b}`)},g=async b=>{if(b.preventDefault(),!d.companyName||!d.adminEmail||!d.adminName){B({title:"Erreur",description:"Le nom de l'organisation, l'email et le nom de l'administrateur sont requis",variant:"destructive"});return}try{f(!0);const w=await fetch("https://vvzxvtiyybilkswslqfn.supabase.co/functions/v1/platform_create_organization",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyName:d.companyName,adminEmail:d.adminEmail,adminName:d.adminName,adminPhone:d.adminPhone||null})}),j=await w.json();if(!w.ok)throw new Error(j.error||"Erreur lors de la cration");B({title:" Organisation cre !",description:"Un email d'invitation a t envoy  l'administrateur.",className:"bg-green-500 text-white"});const{data:_}=await T.rpc("platform_list_organizations");r(_||[]),c(!1),h({companyName:"",adminEmail:"",adminName:"",adminPhone:""})}catch(w){console.error("[Platform] Error creating organization:",w),B({title:"Erreur",description:w.message,variant:"destructive"})}finally{f(!1)}},v=(b,w)=>{navigator.clipboard.writeText(b).then(()=>{B({title:"Lien copi",description:`Le lien de connexion ${w} a t copi dans le presse-papiers`})}).catch(j=>{console.error("Failed to copy:",j),B({title:"Erreur",description:"Impossible de copier le lien",variant:"destructive"})})},y=b=>`https://evatime.fr/login?org=${b}`,x=b=>`https://evatime.fr/client-access?org=${b}`;return n?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):i?o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[o.jsx("p",{className:"text-red-800 font-medium",children:"Erreur lors du chargement des organisations"}),o.jsx("p",{className:"text-red-600 text-sm mt-1",children:i})]}):o.jsxs("div",{children:[o.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Organisations"}),o.jsxs("p",{className:"text-gray-600 mt-1",children:[t.length," organisation",t.length!==1?"s":""," enregistre",t.length!==1?"s":""]})]}),o.jsxs(G,{onClick:()=>c(!0),className:"flex items-center gap-2",children:[o.jsx(hr,{className:"w-4 h-4"}),"Crer une organisation"]})]}),t.length===0?o.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-8 text-center",children:o.jsx("p",{className:"text-gray-500",children:"Aucune organisation trouve"})}):o.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nom"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Slug"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cre le"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Connexions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(b=>o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap cursor-pointer",onClick:()=>m(b.id),children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:b.name})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap cursor-pointer",onClick:()=>m(b.id),children:o.jsx("div",{className:"text-sm text-gray-600",children:b.slug})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap cursor-pointer",onClick:()=>m(b.id),children:o.jsx("div",{className:"text-sm text-gray-600",children:new Date(b.created_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:w=>{w.stopPropagation(),v(y(b.slug),"PRO")},className:"px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded hover:bg-blue-100 transition-colors",title:"Copier le lien de connexion PRO",children:" PRO"}),o.jsx("button",{onClick:w=>{w.stopPropagation(),v(x(b.slug),"CLIENT")},className:"px-3 py-1.5 text-xs font-medium text-green-700 bg-green-50 border border-green-200 rounded hover:bg-green-100 transition-colors",title:"Copier le lien de connexion CLIENT",children:" CLIENT"})]})})]},b.id))})]})}),o.jsx(bh,{open:l,onOpenChange:c,children:o.jsxs(Vc,{children:[o.jsxs(qc,{children:[o.jsx(Wc,{children:"Crer une nouvelle organisation"}),o.jsx(wh,{children:"Un email d'invitation sera envoy  l'administrateur pour dfinir son mot de passe."})]}),o.jsxs("form",{onSubmit:g,className:"space-y-4 mt-4",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"companyName",children:"Nom de l'organisation *"}),o.jsx(pe,{id:"companyName",placeholder:"Ex: Acme Corporation",value:d.companyName,onChange:b=>h({...d,companyName:b.target.value}),disabled:u,required:!0})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"adminEmail",children:"Email administrateur *"}),o.jsx(pe,{id:"adminEmail",type:"email",placeholder:"admin@example.com",value:d.adminEmail,onChange:b=>h({...d,adminEmail:b.target.value}),disabled:u,required:!0})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"adminName",children:"Nom de l'administrateur *"}),o.jsx(pe,{id:"adminName",placeholder:"Jean Dupont",value:d.adminName,onChange:b=>h({...d,adminName:b.target.value}),disabled:u,required:!0})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"adminPhone",children:"Tlphone (optionnel)"}),o.jsx(pe,{id:"adminPhone",type:"tel",placeholder:"06 12 34 56 78",value:d.adminPhone,onChange:b=>h({...d,adminPhone:b.target.value}),disabled:u})]}),o.jsxs("div",{className:"flex gap-2 justify-end pt-4",children:[o.jsx(G,{type:"button",variant:"outline",onClick:()=>c(!1),disabled:u,children:"Annuler"}),o.jsx(G,{type:"submit",disabled:u,children:u?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"w-4 h-4 mr-2 animate-spin"}),"Cration..."]}):"Crer l'organisation"})]})]})]})})]})},qse=()=>{const{id:e}=ma(),t=Te(),[r,n]=p.useState(null),[s,i]=p.useState([]),[a,l]=p.useState(null),[c,u]=p.useState(null),[f,d]=p.useState(!0),[h,m]=p.useState(null),[g,v]=p.useState(!1),[y,x]=p.useState(null),[b,w]=p.useState(!1),[j,_]=p.useState(""),[S,N]=p.useState(""),[E,C]=p.useState(!1),[k,L]=p.useState("");p.useState(!1);const[A,R]=p.useState(null),[O,z]=p.useState(null),[F,V]=p.useState(!1),I=async()=>{try{const{data:q,error:te}=await T.rpc("platform_get_organization_detail",{p_org_id:e});if(te){console.error("[OrganizationDetailPage] RPC error:",te),m(te.message);return}if(q!=null&&q.error){console.error("[OrganizationDetailPage] RPC returned error:",q.error),m(q.error);return}n(q.organization||null),i(q.domains||[]),l(q.settings||null),q.organization&&(_(q.organization.pricing_plan||""),N(q.organization.monthly_price_reference||""),L(q.organization.evatime_load!==null?String(q.organization.evatime_load):""),R(q.organization.evatime_load_estimated),z(q.organization.evatime_load_score));const{data:ue,error:_e}=await T.rpc("platform_get_org_kpis",{p_org_id:e});!_e&&ue&&!ue.error&&u(ue)}catch(q){console.error("[OrganizationDetailPage] Exception:",q),m(q.message)}finally{d(!1)}};p.useEffect(()=>{I()},[e]);const D=()=>{t("/platform")},$=q=>{x(q),v(!0)},M=async()=>{if(!y)return;w(!0);const q=y==="suspend"?"suspended":"active";try{const{data:te,error:ue}=await T.rpc("platform_set_org_status",{p_org_id:e,p_status:q});if(ue){console.error("[OrganizationDetailPage] Status change RPC error:",ue),B({title:"Erreur",description:ue.message,variant:"destructive"});return}if(te!=null&&te.error){B({title:"Erreur",description:te.error,variant:"destructive"});return}B({title:y==="suspend"?"Organisation suspendue":"Organisation ractive",description:`L'organisation a t ${y==="suspend"?"suspendue":"ractive"} avec succs.`}),await I()}catch(te){console.error("[OrganizationDetailPage] Status change exception:",te),B({title:"Erreur",description:te.message,variant:"destructive"})}finally{w(!1),v(!1),x(null)}},W=async()=>{C(!0);try{const{data:q,error:te}=await T.rpc("platform_update_org_pricing",{p_org_id:e,p_pricing_plan:j||null,p_monthly_price:S?parseInt(S,10):null});if(te){console.error("[OrganizationDetailPage] Pricing update RPC error:",te),B({title:"Erreur",description:te.message,variant:"destructive"});return}if(q!=null&&q.error){B({title:"Erreur",description:q.error,variant:"destructive"});return}B({title:"Pricing mis  jour",description:"Les informations de pricing ont t enregistres."}),await I()}catch(q){console.error("[OrganizationDetailPage] Pricing update exception:",q),B({title:"Erreur",description:q.message,variant:"destructive"})}finally{C(!1)}},U=async()=>{V(!0);try{const{data:q,error:te}=await T.rpc("platform_calculate_evatime_load",{p_org_id:e});if(te){console.error("[OrganizationDetailPage] Calculate load RPC error:",te),B({title:"Erreur",description:te.message,variant:"destructive"});return}if(q!=null&&q.error){B({title:"Erreur",description:q.error,variant:"destructive"});return}R(q.load),z(q.score),B({title:"Charge recalcule",description:`Score: ${q.score}  Niveau: ${q.load}`})}catch(q){console.error("[OrganizationDetailPage] Calculate load exception:",q),B({title:"Erreur",description:q.message,variant:"destructive"})}finally{V(!1)}},X=q=>{switch(q){case 0:return{emoji:"",label:"Lger",color:"bg-green-100 text-green-800"};case 1:return{emoji:"",label:"Normal",color:"bg-yellow-100 text-yellow-800"};case 2:return{emoji:"",label:"Complexe",color:"bg-orange-100 text-orange-800"};case 3:return{emoji:"",label:"Critique",color:"bg-red-100 text-red-800"};default:return{emoji:"",label:"Non calcul",color:"bg-gray-100 text-gray-600"}}},se=(()=>{if(A!=null)return A;if(!c)return null;const q=(c.admins||0)*2+(c.prospects||0)+(c.forms_pending||0)*5;return q<=15?0:q<=40?1:q<=70?2:3})(),Z=(q,te)=>{navigator.clipboard.writeText(q).then(()=>{B({title:"Lien copi",description:`Le lien de connexion ${te} a t copi dans le presse-papiers`})}).catch(ue=>{console.error("Failed to copy:",ue),B({title:"Erreur",description:"Impossible de copier le lien",variant:"destructive"})})},oe=q=>`https://evatime.fr/login?org=${q}`,H=q=>`https://evatime.fr/client-access?org=${q}`;return f?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):h||!r?o.jsxs("div",{children:[o.jsx("button",{onClick:D,className:"mb-4 text-sm text-gray-600 hover:text-gray-900",children:" Retour  la liste"}),o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[o.jsx("p",{className:"text-red-800 font-medium",children:"Erreur lors du chargement de l'organisation"}),o.jsx("p",{className:"text-red-600 text-sm mt-1",children:h||"Organisation non trouve"})]})]}):o.jsxs("div",{children:[o.jsxs("button",{onClick:D,className:"mb-6 text-sm text-gray-600 hover:text-gray-900 flex items-center gap-2",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Retour  la liste"})]}),o.jsx("div",{className:"mb-8",children:o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:r.name}),r.status==="suspended"?o.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800",children:" Suspendue"}):o.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:" Active"})]}),o.jsxs("p",{className:"text-gray-600 mt-1",children:["ID: ",r.id]})]}),o.jsx("div",{children:r.status==="suspended"?o.jsx("button",{onClick:()=>$("reactivate"),disabled:b,className:"px-4 py-2 text-sm font-medium text-green-700 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 transition-colors disabled:opacity-50",children:b?"En cours...":" Ractiver"}):o.jsx("button",{onClick:()=>$("suspend"),disabled:b,className:"px-4 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 transition-colors disabled:opacity-50",children:b?"En cours...":" Suspendre"})})]})}),o.jsx(Hc,{open:g,onOpenChange:v,children:o.jsxs(ba,{children:[o.jsxs(wa,{children:[o.jsx(_a,{children:y==="suspend"?"Suspendre cette organisation ?":"Ractiver cette organisation ?"}),o.jsx(Sa,{children:y==="suspend"?"Les utilisateurs de cette organisation ne pourront plus accder  la plateforme.":"Les utilisateurs de cette organisation pourront  nouveau accder  la plateforme."})]}),o.jsxs(ja,{children:[o.jsx(Ea,{disabled:b,children:"Annuler"}),o.jsx(Na,{onClick:M,disabled:b,className:y==="suspend"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700",children:b?"En cours...":y==="suspend"?"Suspendre":"Ractiver"})]})]})}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Connexion  EVATIME"})}),o.jsx("div",{className:"px-6 py-4",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 text-2xl",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Connexion PRO"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("code",{className:"text-xs bg-gray-100 px-3 py-2 rounded border border-gray-200 flex-1 break-all",children:oe(r.slug)}),o.jsx("button",{onClick:()=>Z(oe(r.slug),"PRO"),className:"px-4 py-2 text-sm font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded hover:bg-blue-100 transition-colors whitespace-nowrap",children:"Copier"})]})]})]}),o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 text-2xl",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Connexion CLIENT"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("code",{className:"text-xs bg-gray-100 px-3 py-2 rounded border border-gray-200 flex-1 break-all",children:H(r.slug)}),o.jsx("button",{onClick:()=>Z(H(r.slug),"CLIENT"),className:"px-4 py-2 text-sm font-medium text-green-700 bg-green-50 border border-green-200 rounded hover:bg-green-100 transition-colors whitespace-nowrap",children:"Copier"})]})]})]})]})})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" KPIs Platform V1"})}),o.jsx("div",{className:"px-6 py-4",children:c?o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4",children:[o.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-blue-700",children:c.admins}),o.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Admins"})]}),o.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-green-700",children:c.prospects}),o.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Prospects"})]}),o.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-purple-700",children:c.projects}),o.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Projets"})]}),o.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-orange-700",children:c.forms_pending}),o.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Formulaires en attente"})]}),o.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center border border-gray-200",children:[o.jsx("p",{className:"text-2xl font-bold text-gray-700",children:c.files}),o.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Fichiers"})]}),o.jsxs("div",{className:"bg-teal-50 rounded-lg p-4 text-center col-span-2 sm:col-span-3 lg:col-span-5",children:[o.jsx("p",{className:"text-sm font-medium text-teal-700",children:c.last_activity?new Date(c.last_activity).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Aucune activit"}),o.jsx("p",{className:"text-xs text-teal-600 mt-1",children:"Dernire activit"})]})]}):o.jsx("p",{className:"text-sm text-gray-500 italic",children:"Chargement des KPIs..."})})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" Pricing (interne)"})}),o.jsxs("div",{className:"px-6 py-4",children:[o.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:o.jsx("p",{className:"text-sm text-blue-700",children:" Indicateur interne  aucune facturation automatique"})}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plan tarifaire"}),o.jsxs("select",{value:j,onChange:q=>_(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"-- Non dfini --"}),o.jsx("option",{value:"standard",children:"Standard"}),o.jsx("option",{value:"custom",children:"Custom"}),o.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix mensuel de rfrence ()"}),o.jsx("input",{type:"number",value:S,onChange:q=>N(q.target.value),placeholder:"490 / 1500 / 3000 / 10000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),o.jsx("div",{className:"mt-4",children:o.jsx("button",{onClick:W,disabled:E,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:E?"Enregistrement...":"Enregistrer le pricing"})})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" Charge EVATIME (auto)"})}),o.jsxs("div",{className:"px-6 py-4",children:[o.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:o.jsx("p",{className:"text-sm text-blue-700",children:"Calcule automatiquement  partir de l'activit relle."})}),o.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:X(se).emoji}),o.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${X(se).color}`,children:X(se).label})]}),c&&o.jsxs("span",{className:"text-sm text-gray-500",children:["Score: ",(c.admins||0)*2+(c.prospects||0)+(c.forms_pending||0)*5]})]}),o.jsx("button",{onClick:U,disabled:F,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:F?"Calcul en cours...":" Recalculer"})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" Prix recommand (indicatif)"})}),o.jsxs("div",{className:"px-6 py-4",children:[o.jsx("div",{className:"mb-4 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:o.jsx("p",{className:"text-sm text-gray-600",children:"Bas sur la charge observe. Aucun changement automatique."})}),o.jsx("div",{className:"flex items-center gap-4 mb-4",children:o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg px-4 py-3",children:o.jsx("p",{className:"text-lg font-semibold text-blue-800",children:(()=>({0:" 490  / mois",1:" 1 500  / mois",2:" 3 000  / mois",3:"Sur engagement"})[se]||"Non calcul")()})})}),(()=>{const q=parseInt(S,10)||0,te=se,_e={0:490,1:1500,2:3e3,3:5e3}[te];return te==null||q===0||!_e?null:Math.abs(q-_e)/_e>.5?o.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg flex items-center gap-2",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("p",{className:"text-sm text-orange-700",children:"Prix actuel trs diffrent de la charge observe."})]}):null})()]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Organisation"})}),o.jsx("div",{className:"px-6 py-4",children:o.jsxs("dl",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[o.jsxs("div",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Nom"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:r.name})]}),o.jsxs("div",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Slug"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:r.slug})]}),o.jsxs("div",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Cre le"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(r.created_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),o.jsxs("div",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Mise  jour le"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(r.updated_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:o.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Domaines (",s.length,")"]})}),o.jsx("div",{className:"px-6 py-4",children:s.length===0?o.jsx("p",{className:"text-sm text-gray-500 italic",children:"Aucun domaine configur"}):o.jsx("div",{className:"space-y-3",children:s.map(q=>o.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:q.domain}),o.jsxs("p",{className:"text-xs text-gray-500",children:["Cr le ",new Date(q.created_at).toLocaleDateString("fr-FR")]})]}),q.is_primary&&o.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Principal"})]},q.id))})})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Paramtres"})}),o.jsx("div",{className:"px-6 py-4",children:a?o.jsxs("dl",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[o.jsxs("div",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Nom de marque"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:a.brand_name||"-"})]}),o.jsxs("div",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Logo URL"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900 break-all",children:a.logo_url||"-"})]}),o.jsxs("div",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Couleur primaire"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:a.primary_color?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:a.primary_color}}),o.jsx("span",{children:a.primary_color})]}):"-"})]}),o.jsxs("div",{children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Couleur secondaire"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:a.secondary_color?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:a.secondary_color}}),o.jsx("span",{children:a.secondary_color})]}):"-"})]}),o.jsxs("div",{className:"sm:col-span-2",children:[o.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Cr le"}),o.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(a.created_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}):o.jsx("p",{className:"text-sm text-gray-500 italic",children:"Aucun paramtre configur"})})]})]})]})},Wse=()=>{const e=Te(),[t,r]=p.useState(""),[n,s]=p.useState(""),[i,a]=p.useState(!1),[l,c]=p.useState(!0);p.useEffect(()=>{(async()=>{try{const{data:{user:d},error:h}=await T.auth.getUser();if(h||!d){c(!1);return}const{data:m,error:g}=await T.from("platform_admins").select("user_id, email").eq("user_id",d.id).single();!g&&m?e("/platform/organizations",{replace:!0}):c(!1)}catch(d){console.error("[PlatformLogin] Error checking auth:",d),c(!1)}})()},[e]);const u=async f=>{if(f.preventDefault(),!t.trim()||!/\S+@\S+\.\S+/.test(t)){B({title:"Email invalide",description:"Veuillez saisir une adresse email valide.",variant:"destructive"});return}if(!n.trim()){B({title:"Mot de passe requis",description:"Veuillez saisir votre mot de passe.",variant:"destructive"});return}try{a(!0);const{data:d,error:h}=await T.auth.signInWithPassword({email:t.trim(),password:n.trim()});if(h){console.error("[PlatformLogin] Auth error:",h),B({title:"chec de connexion",description:h.message==="Invalid login credentials"?"Email ou mot de passe incorrect.":h.message,variant:"destructive"}),a(!1);return}if(!d.user)throw new Error("Aucun utilisateur retourn aprs connexion");const{data:m,error:g}=await T.from("platform_admins").select("user_id, email").eq("user_id",d.user.id).single();if(g||!m){console.error("[PlatformLogin] User not in platform_admins:",g),await T.auth.signOut(),B({title:"Accs plateforme refus",description:"Votre compte n'est pas autoris  accder  la plateforme EVATIME.",variant:"destructive"}),a(!1);return}B({title:"Connexion russie",description:`Bienvenue ${m.email}`,className:"bg-green-500 text-white"}),e("/platform/organizations",{replace:!0})}catch(d){console.error("[PlatformLogin] Exception:",d),B({title:"Erreur",description:d.message||"Une erreur est survenue lors de la connexion.",variant:"destructive"}),a(!1)}};return l?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-white mx-auto mb-4"}),o.jsx("p",{className:"text-white font-medium",children:"Vrification de la session..."})]})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-white rounded-full mb-4",children:o.jsx(iv,{className:"w-8 h-8 text-gray-900"})}),o.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"EVATIME Platform"}),o.jsx("p",{className:"text-gray-400",children:"Accs rserv aux administrateurs plateforme"})]}),o.jsxs(le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1,duration:.5},className:"bg-white rounded-lg shadow-xl p-8",children:[o.jsxs("form",{onSubmit:u,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"email",className:"text-gray-700 font-medium",children:"Adresse email"}),o.jsxs("div",{className:"relative",children:[o.jsx(tn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx(pe,{id:"email",type:"email",value:t,onChange:f=>r(f.target.value),placeholder:"admin@evatime.com",className:"pl-10 h-12 border-gray-300 focus:border-gray-900 focus:ring-gray-900",disabled:i,autoComplete:"email",autoFocus:!0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"password",className:"text-gray-700 font-medium",children:"Mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(Gf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),o.jsx(pe,{id:"password",type:"password",value:n,onChange:f=>s(f.target.value),placeholder:"",className:"pl-10 h-12 border-gray-300 focus:border-gray-900 focus:ring-gray-900",disabled:i,autoComplete:"current-password"})]})]}),o.jsx(G,{type:"submit",disabled:i,className:"w-full h-12 bg-gray-900 hover:bg-gray-800 text-white font-semibold text-base",children:i?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"mr-2 h-5 w-5 animate-spin"}),"Connexion en cours..."]}):o.jsxs(o.Fragment,{children:[o.jsx(iv,{className:"mr-2 h-5 w-5"}),"Se connecter"]})})]}),o.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:o.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["Accs restreint aux utilisateurs avec le rle"," ",o.jsx("span",{className:"font-mono font-semibold text-gray-700",children:"platform_admin"})]})})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsxs("p",{className:"text-sm text-gray-400",children:[" ",new Date().getFullYear()," EVATIME Platform - Tous droits rservs"]})})]})})},Hse=()=>{const e=Te(),[t,r]=p.useState(!0),[n,s]=p.useState(null),[i,a]=p.useState({lowPricing:[],churnRisk:[]}),[l,c]=p.useState(""),[u,f]=p.useState([]),d=u.filter(y=>{var b,w;if(!l.trim())return!0;const x=l.toLowerCase();return((b=y.name)==null?void 0:b.toLowerCase().includes(x))||((w=y.slug)==null?void 0:w.toLowerCase().includes(x))});p.useEffect(()=>{(async()=>{try{const{data:x,error:b}=await T.rpc("platform_get_home_kpis");if(b){console.error("[PlatformHomePage] RPC error:",b),B({title:"Erreur",description:b.message,variant:"destructive"});return}if(x!=null&&x.error){console.error("[PlatformHomePage] RPC returned error:",x.error),B({title:"Erreur",description:x.error,variant:"destructive"});return}s({orgsActive:x.orgs_active||0,orgsSuspended:x.orgs_suspended||0,revenueEstimate:x.revenue_estimate||0});const w=x.orgs_data||[];f(w);const j=N=>{if(N.evatime_load_estimated!==null&&N.evatime_load_estimated!==void 0)return N.evatime_load_estimated;const E=(N.users_count||0)*2+(N.prospects_count||0);return E<=15?0:E<=40?1:E<=70?2:3},_=w.filter(N=>{const E=N.monthly_price_reference||0,C=j(N);return E>0&&E<1500&&C>=2}),S=w.filter(N=>{const E=N.monthly_price_reference||0,C=j(N);return E>=1500&&C<=1});a({lowPricing:_,churnRisk:S})}catch(x){console.error("[PlatformHomePage] Exception:",x)}finally{r(!1)}})()},[]);const h=y=>{switch(y){case 0:return{emoji:"",label:"Lger"};case 1:return{emoji:"",label:"Normal"};case 2:return{emoji:"",label:"Complexe"};case 3:return{emoji:"",label:"Critique"};default:return{emoji:"",label:"-"}}},m=y=>{if(y.evatime_load_estimated!==null&&y.evatime_load_estimated!==void 0)return y.evatime_load_estimated;const x=(y.users_count||0)*2+(y.prospects_count||0);return x<=15?0:x<=40?1:x<=70?2:3},g=y=>{switch(y){case 0:return{value:490,label:"490 "};case 1:return{value:1500,label:"1 500 "};case 2:return{value:3e3,label:"3 000 "};case 3:return{value:5e3,label:"5 000 +"};default:return{value:0,label:"-"}}},v=y=>{const x=y.monthly_price_reference||0,b=m(y),w=g(b).value;return!x||!w?"neutral":x<w*.7?"under":x>w*1.5?"over":"ok"};return t?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:" Platform Dashboard"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Vue d'ensemble de l'activit EVATIME"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[o.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-2xl",children:""})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(n==null?void 0:n.orgsActive)||0}),o.jsx("p",{className:"text-sm text-gray-600",children:"Organisations actives"})]})]})}),o.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-2xl",children:""})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(n==null?void 0:n.orgsSuspended)||0}),o.jsx("p",{className:"text-sm text-gray-600",children:"Organisations suspendues"})]})]})}),o.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:o.jsx("span",{className:"text-2xl",children:""})}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[((n==null?void 0:n.revenueEstimate)||0).toLocaleString("fr-FR")," "]}),o.jsx("p",{className:"text-sm text-gray-600",children:"Revenu mensuel estim"})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:[o.jsxs("div",{className:"px-6 py-4 bg-orange-50 border-b border-orange-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-orange-800",children:" Opportunits d'augmentation"}),o.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"EVATIME travaille beaucoup pour ces clients. Le prix actuel est infrieur  la charge observe."})]}),o.jsx("div",{className:"px-6 py-4",children:i.lowPricing.length===0?o.jsx("p",{className:"text-sm text-gray-500 italic",children:"Aucun signal"}):o.jsx("ul",{className:"space-y-2",children:i.lowPricing.slice(0,5).map(y=>{var x;return o.jsxs("li",{className:"flex items-center justify-between",children:[o.jsx("button",{onClick:()=>e(`/platform/organizations/${y.id}`),className:"text-sm text-blue-600 hover:underline",children:y.name}),o.jsxs("span",{className:"text-xs text-gray-500",children:[((x=y.monthly_price_reference)==null?void 0:x.toLocaleString("fr-FR"))||0,"   ",y.prospects_count," prospects"]})]},y.id)})})})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:[o.jsxs("div",{className:"px-6 py-4 bg-red-50 border-b border-red-200",children:[o.jsx("h3",{className:"text-lg font-semibold text-red-800",children:" Clients  risque (valeur perue)"}),o.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Ces clients paient cher mais utilisent peu EVATIME. Ils peuvent ne plus percevoir la valeur."})]}),o.jsx("div",{className:"px-6 py-4",children:i.churnRisk.length===0?o.jsx("p",{className:"text-sm text-gray-500 italic",children:"Aucun signal"}):o.jsx("ul",{className:"space-y-2",children:i.churnRisk.slice(0,5).map(y=>{var x;return o.jsxs("li",{className:"flex items-center justify-between",children:[o.jsx("button",{onClick:()=>e(`/platform/organizations/${y.id}`),className:"text-sm text-blue-600 hover:underline",children:y.name}),o.jsxs("span",{className:"text-xs text-gray-500",children:[((x=y.monthly_price_reference)==null?void 0:x.toLocaleString("fr-FR"))||0,"   ",y.prospects_count," prospects"]})]},y.id)})})})]})]}),o.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Organisations"}),o.jsxs("p",{className:"text-sm text-gray-500",children:[u.length," organisation",u.length>1?"s":""," enregistre",u.length>1?"s":""]})]}),o.jsxs("button",{onClick:()=>e("/platform/organizations?action=create"),className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[o.jsx("span",{children:"+"})," Crer une organisation"]})]}),o.jsx("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200",children:o.jsx("input",{type:"text",value:l,onChange:y=>c(y.target.value),placeholder:"Rechercher par nom, slug...",className:"w-full max-w-md px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Nom"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Charge"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actuel"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Recommand"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Prospects"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Connexions"})]})}),o.jsx("tbody",{className:"divide-y divide-gray-200",children:d.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:l?"Aucune organisation trouve":"Aucune organisation"})}):d.map(y=>o.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>e(`/platform/organizations/${y.id}`),children:[o.jsxs("td",{className:"px-6 py-4",children:[o.jsx("span",{className:"font-medium text-gray-900",children:y.name}),o.jsx("span",{className:"ml-2 text-xs text-gray-400",children:y.slug})]}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.status==="active"?" Actif":" Suspendu"})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{title:`Score estim: ${(y.users_count||0)*2+(y.prospects_count||0)}`,children:h(m(y)).emoji}),o.jsx("span",{className:"text-xs text-gray-500",children:h(m(y)).label})]})}),o.jsx("td",{className:"px-6 py-4 text-sm",children:y.monthly_price_reference?o.jsxs("span",{className:`font-medium ${v(y)==="under"?"text-orange-600":v(y)==="over"?"text-red-600":"text-gray-900"}`,children:[y.monthly_price_reference.toLocaleString("fr-FR")," "]}):o.jsx("span",{className:"text-gray-400 italic",children:"Non dfini"})}),o.jsx("td",{className:"px-6 py-4 text-sm",children:o.jsx("span",{className:"text-blue-600 font-medium",children:g(m(y)).label})}),o.jsx("td",{className:"px-6 py-4 text-center text-sm text-gray-600",children:y.prospects_count||0}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex gap-2",onClick:x=>x.stopPropagation(),children:[o.jsx("button",{onClick:()=>window.open(`https://evatime.fr/admin?org=${y.slug}`,"_blank"),className:"px-3 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-lg hover:bg-green-200 transition-colors",children:" PRO"}),o.jsx("button",{onClick:()=>window.open(`https://evatime.fr/dashboard?org=${y.slug}`,"_blank"),className:"px-3 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-lg hover:bg-blue-200 transition-colors",children:" CLIENT"})]})})]},y.id))})]})})]})]})},Km=({icon:e,title:t,description:r,badgeText:n,delay:s})=>o.jsxs(le.div,{className:"bg-white border border-[#eef1f4] rounded-2xl shadow-card p-6 flex flex-col",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:s},children:[o.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:[e," ",t]}),o.jsx("p",{className:"text-gray-600 flex-grow",children:r}),o.jsx("div",{className:"mt-4",children:o.jsx("span",{className:"inline-block bg-gray-100 text-gray-700 text-xs font-medium px-3 py-1.5 rounded-full",children:n})})]}),Gse=({isOpen:e,onOpenChange:t})=>{const r=Te(),{setActiveAdminUser:n}=Ve(),[s,i]=p.useState(""),[a,l]=p.useState(""),c=async f=>{f.preventDefault();try{const{data:d,error:h}=await T.auth.signInWithPassword({email:s,password:a});if(h){B({title:"Erreur de connexion",description:"Email ou mot de passe incorrect.",variant:"destructive"});return}const{data:m,error:g}=await T.from("users").select("*").eq("user_id",d.user.id).single();if(g||!m){logger.error(" Erreur dtaille:",g),B({title:"Erreur",description:`Compte professionnel introuvable. ${(g==null?void 0:g.message)||""}`,variant:"destructive"}),await T.auth.signOut();return}B({title:"Connexion russie !",description:"Redirection vers l'espace pro...",className:"bg-green-500 text-white"});const v={id:m.id,userId:m.user_id,name:m.name,email:m.email,role:m.role,phone:m.phone,avatarUrl:m.avatar_url,managerId:m.manager_id,accessRights:m.access_rights,createdAt:m.created_at,updatedAt:m.updated_at};n(v),t(!1),setTimeout(()=>{window.location.href="/admin"},500)}catch(d){logger.error("Pro login error:",d),B({title:"Erreur",description:"Une erreur est survenue lors de la connexion.",variant:"destructive"})}},u=()=>{r("/reset-password")};return o.jsx(bh,{open:e,onOpenChange:t,children:o.jsxs(Vc,{className:"sm:max-w-md",children:[o.jsx(qc,{children:o.jsx(Wc,{className:"text-2xl font-bold text-center",children:"Connexion Espace Pro"})}),o.jsxs("form",{onSubmit:c,className:"space-y-6 px-4 py-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"email",children:"Email"}),o.jsx(pe,{id:"email",type:"email",placeholder:"votre@email.com",required:!0,value:s,onChange:f=>i(f.target.value)})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"password",children:"Mot de passe"}),o.jsx(pe,{id:"password",type:"password",placeholder:"********",required:!0,value:a,onChange:f=>l(f.target.value)})]}),o.jsx(G,{type:"submit",className:"w-full gradient-green text-white text-lg py-6",children:"Se connecter"}),o.jsx("div",{className:"text-center",children:o.jsx("button",{type:"button",onClick:u,className:"text-sm text-blue-600 hover:underline",children:"Mot de passe oubli ?"})})]})]})})},GS=()=>{const e=Te(),[t,r]=p.useState(!1),{slugUser:n}=ma();p.useEffect(()=>{n&&sessionStorage.setItem("affiliateUser",n)},[n]);const s=()=>{e("/login")},i=()=>{e("/client-access")},a=n?`/inscription/${n}`:"/inscription";return o.jsxs("div",{className:"bg-gray-50 relative",children:[o.jsx("header",{className:"absolute top-0 right-0 p-4 md:p-6 z-20",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(G,{onClick:s,className:"gradient-green text-white shadow-soft hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:"Espace Pro"}),o.jsx(G,{onClick:i,className:"gradient-blue text-white shadow-soft hover:shadow-lg transition-all duration-300 transform hover:scale-105",children:"Espace Client"})]})}),o.jsx(Gse,{isOpen:t,onOpenChange:r}),o.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center text-center px-4",children:o.jsxs("div",{className:"relative w-full max-w-4xl",children:[o.jsxs(le.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.7,ease:"easeOut"},className:"relative z-10 space-y-6",children:[o.jsxs(le.h1,{className:"text-4xl md:text-6xl font-extrabold text-gray-900 leading-tight",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:["Gagnez ",o.jsx("span",{className:"text-green-600",children:"35% "})," sur votre lectricit, garantis entre 5 et 10 ans "]}),o.jsx(le.h2,{className:"text-4xl md:text-5xl font-extrabold text-gray-800 leading-tight",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},children:"grce  une centrale solaire  ct de chez vous "}),o.jsx(le.p,{className:"max-w-2xl mx-auto text-lg text-gray-600",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5}}),o.jsxs(le.div,{className:"flex flex-col md:flex-row items-center justify-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:[o.jsx(xi,{to:a,children:o.jsx(G,{size:"lg",className:"gradient-green text-white px-8 py-6 rounded-2xl shadow-soft hover:shadow-lg transition-all duration-300 transform hover:scale-105 text-lg font-semibold",children:"Je dmarre mon projet"})}),o.jsx("a",{href:"#comment-ca-marche",className:"mt-3 md:mt-0 md:ml-4 text-base font-medium text-[#1976D2] hover:underline focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded-md",children:"Comment a marche ?"})]})]}),o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-blue-200 rounded-full mix-blend-multiply filter blur-2xl opacity-40 animate-blob"}),o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/4 -translate-y-1/4 w-96 h-96 bg-green-200 rounded-full mix-blend-multiply filter blur-2xl opacity-40 animate-blob animation-delay-2000"}),o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-3/4 -translate-y-3/4 w-96 h-96 bg-yellow-200 rounded-full mix-blend-multiply filter blur-2xl opacity-40 animate-blob animation-delay-4000"})]})}),o.jsx("section",{id:"comment-ca-marche",className:"py-16 px-4",children:o.jsxs("div",{className:"max-w-6xl mx-auto text-center",children:[o.jsx(le.h2,{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-4",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5},children:"Comment a marche ?"}),o.jsx(le.p,{className:"max-w-3xl mx-auto text-lg text-gray-600 mb-12",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:.2},children:"Un systme simple et transparent qui permet de consommer llectricit produite par une centrale solaire locale, avec des conomies garanties."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[o.jsx(Km,{icon:"",title:"Producteur",description:"Centrale solaire photovoltaque qui produit de llectricit verte.",badgeText:" Production locale dnergie renouvelable",delay:.3}),o.jsx(Km,{icon:"",title:"PMO",description:"Association qui gre et rpartit lnergie de manire quitable.",badgeText:" Gestion transparente et bnfique pour tous",delay:.4}),o.jsx(Km,{icon:"",title:"Consommateurs",description:"Particuliers et entreprises qui bnficient dune lectricit moins chre.",badgeText:" Jusqu 40% dconomies sur la facture",delay:.5})]})]})}),o.jsx("style",{jsx:"true",children:`
        .animate-blob {
          animation: blob 7s infinite;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
        @keyframes blob {
          0% {
            transform: translate(0px, 0px) scale(1);
          }
          33% {
            transform: translate(30px, -50px) scale(1.1);
          }
          66% {
            transform: translate(-20px, 20px) scale(0.9);
          }
          100% {
            transform: translate(0px, 0px) scale(1);
          }
        }
      `})]})},Kse=()=>{const e=Te(),t=Ht(),{projectsData:r,authLoading:n,currentUser:s}=Ve(),{organizationId:i,organizationName:a}=an();p.useState("");const[l,c]=p.useState("");p.useState([]);const[u,f]=p.useState(!1),[d,h]=p.useState(!1),[m,g]=p.useState(null);p.useEffect(()=>{const y=sessionStorage.getItem("org_suspended_message");y&&(g(y),sessionStorage.removeItem("org_suspended_message"),B({title:"Organisation suspendue",description:y,variant:"destructive",duration:1e4}))},[]),p.useEffect(()=>{s&&e("/dashboard")},[s,e]),p.useEffect(()=>{var y;(y=t.state)!=null&&y.email&&(c(t.state.email),B({title:" Presque termin !",description:"Cliquez sur 'Recevoir le lien' pour accder  votre espace.",className:"bg-blue-500 text-white"}))},[t.state]),p.useMemo(()=>!r||Object.keys(r).length===0?[]:Object.values(r).filter(y=>y&&y.isPublic).map(y=>({id:y.type,label:y.clientTitle||y.title,icon:y.icon||"",color:y.color})),[r]);const v=async y=>{if(y.preventDefault(),!l.trim()||!/\S+@\S+\.\S+/.test(l)){B({title:"Email invalide",description:"Veuillez saisir une adresse email valide.",variant:"destructive"});return}if(!i){B({title:"Organisation non identifie",description:"Impossible de dterminer l'organisation. Veuillez ressayer.",variant:"destructive"});return}try{f(!0);const{data:x,error:b}=await T.rpc("check_prospect_exists_in_org",{p_email:l.trim(),p_organization_id:i});if(b)throw b;if(!x){B({title:"Compte introuvable",description:`Aucun compte client trouv avec cet email chez ${a||"cette organisation"}. Veuillez vous inscrire d'abord.`,variant:"destructive"}),f(!1);return}const w=`${window.location.origin}/dashboard`,{error:j}=await T.auth.signInWithOtp({email:l.trim(),options:{shouldCreateUser:!0,emailRedirectTo:w}});if(j)throw j;h(!0),B({title:" Email envoy !",description:"Consultez votre bote mail pour accder  votre espace.",className:"bg-green-500 text-white"})}catch(x){logger.error("Error sending magic link:",x),B({title:"Erreur",description:x.message||"Impossible d'envoyer le lien. Veuillez ressayer.",variant:"destructive"})}finally{f(!1)}};return n||!r||Object.keys(r).length===0?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:o.jsxs("div",{className:"text-center",children:[o.jsx(De,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Chargement..."})]})}):m?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 to-orange-100 p-4",children:o.jsxs(le.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center",children:[o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto",children:o.jsx("span",{className:"text-4xl",children:""})})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Accs suspendu"}),o.jsx("p",{className:"text-gray-600 mb-6",children:m}),o.jsx(G,{onClick:()=>e("/"),variant:"outline",className:"w-full",children:"Retour  l'accueil"})]})}):d?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:o.jsxs(le.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full text-center",children:[o.jsx("div",{className:"mb-6",children:o.jsx(Wf,{className:"w-20 h-20 text-green-500 mx-auto"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Email envoy !"}),o.jsxs("p",{className:"text-gray-600 mb-6",children:["Nous vous avons envoy un lien scuris  ",o.jsx("strong",{children:l}),".",o.jsx("br",{}),o.jsx("br",{}),"Cliquez sur le lien dans l'email pour accder  votre espace client."]}),o.jsx(G,{onClick:()=>e("/"),variant:"outline",className:"w-full",children:"Retour  l'accueil"})]})}):o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-3xl shadow-2xl p-8 max-w-lg w-full",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Connexion Client"}),o.jsx("p",{className:"text-gray-600",children:"Recevez un lien scuris pour accder  votre espace"})]}),o.jsxs("form",{onSubmit:v,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"email",children:"Votre adresse email"}),o.jsxs("div",{className:"relative mt-2",children:[o.jsx(tn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"email",type:"email",placeholder:"jean.dupont@email.com",value:l,onChange:y=>c(y.target.value),className:"pl-10",disabled:u})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("span",{className:"w-full border-t"})}),o.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:o.jsx("span",{className:"bg-white px-2 text-gray-500",children:"Ou continuer avec"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs(G,{type:"button",variant:"outline",disabled:!0,className:"opacity-50 cursor-not-allowed",children:[o.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]}),o.jsxs(G,{type:"button",variant:"outline",disabled:!0,className:"opacity-50 cursor-not-allowed",children:[o.jsx("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),"Apple"]})]}),o.jsx("p",{className:"text-xs text-center text-gray-500",children:"Connexion sociale bientt disponible"})]}),o.jsx(G,{type:"submit",className:"w-full gradient-blue text-white py-6 text-lg font-semibold",disabled:u,children:u?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"w-5 h-5 mr-2 animate-spin"}),"Envoi en cours..."]}):"Recevoir mon lien scuris"}),o.jsx("p",{className:"text-xs text-center text-gray-500",children:"Un lien unique vous sera envoy par email pour accder  votre espace en toute scurit."})]}),o.jsxs("div",{className:"mt-6 text-center space-y-2",children:[o.jsxs("p",{className:"text-sm text-gray-600",children:["Pas encore de compte ?"," ",o.jsx("button",{onClick:()=>e("/inscription"),className:"text-blue-600 font-medium hover:underline",children:"Crer un compte"})]}),o.jsx("button",{onClick:()=>e("/"),className:"text-sm text-gray-500 hover:underline block mx-auto",children:" Retour  l'accueil"})]})]})})},Yse=()=>{const e=Te(),{setActiveAdminUser:t}=Ve(),[r,n]=p.useState(""),[s,i]=p.useState(""),[a,l]=p.useState(!1),[c,u]=p.useState(null);p.useEffect(()=>{const h=sessionStorage.getItem("org_suspended_message");h&&(u(h),sessionStorage.removeItem("org_suspended_message"),B({title:"Organisation suspendue",description:h,variant:"destructive",duration:1e4}))},[]);const f=async h=>{h.preventDefault(),l(!0);try{const{data:m,error:g}=await T.auth.signInWithPassword({email:r,password:s});if(g){B({title:"Erreur de connexion",description:"Email ou mot de passe incorrect.",variant:"destructive"}),l(!1);return}const{data:v,error:y}=await T.from("users").select("*").eq("user_id",m.user.id).single();if(y||!v){P.error(" Erreur dtaille:",y),B({title:"Erreur",description:`Compte professionnel introuvable. ${(y==null?void 0:y.message)||""}`,variant:"destructive"}),await T.auth.signOut(),l(!1);return}if(v.organization_id){const{data:b,error:w}=await T.rpc("platform_get_org_status",{p_org_id:v.organization_id});if(!w&&(b==null?void 0:b.status)==="suspended"){await T.auth.signOut(),B({title:"Organisation suspendue",description:"Votre organisation est temporairement suspendue. Contactez le support.",variant:"destructive",duration:1e4}),l(!1);return}}B({title:"Connexion russie !",description:"Chargement de votre espace...",className:"bg-green-500 text-white"});const x={id:v.id,userId:v.user_id,name:v.name,email:v.email,role:v.role,phone:v.phone,avatarUrl:v.avatar_url,managerId:v.manager_id,accessRights:v.access_rights,createdAt:v.created_at,updatedAt:v.updated_at};t(x),setTimeout(()=>{e("/admin/pipeline")},1200)}catch(m){P.error("Pro login error:",m),B({title:"Erreur",description:"Une erreur est survenue lors de la connexion.",variant:"destructive"}),l(!1)}},d=()=>{e("/reset-password")};return c?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-100 flex flex-col items-center justify-center px-4",children:o.jsx(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto",children:o.jsx("span",{className:"text-4xl",children:""})})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Accs suspendu"}),o.jsx("p",{className:"text-gray-600 mb-6",children:c}),o.jsx(G,{onClick:()=>e("/"),variant:"outline",className:"w-full",children:"Retour  l'accueil"})]})})}):o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 flex flex-col items-center justify-center px-4",children:[o.jsxs("button",{onClick:()=>e("/"),className:"absolute top-6 left-6 text-gray-600 hover:text-gray-900 flex items-center gap-2 transition-colors",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Retour  l'accueil"})]}),o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Espace Pro"}),o.jsx("p",{className:"text-gray-600",children:"Connectez-vous  votre compte professionnel"})]}),o.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:o.jsxs("form",{onSubmit:f,className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"email",children:"Email professionnel"}),o.jsx(pe,{id:"email",type:"email",placeholder:"votre@email.com",required:!0,value:r,onChange:h=>n(h.target.value),className:"h-12"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"password",children:"Mot de passe"}),o.jsx(pe,{id:"password",type:"password",placeholder:"********",required:!0,value:s,onChange:h=>i(h.target.value),className:"h-12"})]}),o.jsx(G,{type:"submit",disabled:a,className:"w-full h-12 gradient-green text-white text-lg font-semibold",children:a?"Connexion...":"Se connecter"}),o.jsx("div",{className:"text-center",children:o.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:underline",children:"Mot de passe oubli ?"})})]})}),o.jsx("div",{className:"mt-6 text-center",children:o.jsxs("p",{className:"text-sm text-gray-600",children:["Vous tes un client ?"," ",o.jsx("button",{onClick:()=>e("/client-access"),className:"text-blue-600 hover:underline font-medium",children:"Accdez  votre espace client"})]})})]})]})};function FD({organizationId:e=null,enabled:t=!0}={}){const[r,n]=p.useState([]),[s,i]=p.useState(!0),[a,l]=p.useState(null),c=p.useRef(!1),u=p.useRef(null);p.useEffect(()=>{!t||!e||u.current!==e&&(u.current=e,f(e))},[e,t]),p.useEffect(()=>{if(!t||!e)return;const y=T.channel(`project-templates-changes-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"project_templates",filter:`organization_id=eq.${e}`},x=>{var w;if(c.current){c.current=!1;return}if((w=x.new)!=null&&w.organization_id&&x.new.organization_id!==e)return;const b=j=>({...j,clientTitle:j.client_title,isPublic:j.is_public,coverImage:j.image_url,clientDescription:j.client_description,ctaText:j.cta_text});x.eventType==="INSERT"?n(j=>j.find(S=>S.id===x.new.id)?j:[...j,b(x.new)]):x.eventType==="UPDATE"?n(j=>j.map(_=>_.id===x.new.id?b(x.new):_)):x.eventType==="DELETE"&&n(j=>j.filter(_=>_.id!==x.old.id))}).subscribe();return()=>{T.removeChannel(y)}},[e]);const f=async y=>{try{i(!0),l(null);const{data:x,error:b}=await T.rpc("get_project_templates_for_org",{p_organization_id:y});if(b)throw b;const w=(Array.isArray(x)?x:[]).map(j=>({...j,clientTitle:j.client_title,isPublic:j.is_public,coverImage:j.image_url,clientDescription:j.client_description,ctaText:j.cta_text}));w.sort((j,_)=>(j.type||"").localeCompare(_.type||"")),n(w)}catch(x){P.error("Erreur fetch project templates:",{error:x.message}),l(x.message)}finally{i(!1)}};return{projectTemplates:r,loading:s,error:a,addTemplate:async y=>{if(!e)throw new Error("organization_id requis pour crer un template");try{c.current=!0;const x={...y,organization_id:e},{data:b,error:w}=await T.from("project_templates").insert([x]).select().single();if(w)throw w;const j={...b,clientTitle:b.client_title,isPublic:b.is_public,coverImage:b.image_url,clientDescription:b.client_description,ctaText:b.cta_text};return n(_=>[..._,j]),j}catch(x){throw P.error("Erreur cration template:",{error:x.message}),c.current=!1,x}},updateTemplate:async(y,x)=>{try{c.current=!0;const{data:b,error:w}=await T.from("project_templates").update(x).eq("id",y).select().single();if(w)throw w;const j={...b,clientTitle:b.client_title,isPublic:b.is_public,coverImage:b.image_url,clientDescription:b.client_description,ctaText:b.cta_text};return n(_=>_.map(S=>S.id===y?j:S)),j}catch(b){throw P.error("Erreur modification template:",{error:b.message}),c.current=!1,b}},deleteTemplate:async y=>{try{c.current=!0;const{error:x}=await T.from("project_templates").delete().eq("id",y);if(x)throw x;n(b=>b.filter(w=>w.id!==y))}catch(x){throw P.error("Erreur suppression template:",{error:x.message}),c.current=!1,x}},getTemplateByType:y=>r.find(x=>x.type===y),getPublicTemplates:()=>r.filter(y=>y.is_public===!0),refresh:f}}const KS=()=>{const e=Te(),{slugUser:t}=ma(),{currentUser:r,activeAdminUser:n,setActiveAdminUser:s}=Ve(),{organizationId:i}=an(),{projectTemplates:a,loading:l}=FD({organizationId:i}),[c,u]=p.useState([]),[f,d]=p.useState({name:"",email:""}),[h,m]=p.useState({}),[g,v]=p.useState({id:null,name:null}),[y,x]=p.useState(!1),[b,w]=p.useState(!1);p.useEffect(()=>{localStorage.removeItem("activeAdminUser"),localStorage.removeItem("adminUser"),localStorage.removeItem("users"),n&&s(null)},[n,s]);const j=p.useMemo(()=>!a||a.length===0?[]:a.filter(C=>C.isPublic||C.is_public).map(C=>({id:C.type,label:C.clientTitle||C.client_title,icon:C.icon})),[a]);p.useEffect(()=>{r&&(B({title:"Vous tes dj connect",description:"Redirection vers votre espace client...",variant:"destructive"}),setTimeout(()=>e("/dashboard"),2e3))},[r,e]),p.useEffect(()=>{const C=t||sessionStorage.getItem("affiliateUser");C&&T.from("users").select("id, name, affiliate_slug").eq("affiliate_slug",C).single().then(({data:k,error:L})=>{k&&!L?v({id:k.id,name:k.name}):console.error(" Commercial non trouv pour le slug:",C,L)})},[t]);const _=C=>{u(k=>k.includes(C)?k.filter(L=>L!==C):[...k,C])},S=C=>{const{id:k,value:L}=C.target;d(A=>({...A,[k]:L}))},N=()=>{const C={};return f.name||(C.name="Le nom complet est requis."),f.email?/\S+@\S+\.\S+/.test(f.email)||(C.email="L'adresse e-mail est invalide."):C.email="L'adresse e-mail est requise.",m(C),Object.keys(C).length===0},E=async C=>{if(C.preventDefault(),!!N()){if(c.length===0){B({title:"Slection requise",description:"Veuillez slectionner au moins un projet.",variant:"destructive"});return}try{x(!0);const k=[...new Set(c)],{data:L,error:A}=await T.rpc("check_prospect_exists_in_org",{p_email:f.email.trim(),p_organization_id:i});if(A){console.error("Error checking prospect:",A),B({title:"Erreur",description:"Impossible de vrifier l'email. Ressayez.",variant:"destructive"}),x(!1);return}if(L){B({title:"Compte existant",description:"Un compte existe dj avec cet email dans cette organisation. Connectez-vous plutt.",variant:"destructive"}),x(!1);return}const{data:R,error:O}=await T.rpc("create_affiliated_prospect",{p_name:f.name,p_email:f.email.trim(),p_phone:null,p_company:null,p_address:"",p_affiliate_slug:t||null,p_tags:k,p_status:null,p_host:window.location.hostname});if(O)throw console.error(" Erreur cration prospect:",O),O;const z=`${window.location.origin}/dashboard`,{error:F}=await T.auth.signInWithOtp({email:f.email.trim(),options:{shouldCreateUser:!0,emailRedirectTo:z}});if(F)throw F;sessionStorage.removeItem("affiliateUser"),w(!0),B({title:" Compte cr !",description:"Un email vous a t envoy. Cliquez sur le lien pour accder  votre espace.",className:"bg-green-500 text-white",duration:5e3})}catch(k){B({title:"Erreur",description:k.message||"Une erreur est survenue lors de l'inscription.",variant:"destructive"})}finally{x(!1)}}};return b?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:o.jsxs(le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full max-w-lg bg-white p-8 rounded-2xl shadow-soft text-center",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(tn,{className:"w-8 h-8 text-green-600"})}),o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:" Inscription russie !"}),o.jsx("p",{className:"text-lg text-gray-600 mb-4",children:"Un email avec un lien de connexion vous a t envoy  :"}),o.jsx("p",{className:"text-xl font-semibold text-blue-600 mb-6",children:f.email}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[o.jsxs("p",{className:"text-sm text-gray-700",children:[" ",o.jsx("strong",{children:"Vrifiez votre bote mail"})," et cliquez sur le lien pour accder  votre espace client."]}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Le lien est valide pendant 60 minutes."})]})]}),o.jsx(G,{onClick:()=>e("/client-access"),className:"w-full gradient-blue text-white",children:"Retour  la connexion"})]})}):o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-lg bg-white p-8 rounded-2xl shadow-soft",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 text-center mb-2",children:"Choisissez vos projets"}),o.jsx("p",{className:"text-center text-gray-600 mb-8",children:"Commencez par slectionner les projets qui vous intressent."}),o.jsxs("form",{onSubmit:E,className:"space-y-6",children:[o.jsx("div",{className:"space-y-4",children:j.map((C,k)=>o.jsx(le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*(k+1)},children:o.jsxs(ee,{htmlFor:C.id,className:`flex items-center space-x-3 p-4 rounded-lg border-2 cursor-pointer transition-all ${c.includes(C.id)?"bg-green-50 border-green-300":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[o.jsx(sr,{id:C.id,checked:c.includes(C.id),onCheckedChange:()=>_(C.id)}),o.jsxs("span",{className:"text-base font-medium text-gray-800 flex items-center",children:[o.jsx("span",{className:"mr-2",children:C.icon})," ",C.label]})]})},C.id))}),o.jsxs("div",{className:"space-y-4 pt-6 border-t mt-6",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"name",children:"Nom complet"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(Ac,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"name",placeholder:"Jean Dupont",onChange:S,value:f.name,className:"pl-10",disabled:y})]}),h.name&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.name})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"email",children:"Email"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(tn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"email",type:"email",placeholder:"jean.dupont@email.com",onChange:S,value:f.email,className:"pl-10",disabled:y})]}),h.email&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.email})]})]}),o.jsx(G,{type:"submit",size:"lg",className:"w-full gradient-green text-white text-base font-semibold py-6 rounded-xl shadow-soft hover:shadow-lg transition-all transform hover:scale-105",disabled:y,children:y?"Inscription...":"Crer mon compte"}),o.jsx("div",{className:"text-center",children:o.jsxs("p",{className:"text-sm text-gray-600",children:["Dj un compte ?"," ",o.jsx("button",{type:"button",onClick:()=>e("/client-access"),className:"text-blue-600 font-medium hover:underline",children:"Se connecter"})]})})]})]})})},Jse=()=>{const e=Te(),[t,r]=p.useState(!1),[n,s]=p.useState({companyName:"",adminEmail:"",adminPassword:""}),[i,a]=p.useState({}),l=f=>{const{id:d,value:h}=f.target;s(m=>({...m,[d]:h})),i[d]&&a(m=>({...m,[d]:""}))},c=()=>{const f={};return(!n.companyName||n.companyName.trim().length<2)&&(f.companyName="Le nom de l'entreprise doit contenir au moins 2 caractres"),(!n.adminEmail||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.adminEmail))&&(f.adminEmail="Email invalide"),(!n.adminPassword||n.adminPassword.length<6)&&(f.adminPassword="Le mot de passe doit contenir au moins 6 caractres"),a(f),Object.keys(f).length===0},u=async f=>{if(f.preventDefault(),!c()){B({title:"Erreur de validation",description:"Veuillez corriger les erreurs dans le formulaire",variant:"destructive"});return}r(!0);try{const d=await fetch("https://vvzxvtiyybilkswslqfn.supabase.co/functions/v1/create_organization_onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyName:n.companyName.trim(),adminEmail:n.adminEmail.trim().toLowerCase(),adminPassword:n.adminPassword})}),h=await d.json();if(!d.ok)throw console.error("[SignupPage] Edge Function error:",h),new Error(h.error||"Erreur lors de la cration de l'organisation");if(!(h!=null&&h.success))throw console.error("[SignupPage] Edge Function returned error:",h),new Error((h==null?void 0:h.error)||"Erreur lors de la cration de l'organisation");B({title:" Organisation cre avec succs !",description:"Vous pouvez maintenant vous connecter avec vos identifiants.",className:"bg-green-500 text-white"}),setTimeout(()=>{e("/login",{state:{email:n.adminEmail.trim().toLowerCase(),message:"Votre organisation a t cre ! Connectez-vous pour accder  votre espace."}})},1500)}catch(d){console.error("[SignupPage] Error:",d),B({title:"Erreur",description:d.message||"Une erreur est survenue lors de la cration de l'organisation",variant:"destructive"})}finally{r(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:[o.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:o.jsx(rv,{className:"w-8 h-8 text-blue-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Crer votre organisation"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Commencez votre essai gratuit en quelques clics"})]}),o.jsxs("form",{onSubmit:u,className:"space-y-5",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"companyName",className:"text-sm font-medium text-gray-700 mb-1.5",children:"Nom de l'entreprise *"}),o.jsxs("div",{className:"relative",children:[o.jsx(rv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx(pe,{id:"companyName",type:"text",placeholder:"Ex: Acme Corporation",value:n.companyName,onChange:l,disabled:t,className:`pl-10 ${i.companyName?"border-red-500":""}`})]}),i.companyName&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.companyName})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"adminEmail",className:"text-sm font-medium text-gray-700 mb-1.5",children:"Email administrateur *"}),o.jsxs("div",{className:"relative",children:[o.jsx(tn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx(pe,{id:"adminEmail",type:"email",placeholder:"admin@acme.com",value:n.adminEmail,onChange:l,disabled:t,className:`pl-10 ${i.adminEmail?"border-red-500":""}`})]}),i.adminEmail&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.adminEmail})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"adminPassword",className:"text-sm font-medium text-gray-700 mb-1.5",children:"Mot de passe *"}),o.jsxs("div",{className:"relative",children:[o.jsx(Gf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),o.jsx(pe,{id:"adminPassword",type:"password",placeholder:"Minimum 6 caractres",value:n.adminPassword,onChange:l,disabled:t,className:`pl-10 ${i.adminPassword?"border-red-500":""}`})]}),i.adminPassword&&o.jsx("p",{className:"text-red-500 text-xs mt-1",children:i.adminPassword})]}),o.jsx(G,{type:"submit",disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3",children:t?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"w-5 h-5 mr-2 animate-spin"}),"Cration en cours..."]}):"Crer mon organisation"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsxs("p",{className:"text-sm text-gray-600",children:["Vous avez dj un compte ?"," ",o.jsx("button",{onClick:()=>e("/client-access"),className:"text-blue-600 hover:text-blue-700 font-medium",disabled:t,children:"Se connecter"})]})})]}),o.jsx("div",{className:"mt-4 text-center",children:o.jsx("p",{className:"text-xs text-gray-500",children:" Vos donnes sont scurises et chiffres"})})]})})},Xse=()=>{const e=Te(),{setUserProjects:t,addProspect:r,setCurrentUser:n}=Ve(),[s,i]=p.useState({company:"",name:"",email:"",phone:"",password:""}),[a,l]=p.useState({}),c=d=>{const{id:h,value:m}=d.target;i(g=>({...g,[h]:m}))},u=()=>{const d={};return s.company||(d.company="Le nom de l'entreprise est requis."),s.name||(d.name="Le nom complet est requis."),s.email?/\S+@\S+\.\S+/.test(s.email)||(d.email="L'adresse e-mail est invalide."):d.email="L'adresse e-mail est requise.",s.phone||(d.phone="Le numro de tlphone est requis."),s.password?s.password.length<6&&(d.password="Le mot de passe doit contenir au moins 6 caractres."):d.password="Le mot de passe est requis.",l(d),Object.keys(d).length===0},f=d=>{if(d.preventDefault(),u()){const h=["ProducteurPro"],m={id:`prospect-${Date.now()}`,name:s.name,companyName:s.company,email:s.email,phone:s.phone,address:"",tags:h,status:"Intress",hasAppointment:!1};r(m),t&&t(h);const g={id:m.id,name:m.name,email:m.email};n(g),B({title:"Inscription russie !",description:"Bienvenue dans votre espace partenaire Evatime."}),e("/dashboard")}};return o.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:o.jsx("div",{className:"container mx-auto px-4 py-16 lg:py-24",children:o.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-24 items-center",children:[o.jsxs(le.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.8},className:"space-y-8",children:[o.jsxs("h1",{className:"text-4xl lg:text-6xl font-extrabold tracking-tight",children:["Vendez votre lectricit  un tarif ",o.jsx("span",{className:"text-green-400",children:"plus attractif"})," que l'EDF OA."]}),o.jsx("p",{className:"text-lg text-gray-300",children:"Grce  l'autoconsommation collective (ACC), vous pouvez vendre votre surplus d'nergie directement aux consommateurs locaux, en court-circuitant les tarifs d'obligation d'achat. Augmentez la rentabilit de vos centrales, qu'il s'agisse d'une seule installation ou d'un parc entier."}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"bg-green-500/20 p-2 rounded-full",children:o.jsx(N3,{className:"h-5 w-5 text-green-400"})}),o.jsxs("p",{children:[o.jsx("span",{className:"font-bold",children:"Rentabilit Maximale :"})," Obtenez un meilleur prix pour chaque kWh produit."]})]}),o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"bg-green-500/20 p-2 rounded-full",children:o.jsx(Pi,{className:"h-5 w-5 text-green-400"})}),o.jsxs("p",{children:[o.jsx("span",{className:"font-bold",children:"Circuit Court :"})," Vendez localement et renforcez votre impact territorial."]})]}),o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"bg-green-500/20 p-2 rounded-full",children:o.jsx(gP,{className:"h-5 w-5 text-green-400"})}),o.jsxs("p",{children:[o.jsx("span",{className:"font-bold",children:"Simplicit Garantie :"})," Notre plateforme gre la complexit administrative pour vous."]})]})]})]}),o.jsxs(le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.8,delay:.2},className:"bg-white/10 backdrop-blur-md p-8 rounded-2xl shadow-2xl border border-white/20",children:[o.jsx("h2",{className:"text-3xl font-bold text-center mb-6",children:"Devenez Partenaire Producteur"}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"company",className:"text-gray-300",children:"Nom de l'entreprise"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(x3,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"company",placeholder:"Solar Corp",onChange:c,value:s.company,className:"pl-10 bg-white/10 text-white placeholder-gray-400 border-white/30 focus:ring-green-400 focus:border-green-400"})]}),a.company&&o.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.company})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"name",className:"text-gray-300",children:"Nom complet"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(Ac,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"name",placeholder:"Jack Dupont",onChange:c,value:s.name,className:"pl-10 bg-white/10 text-white placeholder-gray-400 border-white/30 focus:ring-green-400 focus:border-green-400"})]}),a.name&&o.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.name})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"phone",className:"text-gray-300",children:"Tlphone"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(kc,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"phone",type:"tel",placeholder:"06 12 34 56 78",onChange:c,value:s.phone,className:"pl-10 bg-white/10 text-white placeholder-gray-400 border-white/30 focus:ring-green-400 focus:border-green-400"})]}),a.phone&&o.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.phone})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"email",className:"text-gray-300",children:"Email"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(tn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"email",type:"email",placeholder:"jack.dupont@email.com",onChange:c,value:s.email,className:"pl-10 bg-white/10 text-white placeholder-gray-400 border-white/30 focus:ring-green-400 focus:border-green-400"})]}),a.email&&o.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.email})]}),o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"password",className:"text-gray-300",children:"Mot de passe"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(Gf,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),o.jsx(pe,{id:"password",type:"password",placeholder:"",onChange:c,value:s.password,className:"pl-10 bg-white/10 text-white placeholder-gray-400 border-white/30 focus:ring-green-400 focus:border-green-400"})]}),a.password&&o.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.password})]}),o.jsx(G,{type:"submit",size:"lg",className:"w-full bg-green-500 hover:bg-green-600 text-gray-900 font-bold py-6 rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105 mt-4",children:"Je maximise mes revenus"})]})]})]})})})};function Qse(){var r,n,s,i,a,l,c,u,f;const[e,t]=p.useState({projects:null,pipeline:null,company:null,loading:!0,error:null});return p.useEffect(()=>{async function d(){try{const{data:h,error:m}=await T.from("project_templates").select("*");if(m)throw m;const{data:g,error:v}=await T.from("global_pipeline_steps").select("*").order("position");if(v)throw v;const{data:y,error:x}=await T.from("company_settings").select("*").limit(1).single();if(x)throw x;t({projects:h,pipeline:g,company:y,loading:!1,error:null})}catch(h){logger.error(" Erreur:",h),t(m=>({...m,loading:!1,error:h}))}}d()},[]),e.loading?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Test de connexion Supabase en cours..."})]})}):e.error?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-2xl w-full",children:[o.jsx("h1",{className:"text-2xl font-bold text-red-800 mb-4",children:" Erreur de connexion"}),o.jsx("pre",{className:"bg-red-100 p-4 rounded text-sm overflow-auto",children:JSON.stringify(e.error,null,2)})]})}):o.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:" Connexion Supabase russie !"}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:[" Modles de projets (",(r=e.projects)==null?void 0:r.length,")"]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(n=e.projects)==null?void 0:n.map(d=>o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[o.jsx("div",{className:"text-2xl mb-2",children:d.icon}),o.jsx("h3",{className:"font-semibold text-gray-900",children:d.title}),o.jsx("p",{className:"text-sm text-gray-600",children:d.type}),o.jsx("p",{className:"text-xs text-gray-500 mt-2",children:d.is_public?" Public":" Priv"})]},d.id))})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:[" tapes du pipeline (",(s=e.pipeline)==null?void 0:s.length,")"]}),o.jsx("div",{className:"flex gap-4 overflow-x-auto",children:(i=e.pipeline)==null?void 0:i.map(d=>o.jsxs("div",{className:`${d.color} border border-gray-300 rounded-lg p-4 min-w-[150px]`,children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:d.label}),o.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Position: ",d.position]})]},d.id))})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:" Paramtres de l'entreprise"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{className:"text-gray-700",children:[o.jsx("span",{className:"font-semibold",children:"Nom:"})," ",(a=e.company)==null?void 0:a.company_name]}),o.jsxs("p",{className:"text-gray-700",children:[o.jsx("span",{className:"font-semibold",children:"Formulaire de contact:"})," ",((u=(c=(l=e.company)==null?void 0:l.settings)==null?void 0:c.contact_form_config)==null?void 0:u.length)||0," champs"]}),((f=e.company)==null?void 0:f.logo_url)&&o.jsx("img",{src:e.company.logo_url,alt:"Logo",className:"h-16 mt-4"})]})]}),o.jsx("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-4",children:o.jsxs("p",{className:"text-sm text-blue-800",children:[" ",o.jsx("strong",{children:"Astuce:"})," Ouvre la console du navigateur (F12) pour voir les logs dtaills."]})})]})})}const Zse=()=>{const[e]=Bf(),t=Te(),[r,n]=p.useState(!1),[s,i]=p.useState(""),[a,l]=p.useState(""),[c,u]=p.useState(!1),[f,d]=p.useState(!1);p.useEffect(()=>{(async()=>{const g=new URLSearchParams(window.location.hash.substring(1)),v=g.get("access_token");g.get("type");const y=g.get("error"),x=g.get("error_description"),b=e.get("token"),w=e.get("type");if(y){logger.error(" Erreur dans le hash:",y,x),B({title:"Erreur d'authentification",description:x||"Une erreur est survenue.",variant:"destructive"}),setTimeout(()=>t("/"),3e3);return}v||b&&w==="recovery"||(console.warn(" Aucun token de rcupration valide trouv"),console.warn("URL complte:",window.location.href),B({title:"Lien invalide",description:"Ce lien de rinitialisation n'est pas valide ou a expir.",variant:"destructive"}),setTimeout(()=>t("/"),3e3))})()},[e,t]);const h=async m=>{if(m.preventDefault(),s!==a){B({title:"Erreur",description:"Les mots de passe ne correspondent pas.",variant:"destructive"});return}if(s.length<6){B({title:"Erreur",description:"Le mot de passe doit contenir au moins 6 caractres.",variant:"destructive"});return}n(!0);try{const{error:g}=await T.auth.updateUser({password:s});if(g)throw g;const{data:{user:v}}=await T.auth.getUser();if(v){const{data:y}=await T.from("prospects").select("*").eq("user_id",v.id).single();y?(B({title:" Compte activ",description:"Bienvenue ! Votre compte a t activ avec succs.",className:"bg-green-500 text-white"}),setTimeout(()=>{t("/dashboard")},1500)):(B({title:" Mot de passe modifi",description:"Votre mot de passe a t rinitialis avec succs.",className:"bg-green-500 text-white"}),setTimeout(()=>{t("/")},2e3))}else B({title:" Mot de passe modifi",description:"Vous pouvez maintenant vous connecter.",className:"bg-green-500 text-white"}),setTimeout(()=>{t("/")},2e3)}catch(g){logger.error("Erreur rinitialisation mot de passe:",g),B({title:"Erreur",description:g.message||"Impossible de rinitialiser le mot de passe.",variant:"destructive"})}finally{n(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-lg p-8",children:[o.jsxs("div",{className:"space-y-1 mb-6",children:[o.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 mb-4 mx-auto",children:o.jsx(Gf,{className:"w-6 h-6 text-blue-600"})}),o.jsx("h1",{className:"text-2xl font-bold text-center",children:"Rinitialiser le mot de passe"}),o.jsx("p",{className:"text-center text-gray-600",children:"Choisissez un nouveau mot de passe pour votre compte"})]}),o.jsx("div",{children:o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"password",children:"Nouveau mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(pe,{id:"password",type:c?"text":"password",placeholder:"Au moins 6 caractres",value:s,onChange:m=>i(m.target.value),required:!0,disabled:r,className:"pr-10"}),o.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:c?o.jsx(Ql,{className:"w-4 h-4"}):o.jsx(Zl,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(ee,{htmlFor:"confirmPassword",children:"Confirmer le mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(pe,{id:"confirmPassword",type:f?"text":"password",placeholder:"Retapez votre mot de passe",value:a,onChange:m=>l(m.target.value),required:!0,disabled:r,className:"pr-10"}),o.jsx("button",{type:"button",onClick:()=>d(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:f?o.jsx(Ql,{className:"w-4 h-4"}):o.jsx(Zl,{className:"w-4 h-4"})})]})]}),o.jsx(G,{type:"submit",className:"w-full",disabled:r,children:r?"Rinitialisation...":"Rinitialiser le mot de passe"}),o.jsx("div",{className:"text-center",children:o.jsx("button",{type:"button",onClick:()=>t("/"),className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Retour  la connexion"})})]})})]})})};function eie(){const{signatureProcedureId:e}=ma(),[t]=Bf(),r=t.get("token"),[n,s]=p.useState(!0),[i,a]=p.useState(null),[l,c]=p.useState(null),[u,f]=p.useState(null),[d,h]=p.useState(!1),[m,g]=p.useState(!1),[v,y]=p.useState(!1);p.useEffect(()=>{x()},[e,r]);const x=async()=>{try{if(s(!0),a(null),!r){a("Token manquant"),s(!1);return}P.debug("Chargement procdure",{signatureProcedureId:e,token:r});const{data:w,error:j}=await T.from("signature_procedures").select("*, project_files!signature_procedures_file_id_fkey(*)").eq("id",e).eq("access_token",r).single();if(j||!w){P.error("Erreur chargement procdure",j),a("Lien invalide ou expir"),s(!1);return}if(new Date(w.access_token_expires_at)<new Date){a("Lien expir - Veuillez contacter votre conseiller"),s(!1);return}if(w.status==="refused"||w.status==="cancelled"){a(`Signature ${w.status==="refused"?"refuse":"annule"}`),s(!1);return}c(w);const{data:S}=await T.from("signature_proofs").select("id, created_at").eq("signature_procedure_id",w.id).eq("signer_email",w.signer_email).maybeSingle();if(S){P.info("Signataire principal a dj sign",{email:w.signer_email,signedAt:S.created_at}),y(!0),s(!1);return}P.debug(" Procdure charge",{signer_name:w.signer_name,signer_email:w.signer_email,status:w.status});const{data:N,error:E}=await T.storage.from("project-files").createSignedUrl(w.project_files.storage_path,3600);if(E){P.error("Erreur cration URL signe",E),a("Impossible de charger le PDF"),s(!1);return}f(N.signedUrl),s(!1)}catch(w){P.error("Erreur chargement procdure",w),a("Erreur lors du chargement"),s(!1)}},b=async()=>{if(!d){alert("Veuillez accepter les conditions avant de signer");return}try{g(!0),P.debug("Tlchargement PDF pour calcul hash...");const _=await(await(await fetch(u)).blob()).arrayBuffer(),S=await crypto.subtle.digest("SHA-256",_),E=Array.from(new Uint8Array(S)).map(I=>I.toString(16).padStart(2,"0")).join("");P.debug("Hash SHA-256 calcul",{documentHash:E.substring(0,16)+"..."});const{data:C,error:k}=await T.functions.invoke("internal-signature",{body:{signature_procedure_id:e,signer_email:l.signer_email,signer_user_id:null,pdf_file_id:l.file_id,pdf_hash:E}});if(k)throw P.error("Erreur cration preuve signature",k),k;P.debug("Preuve de signature cre",C);const{data:L}=await T.from("signature_procedures").select("signers").eq("id",e).single(),A=((L==null?void 0:L.signers)||[]).map(I=>I.email===l.signer_email&&I.role==="principal"?{...I,status:"signed",signed_at:new Date().toISOString()}:I),R=A.some(I=>I.status==="pending"),O=R?"partially_signed":"completed";P.debug(" Analyse des signataires:",{totalSigners:A.length,signedCount:A.filter(I=>I.status==="signed").length,pendingCount:A.filter(I=>I.status==="pending").length,hasPendingSigners:R,globalStatus:O,allSigners:A});const z={signed_at:new Date().toISOString(),user_agent:navigator.userAgent,platform:navigator.platform,language:navigator.language,screen_resolution:`${window.screen.width}x${window.screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,consent_text:"En signant lectroniquement ce document, je reconnais avoir lu et accept l'intgralit des termes du contrat ci-joint. Je consens  l'utilisation de la signature lectronique et reconnais qu'elle a la mme valeur juridique qu'une signature manuscrite.",signature_method:"AES_eIDAS_art26",document_hash_algorithm:"SHA-256"},{data:F,error:V}=await T.from("signature_procedures").update({status:O,signers:A,signed_at:new Date().toISOString(),document_hash:E,signature_metadata:z}).eq("id",e).eq("access_token",r).select().single();if(V)throw P.error("Erreur mise  jour signature",V),V;if(P.debug("Signature enregistre avec succs",{procedureId:e,signer_name:F.signer_name,signer_email:F.signer_email,globalStatus:O,signed_at:F.signed_at}),O==="completed"){P.debug(" Status = completed - Appel generate-signed-pdf",{procedure_id:e});const{data:I,error:D}=await T.functions.invoke("generate-signed-pdf",{body:{signature_procedure_id:e}});D?P.error(" Erreur gnration PDF sign",D):P.debug(" PDF sign gnr avec succs",I)}else P.debug(" Status = partially_signed - Attente des co-signataires",{globalStatus:O,pendingSigners:A.filter(I=>I.status==="pending")});c(F),y(!0),g(!1)}catch(w){P.error("Erreur signature",w),a(`Erreur lors de la signature: ${w.message}`),g(!1)}};return n?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(De,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Chargement du document..."})]})}):i?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[o.jsx(d0,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Accs refus"}),o.jsx("p",{className:"text-gray-600",children:i})]})}):v&&l?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-green-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[o.jsx(Wf,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contrat sign !"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Votre signature lectronique a t enregistre avec succs."}),o.jsxs("div",{className:"text-sm text-gray-500 space-y-1 bg-gray-50 p-4 rounded-lg",children:[o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Signataire:"})," ",l.signer_name]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Email:"})," ",l.signer_email]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Date:"})," ",new Date(l.signed_at).toLocaleString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-4 md:p-8",children:o.jsxs("div",{className:"max-w-5xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-t-lg shadow-lg p-6 border-b",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Signature lectronique"}),o.jsxs("p",{className:"text-gray-600",children:["Signataire: ",o.jsx("span",{className:"font-semibold",children:l==null?void 0:l.signer_name})," (",l==null?void 0:l.signer_email,")"]}),o.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Expire le: ",new Date(l==null?void 0:l.access_token_expires_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),o.jsxs("div",{className:"bg-white shadow-lg p-6 border-b",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document  signer"}),o.jsx("div",{className:"border rounded-lg overflow-hidden",style:{height:"600px"},children:o.jsx("iframe",{src:u,className:"w-full h-full",title:"Document PDF"})})]}),o.jsxs("div",{className:"bg-white shadow-lg p-6 rounded-b-lg",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Consentement  la signature lectronique"}),o.jsx("p",{className:"text-sm text-blue-800 leading-relaxed",children:"En signant lectroniquement ce document, je reconnais avoir lu et accept l'intgralit des termes du contrat ci-joint. Je consens  l'utilisation de la signature lectronique conforme au rglement eIDAS (article 26) et reconnais qu'elle a la mme valeur juridique qu'une signature manuscrite."}),o.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"Cette signature est horodate et scelle par un hash cryptographique SHA-256 du document."})]}),o.jsxs("div",{className:"flex items-start space-x-3 mb-6",children:[o.jsx(sr,{id:"accept",checked:d,onCheckedChange:h,className:"mt-1"}),o.jsx("label",{htmlFor:"accept",className:"text-sm text-gray-700 cursor-pointer",children:"J'ai lu et accept les termes du contrat, et je consens  signer lectroniquement ce document"})]}),o.jsx(G,{onClick:b,disabled:!d||m,className:"w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold py-6 text-lg",children:m?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"w-5 h-5 animate-spin mr-2"}),"Signature en cours..."]}):o.jsx(o.Fragment,{children:" Signer le contrat"})}),o.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Signature lectronique avance (AES) conforme au rglement eIDAS (UE) n910/2014 - Article 26"})]})]})})}const tie=()=>{const[e]=Bf();Te();const t=e.get("token"),[r,n]=p.useState("otp"),[s,i]=p.useState(""),[a,l]=p.useState(!1),[c,u]=p.useState(""),[f,d]=p.useState(null),[h,m]=p.useState(""),[g,v]=p.useState(""),[y,x]=p.useState(""),[b,w]=p.useState(!1),[j,_]=p.useState(!1),[S,N]=p.useState(3),[E,C]=p.useState(!1);p.useEffect(()=>{if(!t){u("Token manquant");return}(async()=>{var O;try{l(!0);const{data:z,error:F}=await T.from("cosigner_invite_tokens").select("signature_procedure_id, signer_email").eq("token",t).single();if(F||!z){u("Lien invalide"),l(!1);return}const{data:V,error:I}=await T.from("signature_procedures").select("*").eq("id",z.signature_procedure_id).single();if(I||!V){u("Procdure de signature introuvable"),l(!1);return}d(V);const D=(O=V.signers)==null?void 0:O.find(U=>U.email===z.signer_email&&U.role==="cosigner");m(z.signer_email),v((D==null?void 0:D.name)||z.signer_email);const{data:$}=await T.from("signature_proofs").select("id, created_at").eq("signature_procedure_id",V.id).eq("signer_email",z.signer_email).maybeSingle();if($){P.info("Co-signataire a dj sign",{email:z.signer_email,signedAt:$.created_at}),_(!0),l(!1);return}l(!1);const M=`otp_requested_${t}`;localStorage.getItem(M)||(k(),localStorage.setItem(M,Date.now().toString()),setTimeout(()=>localStorage.removeItem(M),10*60*1e3))}catch(z){P.error("Erreur chargement procdure",z),u("Erreur chargement"),l(!1)}})()},[t]);const k=async()=>{try{l(!0),u("");const{data:R,error:O}=await T.functions.invoke("send-cosigner-otp",{body:{token:t}});if(O){u(O.message||"Erreur envoi OTP");return}if(R!=null&&R.already_signed){P.info("Co-signataire a dj sign",{signedAt:R.signed_at}),_(!0),l(!1);return}N(3),u(""),R!=null&&R.dev_otp&&window.location.hostname==="localhost"&&(P.debug("OTP DEV:",R.dev_otp),console.log(" [DEV ONLY] Votre OTP:",R.dev_otp))}catch(R){P.error("Erreur requestOtp",R),u("Erreur envoi OTP")}finally{l(!1)}},L=async R=>{if(R.preventDefault(),s.length!==6){u("Le code doit contenir 6 chiffres");return}try{l(!0),u("");const{data:O,error:z}=await T.functions.invoke("verify-cosigner-otp",{body:{token:t,otp:s}});if(z||O!=null&&O.error){const V=(O==null?void 0:O.error)||(z==null?void 0:z.message)||"Code incorrect";u(V),(O==null?void 0:O.remaining_attempts)!==void 0&&N(O.remaining_attempts),l(!1);return}d(O.procedure),m(O.procedure.signer_email),v(O.procedure.signer_name||O.procedure.signer_email);const{data:F}=await T.from("project_files").select("storage_path").eq("id",O.procedure.file_id).single();if(F!=null&&F.storage_path){const{data:V}=await T.storage.from("project-files").createSignedUrl(F.storage_path,3600);V!=null&&V.signedUrl&&(x(V.signedUrl),n("pdf"))}}catch(O){P.error("Erreur verifyOtp",O),u("Erreur vrification")}finally{l(!1)}},A=async()=>{try{w(!0),u("");const z=await(await(await fetch(y)).blob()).arrayBuffer(),F=await crypto.subtle.digest("SHA-256",z),I=Array.from(new Uint8Array(F)).map(X=>X.toString(16).padStart(2,"0")).join("");P.debug("Cosigner signature - PDF hash calcul",{pdfHash:I});const{data:D,error:$}=await T.functions.invoke("internal-signature",{body:{signature_procedure_id:f.id,signer_email:h,signer_user_id:null,pdf_file_id:f.file_id,pdf_hash:I}});if($){P.error("Erreur signature cosigner",$),u("Erreur lors de la signature"),w(!1);return}P.debug("Preuve de signature cre",D);const{data:M,error:W}=await T.from("signature_procedures").select("id, signers").eq("id",f.id).single();if(W){P.error("Erreur rcupration procdure",W),u("Erreur lors de la signature"),w(!1);return}if(!M){P.error("Procdure introuvable"),u("Procdure introuvable"),w(!1);return}const U=M.id;if(M!=null&&M.signers){const X=M.signers.map(oe=>oe.email===h&&oe.role==="cosigner"?{...oe,status:"signed",signed_at:new Date().toISOString()}:oe),me=X.some(oe=>oe.status==="pending"),se=me?"partially_signed":"completed";P.debug(" Co-signataire - Analyse des signataires:",{email:h,procedureId:U,totalSigners:X.length,signedCount:X.filter(oe=>oe.status==="signed").length,pendingCount:X.filter(oe=>oe.status==="pending").length,hasPendingSigners:me,globalStatus:se,allSigners:X});const{error:Z}=await T.from("signature_procedures").update({signers:X,status:se}).eq("id",U);if(Z){P.error("Erreur mise  jour procdure",Z),u("Erreur lors de la signature"),w(!1);return}if(P.debug("Procdure mise  jour avec succs",{globalStatus:se}),se==="completed"){P.debug(" Co-signataire - Status = completed - Appel generate-signed-pdf",{signature_procedure_id:U});const{data:oe,error:H}=await T.functions.invoke("generate-signed-pdf",{body:{signature_procedure_id:U}});H?P.error(" Co-signataire - Erreur gnration PDF sign",H):P.debug(" Co-signataire - PDF sign gnr avec succs",oe)}else P.debug(" Co-signataire - Status = partially_signed - Attente d'autres signataires",{globalStatus:se,pendingSigners:X.filter(oe=>oe.status==="pending")})}_(!0),w(!1)}catch(R){P.error("Erreur handleSign",R),u("Erreur lors de la signature"),w(!1)}};return t?j?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-green-100 flex items-center justify-center p-4",children:o.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[o.jsx(Wf,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contrat sign !"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Votre signature lectronique a t enregistre avec succs."}),f&&h&&o.jsxs("div",{className:"text-sm text-gray-500 space-y-1 bg-gray-50 p-4 rounded-lg",children:[o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Signataire:"})," ",g]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Email:"})," ",h]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Date:"})," ",new Date().toLocaleString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})}):o.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4",children:o.jsx("div",{className:"max-w-4xl mx-auto",children:r==="otp"?o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md mx-auto",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx(iv,{className:"w-16 h-16 text-blue-600 mx-auto mb-4"}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Vrification de scurit"}),o.jsx("p",{className:"text-gray-600 mt-2",children:"Un code  6 chiffres a t envoy par email"})]}),o.jsxs("form",{onSubmit:L,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(ee,{htmlFor:"otp",children:"Code de vrification"}),o.jsx(pe,{id:"otp",type:"text",value:s,onChange:R=>i(R.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"text-center text-2xl tracking-widest",maxLength:6,disabled:a}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Tentatives restantes: ",S]})]}),c&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:o.jsx("p",{className:"text-sm text-red-700",children:c})}),o.jsx(G,{type:"submit",className:"w-full",disabled:a||s.length!==6,children:a?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"w-4 h-4 mr-2 animate-spin"}),"Vrification..."]}):"Vrifier le code"}),o.jsx(G,{type:"button",variant:"outline",className:"w-full",onClick:k,disabled:a,children:"Renvoyer un code"})]})]}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-4 md:p-8",children:o.jsxs("div",{className:"max-w-5xl mx-auto",children:[o.jsxs("div",{className:"bg-white rounded-t-lg shadow-lg p-6 border-b",children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Signature lectronique - Co-signataire"}),o.jsxs("p",{className:"text-gray-600",children:["Signataire: ",o.jsx("span",{className:"font-semibold",children:f==null?void 0:f.signer_email})]}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Document vrifi et scuris"})]}),o.jsxs("div",{className:"bg-white shadow-lg p-6 border-b",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document  signer"}),c&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:o.jsx("p",{className:"text-sm text-red-700",children:c})}),o.jsx("div",{className:"border rounded-lg overflow-hidden",style:{height:"600px"},children:o.jsx("iframe",{src:y,className:"w-full h-full",title:"Document PDF"})})]}),o.jsxs("div",{className:"bg-white shadow-lg p-6 rounded-b-lg",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[o.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Consentement  la signature lectronique"}),o.jsx("p",{className:"text-sm text-blue-800 leading-relaxed",children:"En signant lectroniquement ce document, je reconnais avoir lu et accept l'intgralit des termes du contrat ci-joint. Je consens  l'utilisation de la signature lectronique conforme au rglement eIDAS (article 26) et reconnais qu'elle a la mme valeur juridique qu'une signature manuscrite."}),o.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"Cette signature est horodate et scelle par un hash cryptographique SHA-256 du document."})]}),o.jsxs("div",{className:"flex items-start space-x-3 mb-6",children:[o.jsx(sr,{id:"accept",checked:E,onCheckedChange:C,className:"mt-1"}),o.jsx("label",{htmlFor:"accept",className:"text-sm text-gray-700 cursor-pointer",children:"J'ai lu et accept les termes du contrat, et je consens  signer lectroniquement ce document"})]}),o.jsx(G,{onClick:A,disabled:!E||b,className:"w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold py-6 text-lg",children:b?o.jsxs(o.Fragment,{children:[o.jsx(De,{className:"w-5 h-5 animate-spin mr-2"}),"Signature en cours..."]}):o.jsx(o.Fragment,{children:" Signer le contrat"})}),o.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Signature lectronique avance (AES) conforme au rglement eIDAS (UE) n910/2014 - Article 26"})]})]})})})}):o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-red-600",children:"Token manquant"})})})},BD=p.createContext(null),rie=({children:e})=>{const[t,r]=p.useState(null),[n,s]=p.useState(null),[i,a]=p.useState(null),[l,c]=p.useState(null),[u,f]=p.useState(null),[d,h]=p.useState(null),[m,g]=p.useState(!0),[v,y]=p.useState(!1);p.useEffect(()=>{(async()=>{var w;try{const j=window.location.hostname,{data:_,error:S}=await T.rpc("resolve_organization_from_host",{host:j});if(S){console.warn("[PublicOrg] RPC error, fallback to platform:",S.message),y(!0),g(!1);return}const N=(_==null?void 0:_.id)||Array.isArray(_)&&((w=_[0])==null?void 0:w.id)||(typeof _=="string"?_:null);if(!N){console.info("[PublicOrg] No org found for hostname, using platform defaults"),y(!0),g(!1);return}r(N),y(!1);const{data:E,error:C}=await T.from("organization_settings").select("display_name, logo_url, primary_color, secondary_color, landing_page_config").eq("organization_id",N).single();!C&&E&&(s(E.display_name),a(E.logo_url),c(E.primary_color),f(E.secondary_color),h(E.landing_page_config)),g(!1)}catch(j){console.error("[PublicOrg] Exception:",j),y(!0),g(!1)}})()},[]),p.useEffect(()=>{l&&document.documentElement.style.setProperty("--primary",l),u&&document.documentElement.style.setProperty("--secondary",u)},[l,u]),p.useEffect(()=>{n&&(document.title=n)},[n]);const x={organizationId:t,brandName:n||"EVATIME",logoUrl:i||"/evatime-logo.png",primaryColor:l,secondaryColor:u,landingConfig:d,loading:m,isPlatform:v};return o.jsx(BD.Provider,{value:x,children:e})},nie=()=>{const e=p.useContext(BD);if(e)return{organizationId:e.organizationId,isPlatformOrg:e.isPlatform,brandName:e.brandName,logoUrl:e.logoUrl,organizationLoading:e.loading,landingConfig:e.landingConfig};const t=p.useContext(_y);return t?{organizationId:t.organizationId,isPlatformOrg:t.isPlatformOrg,brandName:t.brandName,logoUrl:t.logoUrl,organizationLoading:t.organizationLoading,landingConfig:null}:{organizationId:null,isPlatformOrg:!0,brandName:"EVATIME",logoUrl:"/evatime-logo.png",organizationLoading:!1,landingConfig:null}};function hd(){const{toast:e}=jP(),{organizationId:t,isPlatformOrg:r,brandName:n,logoUrl:s,organizationLoading:i,landingConfig:a}=nie(),l=a,c=r||!t,u=c?"EVATIME":n||"EVATIME",f=c?"/evatime-logo.png":s||"/evatime-logo.png",d=["Gnration automatique de devis personnaliss","Cration de factures intelligentes","Suivi des paiements en temps rel","Relances clients automatises","Rapports d'activit instantans"],h=[{icon:ov,title:"Automatisations intelligentes",description:"L'IA gre vos tches rptitives pendant que vous vous concentrez sur l'essentiel",gradient:"from-blue-500 to-cyan-500"},{icon:Ln,title:"Formulaires & questionnaires IA",description:"Crez des formulaires adaptatifs qui s'ajustent automatiquement aux rponses",gradient:"from-cyan-500 to-blue-600"},{icon:z3,title:"Workflows automatiques",description:"Orchestrez vos processus mtier sans une ligne de code",gradient:"from-blue-600 to-indigo-600"},{icon:T3,title:"Documents instantans",description:"Gnrez devis, factures et contrats en quelques secondes",gradient:"from-indigo-600 to-blue-500"},{icon:_3,title:"Paiements & signatures",description:"Encaissez et faites signer vos documents en un clic",gradient:"from-blue-500 to-cyan-600"},{icon:sv,title:"Gestion de projets complte",description:"Pilotez tous vos projets depuis une interface unifie",gradient:"from-cyan-600 to-blue-500"},{icon:S3,title:"Donnes connectes en temps rel",description:"Synchronisation instantane de toutes vos informations",gradient:"from-blue-500 to-indigo-500"}],m=[{icon:pj,title:"Qualification du projet",description:"Le client remplit un formulaire intelligent qui collecte les informations cls sur son projet (localisation, consommation, type de toiture...). L'IA analyse les donnes en temps rel pour valider l'ligibilit du projet."},{icon:Xl,title:"Pr-tude automatique",description:"L'IA gnre instantanment une pr-tude complte : Le client peut simuler lui mme son installation."},{icon:R3,title:"tude technique",description:"Si le client est intress, l'IA assigne le projet  un technicien. Le technicien complte les informations sur site via une application, et l'IA met  jour l'tude technique en temps rel."},{icon:$3,title:"Offre personnalise",description:"Sur la base de l'tude finalise, l'IA gnre une offre commerciale dtaille et personnalise, incluant le plan de financement et les garanties. Elle est envoye automatiquement au client. Un rdv avec un commercial en visio ou sur le terrain est souvent ncssaire pour le contact humain et facilit la rcupration des documents"},{icon:fj,title:"Signature & Paiement",description:"Le client peut signer lectroniquement son devis en un clic en direct avec un closer au telephone ou what app. L'IA dclenche ensuite la demande d'acompte et suit le paiement en temps rel."},{icon:mj,title:"Dmarches administratives",description:"Une fois le devis sign, l'IA pr-remplit tous les documents administratifs ncessaires (mairie, Enedis...) et suit leur avancement, vous notifiant  chaque tape cl."},{icon:U3,title:"Installation & Mise en service",description:"L'IA planifie l'intervention avec le client et les quipes techniques. Elle gnre le rapport de fin de chantier et dclenche la facturation finale une fois l'installation valide."}],g=[{icon:pj,title:"Qualification du besoin",description:"Le client dcrit son projet de piscine via un questionnaire interactif : dimensions, type (enterre, hors-sol), options (chauffage, volet...). L'IA affine les questions pour cerner prcisment ses attentes."},{icon:m0,title:"tude du terrain",description:"L'IA analyse l'adresse du client, les rgles d'urbanisme locales (PLU) et utilise des donnes satellites pour une premire validation de la faisabilit technique (accs, topographie)."},{icon:C3,title:"Proposition de modles adapts",description:"En fonction du budget, des dimensions et des contraintes du terrain, l'IA propose une slection de modles de piscines et d'amnagements pertinents, avec des visuels 3D."},{icon:Ln,title:"Offre complte & devis",description:"Une fois le modle choisi, l'IA gnre un devis dtaill incluant la piscine, les quipements, les travaux de terrassement et les options, le tout envoy instantanment au client."},{icon:fj,title:"Signature & paiement acompte",description:"Le client signe son devis en ligne. L'IA gnre la facture d'acompte et propose le paiement en ligne pour lancer officiellement le projet."},{icon:mj,title:"Dclarations & dmarches",description:"L'IA prpare automatiquement la dclaration pralable de travaux ou la demande de permis de construire avec toutes les pices ncessaires, prte  tre dpose en mairie."},{icon:M3,title:"Prparation & travaux",description:"L'IA coordonne le planning des quipes (terrassement, maonnerie, pose...) et informe le client en temps rel de l'avancement du chantier  chaque tape cl."},{icon:P3,title:"Mise en eau & livraison",description:"Une fois les travaux termins, l'IA planifie la mise en eau, gnre le procs-verbal de rception et envoie les guides d'entretien personnaliss au client."}],v="https://horizons-cdn.hostinger.com/0006a1c4-b9a7-4c6e-882d-144771383456/3bfa51980327b635c396a2f5c6661668.png",y="https://horizons-cdn.hostinger.com/0006a1c4-b9a7-4c6e-882d-144771383456/1f9d3e047ee189487d139fbe166d1557.png",x=()=>{e({title:"Fonctionnalit  venir !",description:" Cette fonctionnalit n'est pas encore implmentemais ne vous inquitez pas ! "})},b=()=>{const w=l||{},j=w.hero_title||`Bienvenue chez ${u}`,_=w.hero_subtitle||"Suivez l'avancement de votre projet en temps rel",S=w.hero_cta_text||"Je dmarre mon projet",N=w.show_how_it_works!==!1,E=w.blocks||[{title:"tude",description:"Analyse de votre projet"},{title:"Installation",description:"Ralisation des travaux"},{title:"Suivi",description:"Accompagnement continu"}];return o.jsxs(o.Fragment,{children:[o.jsx("section",{className:"pt-32 pb-20 px-6",children:o.jsx("div",{className:"container mx-auto max-w-6xl",children:o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center",children:[o.jsx("h1",{className:"text-5xl md:text-7xl font-bold mb-6 bg-gradient-to-r from-gray-900 via-blue-900 to-cyan-900 bg-clip-text text-transparent leading-tight",children:j}),o.jsx("p",{className:"text-xl md:text-2xl text-gray-600 mb-12 max-w-3xl mx-auto",children:_}),o.jsxs("div",{className:"flex justify-center items-center gap-4",children:[o.jsx(G,{onClick:()=>window.location.href="/inscription",className:"bg-[#22c55e] hover:bg-[#16a34a] hover:scale-105 text-white rounded-full px-10 py-6 text-lg font-semibold transition-transform duration-200",children:S}),N&&o.jsx("button",{onClick:()=>{var C;return(C=document.getElementById("how-it-works"))==null?void 0:C.scrollIntoView({behavior:"smooth"})},className:"text-[#22c55e] hover:text-[#16a34a] font-medium text-lg transition-colors",children:w.how_it_works_title||"Comment a marche ?"})]})]})})}),N&&o.jsx("section",{id:"how-it-works",className:"py-20 px-6 bg-gradient-to-br from-blue-50 to-cyan-50",children:o.jsxs("div",{className:"container mx-auto max-w-6xl",children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-center mb-16 text-gray-900",children:w.how_it_works_title||"Comment a marche ?"}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:E.map((C,k)=>o.jsxs(le.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5,delay:k*.1},viewport:{once:!0},className:"bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-shadow",children:[o.jsx("div",{className:"w-16 h-16 flex items-center justify-center text-4xl mb-4",children:C.icon||k+1}),o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:C.title}),o.jsx("p",{className:"text-gray-600",children:C.description})]},k))})]})}),o.jsx("section",{className:"py-20 px-6 bg-gradient-to-br from-blue-600 via-cyan-600 to-blue-700",children:o.jsx("div",{className:"container mx-auto max-w-4xl text-center",children:o.jsxs(le.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-8",children:"Prt  commencer ?"}),o.jsx(G,{onClick:()=>window.location.href="/inscription",className:"bg-white text-blue-600 hover:bg-gray-100 rounded-full px-10 py-6 text-lg shadow-xl font-semibold",children:S})]})})}),o.jsx("footer",{className:"bg-gray-900 text-white py-12 px-6",children:o.jsx("div",{className:"container mx-auto max-w-6xl",children:o.jsxs("div",{className:"flex flex-col items-center gap-6",children:[o.jsxs("div",{className:"flex flex-col items-center gap-3",children:[f&&o.jsx("div",{className:"w-12 h-12 flex items-center justify-center",children:o.jsx("img",{src:f,alt:`${u} Logo`,className:"w-full h-full object-contain"})}),o.jsx("span",{className:"text-xl font-bold",children:u}),o.jsxs("p",{className:"text-gray-400 text-sm",children:[" ",new Date().getFullYear()," ",u,". Tous droits rservs."]})]}),o.jsx(G,{onClick:()=>window.location.href="/partner/login",className:"bg-[#f97316] hover:bg-[#ea580c] hover:scale-105 text-white rounded-full px-8 py-3 font-semibold transition-transform duration-200 shadow-lg",children:"Espace Partenaire"})]})})})]})};return i?o.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):!c&&i?o.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o.jsxs(o.Fragment,{children:[o.jsxs(qd,{children:[o.jsx("title",{children:"EVATIME - L'IA qui pilote votre activit"}),o.jsx("meta",{name:"description",content:"Automatisez votre activit avec l'intelligence artificielle. Formulaires IA, workflows automatiques, documents instantans et gestion de projets complte."})]}),o.jsxs("div",{className:"min-h-screen bg-white",children:[o.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-xl border-b border-gray-100",children:o.jsx("div",{className:"container mx-auto px-6 py-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"flex items-center gap-4",children:s?o.jsx("div",{className:"h-12 flex items-center justify-center",children:o.jsx("img",{src:s,alt:`${u} Logo`,className:"h-full object-contain max-w-[200px]"})}):o.jsx("div",{children:o.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent",children:u})})}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(G,{onClick:()=>window.location.href="/login",className:"bg-[#22c55e] hover:bg-[#16a34a] hover:scale-105 text-white rounded-full px-6 font-medium transition-transform duration-200",children:"Espace Pro"}),o.jsx(G,{onClick:()=>window.location.href="/client-access",className:"bg-[#0ea5e9] hover:bg-[#0284c7] hover:scale-105 text-white rounded-full px-6 font-medium transition-transform duration-200",children:"Espace Client"})]})]})})}),!c&&b(),c&&o.jsxs(o.Fragment,{children:[o.jsx("section",{className:"pt-32 pb-20 px-6",children:o.jsx("div",{className:"container mx-auto max-w-6xl",children:o.jsxs(le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center",children:[o.jsxs("h1",{className:"text-5xl md:text-7xl font-bold mb-6 bg-gradient-to-r from-gray-900 via-blue-900 to-cyan-900 bg-clip-text text-transparent leading-tight",children:["L'IA qui pilote",o.jsx("br",{}),"votre activit"," ",o.jsx("img",{src:y,alt:"Rocket icon",className:"inline-block h-20 w-20 align-middle -mt-5 ml-1"})]}),o.jsx("p",{className:"text-xl md:text-2xl text-gray-600 mb-12 max-w-3xl mx-auto",children:"Automatisez vos processus, gnrez vos documents et pilotez votre entreprise avec l'intelligence artificielle"}),o.jsx("div",{className:"flex justify-center",children:o.jsxs(G,{onClick:x,className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white rounded-full px-8 py-6 text-lg shadow-xl",children:["Essayer gratuitement",o.jsx(dj,{className:"ml-2 h-5 w-5"})]})})]})})}),o.jsx("section",{className:"py-20 px-6 bg-gradient-to-br from-blue-50 to-cyan-50",children:o.jsxs("div",{className:"container mx-auto max-w-6xl",children:[o.jsxs(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6 text-gray-900",children:"Comment a marche ?"}),o.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Une plateforme qui connecte votre entreprise, vos clients et l'IA pour automatiser l'ensemble de votre activit"})]}),o.jsxs(le.div,{initial:{opacity:0,scale:.95},whileInView:{opacity:1,scale:1},viewport:{once:!0},className:"grid md:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-lg border border-gray-100",children:[o.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center mb-6",children:o.jsx("span",{className:"text-3xl",children:""})}),o.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900",children:"Votre entreprise"}),o.jsx("p",{className:"text-gray-600",children:"Dites  EVATIME comment vous travaillez. Elle transforme vos tapes en un systme 100 % automatis."})]}),o.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-lg border border-gray-100",children:[o.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center mb-6",children:o.jsx(ov,{className:"h-8 w-8 text-white"})}),o.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900",children:"L'IA EVATIME"}),o.jsx("p",{className:"text-gray-600",children:"Elle cre les formulaires, pose les bonnes questions, collecte les documents, envoie les relances, gre le pipeline et vous notifie uniquement quand il faut agir."})]}),o.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-lg border border-gray-100",children:[o.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-600 to-indigo-600 flex items-center justify-center mb-6",children:o.jsx("span",{className:"text-3xl",children:""})}),o.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900",children:"Vos clients"}),o.jsx("p",{className:"text-gray-600",children:"Une interface simple o ils envoient leurs infos, dposent leurs documents, signent, paient et suivent l'avancement, sans jamais vous dranger."})]})]})]})}),o.jsx("section",{className:"py-20 px-6 bg-white",children:o.jsxs("div",{className:"container mx-auto max-w-5xl",children:[o.jsx(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-16",children:o.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6 text-gray-900",children:"Exemple : Workflow automatis pour une socit solaire"})}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-0 h-full w-px bg-gray-200 hidden md:block"}),m.map((w,j)=>o.jsxs(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:j*.15},className:"relative flex md:items-center mb-12",children:[o.jsxs("div",{className:`flex items-center w-full md:w-1/2 ${j%2===0?"md:pr-12":"md:pl-12 md:ml-auto md:text-right"}`,children:[o.jsx("div",{className:"flex-shrink-0 w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center md:hidden mr-4",children:o.jsx(w.icon,{className:"h-8 w-8 text-white"})}),o.jsxs("div",{className:"w-full",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:w.title}),o.jsx("p",{className:"text-gray-600",children:w.description})]})]}),o.jsx("div",{className:"hidden md:flex absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 w-16 h-16 rounded-full bg-white border-4 border-gray-200 items-center justify-center",children:o.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center",children:o.jsx(w.icon,{className:"h-6 w-6 text-white"})})})]},j))]}),o.jsxs(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"mt-16 bg-gradient-to-r from-blue-600 to-cyan-600 rounded-2xl p-8 text-center text-white flex flex-col md:flex-row items-center justify-between gap-6",children:[o.jsx("p",{className:"text-xl font-semibold",children:"Ce processus est 100% automatique et pilot par l'IA d'EVATIME"}),o.jsxs(G,{onClick:x,variant:"outline",className:"bg-white/10 text-white hover:bg-white/20 border-white/30 rounded-full px-6 py-3 flex-shrink-0",children:["Voir un autre exemple de workflow",o.jsx(Gn,{className:"ml-2 h-4 w-4"})]})]})]})}),o.jsx("section",{className:"py-20 px-6",children:o.jsx("div",{className:"container mx-auto max-w-6xl",children:o.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[o.jsxs(le.div,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},viewport:{once:!0},children:[o.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-50 text-blue-700 px-4 py-2 rounded-full mb-6",children:[o.jsx(gP,{className:"h-4 w-4"}),o.jsx("span",{className:"text-sm font-semibold",children:"Automatisations intelligentes"})]}),o.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6 text-gray-900",children:"L'IA travaille pour vous 24/7"}),o.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Librez-vous des tches rptitives et concentrez-vous sur ce qui compte vraiment : dvelopper votre activit"}),o.jsx("div",{className:"space-y-4",children:d.map((w,j)=>o.jsxs(le.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:j*.1},className:"flex items-start gap-3",children:[o.jsx(Wf,{className:"h-6 w-6 text-blue-600 flex-shrink-0 mt-1"}),o.jsx("span",{className:"text-gray-700 text-lg",children:w})]},j))})]}),o.jsx(le.div,{initial:{opacity:0,x:30},whileInView:{opacity:1,x:0},viewport:{once:!0},className:"relative",children:o.jsxs("div",{className:"relative rounded-3xl overflow-hidden shadow-2xl border border-gray-100",children:[o.jsx("img",{alt:"Automatisations intelligentes EVATIME",className:"w-full h-auto",src:"https://images.unsplash.com/photo-1516383274235-5f42d6c6426d"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-blue-900/20 to-transparent"})]})})]})})}),o.jsx("section",{className:"py-20 px-6 bg-gray-50",children:o.jsxs("div",{className:"container mx-auto max-w-7xl",children:[o.jsxs(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6 text-gray-900",children:"Tout ce dont vous avez besoin"}),o.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Une suite complte d'outils pilots par l'IA pour grer votre activit de A  Z"})]}),o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:h.map((w,j)=>o.jsxs(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:j*.1},className:"bg-white rounded-3xl p-8 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100 group cursor-pointer",children:[o.jsx("div",{className:`w-14 h-14 rounded-2xl bg-gradient-to-br ${w.gradient} flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300`,children:o.jsx(w.icon,{className:"h-7 w-7 text-white"})}),o.jsx("h3",{className:"text-2xl font-bold mb-3 text-gray-900",children:w.title}),o.jsx("p",{className:"text-gray-600 leading-relaxed",children:w.description})]},j))})]})}),o.jsx("section",{className:"py-20 px-6 bg-gray-50",children:o.jsxs("div",{className:"container mx-auto max-w-5xl",children:[o.jsxs(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6 text-gray-900",children:"Exemple : Workflow pour un constructeur de piscine"}),o.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Du premier contact  la mise en eau, EVATIME gnre et pilote automatiquement l'intgralit du processus pour chaque projet de construction de piscine."})]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-0 h-full w-px bg-gray-200 hidden md:block"}),g.map((w,j)=>o.jsxs(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:j*.15},className:"relative flex md:items-center mb-12",children:[o.jsxs("div",{className:`flex items-center w-full md:w-1/2 ${j%2!==0?"md:pr-12":"md:pl-12 md:ml-auto md:text-right"}`,children:[o.jsx("div",{className:"flex-shrink-0 w-16 h-16 rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center md:hidden mr-4",children:o.jsx(w.icon,{className:"h-8 w-8 text-white"})}),o.jsxs("div",{className:"w-full",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:w.title}),o.jsx("p",{className:"text-gray-600",children:w.description})]})]}),o.jsx("div",{className:"hidden md:flex absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 w-16 h-16 rounded-full bg-white border-4 border-gray-200 items-center justify-center",children:o.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center",children:o.jsx(w.icon,{className:"h-6 w-6 text-white"})})})]},j))]}),o.jsx(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"mt-12 text-center",children:o.jsxs("p",{className:"text-lg text-gray-700 font-medium bg-blue-50 p-4 rounded-lg inline-block",children:["Tout ce workflow piscine est gnr automatiquement ds qu'un client dmarre un projet."," ",o.jsx("span",{className:"font-bold text-blue-700",children:"EVATIME s'adapte  chaque mtier."})]})})]})}),o.jsxs("section",{className:"py-32 px-6 bg-gradient-to-br from-blue-600 via-cyan-600 to-blue-700 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-10",children:o.jsx("div",{className:"absolute top-0 left-0 w-full h-full",style:{backgroundImage:"radial-gradient(circle, white 1px, transparent 1px)",backgroundSize:"50px 50px"}})}),o.jsx("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:o.jsxs(le.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},children:[o.jsx("h2",{className:"text-4xl md:text-6xl font-bold mb-6 text-white",children:"Prt  transformer votre activit ?"}),o.jsx("p",{className:"text-xl md:text-2xl text-blue-100 mb-12",children:"Rejoignez les entreprises qui ont choisi l'intelligence artificielle pour piloter leur croissance"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsxs(G,{onClick:x,className:"bg-white text-blue-600 hover:bg-gray-100 rounded-full px-10 py-6 text-lg shadow-xl font-semibold",children:["Commencer gratuitement",o.jsx(dj,{className:"ml-2 h-5 w-5"})]}),o.jsx(G,{onClick:x,variant:"outline",className:"border-2 border-white text-white hover:bg-white/10 rounded-full px-10 py-6 text-lg",children:"Planifier une dmo"})]})]})})]})]}),o.jsx("footer",{className:"bg-gray-900 text-white py-12 px-6",children:o.jsx("div",{className:"container mx-auto max-w-6xl",children:o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o.jsx("img",{src:v,alt:"EVATIME Logo",className:"w-full h-full object-contain"})}),o.jsx("span",{className:"text-xl font-bold",children:"EVATIME"})]}),o.jsxs("p",{className:"text-gray-400 text-sm",children:[" ",new Date().getFullYear()," EVATIME. Tous droits rservs."]})]})})})]})]})}const sie=Object.freeze(Object.defineProperty({__proto__:null,default:hd},Symbol.toStringTag,{value:"Module"})),iie=[{id:"name",name:"Nom*",type:"text",placeholder:"Jean Dupont",required:!0},{id:"companyName",name:"Socit",type:"text",placeholder:"Nom de la socit (optionnel)",required:!1},{id:"email",name:"Email*",type:"email",placeholder:"jean.dupont@email.com",required:!0},{id:"phone",name:"Tlphone",type:"text",placeholder:"06 12 34 56 78",required:!1},{id:"address",name:"Adresse",type:"text",placeholder:"1 Rue de la Paix, 75002 Paris",required:!1}],oie={id:"id",name:"name",email:"email",phone:"phone",address:"address",status:"status",tags:"tags",notes:"notes",company_name:"companyName",owner_id:"ownerId",has_appointment:"hasAppointment",affiliate_name:"affiliateName",form_data:"formData",created_at:"createdAt",updated_at:"updatedAt",user_id:"userId",organization_id:"organizationId"},el=e=>{if(!e)return null;const t={};for(const[r,n]of Object.entries(oie))e[r]!==void 0&&(t[n]=e[r]);return t.company=e.company_name,t.form_data=e.form_data||{},t.tags=t.tags||[],t.formData=t.formData||{},t.hasAppointment=t.hasAppointment||!1,t},aie={id:"id",title:"title",type:"type",status:"status",notes:"notes",location:"location",share:"share",step:"step",start_time:"start",end_time:"end",contact_id:"contactId",assigned_user_id:"assignedUserId",project_id:"projectId",rescheduled_from_id:"rescheduledFromId",created_at:"createdAt",updated_at:"updatedAt",organization_id:"organizationId"},tl=e=>{if(!e)return null;const t={};for(const[r,n]of Object.entries(aie))e[r]!==void 0&&(t[n]=e[r]);return t},zD=(e,t)=>Array.isArray(e)?e.map(t).filter(Boolean):[],lie=(e,t)=>{const[r,n]=p.useState([]),[s,i]=p.useState(!0),[a,l]=p.useState(null),[c,u]=p.useState(0),[f,d]=p.useState(!0),h=p.useRef(null),m=p.useRef(!0),g=500,v=async(j=0,_=!1)=>{try{_||i(!0);const{data:{session:S}}=await T.auth.getSession();if(!S){console.warn("[useSupabaseProspects] No session - skipping prospects loading"),n([]),i(!1);return}const{data:N,error:E}=await T.rpc("get_prospects_safe",{p_limit:g,p_offset:j});if(E)throw P.error("Erreur fetch prospects",{error:E.message}),E;const{data:C}=await T.rpc("get_prospects_count");C!==null&&u(C);const k=zD(N,el);d(k.length===g),P.debug("Prospects fetched",{count:k.length,offset:j,total:C}),n(_?L=>[...L,...k]:k),l(null)}catch(S){P.error("Erreur chargement prospects",{error:S.message}),l(S.message),B({title:"Erreur",description:"Impossible de charger les prospects.",variant:"destructive"})}finally{i(!1)}},y=()=>{f&&!s&&v(r.length,!0)};return p.useEffect(()=>{if(!e||!e.id){i(!1),n([]);return}v()},[e==null?void 0:e.id]),p.useEffect(()=>{if(!e||!t)return;m.current=!0;const j=T.channel(`prospects-changes-${t}`).on("postgres_changes",{event:"*",schema:"public",table:"prospects",filter:`organization_id=eq.${t}`},_=>{if(m.current)if(_.eventType==="INSERT"){const S=el(_.new);n(N=>[S,...N]),B({title:" Nouveau contact",description:`${S.name} a t ajout !`,className:"bg-green-500 text-white"})}else if(_.eventType==="UPDATE"){P.info(" [useSupabaseProspects] Real-time UPDATE received",{prospectId:_.new.id,name:_.new.name,organizationId:_.new.organization_id,hasFormData:!!_.new.form_data,formDataKeys:_.new.form_data?Object.keys(_.new.form_data):[]});const S=el(_.new);P.info(" [useSupabaseProspects] updatedProspect after transform",{id:S.id,name:S.name,hasFormData:!!S.formData,formDataProjects:Object.keys(S.formData||{}),fullObject:S}),n(N=>{const E=N.map(C=>C.id===_.new.id?S:C);return P.info(" [useSupabaseProspects] State updated, new array length:",E.length),[...E]})}else _.eventType==="DELETE"&&(n(S=>S.filter(N=>N.id!==_.old.id)),B({title:" Contact supprim",description:"Un contact a t supprim."}))}).on("broadcast",{event:"prospect-updated"},_=>{var S;m.current&&(P.debug("Broadcast manual UPDATE received",{id:(S=_.payload)==null?void 0:S.id}),n(N=>N.map(E=>E.id===_.payload.id?_.payload:E)))}).subscribe();return h.current=j,()=>{m.current=!1,T.removeChannel(j),h.current=null}},[e==null?void 0:e.id,t]),p.useEffect(()=>{const j=T.channel("prospects-broadcast-global").on("broadcast",{event:"prospect-updated"},_=>{var S;P.debug("GLOBAL Broadcast received",{id:(S=_.payload)==null?void 0:S.id}),n(N=>{var C,k;P.debug("Before update",{name:(C=N.find(L=>L.id===_.payload.id))==null?void 0:C.name});const E=N.map(L=>L.id===_.payload.id?{..._.payload}:L);return P.debug("After update",{name:(k=E.find(L=>L.id===_.payload.id))==null?void 0:k.name}),E})}).subscribe();return h.current||(h.current=j),()=>{T.removeChannel(j)}},[]),{prospects:r,loading:s,error:a,addProspect:async j=>{try{console.log("[addProspect] started",{prospectData:j});const{data:{user:_}}=await T.auth.getUser();if(!_)throw new Error("Utilisateur non authentifi");if(console.log("[addProspect] auth user",{userId:_.id}),!t)throw new Error("organization_id manquant");console.log("[addProspect] organizationId",{organizationId:t});const{data:S,error:N}=await T.from("prospects").insert({name:j.name,email:j.email,phone:j.phone||"",company_name:j.company||j.companyName||"",address:j.address||"",owner_id:j.ownerId||_.id,status:j.status||"lead",tags:j.tags||[],has_appointment:j.hasAppointment||!1,affiliate_name:j.affiliateName||null,organization_id:t,created_at:new Date().toISOString()}).select().single();if(console.log("[addProspect] insert result",{data:S,error:N==null?void 0:N.message}),N)throw console.error("[addProspect] insert failed",N),N;const E=el(S);return B({title:"Succs",description:`Prospect "${S.name}" cr !`,className:"bg-green-500 text-white"}),E}catch(_){throw console.error("[addProspect] error",_),B({title:"Erreur",description:_.message||"Impossible d'ajouter le prospect.",variant:"destructive"}),_}},updateProspect:async(j,_)=>{try{P.debug("updateProspect called",{idType:typeof j,updatesType:typeof _});let S,N;typeof j=="object"&&j.id?(S=j.id,N=j,P.debug("Update mode: full object")):(S=j,N=_,P.debug("Update mode: separate params"));const E={};N.name!==void 0&&(E.name=N.name),N.email!==void 0&&(E.email=N.email),N.phone!==void 0&&(E.phone=N.phone),N.company!==void 0&&(E.company_name=N.company),N.companyName!==void 0&&(E.company_name=N.companyName),N.address!==void 0&&(E.address=N.address),N.ownerId!==void 0&&(E.owner_id=N.ownerId),N.status!==void 0&&(E.status=N.status),N.tags!==void 0&&(E.tags=N.tags),N.hasAppointment!==void 0&&(E.has_appointment=N.hasAppointment),N.affiliateName!==void 0&&(E.affiliate_name=N.affiliateName),N.formData!==void 0&&(E.form_data=N.formData),P.debug("Preparing update",{prospectId:S,fieldsUpdated:Object.keys(E)});const{data:{user:C}}=await T.auth.getUser(),{data:k}=await T.from("users").select("id").eq("user_id",C==null?void 0:C.id).single();let L,A;if(k){P.debug("Update mode: ADMIN - using update_prospect_safe");const R=await T.rpc("update_prospect_safe",{_prospect_id:S,_data:E});L=R.data,A=R.error}else{P.debug("Update mode: CLIENT - using update_own_prospect_profile");const R=await T.rpc("update_own_prospect_profile",{_data:E});L=R.data,A=R.error}if(A)throw P.error("Erreur RPC",{error:A.message}),P.error("Dtails erreur",{details:JSON.stringify(A)}),A;if(P.debug("RPC Success",{prospectId:S}),L&&L.length>0){const R=L[0],O=el(R);n(z=>z.map(F=>F.id===S?O:F)),P.debug("Local state updated immediately"),!k&&h.current&&(P.debug("Broadcasting manual update to other users"),h.current.send({type:"broadcast",event:"prospect-updated",payload:O}))}return L}catch(S){throw P.error("Erreur update prospect",{error:S.message}),B({title:"Erreur",description:S.message||"Impossible de modifier le prospect.",variant:"destructive"}),S}},deleteProspect:async j=>{try{const{error:_}=await T.from("prospects").delete().eq("id",j);if(_)throw _;n(S=>S.filter(N=>N.id!==j)),B({title:"Succs",description:"Prospect supprim avec succs !",className:"bg-green-500 text-white"})}catch(_){throw P.error("Erreur suppression prospect",{error:_.message}),B({title:"Erreur",description:_.message||"Impossible de supprimer le prospect.",variant:"destructive"}),_}},refetchProspects:v,totalCount:c,hasMore:f,loadMore:y}};function cie({projectType:e,prospectId:t,enabled:r=!0,activeAdminUser:n}){const[s,i]=p.useState([]),[a,l]=p.useState(!1),[c,u]=p.useState(!1),[f,d]=p.useState(null),h=p.useCallback(async()=>{if(!(!e||!r))try{l(!0),d(null);let v=T.from("project_history").select("*").eq("project_type",e).order("created_at",{ascending:!1});t&&(v=v.eq("prospect_id",t));const{data:y,error:x}=await v;if(x)throw x;i(y||[])}catch(v){P.error("Erreur rcupration project history:",{error:v.message}),d(v.message)}finally{l(!1)}},[e,t,r]);p.useEffect(()=>{if(!e||!r)return;h();const v=T.channel(`project-history-${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"project_history",filter:`project_type=eq.${e}`},y=>{i(x=>[y.new,...x])}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"project_history",filter:`project_type=eq.${e}`},y=>{i(x=>x.map(b=>b.id===y.new.id?y.new:b))}).subscribe();return()=>{T.removeChannel(v)}},[e,r,h]);const m=p.useCallback(async({event_type:v,title:y,description:x,metadata:b,createdBy:w,createdByName:j})=>{if(!(!e||!v)){if(!(n!=null&&n.organization_id))throw P.error(" [useSupabaseProjectHistory] organization_id manquant pour addHistoryEvent"),new Error("organization_id manquant pour addHistoryEvent");try{u(!0),d(null);const{data:_,error:S}=await T.from("project_history").insert([{project_type:e,prospect_id:t||null,event_type:v,title:y,description:x,metadata:b,created_by:w||null,created_by_name:j||null,organization_id:n.organization_id}]).select().single();if(S)throw S;return _}catch(_){throw P.error("Erreur ajout history event:",{error:_.message}),d(_.message),_}finally{u(!1)}}},[e,t,n]),g=p.useCallback(async({prospectId:v,projectType:y,title:x,description:b,metadata:w,createdBy:j,createdByName:_})=>{if(!y||!v)return P.error("prospectId and projectType required"),{success:!1,error:"Paramtres manquants"};if(!(n!=null&&n.organization_id))return P.error(" [useSupabaseProjectHistory] organization_id manquant pour addProjectEvent"),{success:!1,error:"organization_id manquant"};try{P.debug("Adding project event",{prospectId:v,projectType:y,title:x,organizationId:n.organization_id});const S=(w==null?void 0:w.event_type)||"form_event",{data:N,error:E}=await T.from("project_history").insert([{project_type:y,prospect_id:v,event_type:S,title:x,description:b,metadata:w||null,created_by:j||null,created_by_name:_||j||null,organization_id:n.organization_id}]).select().single();if(E)throw P.error("Supabase error:",E.message),E;return P.debug("Project event created",{eventId:N.id}),{success:!0,data:N}}catch(S){return P.error("[addProjectEvent] Exception:",{error:S.message||S}),{success:!1,error:S.message||"Erreur inconnue"}}},[n]);return{history:s,loading:a,saving:c,error:f,addHistoryEvent:m,addProjectEvent:g,refetch:h}}const uie=(e,t)=>{const[r,n]=p.useState([]),[s,i]=p.useState(!0),[a,l]=p.useState(null),[c,u]=p.useState(null),{addProjectEvent:f}=cie({projectType:null,enabled:!1,activeAdminUser:e}),d=async()=>{try{const b=new Date,w=new Date(b);w.setMonth(w.getMonth()-3);const j=new Date(b);j.setMonth(j.getMonth()+3);const{data:_,error:S}=await T.from("appointments").select("*").gte("start_time",w.toISOString()).lte("start_time",j.toISOString()).order("start_time",{ascending:!0});if(S)throw S;const N=zD(_,tl);return P.debug("Appointments fetched",{count:N.length,range:`${w.toISOString()} - ${j.toISOString()}`}),n(N),N}catch(b){throw P.error("Erreur chargement appointments:",{error:b.message}),b}},h=async()=>{try{i(!0),l(null),await d()}catch(b){P.error("Erreur chargement agenda:",{error:b.message}),l(b.message),B({title:"Erreur",description:"Impossible de charger l'agenda.",variant:"destructive"})}finally{i(!1)}};p.useEffect(()=>{e&&h()},[e]),p.useEffect(()=>{if(!e||!t)return;const b=T.channel(`agenda-changes-${t}`).on("postgres_changes",{event:"*",schema:"public",table:"appointments",filter:`organization_id=eq.${t}`},w=>{if(w.eventType==="INSERT"){const j=tl(w.new);n(_=>_.some(S=>S.id===j.id)?_:[..._,j])}if(w.eventType==="UPDATE"){const j=tl(w.new);n(_=>_.map(S=>S.id===w.new.id?j:S))}w.eventType==="DELETE"&&n(j=>j.filter(_=>_.id!==w.old.id))}).subscribe();return u(b),()=>{T.removeChannel(b)}},[e,t]);const m=async b=>{try{const{data:{user:w}}=await T.auth.getUser();if(!w)throw new Error("Non authentifi");const j=b.contactId&&b.contactId.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)?b.contactId:null;let _=b.assignedUserId;_||(_=w.id);const S=new Date,N=new Date(S.getTime()+60*60*1e3);if(!t)throw new Error("Organization ID manquant - Impossible de crer le rendez-vous");const{data:E,error:C}=await T.from("appointments").insert([{title:b.title||"Rendez-vous",start_time:b.startTime||S.toISOString(),end_time:b.endTime||N.toISOString(),contact_id:j,assigned_user_id:_,project_id:b.projectId||null,step:b.step||null,type:b.type||"physical",status:b.status||"pending",share:b.share||!1,notes:b.notes||null,location:b.location||null,organization_id:t}]).select().single();if(C)throw C;const k=tl(E);if(n(L=>[...L,k]),B({title:"Succs",description:"Rendez-vous ajout avec succs !",className:"bg-green-500 text-white"}),E.project_id&&E.contact_id)try{const L=E.type==="physical"?"RDV Physique":E.type==="virtual"?"RDV Visio":E.type==="call"?"Appel":"Tche",R=new Date(E.start_time).toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"});await f({prospectId:E.contact_id,projectType:E.project_id,title:"Activit planifie",description:`${L} programm pour le ${R}`,metadata:{event_type:"activity",activity_type:E.type,appointment_id:E.id,start_time:E.start_time,end_time:E.end_time,status:E.status,step:E.step,source:"agenda"},createdBy:(w==null?void 0:w.id)||null,createdByName:(e==null?void 0:e.name)||"Systme"}),P.debug(" Activit journalise dans project_history",{appointmentId:E.id,projectId:E.project_id,type:E.type})}catch(L){P.error(" Erreur journalisation project_history (non-bloquant)",{error:L.message,appointmentId:E.id})}return k}catch(w){throw P.error("Erreur ajout appointment",{error:w.message}),P.error("Dtails erreur",{details:JSON.stringify(w,null,2)}),B({title:"Erreur",description:w.message||"Impossible d'ajouter le rendez-vous.",variant:"destructive"}),w}},g=async(b,w)=>{try{const j=r.find(C=>C.id===b),_={};w.title!==void 0&&(_.title=w.title),w.startTime!==void 0&&(_.start_time=w.startTime),w.endTime!==void 0&&(_.end_time=w.endTime),w.contactId!==void 0&&(_.contact_id=w.contactId),w.assignedUserId!==void 0&&(_.assigned_user_id=w.assignedUserId),w.projectId!==void 0&&(_.project_id=w.projectId),w.step!==void 0&&(_.step=w.step),w.type!==void 0&&(_.type=w.type),w.status!==void 0&&(_.status=w.status),w.share!==void 0&&(_.share=w.share),w.notes!==void 0&&(_.notes=w.notes),w.location!==void 0&&(_.location=w.location);const{data:S,error:N}=await T.from("appointments").update(_).eq("id",b).select().single();if(N)throw N;const E=tl(S);if(n(C=>C.map(k=>k.id===b?E:k)),S.project_id&&S.contact_id&&j)try{const C=w.status!==void 0&&j.status!==S.status,k=(w.startTime!==void 0||w.endTime!==void 0)&&(j.start!==S.start_time||j.end!==S.end_time),L=w.step!==void 0||w.notes!==void 0||w.location!==void 0;if(C||k||L){let A="Activit mise  jour : ";const R=[];if(C){const z={pending:"En attente",effectue:"Effectu",annule:"Annul",reporte:"Report"};R.push(`statut chang en "${z[S.status]||S.status}"`)}if(k){const F=new Date(S.start_time).toLocaleDateString("fr-FR",{day:"2-digit",month:"long",hour:"2-digit",minute:"2-digit"});R.push(`reprogramm le ${F}`)}L&&!C&&!k&&R.push("informations modifies"),A+=R.join(", ");const{data:{user:O}}=await T.auth.getUser();await f({prospectId:S.contact_id,projectType:S.project_id,title:"Activit mise  jour",description:A,metadata:{event_type:"activity",activity_type:S.type,appointment_id:S.id,start_time:S.start_time,end_time:S.end_time,status:S.status,step:S.step,changes:{status:C?{from:j.status,to:S.status}:void 0,date:k?{from:j.start,to:S.start_time}:void 0},source:"agenda"},createdBy:(O==null?void 0:O.id)||null,createdByName:(e==null?void 0:e.name)||"Systme"}),P.debug(" Modification activit journalise dans project_history",{appointmentId:S.id,changes:{hasStatusChange:C,hasDateChange:k,hasOtherChange:L}})}}catch(C){P.error(" Erreur journalisation project_history (non-bloquant)",{error:C.message,appointmentId:S.id})}return S}catch(j){throw P.error("Erreur update appointment:",{error:j.message}),B({title:"Erreur",description:j.message||"Impossible de modifier le rendez-vous.",variant:"destructive"}),j}},v=async b=>{try{const w=r.find(_=>_.id===b),{error:j}=await T.from("appointments").delete().eq("id",b);if(j)throw j;if(n(_=>_.filter(S=>S.id!==b)),B({title:"Succs",description:"Rendez-vous supprim avec succs !",className:"bg-green-500 text-white"}),w!=null&&w.projectId&&(w!=null&&w.contactId))try{const _=w.type==="physical"?"RDV Physique":w.type==="virtual"?"RDV Visio":w.type==="call"?"Appel":"Tche",{data:{user:S}}=await T.auth.getUser();await f({prospectId:w.contactId,projectType:w.projectId,title:"Activit supprime",description:`${_} supprim de l'agenda`,metadata:{event_type:"activity",activity_type:w.type,appointment_id:b,status:"deleted",deleted_at:new Date().toISOString(),source:"agenda"},createdBy:(S==null?void 0:S.id)||null,createdByName:(e==null?void 0:e.name)||"Systme"}),P.debug(" Suppression activit journalise dans project_history",{appointmentId:b,type:w.type})}catch(_){P.error(" Erreur journalisation project_history (non-bloquant)",{error:_.message,appointmentId:b})}}catch(w){throw P.error("Erreur suppression appointment:",{error:w.message}),B({title:"Erreur",description:w.message||"Impossible de supprimer le rendez-vous.",variant:"destructive"}),w}},y=r.filter(b=>b.type==="call"),x=r.filter(b=>b.type==="task");return{appointments:r,calls:y,tasks:x,loading:s,error:a,addAppointment:m,updateAppointment:g,deleteAppointment:v,addCall:m,updateCall:g,deleteCall:v,addTask:m,updateTask:g,deleteTask:v,refetchAll:h}},die=(e={})=>{const t=typeof e=="string"?e:(e==null?void 0:e.organizationId)||null,r=typeof e=="string"?!0:(e==null?void 0:e.enabled)!==!1,[n,s]=p.useState(null),[i,a]=p.useState(!0),[l,c]=p.useState(null),u=p.useRef(!1),f="9769af46-b3ac-4909-8810-a8cf3fd6e307",d=async()=>{if(!r){a(!1);return}try{a(!0);const{data:E,error:C}=await T.from("company_settings").select("*").eq("id",f).single();if(C)throw C;s(E),c(null)}catch(E){P.error("Erreur chargement company settings:",{error:E.message}),c(E.message)}finally{a(!1)}};p.useEffect(()=>{if(!r){a(!1);return}d()},[r]),p.useEffect(()=>{if(!r)return;const E=T.channel("company-settings-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"company_settings",filter:`id=eq.${f}`},C=>{s(k=>JSON.stringify(k)===JSON.stringify(C.new)?k:(u.current=!1,C.new))}).subscribe();return()=>{T.removeChannel(E)}},[r]);const h=async E=>{try{u.current=!0;const{error:C}=await T.from("company_settings").update({logo_url:E,updated_at:new Date().toISOString()}).eq("id",f);if(C)throw P.error("Supabase update error details:",{error:C.message}),u.current=!1,C;if(t){const{error:k}=await T.from("organization_settings").update({logo_url:E,updated_at:new Date().toISOString()}).eq("organization_id",t);k?P.warn("Sync logo vers organization_settings chou:",{error:k.message}):P.info("Logo synchronis vers organization_settings")}return s(k=>({...k,logo_url:E,updated_at:new Date().toISOString()})),B({title:"Logo mis  jour !",description:"Le logo de l'entreprise a t modifi.",className:"bg-green-500 text-white"}),!0}catch(C){throw P.error("Erreur update logo:",{error:C.message}),B({title:"Erreur",description:C.message||"Impossible de mettre  jour le logo.",variant:"destructive"}),C}},m=async()=>{try{u.current=!0;const{error:E}=await T.from("company_settings").update({logo_url:null,updated_at:new Date().toISOString()}).eq("id",f);if(E)throw P.error("Supabase remove error details:",{error:E.message}),u.current=!1,E;if(t){const{error:C}=await T.from("organization_settings").update({logo_url:null,updated_at:new Date().toISOString()}).eq("organization_id",t);C?P.warn("Sync suppression logo vers organization_settings chou:",{error:C.message}):P.info("Suppression logo synchronise vers organization_settings")}return s(C=>({...C,logo_url:null,updated_at:new Date().toISOString()})),B({title:"Logo supprim",description:"Le logo de l'entreprise a t retir.",className:"bg-blue-500 text-white"}),!0}catch(E){throw P.error("Erreur suppression logo:",{error:E.message}),B({title:"Erreur",description:E.message||"Impossible de supprimer le logo.",variant:"destructive"}),E}},g=async E=>{try{u.current=!0;const{error:C}=await T.from("company_settings").update({settings:E,updated_at:new Date().toISOString()}).eq("id",f);if(C)throw P.error("Supabase settings update error details:",{error:C.message}),u.current=!1,C;return s(k=>({...k,settings:E,updated_at:new Date().toISOString()})),!0}catch(C){throw P.error("Erreur update settings:",{error:C.message}),B({title:"Erreur",description:C.message||"Impossible de mettre  jour les paramtres.",variant:"destructive"}),C}},v=async E=>{if(!t)return P.error("updateFormContactConfig: organizationId requis pour isolation multi-tenant"),B({title:"Erreur",description:"Organisation non dfinie. Impossible de sauvegarder.",variant:"destructive"}),!1;try{u.current=!0;const{error:C}=await T.from("organization_settings").upsert({organization_id:t,form_contact_config:E,updated_at:new Date().toISOString()},{onConflict:"organization_id"});if(C)throw P.error("Supabase form contact upsert error (organization_settings):",{error:C.message}),u.current=!1,C;return P.info("Form contact config sauvegard dans organization_settings",{organizationId:t}),!0}catch(C){throw P.error("Erreur update form contact config:",{error:C.message}),B({title:"Erreur",description:"Impossible de mettre  jour le formulaire de contact.",variant:"destructive"}),C}},y=()=>{var E;return((E=n==null?void 0:n.settings)==null?void 0:E.form_contact_config)||[]},x=async E=>{try{u.current=!0;const k={...(n==null?void 0:n.settings)||{},global_pipeline_steps:E},{error:L}=await T.from("company_settings").update({settings:k,updated_at:new Date().toISOString()}).eq("id",f);if(L)throw P.error("Supabase global pipeline update error:",{error:L.message}),u.current=!1,L;return s(A=>({...A,settings:k,updated_at:new Date().toISOString()})),!0}catch(C){throw P.error("Erreur update global pipeline steps:",{error:C.message}),B({title:"Erreur",description:"Impossible de mettre  jour les pipelines globaux.",variant:"destructive"}),C}},b=()=>{var E;return((E=n==null?void 0:n.settings)==null?void 0:E.global_pipeline_steps)||[]},w=async E=>{try{u.current=!0;const k={...(n==null?void 0:n.settings)||{},landing_page_config:E},{error:L}=await T.from("company_settings").update({settings:k,updated_at:new Date().toISOString()}).eq("id",f);if(L)throw P.error("Supabase landing page config update error:",{error:L.message}),u.current=!1,L;return s(A=>({...A,settings:k,updated_at:new Date().toISOString()})),!0}catch(C){throw P.error("Erreur update landing page config:",{error:C.message}),B({title:"Erreur",description:"Impossible de mettre  jour la configuration de la landing page.",variant:"destructive"}),C}},j=async(E,C)=>{try{u.current=!0;const k=(n==null?void 0:n.settings)||{},A={...k.landing_page_config||{},[E]:C},R={...k,landing_page_config:A},{error:O}=await T.from("company_settings").update({settings:R,updated_at:new Date().toISOString()}).eq("id",f);if(O)throw u.current=!1,O;return s(z=>({...z,settings:R,updated_at:new Date().toISOString()})),!0}catch(k){throw P.error("Erreur update landing page field:",{error:k.message,field:E,value:C}),k}},_=async(E,C)=>{try{u.current=!0;const k=(n==null?void 0:n.settings)||{},L=k.landing_page_config||{},R=(L.blocks||N()).map(V=>V.id===E?{...V,...C}:V),O={...L,blocks:R},z={...k,landing_page_config:O},{error:F}=await T.from("company_settings").update({settings:z,updated_at:new Date().toISOString()}).eq("id",f);if(F)throw u.current=!1,F;return s(V=>({...V,settings:z,updated_at:new Date().toISOString()})),!0}catch(k){throw P.error("Erreur update landing page block:",{error:k.message,blockId:E,blockData:C}),k}},S=()=>{var C;const E=((C=n==null?void 0:n.settings)==null?void 0:C.landing_page_config)||{};return{landing_logo_url:E.landing_logo_url||null,hero_title:E.hero_title||"Bienvenue sur notre plateforme",hero_subtitle:E.hero_subtitle||"Grez vos projets nergtiques en toute simplicit",hero_cta_text:E.hero_cta_text||"Commencer maintenant",hero_cta_link:E.hero_cta_link||"/inscription",blocks:E.blocks||N()}},N=()=>[{id:1,icon:"",title:"Crez votre projet",description:"Inscrivez-vous et dcrivez votre projet en quelques clics."},{id:2,icon:"",title:"Nous intervenons",description:"Notre quipe prend en charge votre dossier de A  Z."},{id:3,icon:"",title:"Profitez des rsultats",description:"Suivez l'avancement en temps rel depuis votre espace client."}];return{companySettings:n,loading:i,error:l,updateLogo:h,removeLogo:m,updateSettings:g,updateFormContactConfig:v,getFormContactConfig:y,updateGlobalPipelineSteps:x,getGlobalPipelineSteps:b,updateLandingPageConfig:w,updateLandingPageField:j,updateLandingPageBlock:_,getLandingPageConfig:S,refetch:d}};function fie(e=null){const[t,r]=p.useState([]),[n,s]=p.useState(!0),[i,a]=p.useState(null),l=p.useRef(!1);p.useEffect(()=>{e&&c()},[e]),p.useEffect(()=>{if(!e)return;const m=T.channel(`global-pipeline-changes-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"global_pipeline_steps",filter:`organization_id=eq.${e}`},g=>{if(l.current){l.current=!1;return}g.eventType==="INSERT"?r(v=>v.find(x=>x.id===g.new.id)?v:[...v,g.new].sort((x,b)=>x.position-b.position)):g.eventType==="UPDATE"?r(v=>v.map(y=>y.id===g.new.id?g.new:y).sort((y,x)=>y.position-x.position)):g.eventType==="DELETE"&&r(v=>v.filter(y=>y.id!==g.old.id))}).subscribe();return()=>{T.removeChannel(m)}},[e]);const c=async()=>{if(!e){r([]),s(!1);return}try{s(!0),a(null);const{data:m,error:g}=await T.rpc("get_global_pipeline_steps_for_org",{p_organization_id:e});if(g)throw g;const v=Array.isArray(m)?[...m].sort((y,x)=>(y.position??0)-(x.position??0)):[];r(v)}catch(m){P.error(" Erreur fetch global pipeline steps:",m),a(m.message)}finally{s(!1)}};return{globalPipelineSteps:t,loading:n,error:i,addStep:async(m,g="bg-gray-100")=>{if(!e)throw new Error("organization_id requis pour crer une colonne pipeline");try{l.current=!0;const y=(t.length>0?Math.max(...t.map(j=>j.position)):-1)+1,x=`global-pipeline-step-${Date.now()}`,{data:b,error:w}=await T.from("global_pipeline_steps").insert([{step_id:x,label:m,color:g,position:y,organization_id:e}]).select().single();if(w)throw w;return r(j=>[...j,b].sort((_,S)=>_.position-S.position)),b}catch(v){throw P.error(" Erreur cration colonne pipeline:",v),l.current=!1,v}},updateStep:async(m,g)=>{try{l.current=!0;const{data:v,error:y}=await T.from("global_pipeline_steps").update(g).eq("id",m).select().single();if(y)throw y;return r(x=>x.map(b=>b.id===m?v:b).sort((b,w)=>b.position-w.position)),v}catch(v){throw P.error(" Erreur modification colonne pipeline:",v),l.current=!1,v}},deleteStep:async m=>{try{l.current=!0;const{error:g}=await T.from("global_pipeline_steps").delete().eq("id",m);if(g)throw g;r(v=>v.filter(y=>y.id!==m))}catch(g){throw P.error(" Erreur suppression colonne pipeline:",g),l.current=!1,g}},reorderSteps:async m=>{try{l.current=!0;const g=m.map((v,y)=>({id:v.id,position:y}));for(const v of g){const{error:y}=await T.from("global_pipeline_steps").update({position:v.position}).eq("id",v.id);if(y)throw y}r(m)}catch(g){throw P.error(" Erreur rorganisation colonnes pipeline:",g),l.current=!1,g}},refresh:c}}function hie(e,t=!0){const[r,n]=p.useState([]),[s,i]=p.useState(!0);p.useEffect(()=>{if(!t||!e){i(!1);return}a();const f=`notifications-${e}-${Date.now()}`,d=T.channel(f).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`owner_id=eq.${e}`},h=>{if(h.eventType==="INSERT"){const m=u(h.new);n(g=>g.find(y=>y.id===m.id)?g:[m,...g])}else if(h.eventType==="UPDATE"){const m=u(h.new);n(g=>g.map(v=>v.id===m.id?m:v))}else h.eventType==="DELETE"&&n(m=>m.filter(g=>g.id!==h.old.id))}).subscribe();return()=>{T.removeChannel(d)}},[e,t]);async function a(){try{i(!0);const{data:f,error:d}=await T.from("notifications").select(`
          *,
          prospects!inner(owner_id)
        `).eq("prospects.owner_id",e).order("created_at",{ascending:!1});if(d)throw d;const h=(f||[]).map(u);n(h)}catch(f){P.error(" Error loading admin notifications:",f)}finally{i(!1)}}async function l(f){try{const{prospectId:d,projectType:h,prospectName:m,projectName:g,ownerId:v}=f;if(!v){P.error("ownerId is REQUIRED for notifications");return}P.debug("Checking existing notification",{prospectId:d,projectType:h});const{data:y,error:x}=await T.from("notifications").select("*").eq("prospect_id",d).eq("project_type",h).eq("read",!1).neq("project_name"," Message partenaire").neq("project_name"," Message interne").maybeSingle();if(P.debug("Existing notification check",{found:!!y,error:!!x}),x){P.error(" Error checking existing notification:",x);return}if(y){P.debug("Incrementing notification count",{from:y.count,to:y.count+1});const{error:b}=await T.from("notifications").update({count:y.count+1,created_at:new Date().toISOString()}).eq("id",y.id);if(b)throw P.error("Error updating notification:",b),b;P.debug("Notification count incremented successfully")}else{const{data:b,error:w}=await T.from("prospects").select("organization_id").eq("id",d).single();if(w||!(b!=null&&b.organization_id))throw P.error("Organization introuvable pour le prospect:",{prospectId:d,error:w==null?void 0:w.message}),new Error("Organization introuvable pour le prospect");P.debug("Creating new notification with count=1");const{error:j}=await T.from("notifications").insert({prospect_id:d,owner_id:v,organization_id:b.organization_id,project_type:h,prospect_name:m,project_name:g,count:1,read:!1});if(j)throw P.error("Error creating notification:",j),j;P.debug("New notification created")}}catch(d){P.error("Error creating/updating notification:",d)}}async function c(f){if(!f){P.warn("markAsRead appel sans notificationId valide");return}try{const{error:d}=await T.from("notifications").update({read:!0}).eq("id",f);if(d)throw d;n(h=>h.map(m=>m.id===f?{...m,read:!0}:m))}catch(d){P.error("Error marking notification as read:",d)}}function u(f){return{id:f.id,prospectId:f.prospect_id,projectType:f.project_type,prospectName:f.prospect_name,projectName:f.project_name,count:f.count,read:f.read,timestamp:f.created_at}}return{notifications:r,loading:s,createOrUpdateNotification:l,markAsRead:c,refresh:a}}function pie(e,t=!0){const[r,n]=p.useState([]),[s,i]=p.useState(!0);p.useEffect(()=>{if(!t||!e){n([]),i(!1);return}a();const f=T.channel(`client-notifications-${e}-${Math.random()}`).on("postgres_changes",{event:"*",schema:"public",table:"client_notifications",filter:`prospect_id=eq.${e}`},d=>{if(d.eventType==="INSERT"){const h=u(d.new);n(m=>m.find(v=>v.id===h.id)?m:[h,...m])}else if(d.eventType==="UPDATE"){const h=u(d.new);n(m=>m.map(g=>g.id===h.id?h:g))}else d.eventType==="DELETE"&&n(h=>h.filter(m=>m.id!==d.old.id))}).subscribe();return()=>{T.removeChannel(f)}},[e,t]);async function a(){try{i(!0);const{data:f,error:d}=await T.from("client_notifications").select("*").eq("prospect_id",e).order("created_at",{ascending:!1});if(d)throw d;const h=(f||[]).map(u);n(h)}catch(f){P.error("Erreur chargement client notifications:",{error:f.message})}finally{i(!1)}}async function l(f){try{const{prospectId:d,projectType:h,projectName:m,message:g}=f;if(!d||!h){P.error("Missing required fields:",{error:{prospectId:d,projectType:h}.message});return}const{data:v,error:y}=await T.from("client_notifications").select("*").eq("prospect_id",d).eq("project_type",h).eq("read",!1).maybeSingle();if(y){P.error("Error checking existing notification:",{error:y.message});return}if(v){const{error:x}=await T.from("client_notifications").update({count:v.count+1,message:g,created_at:new Date().toISOString()}).eq("id",v.id);if(x)throw P.error("Erreur update notification:",{error:x.message}),x}else{const{data:x,error:b}=await T.from("prospects").select("organization_id").eq("id",d).single();if(b||!(x!=null&&x.organization_id))throw P.error("Organization introuvable pour le prospect:",{prospectId:d,error:b==null?void 0:b.message}),new Error("Organization introuvable pour le prospect");const{data:w,error:j}=await T.from("client_notifications").insert({prospect_id:d,project_type:h,project_name:m,message:g,count:1,read:!1,organization_id:x.organization_id}).select();if(j)throw P.error("Error inserting notification:",{error:j.message}),j}}catch(d){P.error("Erreur cration/updating client notification:",{error:d.message})}}async function c(f){if(!f){P.warn("markAsRead appel sans notificationId valide");return}try{const{error:d}=await T.from("client_notifications").update({read:!0}).eq("id",f);if(d)throw d;n(h=>h.map(m=>m.id===f?{...m,read:!0}:m))}catch(d){P.error("Error marking client notification as read:",{error:d.message})}}function u(f){return{id:f.id,projectType:f.project_type,projectName:f.project_name,message:f.message,count:f.count,read:f.read,timestamp:f.created_at}}return{notifications:r,loading:s,createOrUpdateNotification:l,markAsRead:c,refresh:a}}function mie(e=null){const{organizationId:t}=an(),[r,n]=p.useState([]),[s,i]=p.useState(!0),[a,l]=p.useState(null),c=m=>({panelId:m.panel_id,prospectId:m.prospect_id,projectType:m.project_type,formId:m.form_id,promptId:m.prompt_id,currentStepIndex:m.current_step_index,messageTimestamp:m.message_timestamp,status:m.status,userOverride:m.user_override,stepName:m.step_name,filledByRole:m.filled_by_role||"client",formData:m.form_data||{},rejectionReason:m.rejection_reason||null,lastSubmittedAt:m.last_submitted_at?new Date(m.last_submitted_at).getTime():null,createdAt:new Date(m.created_at).getTime(),updatedAt:new Date(m.updated_at).getTime()});p.useEffect(()=>{if(e==="__DISABLED__"){n([]),i(!1);return}if(!t){n([]),i(!1);return}(async()=>{try{i(!0);const{data:{session:y}}=await T.auth.getSession();if(P.debug("Loading client form panels",{prospectId:e}),!y){P.debug("No session - skipping form panels loading"),n([]),i(!1);return}let x=T.from("client_form_panels").select("*").eq("organization_id",t);e&&(x=x.eq("prospect_id",e));const{data:b,error:w}=await x.order("created_at",{ascending:!1});if(w)throw P.error("Supabase SELECT error:",w.message),w;console.log("[useSupabaseClientFormPanels] RPC result:",{raw:(b==null?void 0:b.length)||0,organizationId:t,prospectId:e,firstPanel:b!=null&&b[0]?{id:b[0].id,panel_id:b[0].panel_id,prospect_id:b[0].prospect_id,form_id:b[0].form_id,status:b[0].status,filled_by_role:b[0].filled_by_role,form_data:b[0].form_data}:null});const j=Array.isArray(b)?b.map(c):[];console.log("[useSupabaseClientFormPanels] Transformed:",{count:j.length}),n(j),l(null)}catch(y){P.error(" [useSupabaseClientFormPanels] Exception chargement:",y.message||y),n([]),l(y.message||"Erreur inconnue")}finally{i(!1)}})();const g=e?`client-form-panels-${e}`:"client-form-panels-all",v=T.channel(g).on("postgres_changes",{event:"*",schema:"public",table:"client_form_panels",...e&&{filter:`prospect_id=eq.${e}`}},y=>{try{if(y.eventType==="INSERT"){const x=c(y.new);n(b=>{const w=Array.isArray(b)?b:[];return w.some(j=>j.panelId===x.panelId)?w:[x,...w]})}else if(y.eventType==="UPDATE"){const x=c(y.new);n(b=>(Array.isArray(b)?b:[]).map(j=>j.panelId===x.panelId?x:j))}else y.eventType==="DELETE"&&n(x=>(Array.isArray(x)?x:[]).filter(w=>w.panelId!==y.old.panel_id))}catch(x){P.error(" [useSupabaseClientFormPanels] Erreur real-time:",x)}}).subscribe();return()=>{T.removeChannel(v)}},[e,t]);const u=async(m,g)=>{try{const v={};g.status!==void 0&&(v.status=g.status),g.userOverride!==void 0&&(v.user_override=g.userOverride),g.lastSubmittedAt!==void 0&&(v.last_submitted_at=g.lastSubmittedAt),g.formData!==void 0&&(v.form_data=g.formData),g.rejectionReason!==void 0&&(v.rejection_reason=g.rejectionReason);const{error:y}=await T.from("client_form_panels").update(v).eq("panel_id",m);if(y)throw y;return{success:!0}}catch(v){return P.error(" Erreur mise  jour form panel:",v),{success:!1,error:v.message}}},f=async m=>{try{const{error:g}=await T.from("client_form_panels").delete().eq("panel_id",m);if(g)throw g;return{success:!0}}catch(g){return P.error(" Erreur suppression form panel:",g),{success:!1,error:g.message}}},d=async(m,g)=>{try{let v=T.from("client_form_panels").delete().eq("prospect_id",m);g&&(v=v.eq("project_type",g));const{error:y}=await v;if(y)throw y;return{success:!0}}catch(v){return P.error(" Erreur suppression form panels:",v),{success:!1,error:v.message}}},h=async m=>{try{P.debug("Creating form panel",{prospectId:m.prospectId,projectType:m.projectType,formId:m.formId});const{error:g}=await T.from("client_form_panels").insert({panel_id:m.panelId||`panel-${m.prospectId}-${m.projectType}-${m.formId}-${Date.now()}`,prospect_id:m.prospectId,project_type:m.projectType,form_id:m.formId,prompt_id:m.promptId||null,current_step_index:m.currentStepIndex||0,message_timestamp:m.messageTimestamp,status:m.status||"pending",step_name:m.stepName||null,action_id:m.actionId||null});if(g)throw P.error("Supabase INSERT error:",g.message),g;return P.debug("Form panel created successfully"),{success:!0}}catch(g){return P.error("Form panel insertion error:",g.message||g),{success:!1,error:g.message||"Erreur inconnue"}}};return{formPanels:Array.isArray(r)?r:[],loading:s,error:a,createFormPanel:h,updateFormPanel:u,deleteFormPanel:f,deleteFormPanelsByProspect:d}}function gie(e,t=!0){const[r,n]=p.useState({}),[s,i]=p.useState(!0);return p.useEffect(()=>{if(!t||!e)return;(async()=>{try{const{data:c,error:u}=await T.from("project_steps_status").select("prospect_id, project_type, steps");if(u)throw u;const f={};(c||[]).forEach(d=>{const h=`${d.prospect_id}-${d.project_type}`;f[h]=d.steps}),n(f)}catch(c){logger.error(" Error loading all project steps:",c)}finally{i(!1)}})();const l=T.channel(`all-project-steps-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"project_steps_status",filter:`organization_id=eq.${e}`},c=>{if(c.eventType==="INSERT"||c.eventType==="UPDATE"){const u=`${c.new.prospect_id}-${c.new.project_type}`;n(f=>({...f,[u]:c.new.steps}))}else if(c.eventType==="DELETE"){const u=`${c.old.prospect_id}-${c.old.project_type}`;n(f=>{const{[u]:d,...h}=f;return h})}}).subscribe();return()=>{T.removeChannel(l)}},[t,e]),{allProjectSteps:r,loading:s}}const vie=(e,t=!0)=>{const[r,n]=p.useState({}),[s,i]=p.useState(!0),[a,l]=p.useState(null),c=p.useCallback(d=>{if(!d||d.length===0)return{};const h={};return d.forEach(m=>{const{prospect_id:g,project_type:v,data:y}=m;if(!g||!v)return;h[g]||(h[g]={});const x={};(y==null?void 0:y.amount)!==void 0&&y.amount!==null&&(x.amount=y.amount),(y==null?void 0:y.status)!==void 0&&y.status!==null&&(x.status=y.status),h[g][v]=x}),h},[]);p.useEffect(()=>{(async()=>{try{if(!e){n({}),i(!1);return}i(!0),l(null);const{data:h,error:m}=await T.rpc("get_project_infos_for_org",{p_organization_id:e});if(m){P.error("Erreur chargement project_infos:",{error:m.message}),l(m);return}const g=c(h||[]);n(g),P.debug("project_infos loaded from Supabase",{count:Object.keys(g).length})}catch(h){P.error("Erreur fetchProjectInfos:",{error:h.message}),l(h)}finally{i(!1)}})()},[c,e]),p.useEffect(()=>{if(!t||!e)return;const d=T.channel(`project-infos-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"project_infos",filter:`organization_id=eq.${e}`},h=>{if(P.debug("Real-time project_infos",{eventType:h.eventType}),h.eventType==="INSERT"||h.eventType==="UPDATE"){const{prospect_id:m,project_type:g,data:v}=h.new;n(y=>{const x={...y};x[m]||(x[m]={});const b={};return(v==null?void 0:v.amount)!==void 0&&v.amount!==null&&(b.amount=v.amount),(v==null?void 0:v.status)!==void 0&&v.status!==null&&(b.status=v.status),x[m][g]=b,x})}else if(h.eventType==="DELETE"){const{prospect_id:m,project_type:g}=h.old;n(v=>{var x;const y={...v};return(x=y[m])!=null&&x[g]&&(delete y[m][g],Object.keys(y[m]).length===0&&delete y[m]),y})}}).subscribe();return()=>{T.removeChannel(d)}},[t,e]);const u=p.useCallback((d,h)=>{var m;return!d||!h?{}:((m=r==null?void 0:r[d])==null?void 0:m[h])||{}},[r]),f=p.useCallback(async(d,h,m)=>{var g;if(!d||!h){console.warn(" updateProjectInfo: prospectId ou projectType manquant");return}try{const v=((g=r==null?void 0:r[d])==null?void 0:g[h])||{},y=typeof m=="function"?m(v):{...v,...m},x={};(y==null?void 0:y.amount)!==void 0&&(x.amount=y.amount),(y==null?void 0:y.status)!==void 0&&(x.status=y.status),n(w=>{const j={...w};return j[d]||(j[d]={}),Object.keys(x).length===0?(delete j[d][h],Object.keys(j[d]).length===0&&delete j[d]):j[d][h]=x,j});const{error:b}=await T.from("project_infos").upsert({prospect_id:d,project_type:h,data:x},{onConflict:"prospect_id,project_type"});if(b)throw P.error("Erreur upsert project_infos:",{error:b.message}),b;P.debug("project_info updated",{prospectId:d,projectType:h})}catch(v){P.error("Error updateProjectInfo:",{error:v.message});const{data:y}=await T.from("project_infos").select("prospect_id, project_type, data").eq("prospect_id",d).eq("project_type",h).single();throw y&&n(x=>{var j,_;const b={...x};b[d]||(b[d]={});const w={};return((j=y.data)==null?void 0:j.amount)!==void 0&&(w.amount=y.data.amount),((_=y.data)==null?void 0:_.status)!==void 0&&(w.status=y.data.status),b[d][h]=w,b}),v}},[r]);return{projectInfos:r,getProjectInfo:u,updateProjectInfo:f,isLoading:s,error:a}};function xie(e,t,r=!0){p.useEffect(()=>{if(!r||!e||!t||Object.keys(t).length===0)return;const n=T.channel(`auto-create-tasks-${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"project_steps_status",filter:`organization_id=eq.${e}`},async s=>{var i;try{const{prospect_id:a,project_type:l,steps:c}=s.new,u=c.findIndex(g=>g.status==="in_progress");if(u===-1)return;P.debug("Step changed to in_progress",{prospect_id:a,project_type:l,currentStepIndex:u});const f=Object.values(t).find(g=>g.projectId===l);if(!f){P.debug("No prompt found for project",{project_type:l});return}const d=(i=f.stepsConfig)==null?void 0:i[u];if(!d){P.debug("No config for step",{currentStepIndex:u});return}const{data:h,error:m}=await T.from("prospects").select("owner_id, name").eq("id",a).single();if(m){P.error("Error fetching prospect",{error:m});return}for(const g of d.actions||[]){if(g.hasClientAction===!1){P.debug("Creating checklist task",{prospect_id:a,project_type:l,currentStepIndex:u,actionId:g.id});const v=(g.checklist||[]).map(b=>` ${b.text}`).join(`
`),y=JS(new Date),x=new Date(y);x.setMinutes(x.getMinutes()+30),await YS({prospect:h,prospect_id:a,project_type:l,stepName:c[u].name,title:`Tche pour ${h.name}`,notes:v||"Tches  effectuer",taskTime:y,endTime:x});continue}if(g.hasClientAction!==!1&&g.managementMode==="manual"&&g.createTask!==!1){P.debug("Creating task for manual action",{prospect_id:a,project_type:l,currentStepIndex:u,actionId:g.id});const v=JS(new Date),y=new Date(v);y.setMinutes(y.getMinutes()+30),await YS({prospect:h,prospect_id:a,project_type:l,stepName:c[u].name,title:`Tche pour ${h.name}`,notes:g.taskTitle||"Action requise pour ce client",taskTime:v,endTime:y})}}}catch(a){P.error("Error in auto-create-tasks listener",{error:a})}}).subscribe();return()=>{T.removeChannel(n)}},[t,r,e])}async function YS({prospect:e,prospect_id:t,project_type:r,stepName:n,title:s,notes:i,taskTime:a,endTime:l}){const{data:c,error:u}=await T.from("appointments").select("id").eq("type","task").eq("contact_id",t).eq("project_id",r).eq("step",n).eq("title",s).eq("status","pending").gte("created_at",new Date(Date.now()-6e4).toISOString());if(u&&P.error(" Erreur vrification tches existantes:",u),c&&c.length>0)return P.warn(" Tche dj existante, skip cration:",{prospect:e.name,project_type:r,step:n,existing_tasks:c.length}),!0;const{error:f}=await T.from("appointments").insert({type:"task",title:s,assigned_user_id:e.owner_id,contact_id:t,project_id:r,step:n,start_time:a.toISOString(),end_time:l.toISOString(),status:"pending",notes:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});return f?f.code==="23505"?(P.warn(" Tche dj existante (bloque par contrainte unique DB):",{prospect:e.name,project_type:r,step:n,constraint:"unique_pending_task_per_prospect_step"}),!0):(P.error("Error creating task",{error:f}),B({title:"Erreur",description:"Impossible de crer la tche automatique",variant:"destructive"}),!1):(P.info(" Task created automatically",{prospect:e.name,project_type:r,step:n,scheduled_for:a.toISOString()}),B({title:" Tche cre",description:`Une tche a t cre pour ${e.name}`,className:"bg-green-500 text-white"}),!0)}function JS(e=new Date){const t=e.getHours();if(t<9){const r=new Date(e);return r.setHours(9,0,0,0),r}if(t>=9&&t<19)return e;if(t>=19){const r=new Date(e);return r.setDate(r.getDate()+1),r.setHours(9,0,0,0),r}return e}function yie(e,{organizationId:t=null,enabled:r=!0}={}){p.useEffect(()=>{if(!r)return;if(!t){P.warn(" useAutoVerificationTasks: Pas d'organization_id fourni");return}if(!e||Object.keys(e).length===0)return;const n=T.channel(`auto-verification-tasks-${t}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"client_form_panels",filter:`organization_id=eq.${t}`},async s=>{var i,a;try{const l=(i=s.old)==null?void 0:i.status,c=(a=s.new)==null?void 0:a.status;l!=="submitted"&&c==="submitted"&&(P.debug("Client form submitted",{panel_id:s.new.panel_id,prospect_id:s.new.prospect_id,project_type:s.new.project_type}),await bie(s.new,e))}catch(l){P.error(" Erreur dans useAutoVerificationTasks:",l)}}).subscribe();return()=>{T.removeChannel(n)}},[e,t,r])}async function bie(e,t){const{prospect_id:r,project_type:n,form_id:s,verification_mode:i}=e;if((i??"HUMAN").toUpperCase()!=="HUMAN")return;const{data:l,error:c}=await T.from("prospects").select("name, owner_id, organization_id").eq("id",r).single();if(c||!l){P.error(" Erreur rcupration prospect:",c);return}if(!l.organization_id){P.error(" Organization ID manquant pour le prospect:",{prospect_id:r});return}const{data:u,error:f}=await T.from("forms").select("name").eq("form_id",s).single(),d=(u==null?void 0:u.name)||s,h=e.step_name||n||"tape",{data:m,error:g}=await T.from("appointments").select("id").eq("type","task").eq("contact_id",r).eq("project_id",n).eq("step",h).eq("title",`Vrifier le formulaire de ${l.name}`).eq("status","pending").gte("created_at",new Date(Date.now()-6e4).toISOString());if(g&&P.error(" Erreur vrification tches existantes:",g),m&&m.length>0){P.warn(" Tche de vrification dj existante, skip cration:",{prospect:l.name,form:d,existing_tasks:m.length});return}let v=l.owner_id;if(!v){P.warn(` owner_id NULL pour ${l.name}, recherche fallback Global Admin`);const{data:_,error:S}=await T.from("users").select("user_id").eq("organization_id",l.organization_id).eq("role","Global Admin").limit(1).single();if(!S&&_)v=_.user_id;else{P.error(` Aucun admin disponible pour org ${l.organization_id}`),B({title:"Erreur",description:"Aucun admin disponible pour assigner la tche.",variant:"destructive"});return}}const y=`Vrifier le formulaire de ${l.name}`,x=new Date,b=new Date(x.getTime()+30*60*1e3),w={type:"task",title:y,assigned_user_id:v,contact_id:r,project_id:n,step:h,organization_id:l.organization_id,start_time:x.toISOString(),end_time:b.toISOString(),status:"pending",notes:` Vrification requise par un humain

 **Formulaire:** ${d}
 **Client:** ${l.name}
 **tape:** ${h}
 **Projet:** ${n}

 Consultez les rponses du client et validez ou rejetez le formulaire.`,created_at:x.toISOString(),updated_at:x.toISOString()},{error:j}=await T.from("appointments").insert(w);if(j){if(j.code==="23505"){P.warn(" Tche dj existante (bloque par contrainte unique DB):",{prospect:l.name,form:d,constraint:"unique_pending_task_per_prospect_step"});return}P.error(" Erreur cration tche de vrification:",j),B({title:"Erreur",description:"Impossible de crer la tche de vrification.",variant:"destructive"});return}P.info(" Tche de vrification cre:",{title:y,prospect:l.name,form:d,assigned_to:l.owner_id}),B({title:" Tche cre",description:`Tche de vrification assigne pour ${l.name}`,className:"bg-green-500 text-white"})}function wie(e=new Date){const t=new Date(e.toLocaleString("en-US",{timeZone:"Europe/Paris"})),r=t.getDay(),n=t.getHours();if(r===0||r===6){const s=r===0?1:2;return t.setDate(t.getDate()+s),t.setHours(8,0,0,0),t}return n<8?(t.setHours(8,0,0,0),t):(n>=20&&(r===5?t.setDate(t.getDate()+3):t.setDate(t.getDate()+1),t.setHours(8,0,0,0)),t)}async function jie({prospectId:e,projectType:t,moduleId:r,formId:n,ownerId:s,reminderCount:i=0}){try{const{data:a,error:l}=await T.from("prospects").select("first_name, last_name, email").eq("id",e).single();if(l)throw new Error(`Prospect introuvable: ${l.message}`);const{data:c,error:u}=await T.from("forms").select("name").eq("form_id",n).single();if(u)throw new Error(`Formulaire introuvable: ${u.message}`);const f=wie(),d="Formulaire client non complt",h=`
Le client ${a.first_name} ${a.last_name} (${a.email}) n'a pas complt le formulaire "${c.name}" aprs ${i} relance(s).

 Module : ${r}
 Projet : ${t}
 ${i} relance(s) automatique(s) envoye(s)

Action requise : Contacter le client pour l'accompagner dans la compltion du formulaire.
    `.trim(),{data:m,error:g}=await T.from("tasks").insert({title:d,description:h,contact_id:e,owner_id:s,status:"pending",priority:"medium",due_date:f.toISOString(),task_type:"follow_up",metadata:{source:"workflow_v2_auto",moduleId:r,projectType:t,formId:n,reminderCount:i,createdBy:"system"}}).select().single();if(g)throw new Error(`Erreur cration tche: ${g.message}`);return console.log(" [TaskScheduler] Tche cre:",{taskId:m.id,scheduledAt:f.toISOString(),prospectId:e,ownerId:s,reminderCount:i}),{success:!0,taskId:m.id,scheduledAt:f}}catch(a){return console.error(" [TaskScheduler] Erreur cration tche:",a),{success:!1,error:a.message}}}const _ie={answer_question:{label:"Rpondre aux questions",icon:"",description:"Rpond aux questions poses par l'utilisateur"},show_checklist:{label:"Afficher la checklist",icon:"",description:"Montre les lments  vrifier pour cette tape"},show_documents:{label:"Lister les documents",icon:"",description:"Affiche les documents requis ou disponibles"},explain_clause:{label:"Expliquer une clause",icon:"",description:"Explique le contenu juridique d'une clause"},verify_owner:{label:"Vrifier le propritaire",icon:"",description:"Vrifie les informations du propritaire foncier"},calculate_tariff:{label:"Calculer le tarif",icon:"",description:"Calcule le tarif de vente optimal"},check_eligibility:{label:"Vrifier l'ligibilit",icon:"",description:"Vrifie si le projet rpond aux critres"},explain_technical:{label:"Expliquer techniquement",icon:"",description:"Fournit des explications techniques dtailles"},final_check:{label:"Vrification finale",icon:"",description:"Effectue une vrification complte avant validation"}};function woe(e){return _ie[e]||{label:e,icon:"",description:"Action personnalise"}}const vb={targetAudience:"CLIENT",actionType:null,allowedFormIds:[],allowedTemplateIds:[],managementMode:"HUMAN",verificationMode:"HUMAN",completionTrigger:null,requiredFields:[],reminderConfig:{enabled:!1,delayDays:1,maxRemindersBeforeTask:3}},To={objective:"Accompagner l'utilisateur dans cette tape du projet",instructions:"Rponds de manire claire et concise. Si tu ne connais pas la rponse, demande des prcisions.",buttonLabels:{proceedLabel:"Valider et continuer",needDataLabel:"J'ai besoin d'infos"},allowedActions:["answer_question","show_checklist","show_documents"],knowledgeKey:null,tone:"professional",maxResponseLength:500,actionConfig:{...vb}},xs={"appel-offre-investisseurs":{objective:"Guider l'investisseur dans la soumission de son dossier d'appel d'offre photovoltaque",instructions:`Tu es un expert en appels d'offre CRE (Commission de Rgulation de l'nergie).
    
Ton rle:
- Expliquer le processus de soumission
- Vrifier que le dossier est complet
- Rpondre aux questions sur les critres d'ligibilit
- Aider  calculer le tarif de vente optimal

Rgles:
- Ne jamais inventer de chiffres ou de dates
- Toujours vrifier les informations avant de rpondre
- Si incertain, demander confirmation  l'quipe technique
- tre prcis sur les dlais (gnralement 2-3 mois pour les rsultats)`,buttonLabels:{proceedLabel:"Soumettre le dossier",needDataLabel:"Question sur l'AO"},allowedActions:["answer_question","show_checklist","show_documents","calculate_tariff","check_eligibility"],knowledgeKey:"appel-offre",tone:"professional",maxResponseLength:600},"appel-offre":{objective:"Accompagner la soumission  l'appel d'offre CRE",instructions:`Expert en appels d'offre photovoltaque.
    
Priorits:
1. Vrifier l'ligibilit du projet
2. S'assurer que le dossier est complet
3. Conseiller sur le tarif de vente
4. Rappeler les dates limites`,buttonLabels:{proceedLabel:"Valider la soumission",needDataLabel:"Question AO"},allowedActions:["answer_question","show_checklist","show_documents"],knowledgeKey:"appel-offre",tone:"professional",maxResponseLength:500},pdb:{objective:"Scuriser la signature de la promesse de bail avec le propritaire",instructions:`Tu es un assistant juridique spcialis en baux photovoltaques.
    
Ton rle:
- Expliquer les clauses du contrat
- Vrifier les informations du propritaire
- Guider le processus de signature
- Rassurer sur les engagements mutuels

Rgles:
- Toujours recommander une relecture juridique pour les cas complexes
- Ne jamais donner de conseil fiscal personnalis
- Vrifier l'identit du signataire (propritaire lgal)`,buttonLabels:{proceedLabel:"Envoyer pour signature",needDataLabel:"Question sur le bail"},allowedActions:["answer_question","show_checklist","show_documents","verify_owner","explain_clause"],knowledgeKey:"pdb",tone:"reassuring",maxResponseLength:500,actionConfig:{targetAudience:"CLIENT",actionType:"SIGNATURE",allowedFormIds:[],allowedTemplateIds:[],managementMode:"HUMAN",verificationMode:"HUMAN"}},"etude-technique":{objective:"Valider la faisabilit technique du projet photovoltaque",instructions:`Tu es un ingnieur photovoltaque.
    
Ton rle:
- Expliquer les aspects techniques
- Rpondre aux questions sur le dimensionnement
- Clarifier les rsultats de l'tude
- Prparer la visite sur site`,buttonLabels:{proceedLabel:"Valider l'tude",needDataLabel:"Question technique"},allowedActions:["answer_question","show_checklist","explain_technical"],knowledgeKey:"etude-technique",tone:"technical",maxResponseLength:600},raccordement:{objective:"Accompagner la demande de raccordement au rseau Enedis",instructions:`Tu es un expert en raccordement lectrique.
    
Ton rle:
- Expliquer le processus Enedis
- Anticiper les dlais
- Aider  prparer le dossier
- Rpondre aux questions sur la PTF`,buttonLabels:{proceedLabel:"Soumettre  Enedis",needDataLabel:"Question raccordement"},allowedActions:["answer_question","show_checklist","show_documents"],knowledgeKey:"raccordement",tone:"professional",maxResponseLength:500},"mise-en-service":{objective:"Finaliser la mise en service de l'installation",instructions:`Tu supervises la mise en service de l'installation.
    
Ton rle:
- Vrifier que tout est prt
- Coordonner avec Enedis
- S'assurer du bon fonctionnement
- Clbrer la russite du projet !`,buttonLabels:{proceedLabel:" Mettre en service",needDataLabel:"Question finale"},allowedActions:["answer_question","show_checklist","final_check"],knowledgeKey:"mise-en-service",tone:"enthusiastic",maxResponseLength:400}};function Sie(e){if(!e)return To;const t=e.toLowerCase().replace(/[_\s]/g,"-");if(xs[t])return{...To,...xs[t]};const r=Object.keys(xs).find(n=>t.includes(n)||n.includes(t));return r?{...To,...xs[r]}:To}function joe(e,t){if(!e)return;const r=e.toLowerCase().replace(/[_\s]/g,"-");xs[r]={...xs[r]||To,...t},console.log("[V2 Config] Module AI config updated",{moduleId:e,updates:t})}function Nie(e){return Sie(e).actionConfig||{...vb}}function _oe(e,t){if(!e)return;const r=e.toLowerCase().replace(/[_\s]/g,"-"),n=xs[r]||{...To},s=n.actionConfig||{...vb};xs[r]={...n,actionConfig:{...s,...t}},console.log("[V2 Config] Module action config updated",{moduleId:e,actionUpdates:t})}function Soe(e,t=null){var d;const r=[],n=[],s=Nie(e),i=s.targetAudience;(Array.isArray(i)?i.length>0:!!i)||r.push({field:"targetAudience",message:"Au moins une cible doit tre slectionne (Client, Commercial ou Partenaire)"});const l=s.actionType;l||r.push({field:"actionType",message:"Le type d'action doit tre dfini (Formulaire ou Signature)"}),l==="FORM"&&(s.allowedFormIds||[]).length===0&&r.push({field:"allowedFormIds",message:"Au moins un formulaire doit tre slectionn"}),l==="SIGNATURE"&&((s.allowedFormIds||[]).length===0&&r.push({field:"allowedFormIds",message:"Au moins un formulaire de collecte doit tre slectionn pour la signature"}),(s.allowedTemplateIds||[]).length===0&&n.push("Aucun template de contrat slectionn (optionnel)"));const c=s.managementMode;(!c||!["AI","HUMAN"].includes(c))&&r.push({field:"managementMode",message:"Le mode de gestion doit tre dfini (IA ou Humain)"});const u=s.verificationMode;return(!u||!["AI","HUMAN"].includes(u))&&r.push({field:"verificationMode",message:"Le mode de vrification doit tre dfini (IA ou Humain)"}),s.completionTrigger||r.push({field:"completionTrigger",message:"Un trigger de compltion doit tre slectionn (Formulaire valid, Signature complte, etc.)"}),l==="FORM"&&i==="CLIENT"&&((s.requiredFields||[]).length===0&&r.push({field:"requiredFields",message:"Au moins un champ requis doit tre dfini pour viter les validations incompltes"}),(d=s.reminderConfig)!=null&&d.enabled||r.push({field:"reminderConfig",message:"La relance automatique doit tre active pour les formulaires Client"})),console.log("[V2 Validator] Config validation",{moduleId:e,projectType:t,isComplete:r.length===0,errorsCount:r.length,warningsCount:n.length}),{isComplete:r.length===0,errors:r,warnings:n}}function Eie(e,t=!0){const r=p.useRef(new Set);p.useEffect(()=>{if(!t||!e)return;const n=T.channel(`form-reminder-watcher-${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"client_form_panels",filter:`organization_id=eq.${e}`},async s=>{try{const i=s.new;if(i.status==="approved"||i.task_created)return;const a=`${i.prospect_id}-${i.form_id}-${i.reminder_count}`;if(r.current.has(a))return;const l=i.reminder_count||0,c=i.max_reminders_before_task||3;if(l===0)return;if(l>=c){P.info(" [FormReminderWatcher] Seuil atteint  Cration de tche",{prospect_id:i.prospect_id,form_id:i.form_id,reminder_count:l,max_reminders:c});const{data:u,error:f}=await T.from("prospects").select("owner_id, name, email").eq("id",i.prospect_id).single();if(f||!(u!=null&&u.owner_id)){P.error("[FormReminderWatcher] Owner ID introuvable",{error:f});return}const{data:d,error:h}=await T.from("forms").select("name").eq("form_id",i.form_id).single(),m=(d==null?void 0:d.name)||"Formulaire",g=await jie({prospectId:i.prospect_id,prospectName:u.name,prospectEmail:u.email,projectType:i.project_type,formName:m,formId:i.form_id,ownerId:u.owner_id,reminderCount:l});g.success?(P.info(" [FormReminderWatcher] Tche cre avec succs",{task_id:g.taskId,scheduled_at:g.scheduledAt}),r.current.add(a),await T.from("client_form_panels").update({task_created:!0}).eq("panel_id",i.panel_id)):P.error("[FormReminderWatcher] chec cration tche",{error:g.error})}else P.debug("[FormReminderWatcher] Seuil non atteint",{reminder_count:l,max_reminders:c,remaining:c-l})}catch(i){P.error("[FormReminderWatcher] Erreur dans le watcher",{error:i})}}).subscribe();return()=>{T.removeChannel(n)}},[t,e])}const Ym=1*60*1e3,XS=" Vous tes toujours l ? N'hsitez pas si vous avez des questions, je suis l pour vous aider.",Al={start:0,end:24},sx=[0,1,2,3,4,5,6];function Cie(){const e=new Date,t=new Date(e.toLocaleString("en-US",{timeZone:"Europe/Paris"})),r=t.getHours(),n=t.getDay();return sx.includes(n)&&r>=Al.start&&r<Al.end}function Pie(){const e=new Date,t=new Date(e.toLocaleString("en-US",{timeZone:"Europe/Paris"})),r=t.getHours(),n=t.getDay();if(sx.includes(n)&&r<Al.start){const l=new Date(t);return l.setHours(Al.start,0,0,0),l.getTime()-t.getTime()}let s=1,i=(n+1)%7;for(;!sx.includes(i);)s++,i=(i+1)%7;const a=new Date(t);return a.setDate(a.getDate()+s),a.setHours(Al.start,0,0,0),a.getTime()-t.getTime()}function Tie(e,t=!1){const r=p.useRef(new Map),n=p.useRef(new Set),s=p.useCallback(async(l,c,u)=>{try{P.info(" [PresenceCheck] Envoi message prsence",{prospectId:l,projectType:c,panelId:u});const{data:f,error:d}=await T.from("client_form_panels").select("panel_id, status, presence_message_sent").eq("panel_id",u).single();if(d||!f){P.warn("[PresenceCheck] Panel introuvable",{panelId:u,error:d});return}if(f.status!=="pending"){P.debug("[PresenceCheck] Panel non pending, skip",{panelId:u,status:f.status});return}if(f.presence_message_sent===!0){P.debug("[PresenceCheck] Message dj envoy, skip",{panelId:u});return}if(!Cie()){P.debug("[PresenceCheck] Hors fentre horaire, report",{panelId:u});const g=Pie(),v=setTimeout(()=>{s(l,c,u)},g);r.current.set(u,v);return}const{error:h}=await T.from("chat_messages").insert({prospect_id:l,project_type:c,sender:"admin",text:XS,channel:"client",metadata:{type:"presence_check",automated:!0,panel_id:u}});if(h){P.error("[PresenceCheck] Erreur envoi message",{panelId:u,error:h});return}const{error:m}=await T.from("client_form_panels").update({presence_message_sent:!0}).eq("panel_id",u);if(m){P.error("[PresenceCheck] Erreur update flag",{panelId:u,error:m});return}P.info(" [PresenceCheck] Message envoy avec succs",{panelId:u}),n.current.add(u)}catch(f){P.error("[PresenceCheck] Erreur inattendue",{panelId:u,error:f})}},[]),i=p.useCallback((l,c,u,f=Ym)=>{if(r.current.has(u)&&clearTimeout(r.current.get(u)),n.current.has(u))return;const d=setTimeout(()=>{s(l,c,u),r.current.delete(u)},f);r.current.set(u,d)},[s]),a=p.useCallback(l=>{r.current.has(l)&&(clearTimeout(r.current.get(l)),r.current.delete(l))},[]);p.useEffect(()=>{if(!t||!e)return;const l=T.channel(`presence-check-chat-${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`organization_id=eq.${e}`},async f=>{var g;const d=f.new;if(d.sender==="admin"||d.sender==="pro"){if(((g=d.metadata)==null?void 0:g.type)==="presence_check"||d.text===XS){P.debug("[PresenceCheck] Ignore message prsence auto",{prospectId:d.prospect_id,projectType:d.project_type});return}const{data:v,error:y}=await T.from("chat_messages").select("id").eq("prospect_id",d.prospect_id).eq("project_type",d.project_type).eq("sender","client").limit(1);if(y||!v||v.length===0){P.debug("[PresenceCheck] Client jamais interagi, pas de timer",{prospectId:d.prospect_id,projectType:d.project_type});return}P.debug("[PresenceCheck] Message admin/pro dtect, client a dj interagi, dmarrage timer",{prospectId:d.prospect_id,projectType:d.project_type,sender:d.sender});const{data:x,error:b}=await T.from("client_form_panels").select("panel_id, prospect_id, project_type, presence_message_sent").eq("prospect_id",d.prospect_id).eq("project_type",d.project_type).eq("status","pending");if(b||!x||x.length===0)return;for(const w of x){if(w.presence_message_sent){P.debug("[PresenceCheck] Panel dj notifi, pas de nouveau timer",{panelId:w.panel_id});continue}i(w.prospect_id,w.project_type,w.panel_id)}return}if(d.sender!=="client")return;P.debug("[PresenceCheck] Message client dtect",{prospectId:d.prospect_id,projectType:d.project_type});const{data:h,error:m}=await T.from("client_form_panels").select("panel_id, prospect_id, project_type, presence_message_sent").eq("prospect_id",d.prospect_id).eq("project_type",d.project_type).eq("status","pending");if(!(m||!h||h.length===0))for(const v of h)a(v.panel_id),n.current.delete(v.panel_id),await T.from("client_form_panels").update({presence_message_sent:!1}).eq("panel_id",v.panel_id),P.debug("[PresenceCheck] Timer reset aprs rponse client",{panelId:v.panel_id})}).subscribe(),c=T.channel(`presence-check-panels-${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"client_form_panels",filter:`organization_id=eq.${e}`},async f=>{const d=f.new;if(d.status!=="pending")return;P.debug("[PresenceCheck] Nouveau panel dtect",{panelId:d.panel_id});const{data:h,error:m}=await T.from("chat_messages").select("sender, created_at").eq("prospect_id",d.prospect_id).eq("project_type",d.project_type).order("created_at",{ascending:!1}).limit(1);if(m||!h||h.length===0){P.debug("[PresenceCheck] Panel cr sans historique, pas de timer",{panelId:d.panel_id});return}const g=h[0];if(g.sender==="client"){P.debug("[PresenceCheck] Dernier message client, on attend un message admin avant timer",{panelId:d.panel_id});return}const v=new Date(g.created_at),x=new Date().getTime()-v.getTime(),b=Math.max(Ym-x,0);b===0?s(d.prospect_id,d.project_type,d.panel_id):i(d.prospect_id,d.project_type,d.panel_id,b)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"client_form_panels",filter:`organization_id=eq.${e}`},f=>{const d=f.new;d.status!=="pending"&&(a(d.panel_id),P.debug("[PresenceCheck] Panel termin, timer annul",{panelId:d.panel_id}))}).subscribe();return(async()=>{const{data:f,error:d}=await T.from("client_form_panels").select("panel_id, prospect_id, project_type, presence_message_sent").eq("status","pending").eq("presence_message_sent",!1);if(d||!f){P.error("[PresenceCheck] Erreur chargement panels existants",{error:d});return}P.info(`[PresenceCheck] ${f.length} panels pending  surveiller`);for(const h of f){const{data:m}=await T.from("chat_messages").select("sender, created_at").eq("prospect_id",h.prospect_id).eq("project_type",h.project_type).order("created_at",{ascending:!1}).limit(1);if(!m||m.length===0){P.debug("[PresenceCheck] Panel pending sans messages, skip timer",{panelId:h.panel_id});continue}const g=m[0];if(g.sender!=="admin"&&g.sender!=="pro"){P.debug("[PresenceCheck] Dernier message ct client, pas de timer",{panelId:h.panel_id});continue}const v=new Date(g.created_at),x=new Date().getTime()-v.getTime(),b=Math.max(Ym-x,0);b===0?s(h.prospect_id,h.project_type,h.panel_id):i(h.prospect_id,h.project_type,h.panel_id,b)}})(),()=>{for(const[f,d]of r.current.entries())clearTimeout(d);r.current.clear(),T.removeChannel(l),T.removeChannel(c)}},[t,e,i,a,s])}function kie(e,t=!0){const r=p.useRef(new Set),n=p.useCallback(async(s,i,a)=>{try{if(r.current.has(a))return;if(r.current.add(a),r.current.size>1e3){const h=Array.from(r.current);r.current=new Set(h.slice(-500))}P.info(" [ReminderReset] Message client dtect, reset des relances",{prospectId:s,projectType:i,messageId:a});const{data:l,error:c}=await T.from("client_form_panels").select("panel_id, reminder_count, task_created").eq("prospect_id",s).eq("project_type",i).eq("status","pending").eq("task_created",!1);if(c){P.error("[ReminderReset] Erreur fetch panels",{error:c});return}if(!l||l.length===0){P.debug("[ReminderReset] Aucun panel pending  reset",{prospectId:s,projectType:i});return}const u=l.filter(h=>h.reminder_count>0);if(u.length===0){P.debug("[ReminderReset] Aucun panel avec relances  reset",{prospectId:s,projectType:i});const h=l.map(m=>m.panel_id);await T.from("client_form_panels").update({last_reminder_at:new Date().toISOString()}).in("panel_id",h);return}const f=u.map(h=>h.panel_id),{error:d}=await T.from("client_form_panels").update({reminder_count:0,last_reminder_at:new Date().toISOString()}).in("panel_id",f);if(d){P.error("[ReminderReset] Erreur update panels",{error:d});return}P.info(" [ReminderReset] Relances reset avec succs",{prospectId:s,projectType:i,panelsReset:f.length,panelIds:f,previousCounts:u.map(h=>({panelId:h.panel_id,count:h.reminder_count}))})}catch(l){P.error("[ReminderReset] Erreur inattendue",{error:l})}},[]);p.useEffect(()=>{if(!t||!e)return;const s=T.channel(`reminder-reset-chat-${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`organization_id=eq.${e}`},async i=>{const a=i.new;a.sender==="client"&&await n(a.prospect_id,a.project_type,a.id)}).subscribe();return()=>{T.removeChannel(s)}},[t,e,n])}const QS=p.lazy(()=>Fr(()=>import("./FinalPipeline-cf9788df.js"),["assets/FinalPipeline-cf9788df.js","assets/Agenda-4149bd88.js","assets/index-3b5b976b.js","assets/useSupabaseProjectStepsStatus-9177af69.js","assets/external-link-2d13ff19.js","assets/SearchableSelect-44e98734.js","assets/useSupabaseWorkflowModuleTemplates-68970fee.js","assets/workflowV2Config-f801420c.js","assets/pen-square-37948792.js","assets/paperclip-8c10986f.js"])),Aie=p.lazy(()=>Fr(()=>import("./Agenda-4149bd88.js").then(e=>e.a),["assets/Agenda-4149bd88.js","assets/index-3b5b976b.js","assets/useSupabaseProjectStepsStatus-9177af69.js","assets/external-link-2d13ff19.js"])),Rie=p.lazy(()=>Fr(()=>import("./ProfilePage-57250345.js"),["assets/ProfilePage-57250345.js","assets/SearchableSelect-44e98734.js","assets/pen-square-37948792.js"])),Iie=p.lazy(()=>Fr(()=>import("./CharlyPage-745b8866.js"),[])),Oie=p.lazy(()=>Fr(()=>import("./ConfigurationIA-e6f67c99.js"),[])),Die=p.lazy(()=>Fr(()=>import("./ContractTemplatesPage-8d6b94a5.js"),["assets/ContractTemplatesPage-8d6b94a5.js","assets/pen-square-37948792.js"])),$ie=p.lazy(()=>Fr(()=>import("./ContractTemplateEditorPage-1c2a22fe.js"),["assets/ContractTemplateEditorPage-1c2a22fe.js","assets/ContractTemplateEditorPage-8e59e50e.css"])),ZS=p.lazy(()=>Fr(()=>import("./ClientDashboardPage-cdab65b9.js"),["assets/ClientDashboardPage-cdab65b9.js","assets/useSupabaseProjectStepsStatus-9177af69.js","assets/index-3b5b976b.js","assets/paperclip-8c10986f.js"])),Mie=p.lazy(()=>Fr(()=>import("./WorkflowV2Page-6054493e.js"),["assets/WorkflowV2Page-6054493e.js","assets/workflowV2Config-f801420c.js","assets/useSupabaseProjectStepsStatus-9177af69.js","assets/useSupabaseWorkflowModuleTemplates-68970fee.js","assets/ModuleConfigTab-c7765f64.js","assets/rocket-63a2bc73.js","assets/external-link-2d13ff19.js"])),Lie=p.lazy(()=>Fr(()=>import("./ProspectDetailsV2-1f7ffe28.js"),["assets/ProspectDetailsV2-1f7ffe28.js","assets/workflowV2Config-f801420c.js","assets/useSupabaseProjectStepsStatus-9177af69.js","assets/rocket-63a2bc73.js"])),Fie=p.lazy(()=>Fr(()=>import("./WorkflowV2ConfigPage-3484617d.js"),["assets/WorkflowV2ConfigPage-3484617d.js","assets/ModuleConfigTab-c7765f64.js","assets/useSupabaseWorkflowModuleTemplates-68970fee.js","assets/workflowV2Config-f801420c.js","assets/rocket-63a2bc73.js"])),eN=["bg-blue-100","bg-yellow-100","bg-green-100","bg-purple-100","bg-orange-100","bg-indigo-100","bg-teal-100","bg-pink-100","bg-rose-100","bg-gray-100"],Bie={MARKET:"bg-blue-100",ETUDE:"bg-yellow-100",OFFRE:"bg-green-100",CONTRAT:"bg-blue-100","CONTRAT OK":"bg-blue-100","CLIENT ACTIF":"bg-purple-100"},ix=e=>(e||"").toString().trim().toUpperCase(),tN=(e,t,r,n=0)=>{const s=ix(e),i=Bie[s]||eN[n%eN.length];return{id:t||`global-pipeline-step-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,label:s,color:typeof r=="string"&&r.trim()?r:i}},zie=e=>Array.isArray(e)?e.map((t,r)=>{if(typeof t=="string"){const n=ix(t);return n?tN(n,`legacy-global-pipeline-${r}`,void 0,r):null}if(t&&typeof t=="object"&&"label"in t){const n=ix(t.label);if(!n)return null;const s=typeof t.color=="string"?t.color:void 0;return tN(n,t.id||`legacy-global-pipeline-${r}`,s,r)}return null}).filter(Boolean):[],Uie=(e=[],t=[])=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1){const n=e[r],s=t[r];if(!n||!s||n.id!==s.id||n.name!==s.name||n.type!==s.type||n.placeholder!==s.placeholder||!!n.required!=!!s.required)return!1}return!0},Vie=(e=[],t=[])=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1){const n=e[r],s=t[r];if(!n||!s||n.id!==s.id||n.label!==s.label||n.color!==s.color)return!1}return!0},UD=J.createContext(),Ve=()=>J.useContext(UD),mt={INIT:"init",RESOLVING_ORG:"resolving_org",AUTH:"auth",LOADING_USER:"loading_user",READY:"ready",ERROR:"error"};function qie(){const e=Ht();if(e.pathname==="/landing")return o.jsx(hd,{});const t=Te(),r=e.pathname.startsWith("/admin"),[n,s]=p.useState(mt.INIT),[i,a]=p.useState(null),{organizationId:l,organizationLoading:c,organizationError:u,organizationReady:f,brandName:d,logoUrl:h,primaryColor:m,secondaryColor:g,brandingLoading:v,brandingError:y}=an(),[x,b]=p.useState([]),[w,j]=p.useState([]),[_,S]=p.useState(null),[N,E]=p.useState([]),[C,k]=p.useState({});p.useState([]),p.useState([]);const[L,A]=p.useState({}),[R,O]=p.useState({}),[z,F]=p.useState(null),[V,I]=p.useState(null),[D,$]=p.useState(!0),[M,W]=p.useState(!1),[U,X]=p.useState(null),[me,se]=p.useState(!1),Z=p.useRef(!1);p.useEffect(()=>{if(n===mt.INIT){s(mt.RESOLVING_ORG);return}if(n===mt.RESOLVING_ORG){if(u){P.error("[Boot] Organization resolution failed",{error:u}),a(u),s(mt.ERROR);return}if(f){s(mt.AUTH);return}}if(n===mt.AUTH&&!D){s(U?mt.LOADING_USER:mt.READY);return}n===mt.LOADING_USER&&(M||_||!V&&!_&&!D)&&s(mt.READY)},[n,f,u,l,D,U,M,V,_]),jy();const{prospects:oe,addProspect:H,updateProspect:q,loading:te}=lie(D?null:V,l),{appointments:ue,calls:_e,tasks:ke,loading:dt,error:cn,addAppointment:Nn,updateAppointment:Ra,deleteAppointment:rs,addCall:Ki,updateCall:VD,deleteCall:qD,addTask:WD,updateTask:HD,deleteTask:GD,refresh:KD}=uie(D?null:V,l);p.useEffect(()=>{!D&&!te&&oe&&j(oe)},[oe,te,D]);const xb=e.pathname.startsWith("/dashboard"),yb=D||!xb?null:_==null?void 0:_.id;U&&!D&&P.debug("App routing info",{isClientRoute:xb,activeAdmin:V==null?void 0:V.name,currentUser:_==null?void 0:_.name,prospectIdForForms:yb});const{formPanels:YD,createFormPanel:JD,updateFormPanel:XD,deleteFormPanelsByProspect:QD}=mie(f?yb:"__DISABLED__"),{companySettings:ap,updateLogo:ZD,removeLogo:e$,updateFormContactConfig:bb,getFormContactConfig:wb}=die({organizationId:l,enabled:f});p.useEffect(()=>{if(!l){F(null);return}(async()=>{try{const{data:Y,error:K}=await T.from("organization_settings").select("form_contact_config").eq("organization_id",l).single();if(K){P.debug("[App] organization_settings.form_contact_config non trouv, fallback vers company_settings"),F(null);return}F((Y==null?void 0:Y.form_contact_config)||null)}catch{F(null)}})()},[l]);const{globalPipelineSteps:jb,loading:t$,addStep:r$,updateStep:n$,deleteStep:s$,reorderSteps:Kie}=fie(f?l:null),{allProjectSteps:Zc,loading:lp}=gie(l);p.useEffect(()=>{!D&&!lp&&Zc&&k(Q=>{const Y={...Q};return Object.entries(Zc).forEach(([K,ce])=>{const[fe,ae]=K.split("-"),qe=`prospect_${fe}_project_${ae}`;Y[qe]=ce}),Y})},[Zc,lp,D]);const{projectTemplates:cp,loading:Yie,addTemplate:i$,updateTemplate:o$,deleteTemplate:a$,getPublicTemplates:Jie}=FD({organizationId:l,enabled:f}),{forms:_b,loading:Sb}=$y(l);p.useEffect(()=>{!D&&!Sb&&A(_b)},[_b,Sb,D]);const{prompts:eu,loading:Nb}=_I({organizationId:l,enabled:f});p.useEffect(()=>{!D&&!Nb&&O(eu)},[eu,Nb,D]),xie(l,eu,!D&&M),yie(eu,{organizationId:l,enabled:!D&&M&&f}),Eie(l,!D&&M),Tie(l,!D&&M),kie(l,!D&&M);const{notifications:l$,createOrUpdateNotification:c$,markAsRead:u$}=hie((V==null?void 0:V.user_id)||null,!D&&M&&!!V),{notifications:d$,createOrUpdateNotification:f$,markAsRead:h$}=pie((_==null?void 0:_.id)||null,!D&&!!_),{projectInfos:Ia,getProjectInfo:p$,updateProjectInfo:Eb}=vie(l),Oa=p.useMemo(()=>cp.reduce((Y,K)=>(Y[K.type]=K,Y),{}),[cp]),m$=h||"",g$=ZD,Cb=z&&z.length>0?z:wb().length>0?wb():iie;p.useEffect(()=>{(async()=>{var fe;const ce=new URLSearchParams(window.location.search).get("code");if(ce){try{const{data:ae,error:qe}=await T.auth.exchangeCodeForSession(ce);qe?P.error("Error exchanging code for session",{error:qe.message}):ae.session&&(P.debug("Session established from code",{email:(fe=ae.session.user)==null?void 0:fe.email}),X(ae.session),window.history.replaceState({},document.title,window.location.pathname+window.location.hash))}catch(ae){P.error("Exception during code exchange",{error:ae.message})}return}})();const{data:{subscription:Y}}=T.auth.onAuthStateChange((K,ce)=>{var fe;P.debug("Auth event",{event:K,email:(fe=ce==null?void 0:ce.user)==null?void 0:fe.email}),X(ce??null)});return T.auth.getSession().then(({data:K})=>{var fe;const ce=K.session;ce&&(P.debug("Initial session found",{email:(fe=ce.user)==null?void 0:fe.email}),X(ce))}),()=>Y.unsubscribe()},[]);const un=p.useRef(!1);async function Pb(Q){if(!un.current){un.current=!0;try{$(!0);const{data:Y}=await T.from("users").select("*").eq("user_id",Q).maybeSingle();if(Y){if(Y.organization_id){const{data:ae}=await T.rpc("platform_get_org_status",{p_org_id:Y.organization_id});if((ae==null?void 0:ae.status)==="suspended"){P.info("Organization suspended, logging out admin"),await T.auth.signOut(),$(!1),un.current=!1,sessionStorage.setItem("org_suspended_message","Votre organisation est temporairement suspendue. Contactez le support.");return}}const fe={id:Y.id,user_id:Y.user_id,userId:Y.user_id,name:Y.name,email:Y.email,role:Y.role,phone:Y.phone,avatar_url:Y.avatar_url,avatarUrl:Y.avatar_url,manager_id:Y.manager_id,managerId:Y.manager_id,organization_id:Y.organization_id,organizationId:Y.organization_id,access_rights:Y.access_rights,accessRights:Y.access_rights,created_at:Y.created_at,createdAt:Y.created_at,updated_at:Y.updated_at,updatedAt:Y.updated_at};I(fe),W(!0),S(null),setTimeout(()=>{$(!1),un.current=!1},0);return}if(!f||!l){P.debug("Client lookup skipped: organization context not ready",{userId:Q,organizationReady:f,organizationId:l}),setTimeout(()=>{$(!1),un.current=!1},0);return}let K=null;const{data:ce}=await T.from("prospects").select("*").eq("user_id",Q).eq("organization_id",l).maybeSingle();if(K=ce||null,!K){P.debug("No prospect linked in this organization for user",{userId:Q,organizationId:l}),se(!0),S(null),setTimeout(()=>{$(!1),un.current=!1},0);return}if(se(!1),K){if(K.organization_id){const{data:ae}=await T.rpc("platform_get_org_status",{p_org_id:K.organization_id});if((ae==null?void 0:ae.status)==="suspended"){P.info("Organization suspended, logging out client"),await T.auth.signOut(),$(!1),un.current=!1,sessionStorage.setItem("org_suspended_message","Votre organisation est temporairement suspendue. Contactez le support.");return}}const fe={id:K.id,name:K.name,email:K.email,phone:K.phone,address:K.address,companyName:K.company_name,tags:K.tags||[],userId:K.user_id,ownerId:K.owner_id,organizationId:K.organization_id,organization_id:K.organization_id,status:K.status,hasAppointment:K.has_appointment,affiliateName:K.affiliate_name,formData:K.form_data||{},createdAt:K.created_at,updatedAt:K.updated_at};S(fe),I(null),K.tags&&Array.isArray(K.tags)&&b(K.tags),setTimeout(()=>{$(!1),un.current=!1},0);return}S(null),I(null),setTimeout(()=>{$(!1)},0)}catch(Y){P.error("Erreur chargement utilisateur authentifi",{error:Y.message}),setTimeout(()=>{$(!1)},0)}finally{un.current=!1}}}p.useEffect(()=>{if(e.pathname.startsWith("/inscription")||e.pathname.startsWith("/register")||e.pathname==="/"||e.pathname.startsWith("/platform-login")||e.pathname.startsWith("/platform")){I(null),se(!1),setTimeout(()=>{$(!1)},0);return}if(!U){I(null),S(null),se(!1),setTimeout(()=>{$(!1)},0);return}se(!1),$(!0),Pb(U.user.id),e.pathname==="/"&&!_&&!V&&setTimeout(()=>{_&&t("/dashboard")},1e3)},[U]),p.useEffect(()=>{var Q;U&&(!f||!l||V||!_&&!un.current&&(P.debug("Organization ready - triggering deferred user load",{organizationId:l,userId:(Q=U.user)==null?void 0:Q.id}),$(!0),Pb(U.user.id)))},[f,l,U,V,_]),p.useEffect(()=>{if(!(_!=null&&_.id))return;P.debug("Setting up real-time channel for currentUser prospect",{prospectId:_.id});const Q=T.channel(`client-prospect-${_.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"prospects",filter:`id=eq.${_.id}`},Y=>{var ce;P.debug("Real-time UPDATE received for currentUser",{prospectId:(ce=Y.new)==null?void 0:ce.id});const K={id:Y.new.id,name:Y.new.name,email:Y.new.email,phone:Y.new.phone,address:Y.new.address,companyName:Y.new.company_name,tags:Y.new.tags||[],userId:Y.new.user_id,ownerId:Y.new.owner_id,status:Y.new.status,hasAppointment:Y.new.has_appointment,affiliateName:Y.new.affiliate_name,formData:Y.new.form_data||{},createdAt:Y.new.created_at,updatedAt:Y.new.updated_at};S(K)}).subscribe();return()=>{T.removeChannel(Q)}},[_==null?void 0:_.id]),p.useEffect(()=>{if(!(_!=null&&_.id)||!w.length)return;const Q=w.find(Y=>Y.id===_.id);if(Q){const Y=JSON.stringify(_.formData||_.form_data),K=JSON.stringify(Q.formData||Q.form_data);Y!==K&&S({..._,formData:Q.formData||Q.form_data,form_data:Q.formData||Q.form_data})}},[w,_==null?void 0:_.id]),p.useEffect(()=>{Z.current=!0},[]);const v$=async Q=>{try{const Y=[];for(const[K,ce]of Object.entries(Q)){const fe=cp.find(qe=>qe.type===K),ae={title:ce.title,client_title:ce.clientTitle||ce.client_title,icon:ce.icon,color:ce.color,steps:ce.steps,is_public:ce.isPublic!==void 0?ce.isPublic:ce.is_public,image_url:ce.coverImage||ce.image_url,client_description:ce.clientDescription||ce.client_description,cta_text:ce.ctaText||ce.cta_text};fe?(fe.title!==ae.title||fe.client_title!==ae.client_title||fe.icon!==ae.icon||fe.color!==ae.color||JSON.stringify(fe.steps)!==JSON.stringify(ae.steps)||fe.is_public!==ae.is_public||fe.image_url!==ae.image_url||fe.client_description!==ae.client_description||fe.cta_text!==ae.cta_text)&&Y.push(o$(fe.id,ae)):Y.push(i$({type:K,...ae}))}Y.length>0&&await Promise.all(Y)}catch(Y){throw P.error("Erreur handleSetProjectsData",{error:Y.message}),Y}},x$=async Q=>{const Y=Cb||[],K=typeof Q=="function"?Q(Y):Q;if(!Array.isArray(K)){P.warn("Invalid form contact config, using default",{received:typeof K});return}if(!Uie(Y,K))try{await bb(K),F(K)}catch(ce){P.error("Erreur update config formulaire contact",{error:ce.message})}},y$=(Q,Y)=>{var K;return!Q||!Y?{}:((K=Ia==null?void 0:Ia[Q])==null?void 0:K[Y])||{}},Tb=Eb,b$=async Q=>{const Y=jb,K=typeof Q=="function"?Q(Y):Q,ce=zie(K);if(!Vie(Y,ce))try{const fe=new Set(Y.map(We=>We.id)),ae=new Set(ce.map(We=>We.id));for(const We of Y)ae.has(We.id)||await s$(We.id);for(const We of ce)fe.has(We.id)||await r$(We.label,We.color||"bg-gray-100");const qe=ce.filter(We=>fe.has(We.id));for(let We=0;We<qe.length;We++){const Ie=qe[We],Sr=Y.find(up=>up.id===Ie.id);Sr&&(Sr.label!==Ie.label||Sr.color!==Ie.color||Sr.position!==We)&&await n$(Ie.id,{label:Ie.label,color:Ie.color,position:We})}}catch(fe){P.error("Erreur update pipeline steps",{error:fe.message}),B({title:"Erreur",description:"Impossible de mettre  jour les colonnes du pipeline.",variant:"destructive"})}};p.useEffect(()=>{(async()=>{var K,ce;if(!l)return;const Y=localStorage.getItem("evatime_form_contact_config");if(Y){const fe=JSON.parse(Y),ae=z&&z.length>0;((ce=(K=ap==null?void 0:ap.settings)==null?void 0:K.form_contact_config)==null?void 0:ce.length)>0,ae||(await bb(fe),F(fe)),localStorage.removeItem("evatime_form_contact_config")}})()},[l,z]),p.useEffect(()=>{localStorage.getItem("evatime_company_logo")&&localStorage.removeItem("evatime_company_logo")},[]);const w$=async(Q,Y,K)=>{var ce,fe,ae;try{if(K.completedFormId&&K.sender==="client"){const{data:Ie}=await T.from("chat_messages").select("id").eq("prospect_id",Q).eq("project_type",Y).eq("sender","client").eq("completed_form_id",K.completedFormId).eq("related_message_timestamp",K.relatedMessageTimestamp||"");if(Ie&&Ie.length>0)return}if(K.promptId){const{data:Ie}=await T.from("chat_messages").select("id").eq("prospect_id",Q).eq("project_type",Y).eq("sender",K.sender).eq("prompt_id",K.promptId).eq("step_index",K.stepIndex||0).eq("text",K.text||"");if(Ie&&Ie.length>0)return}const qe={prospect_id:Q,project_type:Y,sender:K.sender,text:K.text||null,file:K.file||null,form_id:K.formId||null,completed_form_id:K.completedFormId||null,prompt_id:K.promptId||null,step_index:K.stepIndex!==void 0?K.stepIndex:null,related_message_timestamp:K.relatedMessageTimestamp||null,channel:K.channel||"client",metadata:K.metadata||null,partner_id:K.partnerId||null,read:!1},{error:We}=await T.from("chat_messages").insert([qe]);if(We)throw We;if(K.file&&K.sender==="client"&&Tb(Q,Y,Ie=>Y==="ACC"&&!(Ie!=null&&Ie.ribFile)?{...Ie,ribFile:K.file.name}:Ie||{}),K.sender==="client"){const{data:Ie,error:Sr}=await T.from("prospects").select("name, owner_id").eq("id",Q).single();if(Sr){P.error("Error loading prospect for notification",{error:Sr}),B({title:"Erreur",description:"Impossible de charger les informations du prospect.",variant:"destructive"});return}Ie?await c$({prospectId:Q,ownerId:Ie.owner_id,projectType:Y,prospectName:Ie.name,projectName:((ce=Oa[Y])==null?void 0:ce.title)||Y}):P.warn("No prospect data found for notification",{prospectId:Q})}(K.sender==="admin"||K.sender==="pro")&&await f$({prospectId:Q,projectType:Y,projectName:((fe=Oa[Y])==null?void 0:fe.title)||Y,message:((ae=K.text)==null?void 0:ae.substring(0,50))||"Nouveau message"})}catch(qe){P.error("Erreur envoi message",{error:qe.message}),B({title:"Erreur",description:"Impossible d'envoyer le message. Vrifiez votre connexion.",variant:"destructive"})}},j$=Q=>{u$(Q)},_$=(Q,Y,K)=>N.filter(ce=>ce.share===!0&&ce.contactId===Q&&ce.projectId===Y&&ce.step===K),Da=async(Q,Y,K)=>{const ce=`prospect_${Q}_project_${Y}`;k(fe=>({...fe,[ce]:K}));try{if(!l){P.warn("updateProjectSteps: organisation manquante  skip server save");return}const{data:fe,error:ae}=await T.from("project_steps_status").upsert({prospect_id:Q,project_type:Y,steps:K,organization_id:l,updated_at:new Date().toISOString()},{onConflict:"prospect_id,project_type"}).select().single();if(ae){P.error("Erreur sauvegarde Supabase",{error:ae.message}),B({title:"Erreur",description:"Impossible de sauvegarder les tapes",variant:"destructive"});return}}catch(fe){P.error("Erreur sauvegarde project steps",{error:fe.message})}},S$=(Q,Y)=>{var qe;const K=`prospect_${Q}_project_${Y}`,ce=C[K],fe=(qe=Oa[Y])==null?void 0:qe.steps;if(!fe||fe.length===0)return[];const ae=JSON.parse(JSON.stringify(fe));return ce&&ce.length>0?ae.forEach((We,Ie)=>{const Sr=ce.find(up=>up.name===We.name);Sr&&(We.status=Sr.status)}):ae.length>0&&ae[0].status==="pending"&&(ae[0].status="in_progress"),ae},N$=async(Q,Y,K,ce)=>{if(!ce||ce.length===0){P.error("No steps provided",{prospectId:Q,projectType:Y});return}if(P.debug("Steps received from caller",{count:ce.length}),K<0||K>=ce.length){P.error("Index tape invalide",{currentStepIndex:K,stepsLength:ce.length});return}const fe=JSON.parse(JSON.stringify(ce)),ae=fe[K];if(ae!=null&&ae.subSteps&&Array.isArray(ae.subSteps)&&ae.subSteps.length>0){let qe=ae.subSteps.findIndex(Ie=>Ie.status==="in_progress");if(qe===-1&&(qe=ae.subSteps.findIndex(Ie=>Ie.status==="pending"),qe!==-1&&(ae.subSteps[qe].status="in_progress")),qe!==-1){ae.subSteps[qe].status="completed";const Ie=ae.subSteps.findIndex(Sr=>Sr.status==="pending");if(Ie!==-1){ae.subSteps[Ie].status="in_progress",ae.status="in_progress",fe[K]=ae,P.debug("Substep completed, staying in same step",{completedSub:qe,nextSub:Ie,stepName:ae.name}),await Da(Q,Y,fe);return}}if(!ae.subSteps.every(Ie=>Ie.status==="completed")){P.warn("Sous-tapes incompltes dtectes alors que aucune active trouve",{stepName:ae.name,subSteps:ae.subSteps}),ae.status="in_progress",fe[K]=ae,await Da(Q,Y,fe);return}ae.status="completed",fe[K]=ae}else ae.status="completed",fe[K]=ae;fe[K].name,K+1<fe.length&&(fe[K+1].status="in_progress",fe[K+1].name),await Da(Q,Y,fe)},E$=async Q=>{var K;if(x.includes(Q))return!1;const Y=[...x,Q];if(b(Y),_){const ce=[..._.tags||[],Q];try{await kb({id:_.id,tags:ce}),P.debug(" Tags updated in Supabase",{projectType:Q,updatedTags:ce})}catch(ae){return P.error(" Failed to update tags in Supabase",ae),B({title:"Erreur",description:"Impossible d'ajouter le projet. Veuillez ressayer.",variant:"destructive"}),!1}const fe=(K=Oa[Q])==null?void 0:K.steps;if(fe&&fe.length>0){const ae=JSON.parse(JSON.stringify(fe));ae[0].status="in_progress",Da(_.id,Q,ae)}}return!0},kb=async Q=>{try{await q(Q.id,Q),_&&_.id===Q.id&&(S({..._,...Q}),Q.tags&&b(Q.tags))}catch(Y){P.error("Erreur update prospect",{error:Y.message}),B({title:"Erreur",description:Y.message||"Impossible de modifier le prospect.",variant:"destructive"})}},C$={userProjects:x,setUserProjects:b,addProject:E$,projectsData:Oa,setProjectsData:v$,deleteProjectTemplate:a$,prospects:oe,prospectsLoading:te,setProspects:j,addProspect:H,updateProspect:kb,currentUser:_,setCurrentUser:(Q,Y)=>{const K=Q?{...Q,affiliateName:Y}:null;S(K),K?K.tags&&Array.isArray(K.tags)&&b(K.tags):t("/")},appointments:ue||[],addAppointment:Nn,updateAppointment:Ra,deleteAppointment:rs,getSharedAppointments:_$,getProjectSteps:S$,updateProjectSteps:Da,completeStepAndProceed:N$,calls:_e||[],addCall:Ki,updateCall:VD,deleteCall:qD,tasks:ke||[],addTask:WD,updateTask:HD,deleteTask:GD,agendaLoading:dt,refreshAgenda:KD,addChatMessage:w$,notifications:l$,markNotificationAsRead:j$,clientNotifications:d$,markClientNotificationAsRead:h$,forms:L,prompts:R,formContactConfig:Cb,setFormContactConfig:x$,projectInfos:Ia,getProjectInfo:y$,updateProjectInfo:Tb,supabaseProjectInfos:Ia,getSupabaseProjectInfo:p$,updateSupabaseProjectInfo:Eb,globalPipelineSteps:jb,setGlobalPipelineSteps:b$,pipelineLoading:t$,allProjectSteps:Zc,allStepsLoading:lp,activeAdminUser:V,setActiveAdminUser:I,switchActiveAdminUser:Q=>{Q&&Q.id&&(I(Q),B({title:`Connect en tant que ${Q.name}`,description:`Vous naviguez maintenant avec le profil de ${Q.name}.`,className:"bg-blue-600 text-white"}))},authLoading:D,adminReady:M,bootStatus:n,bootError:i,BOOT_STATUS:mt,clientFormPanels:YD,registerClientForm:JD,updateClientFormPanel:XD,clearClientFormsFor:QD,companyLogo:m$,setCompanyLogo:g$,removeLogo:e$,brandName:d,logoUrl:h,primaryColor:m,secondaryColor:g},Ab=()=>{const Q=d||"Application";return e.pathname==="/"?`${Q} - conomisez sur votre lectricit`:e.pathname.startsWith("/inscription")?`${Q} - Dmarrez votre projet`:e.pathname==="/producteurs"?`${Q} - Vendez mieux votre lectricit`:e.pathname.startsWith("/dashboard/offres")?`${Q} - Nos Offres Exclusives`:e.pathname.startsWith("/dashboard/profil")?`${Q} - Votre Profil`:e.pathname.startsWith("/dashboard")?`${Q} - Votre Espace Client`:e.pathname.startsWith("/admin/profil")?`${Q} Pro - Mon Profil`:e.pathname.startsWith("/admin/charly")?`${Q} Pro - Charly AI`:r?`${Q} Pro - Espace Admin`:Q},Rb=()=>e.pathname==="/"?"Dpensez 35 % de moins sur votre lectricit, garanti 10 ans.":e.pathname.startsWith("/inscription")?`Choisissez vos projets et rejoignez ${d||"notre plateforme"}.`:e.pathname==="/producteurs"?"Optimisez la rentabilit de vos centrales solaires avec l'autoconsommation collective.":e.pathname.startsWith("/dashboard/offres")?"Dcouvrez nos offres pour l'autonomie nergtique, la production solaire et l'investissement.":e.pathname.startsWith("/dashboard/profil")?"Grez vos informations personnelles et vos prfrences.":e.pathname.startsWith("/dashboard")?"Suivez l'avancement de vos projets nergtiques ACC, solaire, et plus.":e.pathname.startsWith("/admin/profil")?"Grez vos informations, utilisateurs et clients.":e.pathname.startsWith("/admin/charly")?"Grez vos campagnes et scripts avec votre assistant IA Charly.":r?`Grez vos prospects, projets et agenda avec ${d||"la plateforme"} Pro.`:"La solution pour vos projets nergtiques.";if(n===mt.ERROR)return o.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[o.jsx("div",{className:"flex justify-center mb-4",children:o.jsx("div",{className:"bg-red-100 rounded-full p-4",children:o.jsx("svg",{className:"h-12 w-12 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Connexion impossible"}),o.jsx("p",{className:"text-gray-600 mb-4",children:i||"Le serveur ne rpond pas. Vrifiez votre connexion internet."}),o.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-6 text-left",children:o.jsxs("p",{className:"text-xs text-gray-500",children:[o.jsx("strong",{children:"Dtails techniques :"}),o.jsx("br",{}),"Boot status: ",n,o.jsx("br",{}),"Organization: ",l||"non rsolue"]})}),o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Ressayer"}),o.jsx("button",{onClick:()=>window.location.href="/",className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:"Retour  l'accueil"})]})]})});if(n===mt.INIT||n===mt.RESOLVING_ORG){const Q={[mt.INIT]:"Initialisation...",[mt.RESOLVING_ORG]:"Connexion au serveur..."};return o.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 font-medium",children:Q[n]||"Chargement..."}),o.jsx("p",{className:"text-xs text-gray-400 mt-2",children:n===mt.RESOLVING_ORG&&"Cela peut prendre quelques secondes..."})]})})}return o.jsxs(UD.Provider,{value:C$,children:[o.jsxs(qd,{children:[o.jsx("title",{children:Ab()}),o.jsx("meta",{name:"description",content:Rb()}),o.jsx("meta",{property:"og:title",content:Ab()}),o.jsx("meta",{property:"og:description",content:Rb()})]}),me&&!D&&!e.pathname.startsWith("/partner")&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-900 px-4 py-3 text-sm flex items-center gap-2",children:[o.jsx("span",{className:"font-semibold",children:"Compte non rattach  cette organisation."}),o.jsx("span",{children:"Demandez une invitation."})]}),o.jsx(p.Suspense,{fallback:o.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500 text-sm",children:"Chargement..."})]})}),children:o.jsxs(H4,{children:[o.jsx(ge,{path:"/platform-login",element:o.jsx(Wse,{})}),o.jsxs(ge,{path:"/platform",element:o.jsx(HG,{}),children:[o.jsx(ge,{index:!0,element:o.jsx(Hse,{})}),o.jsx(ge,{path:"organizations",element:o.jsx(Vse,{})}),o.jsx(ge,{path:"organizations/:id",element:o.jsx(qse,{})})]}),o.jsx(ge,{path:"/",element:o.jsx(hd,{})}),o.jsx(ge,{path:"/landing",element:o.jsx(hd,{})}),o.jsx(ge,{path:"/solaire",element:o.jsx(GS,{})}),o.jsx(ge,{path:"/login",element:o.jsx(Yse,{})}),o.jsx(ge,{path:"/activate-account",element:o.jsx(Use,{})}),o.jsx(ge,{path:"/signup",element:o.jsx(Jse,{})}),o.jsx(ge,{path:"/client-access",element:o.jsx(Kse,{})}),o.jsx(ge,{path:"/inscription",element:o.jsx(KS,{})}),o.jsx(ge,{path:"/inscription/:slugUser",element:o.jsx(KS,{})}),o.jsx(ge,{path:"/producteurs",element:o.jsx(Xse,{})}),o.jsx(ge,{path:"/test-supabase",element:o.jsx(Qse,{})}),o.jsx(ge,{path:"/reset-password",element:o.jsx(Zse,{})}),o.jsx(ge,{path:"/signature/:signatureProcedureId",element:o.jsx(eie,{})}),o.jsx(ge,{path:"/sign/cosigner",element:o.jsx(tie,{})}),o.jsx(ge,{path:"/partner/login",element:o.jsx(Cse,{})}),o.jsxs(ge,{path:"/partner",element:o.jsx(KG,{}),children:[o.jsx(ge,{index:!0,element:o.jsx(US,{})}),o.jsx(ge,{path:"missions",element:o.jsx(US,{})}),o.jsx(ge,{path:"missions/:missionId",element:o.jsx(Ose,{})}),o.jsx(ge,{path:"contacts",element:o.jsx(Dse,{})}),o.jsx(ge,{path:"charly",element:o.jsx(Lse,{})}),o.jsx(ge,{path:"preuves",element:o.jsx(Fse,{})})]}),o.jsx(ge,{path:"/:slugUser",element:o.jsx(GS,{})}),o.jsx(ge,{path:"/client/activation",element:o.jsx(zse,{})}),o.jsxs(ge,{path:"/client/dashboard",element:o.jsx(_1,{}),children:[o.jsx(ge,{index:!0,element:o.jsx(ZS,{})}),o.jsx(ge,{path:"parrainage",element:o.jsx(qS,{})}),o.jsx(ge,{path:"profil",element:o.jsx(Gm,{})}),o.jsx(ge,{path:"offres",element:o.jsx(HS,{})})]}),o.jsxs(ge,{path:"/dashboard",element:o.jsx(_1,{}),children:[o.jsx(ge,{index:!0,element:o.jsx(ZS,{})}),o.jsx(ge,{path:"parrainage",element:o.jsx(qS,{})}),o.jsx(ge,{path:"profil",element:o.jsx(Gm,{})}),o.jsx(ge,{path:"offres",element:o.jsx(HS,{})})]}),o.jsxs(ge,{path:"/admin",element:o.jsx(qG,{}),children:[o.jsx(ge,{index:!0,element:o.jsx(QS,{})}),o.jsx(ge,{path:"pipeline",element:o.jsx(QS,{})}),o.jsx(ge,{path:"agenda",element:o.jsx(Aie,{})}),o.jsx(ge,{path:"contacts",element:o.jsx(_K,{})}),o.jsx(ge,{path:"charly",element:o.jsx(Iie,{})}),o.jsx(ge,{path:"configuration-ia",element:o.jsx(Oie,{})}),o.jsx(ge,{path:"workflows-charly",element:o.jsx(TJ,{})}),o.jsx(ge,{path:"workflow-v2/:prospectId/:projectType",element:o.jsx(Mie,{})}),o.jsx(ge,{path:"workflow-v2-config",element:o.jsx(Fie,{})}),o.jsx(ge,{path:"prospect-v2/:prospectId",element:o.jsx(Lie,{})}),o.jsx(ge,{path:"landing-page",element:o.jsx(LJ,{})}),o.jsx(ge,{path:"projects-management",element:o.jsx(Kre,{})}),o.jsx(ge,{path:"forms-management",element:o.jsx(_se,{})}),o.jsx(ge,{path:"contract-templates",element:o.jsx(Die,{})}),o.jsx(ge,{path:"contract-templates/editor",element:o.jsx($ie,{})}),o.jsx(ge,{path:"project-display",element:o.jsx(Sse,{})}),o.jsx(ge,{path:"partners",element:o.jsx(Nse,{})}),o.jsx(ge,{path:"partners/:partnerId",element:o.jsx(Ese,{})}),o.jsx(ge,{path:"profil",element:o.jsx(Rie,{})}),o.jsx(ge,{path:"parametres",element:o.jsx(Gm,{})})]})]})}),o.jsx(K3,{})]})}class Wie extends J.Component{constructor(r){super(r);Gs(this,"handleReload",()=>{window.location.reload()});Gs(this,"handleGoHome",()=>{window.location.href="/"});Gs(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,n){console.error(" ErrorBoundary caught an error:",r),console.error("Component stack:",n.componentStack),this.setState({error:r,errorInfo:n})}render(){return this.state.hasError?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-lg w-full text-center",children:[o.jsx("div",{className:"flex justify-center mb-4",children:o.jsx("div",{className:"bg-red-100 rounded-full p-4",children:o.jsx(qf,{className:"h-12 w-12 text-red-600"})})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Oups ! Une erreur est survenue"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"L'application a rencontr un problme inattendu. Essayez de rafrachir la page ou de retourner  l'accueil."}),!1,o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsxs(G,{onClick:this.handleReload,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[o.jsx(Kf,{className:"h-4 w-4 mr-2"}),"Rafrachir"]}),o.jsxs(G,{onClick:this.handleGoHome,variant:"outline",children:[o.jsx(uP,{className:"h-4 w-4 mr-2"}),"Retour  l'accueil"]})]}),o.jsx("p",{className:"text-xs text-gray-400 mt-6",children:"Si le problme persiste, contactez le support technique."})]})}):this.props.children}}const Hie=()=>{const e=window.location.pathname;return e==="/"||e==="/landing"},Gie=()=>{if(Hie()){const e=J.lazy(()=>Fr(()=>Promise.resolve().then(()=>sie),void 0));return o.jsx(J.Suspense,{fallback:o.jsx("div",{className:"flex items-center justify-center h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:o.jsx("div",{className:"text-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"})})}),children:o.jsx(Kw,{children:o.jsx(rie,{children:o.jsx(e,{})})})})}return o.jsx(Wie,{children:o.jsx(Kw,{children:o.jsx(VG,{children:o.jsx(tH,{children:o.jsx(qie,{})})})})})};Jm.createRoot(document.getElementById("root")).render(o.jsx(J.StrictMode,{children:o.jsx(Gie,{})}));export{d0 as $,Hc as A,G as B,h0 as C,bh as D,jh as E,ba as F,wa as G,_a as H,Sa as I,ja as J,Ea as K,Na as L,tn as M,B as N,LD as O,hr as P,Ln as Q,J as R,Xt as S,Fn as T,Pi as U,mP as V,Zl as W,es as X,E3 as Y,ad as Z,Xl as _,an as a,nA as a$,hP as a0,Gn as a1,he as a2,hj as a3,Hf as a4,De as a5,Ac as a6,tv as a7,Bf as a8,Nie as a9,cK as aA,on as aB,It as aC,sa as aD,nH as aE,y1 as aF,cH as aG,sH as aH,JH as aI,B0 as aJ,gP as aK,mi as aL,Ph as aM,foe as aN,_I as aO,doe as aP,I3 as aQ,ere as aR,qre as aS,wre as aT,wse as aU,sr as aV,Ti as aW,S6 as aX,w3 as aY,Mo as aZ,rA as a_,f0 as aa,jl as ab,ee as ac,pe as ad,Mn as ae,wh as af,$se as ag,My as ah,$y as ai,CJ as aj,UA as ak,fP as al,mie as am,x3 as an,A3 as ao,qA as ap,UI as aq,VI as ar,Fy as as,RD as at,ID as au,OD as av,DD as aw,$D as ax,nx as ay,Zo as az,Ve as b,dy as b0,ac as b1,Hd as b2,BG as b3,ov as b4,dj as b5,vn as b6,eoe as b7,jr as b8,Di as b9,mh as ba,Ht as bb,j3 as bc,Gf as bd,ma as be,qf as bf,iv as bg,vb as bh,Soe as bi,Sie as bj,D3 as bk,joe as bl,_oe as bm,woe as bn,Fr as bo,nG as bp,ie as c,FD as d,cie as e,b3 as f,Ds as g,jy as h,VA as i,o as j,Vc as k,P as l,le as m,qc as n,Wc as o,kc as p,g0 as q,p as r,T as s,m0 as t,Te as u,zt as v,Qt as w,Ut as x,Pe as y,TR as z};
